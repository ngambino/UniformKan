\documentclass[reqno,10pt,a4paper,oneside,draft]{amsart}

\setcounter{tocdepth}{1}
%\usepackage[parfill]{parskip}

\usepackage{uniform-kan-prelude}

\newcommand{\LL}{\mathsf{L}}
\newcommand{\RR}{\mathsf{R}}
\newcommand{\MM}{\mathsf{M}}

\title{The Frobenius condition, right properness, \linebreak and uniform fibrations}

\begin{document}

\begin{abstract}
We develop further the theory of weak factorization systems and algebraic weak factorization systems.
In particular, we give a method for constructing (algebraic) weak factorization systems whose right maps can be thought of as (uniform) fibrations and that satisfy the (functorial) Frobenius condition.
As applications, we obtain a new proof that the Quillen model structure for Kan complexes is right proper, avoiding entirely the use of topological realization and minimal fibrations, and we solve an open problem in the study of homotopical models of type theories, proving a constructive version of the preservation of Kan fibrations by pushforward along Kan fibrations.
Our results also subsume and extend work by Coquand and others on cubical sets.
\end{abstract}

\author{Nicola Gambino}
\address{School of Mathematics, University of Leeds, Leeds LS2 9JT, UK}
\email{n.gambino@leeds.ac.uk}

\author{Christian Sattler}
\address{School of Mathematics, University of Leeds, Leeds LS2 9JT, UK}
\email{c.sattler@leeds.ac.uk}

% \date{\today}

\maketitle

\section*{Introduction}

This paper studies the Frobenius condition for weak factorization systems (wfs's), which asserts that pullback along a right map preserves left maps~\cite{garner:topological-simplicial,gambino-garner:idtypewfs}.
One reason for the interest in this condition is that it is closely related to the right properness of a Quillen model structure, which requires that pullback along a fibration preserves weak equivalences.
Indeed, for a Quillen model structure in which the cofibrations are stable under pullback, such as the Cisinski model structures~\cite{cisinski-asterisque}, right properness is equivalent to the Frobenius condition for the wfs of trivial cofibrations and fibrations.
Furthermore, when pushforward along right maps exists, \ie pullback along right maps has a right adjoint, the Frobenius condition is equivalent to the preservation of right maps by pushforward along a right map.
In the category of simplicial sets, this amounts to the preservation of Kan fibrations by pushforward along Kan fibrations, a fact that plays an important role in Voevodsky's simplicial model of univalent foundations~\cite{voevodsky-simplicial-model}.

For our development, we work in the setting of a category $\cal{E}$ equipped with an appropriate cofibrantly
generated wfs~$(\Cof, \TrivFib)$, to be thought of as consisting of cofibrations and trivial fibrations, and a functorial cylinder satisfying appropriate assumptions.
Building on ideas in~\cite{cisinski-asterisque}, we then construct a new wfs $(\TrivCof, \Fib)$, to be thought of as consisting of  trivial cofibrations and fibrations~(\cref{thm:wfstimes}). Here, a fibration is defined a a map with the right lifting property with respect to a class of maps called here generating trivial cofibrations, which are obtained as (a generalized form of) pushout product between the endpoint inclusions of the functorial cylinder and generating 
cofibrations.  We then prove that the wfs $(\TrivCof, \Fib)$ satisfies the Frobenius condition~(\cref{thm:non-alg-frobenius}).
When applied in the category of simplicial sets, with the wfs of monomorphisms and trivial Kan fibrations~\cite{quillen-homotopical} as $(\Cof, \TrivFib)$, fibrations in our sense are exactly Kan fibrations.
Therefore, our results yield a proof that the wfs of trivial cofibrations and Kan fibrations satisfies the Frobenius condition, and so give a new proof of right properness of the Quillen model structure for Kan complexes which avoids entirely topological realization, used in~\cite{hovey-model-categories}, and minimal fibrations, used in~\cite{joyal-tierney:simplicial-homotopy-theory}.

We then obtain analogous results for algebraic weak factorization systems (awfs's)~\cite{garner:small-object-argument,grandis-tholen-nwfs}.
In an awfs, the left and right right maps do not just satisfy a lifting property, but are equipped with a natural family of solutions for lifting problems.
The technical ingredient underpinning this idea is to express algebraic orthogonality not just with respect to a class of maps in a fixed category $\cal{E}$, but with respect to a category $\cal{I}$ equipped with a functor, which is often an inclusion or a forgetful functor, $u \co \cal{I} \to \cal{E}^\to$, where $\cal{E}^\to$ is the arrow category of $\cal{E}$.
For example, when~$\cal{E}$ is a presheaf category it is natural to define a uniform trivial cofibration to be a right map with respect to the category of monomorphisms and pullback squares, considered with the evident inclusion into $\cal{E}^\to$.
Unfolding the relevant definitions, a uniform trivial cofibration is a map equipped with diagonal fillers for lifting problems against monomorphisms, with the fillers satisfying a naturality condition with respect to pullback squares between monomomorphism.
The presence of this algebraic structure remedies some unsatisfactory aspects of wfs's (such as the failure of orthogonality classes to be closed under all colimits), something that has proved to be useful for applications (see~\cite{batanin-cisinski-weber,garner:globular-operator-awfs,garner-homomorphisms} or~\cite{awodey-cubical,coquand-cubical-sets,cohen-et-al:cubicaltt,pitts-cubical-nominal,swan-awfs} for examples).
The Frobenius condition has a natural counterpart in this context, called the functorial Frobenius condition~\cite{garner:topological-simplicial}, which requires that the pullback along right maps not only preserves left maps but also preserves morphisms between them.

Starting from a suitable awfs $(\CC, \TF)$, whose left and right maps are to be thought of as uniform cofibrations and uniform trivial fibrations, we define uniform fibrations by algebraic orthogonality with respect to a category having 
generating trivial cofibrations as objects.
We then show that there exists an awfs $(\TC, \FF)$ that has uniform fibrations as right maps (\cref{thm:sset-cset-nwfs}) and that satisfies the functorial Frobenius condition (\cref{uniform-fibrations-uniform-frobenius}).
Therefore, pushforward along a uniform fibration preserves uniform fibrations (\cref{uniform-fibrations-frobenius-pushforward}).
An important technical step in this development is the characterization of when an algebraically-free awfs (in the sense of~\cite{garner:small-object-argument}) has the functorial Frobenius property (\cref{thm:frobenius-comparison}), which is somehow more elaborate than its counterpart for ordinary wfs's and is of independent interest.

In order to apply our algebraic results in simplicial sets and cubical sets, we show that, given a category of monomorphisms and pullback squares satisfying some mild assumptions, it is possible to construct an awfs $(\CC, \TF)$ satisfying the conditions necessary to apply our results (\cref{rem-lift-suitable}).
Instantiating our definitions, we obtain the notion of a uniform Kan fibration which subsumes the one introduced in~\cite{cohen-et-al:cubicaltt}.
We then establish the existence of an awfs that has uniform Kan fibrations as right maps and that satisfies the functorial Frobenius property, so that pushforward along a uniform Kan fibration preserves uniform Kan fibrations.


These results contribute to the ongoing investigations on whether Voevodsky's simplicial model of univalent foundations~\cite{voevodsky-simplicial-model} admits a constructive version, \ie one that can be defined without the law of excluded middle and the axiom of choice. In order to do this, it is necessary to overcome the problem that the interpretation of
$\Pi$-types in the simplicial model relies on the preservation of Kan fibrations by pushforward along Kan fibrations~\cite[Lemma~2.3.1]{voevodsky-simplicial-model}, which cannot be proved constructively~\cite[Section~6]{coquand-non-constructivity-kan}. Here, we solve this problem by working with the notion of a uniform Kan fibration, that is classically equivalent to the usual one, but allows us to prove constructively the preservation of uniform Kan fibrations by pushforward along uniform Kan fibrations. Indeed, the proof of our results in  the case of simplicial sets, as well as cubical sets, are constructive.

Furthermore, our results also shed some light on the cubical set models of type theory that have been
investigated extensively in recent years~\cite{awodey-cubical,coquand-cubical-sets,cohen-et-al:cubicaltt,pitts-cubical-nominal,swan-awfs}. Indeed, the independence results obtained in~\cite{coquand-non-constructivity-kan} mentioned above have led the research community to shift its focus on models based on cubical sets and uniform Kan fibrations, since in that setting it is possible to develop a constructive model of univalent foundations~\cite{cohen-et-al:cubicaltt}, showing in particular that pushforward along a uniform Kan fibration preserves uniform Kan fibrations. But, as our results show, the key aspect that makes it possible to obtain that result on pushforward is the idea of using the algebraic notion of a uniform Kan fibration, rather than working with cubical sets. Since our results apply to cubical sets, we give also a new proof of the fact that pushforward along a uniform Kan fibration preserves uniform Kan fibrations, avoiding entirely complex calculations with cubical sets, unlike the existing ones~\cite{cohen-et-al:cubicaltt,huber-thesis}.
Indeed, one of the initial motivations for this work was to explore whether the theory of uniform fibrations in cubical sets could be developed at a greater level of generality, so as to make it applicable also to simplicial sets.

We also provide a characterization of uniform trivial fibrations in terms of the partial map classifer 
(\cref{thm:part-map-classifier}), as suggested to us by Thierry Coquand and Andr\'e Joyal.
We then use this characterization to show in what sense the notion of a uniform (trivial) fibration subsumes the standard notion of a (trivial) fibration (\cref{unif-vs-non-unif}) In particular, we prove that, in a presheaf category, a map can be equipped with the structure of a uniform (trivial) fibration if and only if it is a (trivial) fibration.
As we observe in~\cref{why-uniform}, however, the algebraic notion of a fibration is essential for our results in~\cref{sec:alg-fib} to hold constructively.

\subsection*{Remark}
In the hope of making the paper more concise, we confine comments on constructivity issues to certain remarks and footnotes.
However, let us point out here for the interested readers that our development does not rely on the law of the excluded middle or the axiom of choice, apart from~\cref{thm:wfstimes}, \cref{thm:sset-cset-nwfs} and \cref{rem-lift-suitable}.
For~\cref{thm:sset-cset-nwfs} and \cref{rem-lift-suitable}, we argue that the result holds constructively for simplicial sets and cubical sets separately, in~\cref{rem:constructive-small-object}.%

\subsection*{Organization of the paper} \cref{sec:bac} introduces the setting in which we work throughout the paper.
The core of the paper is then organized in two parts: the first part (\cref{sec:fib,sec:frob}) studies wfs's; the second part (\cref{sec:ortf,sec:frobc,sec:alg-fib,sec:alg-frob}) studies awfs's.
In the first part, we introduce fibrations and establish the existence of the corresponding wfs in \cref{sec:fib}, and then prove the Frobenius property for this wfs in \cref{sec:frob}.
In the second part, we begin by establishing basic facts about orthogonality functors (\cref{sec:ortf}) and then establishing necessary and sufficient conditions for an algebraically-free awfs to satisfy the functorial Frobenius condition (\cref{sec:frobc}).
The rest of the second part then proceeds in parallel with the first part.
\cref{sec:alg-fib} (parallel to \cref{sec:fib}) introduces uniform fibrations and establishes the existence of the associated awfs, while~\cref{sec:alg-frob} (parallel to \cref{sec:frob}) proves the Frobenius property for uniform fibrations.
We end the paper in \cref{sec:fib-psh} studying uniform (trivial) fibrations in presheaf categories and relating (trivial) fibrations and uniform (trivial) fibrations.

\subsection*{Acknowledgements}

We are grateful to Steve Awodey, Thierry Coquand, Richard Garner, Simon Huber, Andr\'e Joyal, Andrew Pitts, Emily Riehl, and Andrew Swan for helpful discussions and comments on earlier versions of the paper, to Marco Larrea Schiavon for pointing out an erroneous statement of \cref{retract-closure} in an earlier version of this paper, and to Fosco Loregian for pointing us to a useful reference.
This material is based on research sponsored by the Air Force Research Laboratory, under agreement number FA8655-13-1-3038, by a grant from the John Templeton Foundation, and by an EPSRC grant (EP/M01729X/1).

\section{Background}
\label{sec:bac}

Throughout the paper, we work with a category $\cal{E}$, assumed to be locally presentable and locally cartesian closed.
%\footnote{We choose to work in this fixed setting for simplicity of presentation.
%However, let us note here that the only aspects of local cartesian closure used are pullbacks and the existence of right adjoints to pullback along what we later call fibrations.}
In particular, $\catE$ is cocomplete and finitely complete and pullback preserves all limits and colimits, since it has both a left adjoint and a right adjoint.
For an arrow $f \co X \to Y$, we write $f^* \co \cal{E}_{/Y} \to \cal{E}_{/X}$ for the pullback along $f$, $f_{!} \co \cal{E}_{/X} \to \cal{E}_{/Y}$ for its left adjoint, which is given by composition with $f$, and $f_* \co \cal{E}_{/X} \to \cal{E}_{/Y}$ for its right adjoint, which we call pushforward along $f$.
We write $\cal{E}^\to$ for the category of arrows of $\cal{E}$ and $\cal{E}^\to_{\mathrm{cart}}$ for the subcategory of~$\cal{E}^\to$ of arrows and cartesian squares.

Examples of such categories abound; in particular, our assumptions are satisfied not just by presheaf categories, but by arbitrary Grothendieck toposes.
Our definitions and results are illustrated in two running examples.
The first is the category~$\SSet$ of simplicial sets, defined as the category of presheaves over the simplex category~$\Delta$.
The second is the category $\CSet$ of cubical sets of~\cite{cohen-et-al:cubicaltt}.
This is defined as the category of presheaves over the category $\Box$ with objects of the form $\Box^A$ with $|A| \in \mathbb{N}$ and morphisms~$\Box^A \to \Box^B$ given by functions from $B$ to the free de Morgan algebra on
$A$. Here, a de Morgan algebra is defined to be a bounded distributive lattice $(X, \land, \lor, \top, \bot)$ further equipped with a unary operation $\neg \co X \to X$ satisfying $\neg \neg x = x$, for all $x \in X$, and de Morgan's laws: $\neg (x \land y) = \neg x \lor \neg y$, $\neg (x \lor y) = \neg x \land \neg y$, for all $x, y \in X$.


Thus,~$\CSet$ is the category of cubical sets with symmetries, diagonals, connections, and involutions.
Note that the presence of symmetries precludes $\Box$ from being a Reedy category.
We stress that the only feature of the category $\Box$ relevant for the main results are connections and symmetries.
Thus, our results apply equally to many other variations of cubical sets, excluding however those considered in~\cite{coquand-cubical-sets,huber-thesis}, which do not have connections.

Recall from~\cite{kamps-porter:homotopy} that a \emph{functorial cylinder} in $\calE$ is an endofunctor $\interval \otimes (-) \co \catE \to \catE$ equipped with natural transformations
\[
\lcyl \otimes (-) \co \Id_\catE \to \interval \otimes (-)
\, , \quad
\rcyl \otimes (-) \co \Id_\catE \to \interval \otimes (-)
\, ,\]
called the left and right \emph{endpoint inclusions}, respectively.
Such a functorial cylinder is said to have \emph{contractions} if $\lcyl \otimes (-)$ and $\rcyl \otimes (-)$ have a common retraction $\ccyl \otimes (-) \co \interval \otimes (-) \to \Id_\catE$, making the following diagrams commute:
\[
\xymatrix@C+2em{
  \Id_\catE
  \ar[r]^-{\lcyl \otimes (-)}
  \ar@{=}[dr]
&
  \interval \otimes (-)
  \ar[d]^(0.4){\ccyl \otimes (-)}
&
  \Id_\catE
  \ar[l]_-{\rcyl \otimes (-)}
  \ar@{=}[dl]
\\&
  \Id_\catE
\rlap{.}}
\]
Further, a functorial cylinder with contractions as above has \emph{connections} if, for $k \in \braces{0\,, 1}$, there is a natural transformations $c^k \otimes (-) \co \interval \otimes \interval \otimes (-) \to \interval \otimes (-)$ such that the diagrams
\begin{equation} \label{connections:0}
\begin{gathered}
\xymatrix@C+3em{
  \interval \otimes (-)
  \ar[r]^-{\kcyl \otimes \interval \otimes (-)}
  \ar[d]_{\ccyl \otimes (-)}
&
  \interval \otimes \interval \otimes (-)
  \ar[d]^{c^k \otimes (-)}
&
  \interval \otimes (-)
  \ar[l]_-{\interval \otimes \kcyl \otimes (-)}
  \ar[d]^{\ccyl \otimes (-)}
\\
  \Id_\catE
  \ar[r]_{\kcyl \otimes (-)}
&
  \interval \otimes (-)
&
  \Id_\catE
  \ar[l]^{\kcyl \otimes (-)}
}
\end{gathered}
\end{equation}
and
\begin{equation} \label{connections:1}
\begin{gathered}
\xymatrix@C+3em{
  \interval \otimes (-)
  \ar[r]^-{\kcylinv \otimes \interval \otimes (-)}
  \ar@{=}[dr]
&
  \interval \otimes \interval \otimes (-)
  \ar[d]^(0.4){c^k \otimes (-)}
&
  \interval \otimes (-)
  \ar[l]_-{\interval \otimes \kcylinv \otimes (-)}
  \ar@{=}[dl]
\\&
  \interval \otimes (-)
}
\end{gathered}
\end{equation}
commute.
We adopt the convention of associating the tensor product notation to the right.
If the functor $\interval\otimes (-) \co \catE \to \catE$ has a right adjoint
$\exp(I, -) \co \catE \to \catE$, then we obtain a \emph{functorial cocylinder}
\[
(\exp(\interval, -), \exp(\bar{\delta}^0, -), \exp(\bar{\delta}^1, -)) \, ,
\]
\ie a functorial cylinder in the opposite category $\catE^{\op}$~\cite{kamps-porter:homotopy}.
Contractions and (effective) connection carry over as well.
In this case, note also that $\interval\otimes (-) \co \catE \to \catE$ preserves colimits.

Our main examples of functorial cylinders with contractions and connections, discussed below, arise from a monoidal structure, written $(\catE, \otimes, \top)$, and the presence of an \emph{interval object}, \ie an object~$\interval \in \catE$ equipped with maps~$\lcyl, \rcyl \co \top \to \interval$, called the left and right \emph{endpoint inclusions}, respectively.
In such a situation, a functorial cylinder is given by tensoring with $\interval$.
It is immediate to isolate structures on the interval object that guarantee the presence of contractions and connections on the associated functorial cylinder: contractions are induced by a map $\ccyl \co \interval \to \top$ and connections by maps $c^k \co \interval \otimes \interval \to \interval$, for $k \in \braces{0\,, 1}$, provided that suitable axioms hold.
Note that if the unit $\top$ of the monoidal structure is a terminal object, then we have contractions in a canonical way.

\begin{example} \label{exa:cyl-in-sset}
In $\SSet$, considered as a monoidal category with respect to its cartesian structure, an interval object is given by $\Delta^1$ with endpoint inclusions~$\kcyl  \co \braces{k} \to \Delta^1$ given by special cases of horn inclusions, $\kcyl = h^1_k$, for $k \in \braces{0\,, 1}$.
We have contractions since the monoidal structure is cartesian and connections $c^k \co \Delta^1 \times \Delta^1 \to \Delta^1$, with $k \in \braces{0\,, 1}$, given on points by $c^0(x, y) = \min(x, y)$ and $c^1(x, y) = \max(x, y)$ uniquely determined since~$\Delta^1$ and~$\Delta^1 \times \Delta^1$ are nerves of posets and $\min$ and $\max$ are monotone.
\end{example}

\begin{example} \label{exa:cyl-in-cuset}
The category $\Box$ has finite products, which makes cubical sets into a symmetric monoidal closed category.
In $\CSet$, an interval object with contractions is given by $\Box^1$ with endpoint inclusions $\kcyl \co \braces{k} \to \Box^1$ given by the maps from a singleton set to the free de Morgan algebra on an empty set that pick the bottom element for $k = 0$ and the top element for $k =1$.
We have contractions since the unit of the monoidal structure is a terminal object.
Connection operations $c^k \co \Box^1 \otimes \Box^1 \iso \Box^2 \to \Box^1$ for $k \in \braces{0\,, 1}$ are given by the maps from a singleton set to the free de Morgan algebra on a two-element set $\braces{x\,, y}$ that pick $x \wedge y$ and $x \vee y$, respectively).
\end{example}

For the remainder of this section and the next one, we work with ordinary wfs's~\cite{bousfield-wfs} and use standard notation and terminology.
For example, for a class $\cal{I}$ of maps in $\cal{E}$, we write $\liftr{\cal{I}}$ for the class of maps having the right lifting property with respect to all maps in $\cal{I}$.
As is well-known, we have inclusions
\begin{equation} \label{equ:inclus-orthog}
\cal{I} \subseteq \liftl{(\liftr{\cal{I}})}
\, , \quad
\cal{I} \subseteq \liftr{(\liftl{\cal{I}})}
\, .\end{equation}
Let us recall the definition of the Frobenius property.

\begin{definition}
We say that a wfs $(\cal{L}, \cal{R})$ has the \emph{Frobenius property} if the pullback of an $\cal{L}$-map along an 
$\cal{R}$-map is again an $\cal{L}$-map.
\end{definition}

See~\cite{clementino:frobenius} for an explanation of the connection with Lawvere's Frobenius condition~\cite{lawvere-equality}.
As mentioned in the introduction, a Quillen model structure~$(\mathsf{Weq}, \Fib, \Cof)$ in which the cofibrations are stable under pullback (such as the Quillen model structure for Kan complexes~\cite{quillen-homotopical}, where the cofibrations are the monomorphisms) is right proper, \ie the pullback of a weak equivalence along a fibration is again a weak equivalence, if and only if the wfs~$(\TrivCof, \Fib)$ of trivial cofibrations and fibrations has the Frobenius property.

We say that a wfs $(\cal{L}, \cal{R})$ is \emph{free} on a class of maps $\cal{I}$ (not necesssarily a set) if 
$\cal{R} = \liftr{\cal{I}}$.
If this is the case, then $\cal{L} = \liftl{(\liftr{\cal{I}})}$.
Of course, a wfs could be free on many different classes of maps.
By Quillen's small object argument~\cite{quillen-homotopical}, every set $\cal{I}$ determines a wfs $(\cal{L}, 
\cal{R})$ free on $\cal{I}$.
These are what we call \emph{cofibrantly generated wfs's}.
The next proposition is used in the proof of~\cref{thm:non-alg-frobenius} and provides the non-algebraic counterpart of \cref{thm:frobenius-comparison}, which is the main result of \cref{sec:frobc}.

\begin{proposition} \label{thm:frobenius-equivalence}
Let $(\cal{L}, \cal{R})$ be a wfs that is free on a class of maps $\cal{I}$.
Then the following are equivalent:
\begin{enumerate}[(i)]
\item $(\cal{L}, \cal{R})$  has the Frobenius property.
\item The pushforward along an $\cal{R}$-map preserves $\cal{R}$-maps.
\item The pullback of an $\cal{I}$-map along an $\cal{R}$-map is an $\cal{L}$-map.
\end{enumerate}
\end{proposition}

\begin{proof} The claims follow by standard properties of the interaction between lifting properties and adjoint functors.
\end{proof}

\section{Fibrations}
\label{sec:fib}

Let us now assume that $\catE$ is equipped with a functorial cylinder $\interval\otimes (-) \co \catE \to \catE$ with contractions and connections, and that $\interval\otimes (-) \co \catE \to \catE$ has a right adjoint.
The notion of a fibration that we introduce and study in this section and the next is relative not only to $\cal{E}$ and its functorial cylinder, but also to a wfs on $\cal{E}$ satisfying some assumptions that we encapsulate in the notion of a \emph{suitable wfs}, given in \cref{thm:suitable-wfs} below.
In order to state that definition, we need some notation.
For $k \in \braces{0, 1}$ and a map $i \co A \to B$ in $\catE$, we define the \emph{Leibniz product}~\cite{riehl-verity:reedy} of the endpoint inclusion~$\kcyl \otimes (-)$ and~$i$ to be the map
\[
\kcyl \hatotimes i \co (\interval \otimes A) +_A B \to \interval \otimes B
\]
determined uniquely by the following pushout diagram:
\begin{gather*}
\xymatrix@C=1.2cm{
  A
  \ar[r]^{i}
  \ar[d]_{\kcyl \otimes A}
&
  B
  \ar@/^2pc/[ddr]^{\kcyl \otimes B}
  \ar[d]
&\\
  \interval \otimes A
  \ar@/_1pc/[drr]_{\interval \otimes i}
  \ar[r]
&
  (\interval \otimes A) +_A B
  \ar[dr]^-{\delta^k \hatotimes i}
&\\&&
  \interval \otimes B
\rlap{.}}
\end{gather*}
We shall use Leibniz products with endpoint inclusions throughout the paper.
In the next definition and onwards, we write $(\Cof, \TrivFib)$ to denote a suitable wfs, and refer to maps in $\Cof$ as \emph{cofibrations} and maps in $\TrivFib$ as \emph{trivial fibrations}; this helps to convey some of the basic intuition motivating our development.

\begin{definition} \label{thm:suitable-wfs}
A wfs $(\Cof, \TrivFib)$ is said to be \emph{suitable} if the following hold:
\begin{enumerate}[({S}1)]
\item $(\Cof, \TrivFib)$ is cofibrantly generated,
\item every object is cofibrant, \ie for every $X \in \cal{E}$, the unique map $\bot_X \co 0 \to X$ is a cofibration,
\item cofibrations are closed under pullbacks, \ie for every pullback square
\[
\xymatrix{
  B
  \ar[d]_j
  \ar[r]^q
  \pullback{dr}
&
  A
  \ar[d]^i
\\
  Y
  \ar[r]_p
&
  X
}
\]
if $i \in \Cof$ then $j \in \Cof$,
\item cofibrations are closed under Leibniz product with the endpoint inclusions, \ie for every $i \in \Cof$ we have~$\kcyl \hatotimes i \in \Cof$.
\end{enumerate}
\end{definition}

\begin{example} \label{thm:generation-presheaf-cisinski}
By a result of Cisinski~\cite[Proposition~1.2.27]{cisinski-asterisque}, every presheaf category admits a suitable wfs whose cofibrations are the mononomorphisms.
When $\cal{E}$ is a category of presheaves over an elegant Reedy category~\cite{bergner-rezk-elegant}, a map has the right lifting property with respect to monomorphisms if and only if it has it with respect to boundary inclusions (latching object inclusions for representables).
\end{example}

Let us now fix a suitable wfs $(\Cof,\TrivFib)$ and let $\cal{I}$ be a set of maps that cofibrantly generates it, which exists by assumption (S1). We refer to  elements of $\cal{I}$ as \emph{generating cofibrations}. 
We wish to define a new wfs, to be thought of as consisting of trivial cofibrations and fibrations.
For this, we begin by defining the set of maps that determines the notion of a fibration.
This set is defined by letting
\begin{equation} \label{equ:cylinc}
\cal{I}_\otimes \defeq \braces{\kcyl \hatotimes i \mid k \in \braces{0\,, 1} \, , \; i \in \cal{I} }
\, .\end{equation}
We refer to elements of $\cal{I}_\otimes$ as \emph{generating trivial cofibrations}.

\begin{definition} \label{thm:fib}
A \emph{fibration} is a map with the right lifting property with respect to all generating trivial cofibrations.
\end{definition}

We now define a \emph{trivial cofibration} to be a map with the left lifting property with respect to all fibrations.
We write $\Fib$ for the class of fibrations and $\TrivCof$ for the class of trivial cofibrations, so that 
\[
\Fib = \liftr{(\cal{I}_\otimes)} \, , \quad \TrivCof = \liftl{\Fib} \, .
\]
The next proposition is immediate. 

\begin{proposition} \label{thm:wfstimes}
$(\TrivCof, \Fib)$ is a wfs in $\cal{E}$.
\end{proposition}

\begin{proof} By the small object argument, with $\cal{I}_\otimes$ as the generating set. 
\end{proof} 

Note that, since $\Cof$ is closed under Leibniz products with the endpoint inclusions, we have that~$\cal{I}_\otimes \subseteq \Cof$. Therefore, since $\Cof$ is saturated, we have $\TrivCof \subseteq \Cof$, \ie every trivial cofibration is a cofibration.
We now illustrate our notion of a fibration in our running examples.

\begin{example} \label{thm:fib-is-kan}
In $\SSet$, let~$(\Cof, \TrivFib)$ be the wfs of monomorphisms and trivial Kan fibrations, which is cofibrantly generated by the set of boundary inclusions 
\[
\cal{I} = \{  i^n \co \partial \Delta^n \to \Delta^n \ \mid \ n \in \mathbb{N} \} \rlap{.}
\]
Then, a fibration in our sense is a map with the right lifting property with respect to all maps of the form
\[
h_k^1 \hatotimes i^n \co (\Delta^1 \times \partial \Delta^n ) \cup (\braces{k} \times \Delta^n ) \to \Delta^1 \times \Delta^n 
\, ,\]
given by the Leibniz product of an endpoint inclusion $h_k^1 \co \braces{k} \to \Delta^1$ with a 
boundary inclusion $i^n \co \partial \Delta^n \to \Delta^n$.
This is shown equivalent to the usual notion of Kan fibration in~\cite[Chap.~IV, Sec.~2]{gabriel-zisman:calculus-of-fractions}.
\end{example}

\begin{example} \label{nonalgebraic-cof}
In $\CSet$, let $(\Cof, \TrivFib)$ be the wfs in which~$\Cof$ consists of all monomorphisms, which is
suitable by~\cite[Proposition~1.2.27]{cisinski-asterisque} (\cf~\cref{thm:generation-presheaf-cisinski}). 
A fibration in $\CSet$ will be called a \emph{Kan fibration}.
To illustrate the relationship with the standard Kan filling condition for cubes, let $i^n \co \partial \Box^n \to \Box^n$, for $n \in \mathbb{N}$, denote the boundary inclusion for~$\Box^n$, which is given by the $n$-fold Leibniz tensor of~$[\lcyl, \rcyl] \co \braces{0\,, 1} \to \Box^1$.
%\footnote{Note that for our choice of cube category, which is not Reedy, this will not be a maximal non-trivial subobject.}
Then 
\[
\lcyl \hatotimes i^n \co \sqcup_1^{1+n} \to \Box^{1+n} \, , \quad  \rcyl \hatotimes i^n \co \sqcap_1^{1+n} \to \Box^{1+n}
\]
are the inclusions. 
Since the cube category has symmetries, a Kan fibration in $\CSet$ has the right lifting property also with respect to open box inclusions, which are counterparts in cubical sets of the horn inclusions in simplicial sets.
%\footnote{Without symmetries, one should consider two-sided Leibniz tensors such as $i^a \hatotimes \lcyl \hatotimes i^b \co \sqcup_a^{a+1+b} \to \Box^{a+1+b}$.}
The fibrant cubical types defined in~\cite{cohen-et-al:cubicaltt} arise by considering fibrations as defined by weak right 
orthogonality with respect to \notec{To be fixed} the subset $\cal{I}' \subseteq \cal{I}$  spanned by monomorphisms\footnote{Or decidable monomorphisms, if working constructively.} classified by their face lattice~$\Phi$, \ie those arising as a pullback 
of~$\braces{\top} \to \Phi$, excluding for example diagonals in cubes.
%Since the presence of symmetries, diagonals, and connections precludes the cube category from being Reedy, this may turn out to be a %natural restriction.
Note that $\cal{I}'$ is the left class of a suitable wfs and is thus covered by our development.
\end{example}


\begin{remark} \label{cisinski-remark}
We relate the notion of a fibration introduced here with the notion of a naive fibration introduced by Cisinski~\cite{cisinski-asterisque}.
For this, let $m \otimes (-)  \co \Id_\catE + \Id_\catE \to \interval \otimes (-)$ be the natural transformation
given by
\[
m \otimes (-) \defeq [\lcyl \otimes (-), \rcyl \otimes (-)]
\, .\]
A \emph{naive Cisinski fibration} would be defined as a map with the right lifting property with respect to the class
\begin{align*}
\cal{I}_\otimes'
&\defeq
\braces{(m \hatotimes (-))^n (\kcyl \hatotimes i) \mid n \in \mathbb{N} \, , \; k \in \braces{0\,,1} \, , \;  i \in \cal{I} }
\\
&=_{\phantom{\operatorname{def}}}
\braces{m \hatotimes \ldots \hatotimes m \hatotimes \kcyl \hatotimes i \mid k \in \braces{0\,,1} \, , \;  i \in \cal{I} } \rlap{.}
\end{align*}
Informally, one could think of this set as the closure of $\cal{I}_\otimes$ under Leibniz product with $m$.

Our reasons for working with~$\cal{I}_\otimes$ instead of this class are twofold.
First, if the functorial cylinder is induced by tensoring with an interval object in a symmetric monoidal category and~$\Cof$ is closed under Leibniz product with the boundary inclusion $[\lcyl, \rcyl] \co 1 + 1 \to \interval$, then by permuting the Leibniz product one sees that every fibration is a naive Cisinski fibration.
This is the case in our main examples, where $\Cof$ consists of all monomorphisms, the map $[\lcyl, \rcyl]$ is a monomorphism, and Leibniz product preserves monomorphisms.

For our second point, we use some notions and results in~\cref{sec:frob}.
If we assume generalized connections (in the sense of $(1+n+1)$-ary operations that behave as connections for fixed middle~$n$ arguments), and that $\Cof$ is closed under Leibniz product with $[\lcyl, \rcyl]$ (for example, this is the case if $[\lcyl, \rcyl]$ is a monomorphism and the maps in~$\Cof$ are the monomorphisms in a presheaf category), then the maps in $\cal{I}'_\otimes$ can still be shown to be strong homotopy equivalences.
This gives rise to an inclusion $\Cof' \to \Cof \cap S$ (where $S$ is the class of strong homotopy equivalences that we define in \cref{sec:frob}).
By \cref{thm:main-sheretract}, it then follows that every fibration is a naive Cisinski fibration.
\end{remark}




We now wish to give an equivalent characterization of fibrations, which does not refer to the generating
cofibrations. For this, we use the cocylinder structure on the right adjoint $\exp(\interval, -)$ to $\interval \otimes (-)$.
For $k \in \{ 0 \, , 1 \}$ and a map $f \co X \to Y$ in $\calE$, we define the \emph{Leibniz exponential} of
$\exp(\bar{\kcyl}, -)$ and $f$ to be the map
\[
\hatexp(\kcyl, f) \co X^\interval \to Y^\interval \times_{Y} X
\]
determined uniquely by the the following pullback diagram:
\[
\xymatrix{
X^\interval \ar@/^2pc/[drr]^-{\exp(\bar{\kcyl}, X)}  \ar@/_2pc/[ddr]_{\exp(\interval, f)} \ar[dr]^-{\hatexp(\bar{\kcyl}, f)} &  & \\
  &   Y^\interval \times_{Y} X    \ar[d] \ar[r]  & X \ar[d]^f \\
  & Y^\interval \ar[r]_{\exp(\bar{\kcyl}, Y)} & Y \rlap{.} }
  \]
This gives a functor, fitting in an adjunction with the Leibniz product, as follows:
\begin{equation}
\label{equ:leibniz-prod-exp}
\xymatrix@C+4em{
  \catE^\to
  \ar@<1ex>[r]^{\kcyl \hatotimes (-)}
  \ar@{}[r]|{\bot}
&
  \catE^\to
  \ar@<1ex>[l]^{\hatexp(\bar{\delta}^k, -)}
\rlap{.}}
\end{equation}
The desired characterization of fibrations, stated in the next proposition, now follows from standard adjointness arguments.


\begin{proposition} \label{thm:char-fib-nonalg} For a map $p \co X \to Y$ in $\cal{E}$, the following are equivalent:
\begin{enumerate}[(i)]
\item $p$ is a fibration,
\item $\hatexp(\bar{\lcyl}, p)$ and $\hatexp(\bar{\rcyl}, p)$ are trivial fibrations.
\end{enumerate} \qed
\end{proposition}

Note that \cref{thm:char-fib-nonalg} implies, by standard orthogonality arguments, that $\Fib = \liftr{(\Cof_\otimes)}$, where 
$\Cof_\otimes \defeq \braces{\delta^k \hatotimes i \mid  k \in \{ 0 \, , 1 \} \, , \;  i \in \Cof \,  }$. The next corollary will be useful to establish the Frobenius property for $(\TrivCof, \Fib)$ in~\cref{sec:frob}. 

\begin{corollary} 
\label{thm:kcyl-of-cof-is-trivcof-non-alg} Let $f \co X \to Y$ in $\cal{E}$. 
If $f \in \Cof$, then $\kcyl \hatotimes f \in \TrivCof$, for $k \in \{0 \, , 1 \}$.
\end{corollary}

\begin{proof} Assume $f \in \Cof$ and let $k \in \{0 \, 1 \}$. In order to show that $\kcyl \hatotimes f \in \TrivCof$, it suffices to show that  $\kcyl \hatotimes f \in \liftl{( \liftr{\TrivCof})}$, \ie $\kcyl \hatotimes f \in \liftl{\Fib}$. But we have that 
\begin{alignat*}{2} 
\kcyl \hatotimes f \in  \liftl{\Fib} 
& \Leftrightarrow (\forall p \in \Fib) \, \kcyl \hatotimes f  \pitchfork p & \\ 
& \Leftrightarrow (\forall p \in \Fib) \, f  \pitchfork \hatexp(\bar{\kcyl}, p) & 
\end{alignat*}
But we know that if $p \in \Fib$, then $ \hatexp(\bar{\kcyl}, p) \in \TrivFib$ by~\cref{thm:char-fib-nonalg}. 
\end{proof} 



\section{The Frobenius property for fibrations}
\label{sec:frob}

We continue to work with the locally presentable and locally cartesian closed category $\catE$, equipped with a functorial cylinder $\interval\otimes (-) \co \catE \to \catE$ with contractions and connections, and such that~$\interval\otimes (-) \co \catE \to \catE$ has a right adjoint, and a fixed suitable wfs $(\Cof, \TrivFib)$ in $\calE$, with generating set~$\cal{I}$.

Our aim in this section is to show that the wfs $(\TrivCof, \Fib)$ of \cref{thm:wfstimes} satisfies the Frobenius property.
Our proof of the Frobenius property consists of three main steps.
First, we introduce the notion of a \emph{strong homotopy equivalence} (\cref{def:strhe}) and give a characterization of strong homotopy equivalences as certain retracts (\cref{strong-h-equiv-as-section-non-alg}).
Secondly, we show that the maps in $\cal{I}$ which are strong homotopy equivalences are retracts of maps in $\cal{I}_\otimes$, and that every map in $\cal{I}_\otimes$ is both in $\cal{I}$ and a strong homotopy
equivalence (\cref{thm:main-sheretract}).
Thirdly, we show that the pullback of a strong homotopy equivalence along a fibration is again an strong homotopy equivalence (\cref{thm:non-alg-frobenius-she}).
With these facts in place, the Frobenius condition for $(\TrivCof, \Fib)$ in \cref{thm:non-alg-frobenius} follows easily.

We begin by introducing strong homotopy equivalences.
For this, we need to review some preliminary notions.
Let $f, g \co X \to Y$ be maps in $\catE$.
Recall that a \emph{homotopy from $f$ to $g$}, denoted $\phi \co f \sim g$, is a morphism $\phi \co \interval \otimes X \to Y$ such that the following diagram commutes:
\begin{equation} \label{equ:homotopy}
\begin{gathered}
\xymatrix@C=1.2cm{
  X
  \ar[r]^-{\lcyl \otimes X}
  \ar[dr]_{f}
&
  \interval \otimes X
  \ar[d]^(0.4){\phi}
&
  X
  \ar[dl]^{g}
  \ar[l]_-{\rcyl \otimes X}
\\&
  Y
\rlap{.}}
\end{gathered}
\end{equation}
We say that a map $f \co X \to Y$  in $\catE$ is called a \emph{left} (or {\emph{$0$-oriented}) \emph{homotopy equivalence} if there exist $g \co Y \to X$ and homotopies $\phi \co g \cc f \sim \id_X $, $\psi \co f \cc g \sim \id_Y$.
Dually, we have a \emph{right} (or {\emph{ $1$-oriented}) \emph{homotopy equivalence} if there exist $g \co Y \to X$ and homotopies $\phi \co \id_X \sim g \cc f$, $\psi \co \id_Y \sim f \cc g$.
The notion of a strong homotopy equivalence, defined below, is obtained by requiring an additional condition on the homotopies $\phi$ and $\psi$.

\begin{definition} \label{def:strhe}
For $k \in \braces{0\,, 1}$, a map $f \co X \to Y$  in $\catE$ is called a \emph{strong $k$-oriented homotopy equivalence} if there is a map $g$ and homotopies $\phi$ and $\psi$ making $f$ into a $k$-oriented homotopy equivalence such that the following diagram commutes:
\[
\xymatrix{
  \interval \otimes X
  \ar[r]^{\interval \otimes f}
  \ar[d]_{\phi}
&
  \interval \otimes Y
  \ar[d]^{\psi}
\\
  X
  \ar[r]_{f}
&
  Y \, .
}
\]
\end{definition}

We write $S_k$ for the class of strong $k$-oriented homotopy equivalences and let~$S \defeq S_0 \cup S_1$.
Elements of $S$ are called \emph{strong homotopy equivalences}.

\begin{remark} \label{thm:endpoint-are-she}
The components of the endpoint inclusion $\kcyl \otimes (-) \co \Id_\catE \to \interval \otimes (-)$ are strong $k$-oriented homotopy equivalences.
In fact, they are strong $k$-oriented deformation retracts, \ie strong $k$-oriented homotopy equivalences for which the homotopy~$\phi$ is trivial, \ie $\phi = \varepsilon \otimes X$, where $\varepsilon$ is the contraction of the functorial cylinder.
To show this, one exploits crucially the assumption that the functorial cylinder has connections.
For $k = 0$, the retraction is given by~$\varepsilon \otimes X \co \interval \otimes X \to X$ and the homotopy $\psi \co (\lcyl \otimes X) \circ (\varepsilon \otimes X)  \sim
1_{\interval \otimes X}$ is given by the connection~$c^0 \otimes X$.
The axioms for the left and right endpoint of $\psi$ follow from the left sides of~\eqref{connections:0} and~\eqref{connections:1}, respectively.
The axiom for strength follows from the right part of~\eqref{connections:0}.
The case $k = 1$ is similar.
\end{remark}

Let us give an alternative characterization of strong $k$-oriented homotopy equivalences.
For this, observe that we have a commutative diagram \notec{We should explain why this commutes. (Because the square $0, \Id, \Id, I \otimes (-)$ commutes and \eqref{equ:thetak} is induced by that. See \cref{theta} where this is done properly.)}
\begin{equation} \label{equ:thetak}
\begin{gathered}
\xymatrix@C+2em{
  X
  \ar[r]^-{\kcylinv \otimes X}
  \ar[d]_{f}
&
 \interval \otimes X
 \ar[r]^-{\iota_1}
 &
  (\interval \otimes X) +_X Y \ar[d]^{\kcyl \hatotimes f}
  \\
  Y
  \ar[rr]_-{\kcylinv \otimes Y}
  &
&
  \interval \otimes Y
}
\end{gathered}
\end{equation}
for $k \in \braces{0\,, 1}$.
This diagram gives us (functorially in $f$) an arrow~$\thetak \hatotimes f \co f \to \kcyl \hatotimes f$ in the category of maps in~$\catE$, which we use in the next lemma to provide a characterization of strong homotopy equivalences as retractions.

\begin{lemma} \label{strong-h-equiv-as-section-non-alg}
A map $f \co X \to Y$ is a strong $k$-oriented homotopy equivalence if and only if the map $\thetak \hatotimes f  \co f \to \kcyl \hatotimes f$ exhibits $f$ as a retract of $\kcyl \hatotimes f$, \ie there are dotted arrows as follows:
\[
\xymatrix@C+4em{
  X
  \ar[r]^-{\iota_1 \cc (\kcylinv \otimes X)}
  \ar[d]_f
&
  (\interval \otimes X) +_X Y
  \ar[d]^{\kcyl \hatotimes f}
  \ar@{.>}[r]
&
  X
  \ar[d]^f
\\
  Y
  \ar[r]_-{\kcylinv \otimes Y}
&
  \interval \otimes Y
  \ar@{.>}[r]
&
  Y
\rlap{,}}
\]
such that the two horizontal composites are identities.
\end{lemma}

\begin{proof}
First, by a standard diagram-chasing argument, giving the square on the right is equivalent to giving maps $\phi \co \interval \otimes X \to X$, $g \co Y \to X$, $\psi \co \interval \otimes Y \to Y$ such that the following diagrams commute:
\begin{align} \label{equ:first-three}
\begin{gathered}
\xymatrix{
  X
  \ar[r]^-{\kcyl \otimes X}
  \ar[d]_f
&
  \interval \otimes X
  \ar[d]^{\phi}
\\
  Y \ar[r]_-{g}
&
  X
\rlap{,}}
\end{gathered}
&&
\begin{gathered}
\xymatrix{
  Y
  \ar[r]^-g
  \ar[d]_{\kcyl \otimes Y}
&
  X
  \ar[d]^f
\\
  \interval \otimes Y
  \ar[r]_-{\psi}
&
  Y
\rlap{,}}
\end{gathered}
&&
\begin{gathered}
\xymatrix{
  \interval \otimes X
  \ar[r]^-\phi
  \ar[d]_{I \otimes f}
&
  X
  \ar[d]^{f}
\\
  \interval \otimes Y
  \ar[r]_-{\psi}
&
  Y
\rlap{.}}
\end{gathered}
\end{align}
Second, requiring that the two horizontal composites are identities means that the diagrams
\begin{align} \label{equ:second-two}
\begin{gathered}
\xymatrix@C+2em{
  X
  \ar[r]^-{\kcylinv \otimes X}
  \ar@{=}[dr]
&
  \interval \otimes X
  \ar[d]^\phi
\\&
  X
\rlap{,}}
\end{gathered}
&&
\begin{gathered}
\xymatrix@C+2em{
  Y
  \ar[r]^-{\kcylinv \otimes Y}
  \ar@{=}[dr]
&
  \interval \otimes Y
  \ar[d]^{\psi}
\\&
  Y
}
\end{gathered}
\end{align}
commute.
With reference to the diagram in~\eqref{equ:homotopy}, the equations in~\eqref{equ:first-three} provide endpoint~$k$ for~$\phi$ and~$\psi$, and strength, respectively; while the equations in~\eqref{equ:second-two} provide endpoints~$1-k$ for~$\phi$ and~$\psi$, respectively.
\end{proof}


As observed in~\cref{thm:endpoint-are-she}, $\kcyl \otimes X \co X \to \interval \otimes X$ is a strong $k$-oriented homotopy equivalence for all $X \in \cal{E}$.
Therefore, by~\cref{strong-h-equiv-as-section-non-alg}, $\thetak \hatotimes (\kcyl \otimes X)  \co \kcyl \otimes X \to \kcyl \hatotimes (\kcyl \otimes X)$ exhibits $\kcyl \otimes X$ as a retract of
$\kcyl \hatotimes (\kcyl \otimes X)$. We spell out the retraction, since we will make use of it in the proof of~\cref{thm:kcylf-is-she} below:
\begin{equation}
\label{equ:kcyl-as-retract}
\begin{gathered}
\xymatrix@C+4em{
  X
  \ar[r]^-{\iota_1 \cc (\kcylinv \otimes X)}
  \ar[d]_{\kcyl \otimes X}
&
  (\interval \otimes X) +_X (\interval \otimes X)
  \ar[d]^{\kcyl \hatotimes (\kcyl \otimes X)}
  \ar[r]^-{[\varepsilon_X, \varepsilon_X]}
&
  X
  \ar[d]^{\kcyl \otimes X}
\\
  \interval \otimes X
  \ar[r]_-{\kcylinv \otimes (\interval \otimes X)}
&
  \interval \otimes (\interval \otimes X)
  \ar[r]_{c_X}
&
  \interval \otimes X
\rlap{,}}
\end{gathered}
\end{equation}
where $[\varepsilon_X, \varepsilon_X]$ indicates the copair of two copies of the contraction $\varepsilon_X \co \interval \otimes X \to X$. The commutativity of the right-hand side diagram
and the fact that the horizontal composites are identities follow easily from the axioms for contractions and connections.


Note that strong $k$-oriented homotopy equivalences have better closure properties than strong $k$-oriented deformation retracts.
For example, \cref{strong-h-equiv-as-section} implies that strong $k$-oriented homotopy equivalences are closed under retracts.
Indeed, let $f$ be a strong homotopy equivalence and $g$ be a retract of $f$.
Then, $\thetak \hatotimes g$ is a retract of $\thetak \hatotimes f$, since $\thetak \hatotimes (-) \co \catE^\to \to \catE^\to$ is a functor and functors preserve retracts.
Since~$f$ is a strong homotopy equivalence, $\thetak \hatotimes f$ is a section.
But then $\thetak \hatotimes g$ is also a section (since sections are closed under retracts), and so $g$ is a strong $k$-oriented homotopy equivalence.

\begin{lemma} \label{thm:kcylf-is-she}
For every $f$ in $\cal{E}$, we have that $\kcyl \hatotimes f$ is a strong $k$-oriented homotopy equivalence.
\end{lemma}

\begin{proof} This is a  diagram-chasing argument, but we present it in outline since this gives an unfolding of the abstract proof of ~\cref{thm:kcylf-is-she-alg},
which establishes the corresponding fact in the algebraic setting. By \cref{strong-h-equiv-as-section-non-alg} it suffices to show that  the diagram
 \begin{equation*}
 \begin{gathered}
\xymatrix@C+8em{
  (\interval \otimes X) +_X Y
  \ar[r]^-{\iota_1 \cc (\kcylinv \otimes  (( \interval \otimes X) +_X Y) }
  \ar[d]_{\kcyl \hatotimes f}
&
 \big( (\interval \otimes X) +_X Y \big) +_{ (\interval \otimes X) +_X Y} (\interval \otimes Y)
  \ar[d]^{\kcyl \hatotimes (\kcyl \hatotimes f)}
\\
  \interval \otimes Y
  \ar[r]_-{\kcylinv \otimes (\interval \otimes Y)}
&
  \interval \otimes (\interval \otimes Y)}
\end{gathered}
\end{equation*}
exhibits $\kcyl \hatotimes f$ as a retract of $\kcyl \hatotimes (\kcyl \hatotimes f)$ in $\cal{E}^\to$. The key step in the proof is to replace this problem with an equivalent one. For this,
we need to construct some auxiliary maps. First, we define
\[
\sigma_f  \co
 	(\interval \otimes X) +_X Y
	\to
	(\interval \otimes (\interval \otimes X)) +_X (\interval \otimes Y)
\]
 by letting $\sigma_f \defeq (\kcyl \otimes (\interval \otimes X)) +_X (\kcyl \otimes Y)$. Secondly, we have a pushout diagram
\[
\xymatrix{
X \ar[r]^f \ar[d]_{\kcyl  \otimes X} & Y \ar[r]^{\kcyl \otimes Y}  & \interval \otimes Y  \ar[dd]^{\iota_2} \ar@/^2pc/[dddr]^{\kcyl \otimes (\interval \otimes Y)} &  \\
\interval \otimes X \ar[d]_{\kcyl \otimes (\interval \otimes X)} & & \\
\interval \otimes (\interval \otimes X) \ar[rr]_-{\iota_1} \ar@/_2pc/[drrr]_{\interval \otimes (\interval \otimes f)} & & (\interval \otimes (\interval \otimes X)) +_X (\interval \otimes Y) \ar[dr]^{\tau_f} &  \\
 & & & I \otimes (I \otimes Y) }
 \]
Using the maps $\sigma_f$ and $\tau_f$, we then have a further pushout diagram
\[
\xymatrix{
 (\interval \otimes X) +_X Y  \ar[r]^{\kcyl \hatotimes f} \ar[d]_{\sigma_f}  & \interval \otimes Y \ar[d]^{\iota_2}  \ar@/^2pc/[ddr]^{\kcyl \otimes (\interval \otimes Y)} & \\
 (\interval \otimes (\interval \otimes X)) +_X (\interval \otimes Y)  \ar[r]^-{\iota_1} \ar@/_1pc/[drr]_{\tau_f} & Z \ar[dr]^-(.4){ (\kcyl \mathbin{\hat{\cc}} \kcyl) \hatotimes f}  & \\
  & & \interval \otimes (\interval \otimes Y) \rlap{,}}
  \]
 where the notation $(\kcyl \mathbin{\hat{\cc}} \kcyl) \hatotimes f$ is intented to suggest the analogy with the proof of~\cref{thm:kcylf-is-she-alg}.
 Since the functor $\interval \otimes (-) \co \cal{E} \to \cal{E}$ preserves pushouts (since it preserves all colimits being a left adjoint), it is possible to
 show that our goal is equivalent to showing that the diagram
 \[
\xymatrix@C+10em{
  (\interval \otimes X) +_X Y
  \ar[r]^-{\iota_1 \cc (   (\kcylinv \otimes (\interval \otimes X)) +_X (\kcylinv \otimes Y)   )}
  \ar[d]_{\kcyl \hatotimes f}
&
Z
  \ar[d]^{(\kcyl \mathbin{\hat{\cc}} \kcyl) \hatotimes f } \\
  \interval \otimes Y
  \ar[r]_-{\kcylinv \otimes (\interval \otimes Y)}
&
  \interval \otimes (\interval \otimes Y)}
  \]
exhibits $\kcyl \hatotimes f$ as a retract of $(\kcyl \mathbin{\hat{\cc}} \kcyl) \hatotimes f$ in $\cal{E}^\to$.  But this can be proved easily following the same ideas used
to construct the retraction in~\eqref{equ:kcyl-as-retract}.
\end{proof}

For our second step, we return to consider a suitable wfs $(\Cof, \TrivFib)$ with generating set $\cal{I}$ and the induced wfs $(\TrivCof, \Fib)$ of \cref{thm:wfstimes}, with generating set $\cal{I}_\otimes$ defined in~\eqref{equ:cylinc}. 
We focus on the class $\Cof \cap S$, \ie the class of cofibrations that are strong homotopy equivalences.
The next lemma relates them to the generating trivial cofibrations defined in~\eqref{equ:cylinc} and the trivial
cofibrations. 

\begin{lemma} \label{thm:main-sheretract}  We have
\begin{enumerate}[(i)]
\item $\cal{I}_\otimes \subseteq \Cof \cap S$,
\item $\Cof \cap S \subseteq \TrivCof$.
\end{enumerate}
\end{lemma}

\begin{proof}
For part~(i), we have that $\cal{I}_\otimes \subseteq \Cof$ since $\cal{I} \subseteq \Cof$ and $\Cof$ is closed under Leibniz product with~$\kcyl$ (condition (S4) in \cref{thm:suitable-wfs}). We also have $\cal{I}_\otimes \subseteq S$
since  $\kcyl \hatotimes f$ is a strong $k$-oriented homotopy equivalence for every $f \co X \to Y$, by~\cref{thm:kcylf-is-she}. 
For part~(ii), let $f \in \Cof \cap S$.
Since $f \in S$, \cref{strong-h-equiv-as-section-non-alg} implies that $f$ is a retract of~$\kcyl \hatotimes f$ for some $k \in \braces{0\,, 1}$.
Because $f \in \Cof$, we have $\kcyl \hatotimes f \in \TrivCof$ by \cref{thm:kcyl-of-cof-is-trivcof-non-alg}. 
The claim follows since $\TrivCof$ is closed under retracts.
\end{proof}

\begin{remark} \label{fib-and-she}
By \cref{thm:main-sheretract}, we have that $\Fib = \liftr{(\Cof \cap S)}$, \ie a map is a fibration if and only if it has the right lifting property with respect to the cofibrations that are strong homotopy equivalences.
\end{remark}

The next lemma is the third main step of the proof of the Frobenius property for~$(\TrivCof, \Fib)$.

\begin{lemma} \label{thm:non-alg-frobenius-she}
For $k \in \braces{0\,, 1}$, the pullback of a strong $k$-oriented homotopy equivalence along a fibration is again a strong $k$-oriented homotopy equivalence.
\end{lemma}

\begin{proof}
Consider a pullback diagram
\begin{equation} \label{non-alg-strong-h-equiv-uniform-base-change:0}
\begin{gathered}
\xymatrix{
 B \ar[d]_j \ar[r]^q & A \ar[d]^i \\
Y \ar[r]_p & X \rlap{,}}
\end{gathered}
\end{equation}
where $i  \in S_k$ and $p \in \Fib$.
We wish to show that $j \in  S_k$.
Since $i \in S_k$, $\thetak \hatotimes i \co i \to \kcyl \hatotimes i$ has a retraction $\rho \co \kcyl \hatotimes i \to i$.
We show that $\thetak \hatotimes j \co j \to \kcyl \hatotimes j$ has a retraction $\tau \co  \kcyl \hatotimes j \to j$.
We define the retraction $\tau$ so that the diagram below commutes.
Here, $\sigma \co j \to i$ is the pullback in~\eqref{non-alg-strong-h-equiv-uniform-base-change:0} and the horizontal composites should be identities:
\[
\xymatrix@C+2em{
j
  \ar[r]^-{\thetak \hatotimes j}
  \ar[d]_{\sigma}
&
  \kcyl \hatotimes j
  \ar@{.>}[r]^-{\tau}
  \ar[d]_{\kcyl \hatotimes \sigma}
&
 j
  \ar[d]^{\sigma}
\\
  i
  \ar[r]_-{\thetak \hatotimes i}
&
  \kcyl \hatotimes i
  \ar[r]_-{\rho}
&
  i
\rlap{.}}
\]
Since the pullback square $\sigma$ is a cartesian arrow with respect to the codomain fibration, it suffices to solve this problem on codomains, again omitting horizontal composite identities:
\[
\xymatrix@C+2em{
  Y
  \ar[r]^-{\kcylinv \otimes Y}
  \ar[d]_{p}
&
  \interval \otimes Y
  \ar@{.>}[r]^-{\cod(\tau)}
  \ar[d]^{\interval \otimes p}
&
  Y
  \ar[d]^{p}
\\
  X
  \ar[r]_-{\kcylinv \otimes X}
&
  \interval \otimes X
  \ar[r]_-{\cod(\rho)}
&
  X
\rlap{.}}
\]
To find the dotted arrow is to construct a diagonal filler in the following square:
\[
\xymatrix@C+2em{
  Y
  \ar@{=}[rr]
  \ar[d]_{\kcylinv \otimes Y}
&&
  Y
  \ar[d]^{p}
\\
  \interval \otimes Y
  \ar[r]_-{I \otimes p}
  \ar@{.>}[urr]^(0.4){\cod(\tau)}
&
  \interval \otimes X
  \ar[r]_-{\cod(\rho)}
&
  X
\rlap{.}}
\]
But now $\kcylinv \otimes Y \iso \kcylinv \hatotimes \bot_Y$, where $\bot_Y \co 0 \to Y$ is the unique map from the initial object of~$\catE$ into~$Y$, which is a cofibration by the assumption that $(\Cof, \TrivFib)$ is suitable (condition~(S2) of \cref{thm:suitable-wfs}). By~\cref{thm:kcyl-of-cof-is-trivcof-non-alg}, we have that $\kcylinv \hatotimes \bot_Y \in \TrivCof$ and
so we have a diagonal filler since~$p \in \Fib$.
\end{proof}

\begin{theorem} \label{thm:non-alg-frobenius}
The wfs $(\TrivCof, \Fib)$ has the Frobenius property.
\end{theorem}

\begin{proof}
By~\cref{thm:frobenius-equivalence}, it suffices to show that, for a pullback of the form
\begin{equation*}
\begin{gathered}
\xymatrix{
 B \ar[d]_j \ar[r]^q & A \ar[d]^i \\
Y \ar[r]_p & X \rlap{,}}
\end{gathered}
\end{equation*}
where $i \in \Cyl$ and $p \in \Fib$, we have $j \in \TrivCof$.
By part (ii) of~\cref{thm:main-sheretract}, $i \in \Cof \cap S$.
By the closure of $\Cof$ under pullbacks (condition~(S3) of \cref{thm:suitable-wfs}) and~\cref{thm:non-alg-frobenius-she}, it follows that~$j \in \Cof \cap S$.
But $\Cof \cap S \subseteq \TrivCof$ by part~(i) of~\cref{thm:main-sheretract} and the closure of $\TrivCof$ under retracts.
\end{proof}

\begin{example}
When applied to the category of simplicial sets (see \cref{thm:fib-is-kan}), \cref{thm:non-alg-frobenius} gives a new proof of right properness of the Quillen model structure for Kan complexes.
This proof avoids the use of topological realization, which is used in~\cite[Theorem~13.1.13]{hirschhorn-model-localizations} to deduce the desired result from the right properness of the model structure on topological spaces in which the fibrations are the Serre fibrations.
It also avoids the use of the theory of minimal fibrations, which is used in~\cite[Theorem~1.7.1]{joyal-tierney-notes} to establish the result working purely combinatorially.
\end{example}

\section{Categories of orthogonal maps}
\label{sec:ortf}

This section starts the second part of the paper, in which we are interested in generalizations for algebraic weak factorization systems (awf's)~\cite{garner:small-object-argument,grandis-tholen-nwfs} of the results obtained earlier.
In this section and the next we will need to review and establish some facts about the algebraic setting that are useful for our development.
Importantly, in the algebraic setting we do not consider just classes of arrows in $\catE$, but rather categories~$\cal{I}$, to be thought of as indexing categories, and functors~$u \co \cal{I} \to \catE^\to$.
In the following, we write $u_i \co A_i \to B_i$ for the effect of such a functor on~$i \in \cal{I}$.
Let us recall the following definition from~\cite{garner:small-object-argument}.

\begin{definition} \label{def:right-map}
Let $u \co \cal{I} \to \catE^\to$.
\begin{enumerate}[(i)]
\item
A \emph{right $\cal{I}$-map} $(f, \phi) \co X \to Y$ consists of a map $f \co X \to Y$ in $\catE$ and a function~$\phi$ that assigns to each $i \in \cal{I}$ and commuting square
\[
\xymatrix@C=2cm{
  A_i
  \ar[r]^{s}
  \ar[d]_{u_i}
&
  X
  \ar[d]^f
\\
  B_i
  \ar[r]_{t}
&
  Y
}
\]
a diagonal filler $\phi(i,s, t) \co B_i \to X$, satisfying the following naturality condition: for every diagram of the form
\[
\xymatrix{
  A_i
  \ar[r]^{a}
  \ar[d]_{u_i}
&
  A_j
  \ar[r]^{s}
  \ar[d]_{u_j}
&
  X
  \ar[d]^f
\\
  B_i
  \ar[r]_{b}
&
  B_j
  \ar[r]_{t}
&
  Y
\rlap{,}}
\]
where the left square is the image of $\sigma \co i \to j$ in $\cal{I}$ under $u$, we have that
\[
\phi(j, s, t) \cc b = \phi(i, s \cc a, t \cc b)
\, .\]
\item
A \emph{right $\cal{I}$-map morphism} $\alpha \co (f, \phi) \to (f', \phi')$ is a square $\alpha \co f \to f'$ in~$\catE$ satisfying an evident compatibility condition with respect to the choices of diagonal fillers.
\end{enumerate}
\end{definition}

For $u \co \cal{I} \to \catE^\to$, we write $\liftr{\cal{I}}$ for the category of right $\cal{I}$-maps and their morphisms.
We then let $\liftr{u} \co \liftr{\cal{I}} \to \catE^\to$ be the evident forgetful functor, which we call the \emph{right orthogonal} of $u$. Analogously, we can define the category $\liftl{\cal{I}}$  of left $\cal{I}$-maps and their morphisms
and the forgetful functor $\liftl{u} \co \liftl{\cal{I}} \to \cal{E}^\to$, which we call the \emph{left orthogonal} of $u$.
As shown in~\cite[Proposition~3.8]{garner:small-object-argument}, the orthogonality operations
extend to functors forming an adjunction
\begin{equation} \label{garner-adjunction}
\begin{gathered}
\xymatrix@C+2em{
  \CAT_{/\catE^\to}
  \ar@<5pt>[r]^-{\liftl{\brarghole}}
  \ar@{}[r]|-{\bot}
&
  \CAT_{/\catE^\to}^{\op}
  \ar@<5pt>[l]^-{\liftr{\brarghole}}
\rlap{.}}
\end{gathered}
\end{equation}
Even if objects of $\CAT_{/\catE^\to}$ are pairs of the form $(\cal{I}, u)$, where $\cal{I}$ is a category $u \co
\cal{I} \to \catE^\to$ is a functor, in the following we shall often refer to them by their domains.
A similar convention applies to maps in $\CAT_{/\catE^\to}$.
For example, we write the components of the unit and counit simply as
\[
\eta_\cal{I} \co \cal{I} \to \liftl{(\liftr{\cal{I}})}
\, , \quad
\varepsilon_\cal{I} \co \cal{I} \to \liftr{(\liftl{\cal{I}})}
\, .\]
These are the algebraic counterparts of the inclusions in~\eqref{equ:inclus-orthog}.
In the following, we will see that some familiar equalities between two classes of maps are replaced by functors back and forth between two categories over $\cal{E}^\to$, for which we now introduce some notation.
Given $u \co \cal{I} \to \cal{E}^\to$ and $v \co \cal{J} \to \cal{E}^\to$, we write
\begin{equation} \label{equ:logical-equivalence}
\cal{I} \leftrightarrow \cal{J}
\end{equation}
to mean that there are functors $F \co \cal{I} \to \cal{J}$ and $G \co \cal{J} \to \cal{I}$ over $\cal{E}^\to$.

The rest of this section is devoted to establishing some facts regarding categories of orthogonal maps, describing the interplay between orthogonality functors and retract closure, slicing, adjunctions, Leibniz adjunctions, and Kan extensions.
Most of these facts are expected generalizations of well-known statements for classes of weakly orthogonal classes in the standard setting.
They are probably known to experts, but we include them since they are used in the remainder of the paper and we could not find them in the literature.
We omit most proofs, which are straightforward.
Given a functor $u \co \cal{I} \to \calE^\to$, we define its~\emph{retract closure} $\overline{u} \co \overline{\cal{I}} \to \catE^\to$ as follows.
An object of $\overline{\cal{I}}$ is a tuple~$(i, e, \sigma, \tau)$ consisting of an object $i \in \cal{I}$, an object $e \in \catE^\to$, and maps $\sigma \co e \rightarrow u_i$ $\rho \co u_i \rightarrow e$ in $\catE^\to$ which exhibit $e$ as a retract of $u_i$ in $\catE^\to$, \ie such that
\[
\xymatrix{
  e
  \ar[r]^{\sigma}
  \ar@{=}[dr]
&
  u_i
  \ar[d]^{\rho}
\\&
  e
\rlap{.}}
\]
A map $(f, \kappa) \co (i, e, \sigma, \tau) \to (i', e', \sigma', \tau')$ in $\overline{\cal{I}}$ consists of a map $f \co i \to i'$ in $\cal{I}$ and a map $\kappa \co e \rightarrow e'$ in $\catE^\to$ such that the following diagram in $\catE^\to$ commutes:
\[
\xymatrix{
  e
  \ar[r]^{\sigma}
  \ar[d]_{\kappa}
&
  u_i
  \ar[r]^{\rho}
  \ar[d]^{u_f}
&
  e
  \ar[d]^{\kappa}
\\
  e'
  \ar[r]_{\sigma'}
&
  u_{i'}
  \ar[r]_{\rho'}
&
  e'
\rlap{.}}
\]
The functor $\overline{u} \co \overline{\cal{I}} \to \catE^\to$ is then defined on objects by letting $\overline{u}(i, e, \sigma, \tau) \defeq e$, and on maps by letting $\overline{u}(f, \kappa) \defeq \kappa$.
The operation of retract closure gives a monad in an evident way.
The next proposition uses the notation introduced in~\eqref{equ:logical-equivalence}.

\begin{proposition} \label{retract-closure}
For every $u \co \cal{I} \to \catE^\to$, we have pairs of functors as follows
\[
\begin{aligned}
  \liftr{(\overline{\cal{I}})} &\leftrightarrow \liftr{\cal{I}}
\, ,&
  \liftr{(\overline{\overline{\cal{I}}})} &\leftrightarrow \liftr{\overline{\cal{I}}}
\, ,&
  \liftl{(\overline{\cal{I}})} &\leftrightarrow \liftl{\cal{I}}
\, ,&
 \liftl{(\overline{\overline{\cal{I}}})} &\leftrightarrow \liftl{\overline{\cal{I}}}
\end{aligned}
\]
over $\catE^\to$.
\qed
\end{proposition}

Given $u \co \cal{I} \to \catE^\to$ and $X \in \catE$, we define the \emph{slice category} $\cal{I}_{/X}$ and functor $u_{/X} \co \cal{I}_{/X} \to \catE_{/X}^\to$ as follows.
The category $\cal{I}_{/X}$ has as objects pairs consisting of an object $i \in \cal{I}$ and a commutative triangle in $\catE$ of the form
\[
\xymatrix@C-1em{
  A_i
  \ar[dr]
  \ar[rr]^{u_i}
&&
  B_i
  \ar[dl]
\\&
  X
\rlap{.}}
\]
The functor $u_{/X} \co \cal{I}_{/X} \to \catE_{/X}^\to$ sends such a pair to $u_i \co A_i \to B_i$, viewed as a morphism in~$\catE_{/X}$.
There is also a \emph{coslice} category under $X$, described dually, which we denote $u_{\backslash X} \co  \cal{I}_{\backslash X} \to \catE^\to$.
With these definitions in place, the commutation between slicing and weak orthogonality functors in the algebraic setting can be stated as follows.

\begin{proposition} \label{pitchfork-slicing}
Let $u \co \cal{I} \to \catE^\to$ and $X \in \cal{E}$.
\begin{enumerate}[(i)]
\item The right orthogonality functor commutes with slicing, \ie we have $\liftr{(\cal{I}_{/X})} = (\liftr{\cal{I}})_{/X}$ as categories over $\catE^\to$.
\item The left orthogonality functor commutes with coslicing, \ie we have $\liftl{(\cal{I}_{\backslash X})} = (\liftl{\cal{I}})_{\backslash X}$ as categories over $\catE^\to$.
\qed
\end{enumerate}
\end{proposition}

In contrast to the right orthogonality functor, the left orthogonality functor does not commute with slicing in general.
However, it does under certain assumptions, as described in \cref{pitchfork-slicing-grothendieck} below.
%Note that \cref{pitchfork-slicing-grothendieck} has an evident dual, which we do not state explicitly.

\begin{proposition} \label{pitchfork-slicing-grothendieck}
Let $u \co \cal{I} \to \cal{E}^\to$ and assume that
\[
\xymatrix@C-1em{
  \cal{I}
  \ar[rr]^{u}
  \ar[dr]_{\cod_{\cal{E}} \cc u}
&&
  \cal{E}^\to
  \ar[dl]^{\cod_{\cal{E}}}
\\&
  \cal{E}
}
\]
is a morphism of Grothendieck fibrations.
Then the left orthogonality functor commutes with slicing on $u$, \ie for $X \in \cal{E}$ we have
$\liftl{(\cal{I}_{/X})} = (\liftl{\cal{I}})_{/X}$.
\end{proposition}

\begin{proof}
First note that the composite $\cod_{\cal{E}_{/X}} \cc u_{/X}$ is also a Grothendieck fibration.
When constructing the category of left maps for $\cal{I}$ or $\cal{I}_{/X}$, an application of base change and naturality of diagonal fillers shows that it is sufficient to consider lifting problems with the bottom arrow an identity.
But for such lifting problems the order of slicing makes no difference.
\end{proof}

\begin{corollary} \label{pitchfork-slicing-monad} \leavevmode
\begin{enumerate}[(i)]
\item The monad $\liftl{(\liftr{(-)})}$ commutes with slicing.
\item The monad $\liftr{(\liftl{(-)})}$ commutes with coslicing.
\end{enumerate}
\end{corollary}

\begin{proof}
Use \cref{pitchfork-slicing} and note, for the first statement, that categories of right maps satisfy the assumptions of \cref{pitchfork-slicing-grothendieck}.
The second statement follows dually.
\end{proof}

\begin{proposition}
The retract closure commutes with slicing and coslicing, in the sense that for every $u \co \cal{I} \to \catE^\to$ we have $\overline{\cal{I}_{/X}} = \overline{\cal{I}}_{/X}$ and $\overline{\cal{I}_{\backslash X}} = \overline{\cal{I}}_{\backslash X}$ as categories over $\catE^\to$.
\qed
\end{proposition}

The following two propositions are instances of Proposition~21 of \cite{bourke-garner-I} with double categories of squares specialized to categories of arrows.
The first proposition also appears in the form of the pullback square~(6.3) in \cite{riehl-monoidal-ams}.

\begin{proposition} \label{lift-of-adjunction}
Let $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \cal{F}^\to$.
For an adjunction $F \dashv G$ between $\cal{E}$ and $\cal{F}$, the following are equivalent:
\begin{enumerate}[(i)]
\item the functor $F \co \catE^\to \to \cal{F}^\to$ lifts to a functor $\widetilde{F} \co \cal{I} \to \liftl{\cal{J}}$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \ar[r]^{\widetilde{F}}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \catE^\to
  \ar[r]_-{F}
&
  \cal{F}^\to
\rlap{,}}
\]
\item the functor $G \co \cal{F}^\to \to \catE^\to$ lifts to a functor $\widetilde{G} \co \cal{J} \to \liftr{\cal{I}}$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{J}
  \ar[d]_{v}
  \ar[r]^{\widetilde{G}}
&
  \liftr{\cal{I}}
  \ar[d]^{\liftr{u}}
\\
  \cal{F}^\to
  \ar[r]_{G}
&
  \catE^\to
\rlap{.}  }
\]
\end{enumerate}
\qed
\end{proposition}

\begin{proposition} \label{lift-of-mates}
Let $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \cal{F}^\to$.
Let $F_1 \dashv G_1$ and $F_2 \dashv G_2$ be adjunctions between $\cal{E}$ and $\cal{F}$ satisfying the equivalent conditions of \cref{lift-of-adjunction}.
Let $m \co F_1 \to F_2$ and $n \co G_2 \to G_1$ be natural transformations forming mates.
Then the following are equivalent:
\begin{enumerate}[(i)]
\item
The natural transformation $m$ lifts as follows:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \rtwocell_{\widetilde{F_2}}^{\widetilde{F_1}}{\widetilde{m}}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \catE^\to
  \rtwocell_{F_2}^{F_1}{m}
&
  \cal{F}^\to
\rlap{,}}
\]
\item
The natural transformation $n$ lifts as follows:
\[
\xymatrix@C=1.2cm{
  \cal{J}
  \rtwocell_{\widetilde{G_1}}^{\widetilde{G_2}}{\widetilde{n}}
  \ar[d]_{u}
&
  \liftr{\cal{I}}
  \ar[d]^{\liftl{v}}
\\
  \cal{F}^\to
  \rtwocell_{G_1}^{G_2}{n}
&
  \cal{E}^\to
\rlap{.}}
\]
\qed
\end{enumerate}
\end{proposition}

We generalize \cref{lift-of-adjunction} to Leibniz adjunctions~\cite{riehl-verity:reedy}.
Let us fix bifunctors $F \co \cal{K} \times \catE \to \cal{F}$ and $G \co \cal{K}^{\op} \times \cal{F} \to \catE$ related pointwise, for $k \in \cal{K}$, by an adjunction:
\[
\xymatrix@C+1em{
  \catE
  \ar@<5pt>[r]^{F(k, \arghole)}
  \ar@{}[r]|{\bot}
&
  \cal{F}
  \ar@<5pt>[l]^{G(k, \arghole)}
\rlap{.}}
\]
Let $ \widehat{F} \co \cal{K}^\to \times \catE^\to \to \cal{F}^\to$ and $ \widehat{G} \co (\cal{K}^{\op})^\to \times \cal{F}^\to \to \catE^\to$ denote the Leibniz constructions for~$F$ and~$G^{\op}$, using pullback instead of pushout for~$\widehat{G}$.
Here and below we assume that the categories under consideration have sufficient structure to carry out the relevant Leibniz constructions.
The following proposition can be seen as a generalization of Theorem~6.5 in \cite{riehl-monoidal-ams}, capturing the formal essence of the argument.

\begin{proposition} \label{lift-of-leibniz-adjunction}
Let $u \co \cal{I} \to \catE^\to$, $v \co \cal{J} \to \cal{F}^\to$ be functors.
Then the following are equivalent for $h \co X \to Y$ in $\cal{K}$:
\begin{enumerate}[(i)]
\item liftings $F' \co \cal{I} \to \liftl{\cal{J}}$ of $\widehat{F}(h, \arghole) \co \catE^\to \to \cal{F}^\to$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \ar[r]^{F'}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \catE^\to
  \ar[r]_-{\widehat{F}(h, \arghole)}
&
  \cal{F}^\to
\rlap{,}}
\]
\item liftings $G' \co \cal{J} \to \liftr{\cal{I}}$ of $\widehat{G}(h, \arghole) \co \cal{F}^\to \to \catE^\to$ making the following diagram commute:
\[
\begin{gathered}
\xymatrix@C+2em{
  \cal{J}
  \ar[d]_{v}
  \ar[r]^{G'}
&
  \liftr{\cal{I}}
  \ar[d]^{\liftr{u}}
\\
  \cal{F}^\to
  \ar[r]_-{\widehat{G}(h, \arghole)}
&
  \catE^\to
\rlap{.}}
\end{gathered}
\]
 \qed
\end{enumerate}
\end{proposition}

% \cref{lift-of-adjunction} is the special case of \cref{lift-of-leibniz-adjunction} where $\cal{K}$ is the terminal category.

Next, we establish some facts about the interaction between orthogonality functors and Kan extensions along fully faithful functors.

\begin{proposition} \label{kan-extension-closure}
Let $F \co \cal{I} \to \cal{J}$ be a fully faithful functor.
\begin{enumerate}[(i)]
\item Assume that the pointwise left Kan extension of $u \co \cal{I} \to \catE^\to$ along $F$ exists:
\[
\xymatrix@!C@C-1em{
  \cal{I}
  \ar[dr]_{u}
  \ar[rr]^{F}
&&
  \cal{J}
  \ar[dl]^{\Lan_F u}
\\&
  \catE^\to
\rlap{.}}
\]
Then the functor $\liftr{F} \co \liftr{\cal{J}} \to \liftr{\cal{I}}$, fitting in the diagram
\[
\xymatrix@!C@C-1em{
  \liftr{\cal{I}}
  \ar[dr]_{\liftr{u}}
&&
  \liftr{\cal{J}}
  \ar[ll]_{\liftr{F}}
  \ar[dl]^{\liftr{(\Lan_F u)}}
\\&
  \catE^\to
\rlap{,}}
\]
is an isomorphism.
\item Assume that the pointwise right Kan extension of $u \co \cal{I} \to \catE^\to$ along $F$ exists:
\[
\xymatrix@!C@C-1em{
  \cal{I}
  \ar[dr]_{u}
  \ar[rr]^{F}
&&
  \cal{J}
  \ar[dl]^{\Ran_F u}
\\&
  \catE^\to
\rlap{.}}
\]
Then the functor $\liftl{F} \co \liftl{\cal{J}} \to \liftl{\cal{I}}$, fitting in the diagram
\[
\xymatrix@!C@C-1em{
  \liftl{\cal{I}}
  \ar[dr]_{\liftl{u}}
&&
  \liftl{\cal{J}}
  \ar[ll]_{\liftl{F}}
  \ar[dl]^{\liftl{(\Ran_F u)}}
\\&
  \catE^\to
\rlap{,}}
\]
is an isomorphism.
\end{enumerate}
\end{proposition}

\begin{proof}
This follows from Lemma~24 orf \cite{bourke-garner-I}.
\end{proof}

Finally, we prove two results in the special case that $\catE$ is a presheaf category, say $\cal{E} = \Psh(\mathbb{C})$, for $\mathbb{C}$ a small category.
We write $\yon \co \mathbb{C} \to \cal{E}$ for the Yoneda embedding.
Recall from \cref{sec:bac} that we write $\catE_{\cart}^\to$ for the category of arrows and pullback squares in~$\cal{E}$.

\begin{lemma} \label{left-kan-extension-of-representables}
Let $\cal{J}$ be a full subcategory of $\catE_{\cart}^\to$ closed under base change to representables, \ie closed under pullbacks along morphisms with domain a representable presheaf.
Let $\cal{I}$ denote its restriction to arrows into representables.
\[
\xymatrix@C-1em{
  \cal{I}
  \ar[rr]
  \ar[dr]
&&
  \cal{J}
  \ar[dl]
\\&
  \catE^\to
}
\]
Then the inclusion $\cal{J} \to \catE^\to$ is the left Kan extension of $\cal{I} \to \catE^\to$ along $\cal{I} \to \cal{J}$.
\end{lemma}

\begin{proof}
Since $\catE^\to$ is cocomplete, we can verify the claim using the colimit formula for left Kan extensions.
All of the following will be functorial in an object $j \co A \to B$ of $\cal{J}$.
We consider the diagram $d \co S \to \catE^\to$, where $S$ is the set of pullback squares of the form
\[
\xymatrix@C=1.2cm{
  A'
  \ar[r]
  \ar[d]_{i}
  \pullback{dr}
&
  A
  \ar[d]^{j}
\\
  \yon(x)
  \ar[r]_-{b}
&
  B
}
\]
with $i \co A' \to \yon(x)$ in $\cal{I}$, and the function $d$ maps such a square to $i \in \cal{E}^\to$.
Our goal is to show that its colimit is $j$.
Using the assumption that $\cal{J}$ is closed under base change to representables, the given diagram can be described equivalently as the the diagram indexed by maps $b \co \yon(x) \to B$ and valued $b^*(j)$.
The claim can then be restated as $\colim_{b \co \yon(x) \to B} b^*(j) \iso j$, which holds since pullback commutes with colimits in presheaf categories, and $\colim_{b \co \yon(x) \to B} \yon(x) \iso B$.
\end{proof}

\begin{proposition} \label{awfs-on-arrows-into-representables}
Let~$\cal{J}$ be a full subcategory of $\catE_{\cart}^\to$ closed under base change to representables.
Let $\cal{I}$ denote its restriction to arrows into representables,
\[
\xymatrix@C-1em{
  \cal{I}
  \ar[rr]
  \ar[dr]
&&
  \cal{J}
  \ar[dl]
\\&
  \catE^\to
\rlap{.}}
\]
Then $\liftr{\cal{I}} = \liftr{\cal{J}}$.
\end{proposition}

\begin{proof}
The result follows by combining part~(i) of \cref{kan-extension-closure} and \cref{left-kan-extension-of-representables}.
\end{proof}

\section{The functorial Frobenius condition}
\label{sec:frobc}

Recall from~\cite{garner:small-object-argument,grandis-tholen-nwfs} that an \emph{algebraic weak factorization} system~$(\LL, \RR)$ on a category $\cal{E}$ consist of a pair of functors $\LL, \RR \co \cal{E}^\to \to \cal{E}^\to$ providing factorizations
\[
\xymatrix{
  X
  \ar[rr]^{f}
  \ar[dr]_{L f}
&&
  Y
\\&
  \MM f
  \ar[ur]_{R f}
}
\]
functorially in~$f \in \cal{E}^\to$ and respective extensions of the (co)pointed endofunctor $\LL \to \Id$ and $\Id \to \RR$ given by
\begin{align*}
\xymatrix{
  X
  \ar@{=}[r]
  \ar[d]_{\LL f}
&
  X
  \ar[d]^{f}
\\
  \MM f
  \ar[r]_{\RR f}
&
  Y
\rlap{,}}
&&
\xymatrix{
  X
  \ar[r]^{\LL f}
  \ar[d]_{f}
&
  \MM f
  \ar[d]^{\RR f}
\\
  Y
  \ar@{=}[r]
&
  Y
}
\end{align*}
for $f \co X \to Y$ to a (co)monad with (co)unit $\LL \to \LL \LL$ and $\RR \RR \to \RR$ of the form
\begin{align*}
\xymatrix{
  X
  \ar@{=}[r]
  \ar[d]_{\LL f}
&
  X
  \ar[d]^{\LL \LL f}
\\
  \MM f
  \ar[r]_{\Delta_f}
&
  \MM \LL f
\rlap{,}}
&&
\xymatrix{
  \MM \RR f
  \ar[r]^{\mu_f}
  \ar[d]_{\RR \RR f}
&
  \MM f
  \ar[d]^{\RR f}
\\
  Y
  \ar@{=}[r]
&
  Y
}
\end{align*}
for $f \co X \to Y$ such that the natural transformation $\LL \RR \to \RR \LL$ given by the square
\[
\xymatrix{
  \MM \LL f
  \ar[r]^{\Delta_f}
  \ar[d]_{\LL \RR f}
&
  \MM
  \ar[d]^{\RR \LL f}
\\
  \MM f
  \ar[r]_{\mu_f}
&
  \MM \RR f
}
\]
for $f \co X \to Y$ is a distributive law.

We write $\pCoalg{\LL}$ and $\pcoalg{\LL}$ for the category of monad algebras and of pointed endofunctor algebras, respectively, over $\LL$. Similarly, we write $\pAlg{\RR}$ and $\palg{\RR}$  for the categories of comonad algebras and copointed endofunctor algebras, respectively, over $\RR$. These come equipped with forgetful functors into $\cal{E}^\to$ and fulfill
\[
\pcoalg{\LL} = \liftl{\pAlg{\RR}}
\, , \quad
\palg{\RR} = \liftr{\pCoalg{\LL}}
\, .\]
The awfs $(\LL, \RR)$ has an underlying ordinary wfs, in which the left (right) class consists of the maps that admit the structure making them into an element of $\pcoalg{\LL}$ (of $\palg{\RR}$, respectively).
Recall also that an awfs $(\LL, \RR)$ is said to be \emph{algebraically-free} on $u \co \cal{I} \to \cal{E}^\to$ if $\pAlg{\RR} \iso \liftr{\cal{I}}$.
By Garner's small object argument~\cite{garner:small-object-argument}, every $u \co \cal{I} \to \cal{E}^\to$ with $\cal{I}$ small determines an awfs $(\LL, \RR)$ that is algebraically-free on $\cal{I}$.
We call such an awfs \emph{cofibrantly generated}.

We now state the analogue for an awfs of the Frobenius condition for a wfs.
This condition, called the functorial Frobenius condition, was stated for a cloven wfs in~\cite{garner:topological-simplicial}, which is a slightly more general notion than
that of an awfs.
Let us fix some notation.
For a category $\cal{E}$, we write $\cal{E}^\to \times_\cal{E} \cal{E}^\to$ for the pullback of $\cod \co \cal{E}^\to \to \cal{E}$ with itself.
This is the category of cospans in $\cal{E}$, \ie pairs of arrows with common codomain.
Pullback gives a functor $P \co  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to \to \cal{E}^\to$ sending a cospan $(g, h)$ to $h^*(g)$.

\begin{definition} \label{functorial-frobenius}
An awfs $(\LL, \RR)$ satisfies the \emph{functorial Frobenius condition} if pullback along $\palg{\RR}$ preserves $\pcoalg{\LL}$, in the sense of a lift $\tilde{P}$ of $P$, as follows:
\[
\xymatrix@C+2em{
  \pcoalg{\LL} \times_{\cal{E}} \palg{\RR}
  \ar@{.>}[r]^{\tilde{P}}
  \ar[d]
&
  \pcoalg{\LL}
  \ar[d]
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P}
&
  \cal{E}^\to
\rlap{.}}
\]
\end{definition}

In this section we obtain an analogue of~\cref{thm:frobenius-equivalence} for awfs's, \ie a necessary and sufficient condition for an algebraically-free awfs to satisfy the functorial Frobenius condition.
In the next section, we apply this characterization to prove a functorial Frobenius property for the awfs having uniform fibrations as right maps.
In order to prove the desired characterization, it is convenient to work with a variant of the functorial Frobenius condition, which we introduce in~\cref{generalized-uniform-frob} below.

For this, we introduce some notation.
Given $u \co \cal{I} \to \cal{E}^\to$, we write $\cal{I}_{/\cal{E}}$ for the category with objects given by
tuples $(X, i, a, b)$, where $X \in \cal{E}$, $i \in \cal{I}$, $a \co A_i \to X$, $b \co B_i \to X$, such that the following diagram commutes:
\[
\xymatrix{
A_i \ar[dr]_a \ar[rr]^{u_i} & & B_i \ar[dl]^{b} \\
 & X \rlap{.} & }
\]
We write $s \co \cal{I}_{/\cal{E}} \to \cal{E}$ for the first projection.
Then, for $v \co \cal{J} \to \cal{E}^\to$, we can form a pullback
\[
\xymatrix{
  \cal{I}_{/\cal{E}} \times_{\cal{E}} \cal{J}
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  \cal{J}
  \ar[d]^{\cod \cc v}
\\
  \cal{I}_{/\cal{E}}
  \ar[r]_s
&
  \cal{E}
\rlap{.}}
\]
When $u$ and $v$ are the identity on $\cal{E}^\to$, we obtain
\[
\xymatrix{
  \cal{E}_{/\cal{E}} \times_{\cal{E}} \cal{E}^\to
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  \cal{E}^\to
  \ar[d]^{\cod}
\\
  \cal{E}^\to_{/\cal{E}}
  \ar[r]_s
&
  \cal{E}
\rlap{.}}
\]
Pullback gives a functor $Q \co  \cal{E}^\to_{/\cal{E}} \times_{\cal{E}} \cal{E}^\to \to \cal{E}_{/\cal{E}}^\to$ sending $(f, h)$ to $h^*(f)$.

\begin{definition} \label{generalized-uniform-frob}
Let $u \co \cal{I} \to \cal{E}^\to$, $v \co \cal{J} \to \cal{E}^\to$, $w \co \cal{K} \to \catE^\to$ be categories of arrows.
We say that $(\cal{I}, \cal{J}, \cal{K})$ satisfies the \emph{generalized functorial Frobenius condition} if pullback along $\cal{J}$-maps sends $\cal{I}$-maps to $\cal{K}$-maps, \ie the functor $Q$ admits a lift $\tilde{Q}$ as below:
\begin{equation} \label{generalized-uniform-frob:lift}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I}_{/\cal{E}} \times_{\cal{E}} \cal{J}
  \ar@{.>}[r]^{\tilde{Q}}
  \ar[d]_{u_{/\cal{E}} \times_{\cal{E}} v}
&
  \cal{K}_{/\cal{E}}
  \ar[d]^{w_{/\cal{E}}}
\\
  \cal{E}^\to_{/\cal{E}} \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{Q}
&
  \cal{E}_{/\cal{E}}^\to
\rlap{.}}
\end{gathered}
\end{equation}
\end{definition}

The next proposition shows in what sense the generalized functorial Frobenius condition is functorial in its parameters.

\begin{proposition} \label{generalized-uniform-frob-functorial}
Consider categories $u_t \co \cal{I}_t \to \cal{E}^\to$, $v_t \co \cal{J}_t \to \cal{E}^\to$, $w \co \cal{K}_t \to \cal{E}^\to$ of arrows, for $t \in \braces{1\,, 2}$, related as follows:
\begin{align*}
\xymatrix@!C@C-1.5em{
  \cal{I}_2
  \ar[rr]^{F}
  \ar[dr]_{u_2}
&&
  \cal{I}_1
  \ar[dl]^{u_1}
\\&
  \catE^\to
\rlap{,}}
&&
\xymatrix@C-1.5em{
  \cal{J}_2
  \ar[rr]^-{G}
  \ar[dr]_{v_2}
&&
  \cal{J}_1
  \ar[dl]^{v_1}
\\&
  \catE^\to
\rlap{,}}
&&
\xymatrix@C-1.5em{
  \cal{K}_1
  \ar[rr]^-{H}
  \ar[dr]_{w_1}
&&
  \cal{K}_2
  \ar[dl]^{w_2}
\\&
  \catE^\to
\rlap{.}}
\end{align*}
If $(\cal{I}_1, \cal{J}_1, \cal{K}_1)$ satisfies the generalized functorial Frobenius condition, then so does $(\cal{I}_2, \cal{J}_2, \cal{K}_2)$.
\qed
\end{proposition}

Next, we show that the generalized functorial Frobenius condition can be simplified under some assumptions.

\begin{proposition} \label{generalized-uniform-frob-nicer}
Let $u \co \cal{I} \to \cal{E}^\to$, $v \co \cal{J} \to \cal{E}^\to$, $w \co \cal{K} \to \cal{E}^\to$ be categories of arrows such that
\begin{equation} \label{uniform-frob:comprehension}
\begin{gathered}
\xymatrix@C-1em{
  \cal{J}
  \ar[rr]^{v}
  \ar[dr]_{\cod_{\cal{E}} \cc v}
&&
  \cal{E}^\to
  \ar[dl]^{\cod_{\cal{E}}}
\\&
  \cal{E}
}
\end{gathered}
\end{equation}
is a morphism of Grothendieck fibrations.
Then the following are equivalent:
\begin{enumerate}[(i)]
\item the triple $(\cal{I}, \cal{J}, \cal{K})$ satisfies the generalized functorial Frobenius condition,
\item there is a lift $\tilde{P}$ as below:
\begin{equation} \label{generalized-uniform-frob-nicer:lift}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I} \times_{\cal{E}} \cal{J}
  \ar@{.>}[r]^{\tilde{P}}
  \ar[d]_{u \times_{\cal{E}} v}
&
  \cal{K}
  \ar[d]^{w}
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P}
&
  \cal{E}^\to
\rlap{.}}
\end{gathered}
\end{equation}
\end{enumerate}
\end{proposition}

\begin{proof}
We will show that giving lifts $\tilde{Q}$ and $\tilde{P}$ as in~\eqref{generalized-uniform-frob:lift} and \eqref{generalized-uniform-frob-nicer:lift}, respectively, is equivalent.
The situation \eqref{generalized-uniform-frob:lift} a priori represents a more general scenario: we are pulling back an arrow $u_i \co A \to B$ with $i \in \cal{I}$ over an object $Y$ along a map $v_j \co X \to Y$ with $j \in \cal{J}$.
In contrast, in \eqref{generalized-uniform-frob-nicer:lift} we restrict to the case that the map $B \to Y$ is the identity.
It follows that any lift $\tilde{Q}$ induces a lift $\tilde{P}$.
However, under the stated assumption, the lift $\tilde{Q}$ can be reconstructed from the lift $\tilde{P}$ by first pulling back $v_j$ along $B \to Y$ to a map $v_{j'} \co B \to D$ with $j' \to j$ a map in $\cal{J}$ in the above situation and then setting $\tilde{Q}(i, j) \defeq \tilde{P}(i, j')$.
%If $\cal{K}$ is a category of arrows, this choice of $\tilde{Q}$ is forced upon us (up to isomorphism) by functoriality of $Q$ and the fact that $w$ reflects isomorphisms.
\end{proof}

We can now restate the functorial Frobenius condition of~\cref{functorial-frobenius} equivalently in terms of the generalized functorial Frobenius condition of~\cref{generalized-uniform-frob}.

\begin{proposition}
Let $(\mathsf{L}, \mathsf{R})$ be an awfs on $\cal{E}$.
Then the following are equivalent:
\begin{enumerate}[(i)]
\item $(\LL, \RR)$ satisfies the functorial Frobenius condition,
\item $(\pcoalg{\LL}, \palg{\RR}, \liftl{(\liftr{\pcoalg{\LL}})})$ satisfies the generalized functorial Frobenius condition.
\end{enumerate}
\end{proposition}

\begin{proof}
Recall that $\pcoalg{\LL} = \liftl{\pAlg{\RR}}$ is a category of left maps.
We observe that both (i) and (ii) are equivalent to $(\pcoalg{\LL}, \palg{\RR}, \pcoalg{\LL})$ satisfying the generalized functorial Frobenius condition.
For the equivalence with (i), use \cref{generalized-uniform-frob-nicer}.
For the equivalence with (ii), use \cref{generalized-uniform-frob-functorial}, noting that
$\pcoalg{\LL} \leftrightarrow \liftl{(\liftr{\pcoalg{\LL}})}$ over $\cal{E}^\to$, using the adjunction~\eqref{garner-adjunction}.
\end{proof}

The benefit of the reformulation of the functorial Frobenius condition as a generalized functorial Frobenius condition is that the latter admits an equivalent rephrasing in terms of pushforward, rather than pullback, functors.
This rephrasing, which does not seem directly possible for the functorial Frobenius condition, will be essential to our characterization of algebraically-free awfs's satisfying the functorial Frobenius condition.
As a first step towards the pushforward formulation, we decompose the generalized functorial Frobenius condition into an object part and a morphism part.
For this, recall that any arrow $f \co X \to Y$ induced an adjunction~$f_{!} \dashv f^*$ between the slices $\cal{E}_{/X}$ and $\cal{E}_{/Y}$ given by left composition $f_{!}$ and pullback $f^*$.
Given a functor $u \co \cal{I} \to \catE^\to$, it is immediate to check that the left composition functor lifts as follows:
\[
\xymatrix@C+1em{
  \cal{I}_{/X}
  \ar[r]^-{\widetilde{f_!}}
  \ar[d]_{u_{/X}}
&
  \cal{I}_{/Y}
  \ar[d]^{u_{/Y}}
\\
  \calE_{/X}^\to
  \ar[r]_-{f_!}
&
  \calE_{/Y}^\to
\rlap{.}}
\]
Note that we can view the bottom map as a lift of $f_! \co \cal{E}_{/X} \to \cal{E}_{/Y}$ to arrow categories.
Composing with the unit $\cal{I}_{/Y} \to \liftl{(\liftr{(\cal{I}_{/Y})})}$ of the adjunction \eqref{garner-adjunction}, applying \cref{lift-of-adjunction}, and using \cref{pitchfork-slicing} to commute orthogonality functors with slicing, the pullback functor $f^* \co \catE_{/Y} \to \catE_{/X}$ then lifts to slices of the right orthogonality categories,
\[
\xymatrix@C=1.5cm{
  \liftr{\cal{I}}_{/Y}
  \ar[d]_{{\liftr{u}}_{/Y}}
  \ar[r]^{\widetilde{f^*}}
&
  \liftr{\cal{I}}_{/X}
  \ar[d]^{{\liftr{u}}_{/X}}
\\
  {\catE}_{/Y}^\to
  \ar[r]_{f^*}
&
  \catE_{/X}^\to
\rlap{.}}
\]

\begin{proposition} \label{def:uniFrobcond}
Let $u \co \cal{I} \to \catE^\to$, $v \co \cal{J} \to \cal{E}^\to$, $w \co \cal{K} \to \catE^\to$.
Then $(\cal{I}, \cal{J}, \liftl{(\liftr{\cal{K}})})$ satisfies the generalized functorial Frobenius property if and only if the following hold:
\begin{enumerate}[(i)]
\item for every $j \in \cal{J}$, pullback along $v_j \co C_j \to D_j$ lifts to a functor
\[
\xymatrix@C+3em{
  \cal{I}_{/Y}
  \ar[r]^-{\widetilde{v_j^*}}
  \ar[d]_-{u_{/D_j}}
&
  \liftl{(\liftr{\cal{K}})}_{/C_j}
  \ar[d]^-{\liftl{(\liftr{w})}_{/C_j}}
\\
  \catE_{/D_j}^\to \ar[r]_-{v_j^*}
&
  \catE_{/C_j}^\to
\rlap{.}}
\]
\item for every $\tau \co j \to k$ in $\cal{J}$, the square
\begin{equation} \label{def:beck-chevalley:0}
\begin{gathered}
\xymatrix@C+3em{
  C_j
  \ar[r]^{v_j}
  \ar[d]_{s}
&
  D_j
  \ar[d]^{t}
\\
  C_{k}
  \ar[r]_-{v_{k}}
&
  D_{k}
\rlap{,}}
\end{gathered}
\end{equation}
induced by $v_\tau \co v_j \to v_k$ is such that the canonical natural transformation
\[
\xymatrix@C+3em{
  \catE^\to_{/D_j}
  \ar[d]_{t_!}
  \ar[r]^{v_j^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\phi$}}
&
  \catE^\to_{/C_j}
  \ar[d]^{s_!}
\\
  \catE^\to_{/D_k}
  \ar[r]_{v_k^*}
&
  \catE^\to_{/C_k}
}
\]
lifts to a natural transformation
\[
\xymatrix@C+3em{
  \cal{I}_{/D_j}
  \ar[r]^{\widetilde{v_j^*}}
  \ar[d]_{\widetilde{t_!}}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\tilde{\phi}$}}
&
  \liftl{(\liftr{\cal{K}})}_{/C_j}
  \ar[d]^{s_!}
\\
  \cal{I}_{/D_k}
  \ar[r]_{\widetilde{v_k^*}}
&
  \liftl{(\liftr{\cal{K}})}_{/C_k}
\rlap{.}}
\]
\end{enumerate}
\end{proposition}

\begin{proof}
We consider the lift $\widetilde{Q}$ of $Q$ in the generalized functorial Frobenius condition~\eqref{generalized-uniform-frob:lift} for $(\cal{I}, \cal{J}, \liftl{(\liftr{\cal{K}})})$.
Since the functor $\liftl{(\liftr{w})} \co \liftl{(\liftr{\cal{K}})} \to \cal{E}^\to$ is faithful, the lift $\widetilde{Q}$ consists just of a lift of the action of $Q$ on objects that is coherent with respect to the action of $Q$ on morphisms, in the sense that the action of $Q$ on morphisms determines uniquely the action of $\widetilde{Q}$ on morphisms.
Coherence in morphisms in $\cal{I}_{/\cal{E}} \times_{\cal{E}} \cal{J}$ of the action on objects of $\widetilde{Q}$ separates into two parts:
\begin{enumerate}[(1)]
\item coherence in morphisms in $\cal{I}_{/D_j}$ for fixed $v_j \co C_j \to D_j$ with $j \in \cal{J}$,
\item coherence in morphisms in $\cal{J}$.
\end{enumerate}
The action of $\widetilde{Q}$ on objects together with coherence~(1) constitutes part~(i).
Coherence~(2) constitutes part~(ii).
\end{proof}

Note that if the commutative square~\eqref{def:beck-chevalley:0} is a pullback, then the canonical natural transformation~$\phi$ is an isomorphism by the usual Beck-Chevalley condition, and so is~$\tilde{\phi}$ since $\liftl{(\liftr{u})}$ reflects isomorphisms.

\cref{def:uniFrobcond} has an immediate dual, expressed in terms of pushforward rather than pullback, which we state next.

\begin{proposition} \label{lift-pushforward}
Let $u \co \cal{I} \to \catE^\to$, $v \co \cal{J} \to \cal{E}^\to$, $w \co \cal{K} \to \catE^\to$.
Then $(\cal{I}, \cal{J}, \liftl{(\liftr{\cal{K}})})$ satisfies the generalized Frobenius property if and only if the following hold:
\begin{enumerate}[(i)]
\item for every $j \in \cal{J}$, pushforward along $v_j \co C_j \to D_j$ lifts to a functor
\[
\xymatrix@C=1.5cm{
  {\liftr{\cal{K}}}_{/C_j}
  \ar[r]^{\widetilde{(v_j)_*}}
  \ar[d]_{\liftr{w}_{/C_j}}
&
  {\liftr{\cal{I}}}_{/D_j}
  \ar[d]^{{\liftr{u}}_{/D_j}}
\\
  \catE_{/C_j}^\to
  \ar[r]_{(v_j)_*}
&
  \catE_{/D_j}^\to
\rlap{.}}
\]
\item for every $\tau \co j \to k$, the square~~\eqref{def:beck-chevalley:0} induced by $v_\tau \co v_j \to v_k$ is such that the canonical natural transformation
\[
\xymatrix@C+2em{
  \catE^\to_{/C_k}
  \ar[r]^{(v_k)_*}
  \ar[d]_{s^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\psi$}}
&
  \catE^\to_{/D_k}
  \ar[d]^{t^*}
\\
  \catE^\to_{/C_j}
  \ar[r]_{(v_j)_*}
&
  \catE^\to_{/D_j}
}
\]
lifts to a natural transformation
\[
\xymatrix@C+2em{
  {\liftr{\cal{K}}}_{/C_k}
  \ar[r]^{\widetilde{(v_k)_*}}
  \ar[d]_{\widetilde{s^*}}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\tilde{\psi}$}}
&
  {\liftr{\cal{I}}}_{/D_k}
  \ar[d]^{\widetilde{t^*}}
\\
  {\liftr{\cal{K}}}_{/C_j}
  \ar[r]_{\widetilde{(v_j)_*}}
&
  {\liftr{\cal{I}'}}_{/D_j}
\rlap{.}}
\]
\end{enumerate}
\end{proposition}

\begin{proof}
For (i), apply \cref{lift-of-adjunction} to the adjunction $v_j^* \dashv (v_j)_*$ with $u = u_{/D_j}$ and $v = {\liftr{w}}_{/C_j}$, using \cref{pitchfork-slicing-grothendieck} to permute slicing and orthogonality functors.
For (ii), apply \cref{lift-of-mates} to the adjunctions $s_! v_j^* \dashv (v_j)_* s^*$ and $v_k^* t_! \dashv t^* (v_k)_*$ recalling that $\phi$ and $\psi$ are mates.
\end{proof}

\begin{proposition} \label{double-pitchfork-in-generalized-uniform-frob}
Let $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \catE^\to$.
Then the following are equivalent:
\begin{enumerate}[(i)]
\item $(\cal{I}, \cal{J}, \liftl{(\liftr{\cal{I}})})$ satisfies the generalized functorial Frobenius condition.
\item $(\liftl{(\liftr{\cal{I}})}, \cal{J}, \liftl{(\liftr{\cal{I}})})$ satisfies the generalized functorial Frobenius condition.
\end{enumerate}
\end{proposition}

\begin{proof}
Using \cref{generalized-uniform-frob-functorial} and the unit $\cal{I} \to \liftl{(\liftr{\cal{I}})}$ of the adjunction~\eqref{garner-adjunction}, we see that statement~(ii) implies statement~(i).
For the converse direction, we use the characterizations of statements~(i) and~(ii) provided by \cref{lift-pushforward}.
The lift of pushforward for~(i) can be composed with the counit $\liftr{\cal{I}} \to \liftr{(\liftl{(\liftr{\cal{I}})})}$ of the adjunction~\eqref{garner-adjunction} to induce a lift of pushforward for~(ii).
\end{proof}

We can finally give the desired characterization of the functorial Frobenius condition for an algebraically-free awfs.

\begin{theorem} \label{thm:frobenius-comparison}
Let $(\LL, \RR)$ be an awfs algebraically-free on $u \co \cal{I} \to \cal{E}^\to$.
Then the following are equivalent:
\begin{enumerate}[(i)]
\item $(\LL, \RR)$ satisfies the functorial Frobenius condition,
\item $(\cal{I}, \liftr{\cal{I}}, \liftl{(\liftr{\cal{I}})}) = (\cal{I}, \pAlg{\RR}, \pcoalg{\LL})$ satisfies the generalized functorial Frobenius condition.
\end{enumerate}
\end{theorem}

\begin{proof}
Using \cref{retract-closure} and the adjunction~\eqref{garner-adjunction}, we have $\overline{\liftr{\cal{I}}} \leftrightarrow \liftr{\cal{I}}$, hence $\pAlg{\RR} \leftrightarrow \overline{\pAlg{\RR}}$.
Note that $\overline{\pAlg{\RR}} \leftrightarrow \palg{\RR}$ (this is the case for (co)pointed endofunctor and (co)monad algebras over any (co)monad).
It follows that $\pAlg{\RR} \leftrightarrow \palg{\RR}$.

With this, the functorial Frobenius condition for $(\LL, \RR)$ can be stated equivalently as the existence of a lift
\begin{equation} \label{frobenius-comparison:0}
\begin{gathered}
\xymatrix@C+2em{
  \liftl{(\liftr{\cal{I}})} \times_{\cal{E}} \liftr{\cal{I}}
  \ar@{.>}[r]
  \ar[d]
&
  \liftl{(\liftr{\cal{I}})}
  \ar[d]
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P'}
&
  \cal{E}^\to
\rlap{.}}
\end{gathered}
\end{equation}
Using \cref{generalized-uniform-frob-nicer}, this corresponds to the generalized functorial Frobenius condition for $(\liftl{(\liftr{\cal{I}})}, \liftr{\cal{I}}, \liftl{(\liftr{\cal{I}})})$.
By \cref{double-pitchfork-in-generalized-uniform-frob}, this is equivalent to the generalized functorial Frobenius condition for $(\cal{I}, \liftr{\cal{I}}, \liftl{ (  \liftr{\cal{I}} ) }   )$.
\end{proof}

We conclude the section with a result needed in \cref{sec:alg-frob}.

\begin{proposition} \label{generalized-uniform-frob-product-u}
Let $u_k \co \cal{I}_k \to \cal{E}^\to$, $w_k \co \cal{K}_k \to \cal{E}^\to$ for $k \in \braces{1\,, 2}$ and $v \co \cal{J} \to \cal{E}^\to$.
If $(\cal{I}_1, \cal{J}, \cal{K}_1,)$ and $(\cal{I}_2, \cal{J}, \cal{K}_2)$ satisfy the generalized functorial Frobenius property, then so do
\[
(\cal{I}_1 \times_{\cal{E}^\to} \cal{I}_2, \cal{J}, \cal{K}_1 \times_{\cal{E}^\to} \cal{K}_2)
\, , \quad
(\cal{I}_1 +_{\cal{E}^\to} \cal{I}_2, \cal{J}, \cal{K}_1 +_{\cal{E}^\to} \cal{K}_2)
\, .\]
\end{proposition}

\begin{proof}
This follows easily from \cref{generalized-uniform-frob-functorial} using the universal property of products and coproducts in the category $\CAT_{/\cal{E}^\to}$.
\end{proof}

This concludes our work on orthogonality functors and the functorial Frobenius condition in general.
In \cref{sec:alg-fib} and \cref{sec:alg-frob}, we develop the algebraic counterpart of the material in \cref{sec:fib} and \cref{sec:frob}.

\section{Uniform fibrations}
\label{sec:alg-fib}

This section is devoted to introducing the notion of a uniform fibration, which is the algebraic counterpart of the notion of a fibration introduced in~\cref{thm:fib}.
For this, we first introduce suitable awfs's, in complete analogy with the way we defined suitable wfs's in~\cref{thm:suitable-wfs}.
When introducing and discussing a suitable awfs, we use the notation $(\CC, \TF)$ and let
\[
\Cof \defeq \pcoalg{\CC}
\, , \quad
\TrivFib \defeq \palg{\TF}
\, .\]
We then refer to objects in $\Cof$ as \emph{uniform cofibrations} and objects in $\TrivFib$ as \emph{uniform trivial fibrations}.
Again, we hope that this helps to convey some of the basic intuition motivating our development.

\begin{definition} \label{thm:suitable-awfs}
An awfs $(\CC, \TF)$ is said to be \emph{suitable} if the following conditions hold.
\begin{enumerate}[({S}1)]
\item $(\CC, \TF)$ is cofibrantly generated.
\item The functor $\bot \co \cal{E} \to \cal{E}^\to$ mapping $X \in \cal{E}$ to $\bot_X \co 0_{\cal{E}} \to X$ factors through $\Cof$, as in the diagram
\[
\xymatrix@C+3em{
\catE \ar[r]^{\tilde{\bot}} \ar@/_1pc/[dr]_{\bot} & \Cof \ar[d] \\
  & \catE^\to}
\]
\item $\Cof$ is closed under pullback, in the sense that the pullback functor $Q$ of \cref{sec:frobc} lifts as follows:
\[
\xymatrix@C+3em{
  \Cof_{/\cal{E}} \times_{\cal{E}} \cal{E}^\to
  \ar@{.>}[r]^{\widetilde{Q}}
  \ar[d]_{u_{/\cal{E}}}
&
  \Cof_{/\cal{E}}
  \ar[d]^{u_{/\cal{E}}}
\\
  \catE^\to_{/\cal{E}} \times_{\cal{E}} \calE^\to
  \ar[r]_{Q}
&
  \catE^\to_{\cal{E}}
\rlap{.}}
\]
\notec{This can be succinctly expressed by saying that $(\Cof, \cal{E}^\to, \Cof)$ satisfies the generalized uniform Frobenius condition.
In any case, the diagram should probably be replaced by the diagram for the equivalent simpler condition of \cref{generalized-uniform-frob-nicer}.}
\item $\Cof$ is closed under Leibniz product with endpoint inclusions, in the sense that the Leibniz product functor lifts as follows:
\[
\xymatrix@C+3em{
  \Cof
  \ar@{.>}[r]^{\widetilde{\kcyl \hatotimes (-)}}
  \ar[d]_{u}
&
 \Cof
  \ar[d]^{u}
\\
  \catE^\to
  \ar[r]_{\kcyl \hatotimes (-)}
&
  \catE^\to
\rlap{.}}
\]
\end{enumerate}
\end{definition}

The main difference between the notion of a suitable wfs~(\cref{thm:suitable-wfs}) and that of a suitable awfs (\cref{thm:suitable-awfs}) is that the conditions in the former express closure of the class of left maps under the action of certain functions, while the conditions in the latter express closure of the category of left maps under the action of certain functors.

\begin{example} \label{unif-triv-fib-sset}
As we will see in~\cref{sec:fib-psh}, the categories $\SSet$ and $\CSet$ admit suitable awfs's $(\CC, \TF)$ that are algebraically-free on the categories $\cal{M}$ of all monomorphisms and pullback squares, \ie such that $\TrivFib = \liftr{\cal{M}}$.
The right maps of these awfs's are a natural algebraic counterpart of trivial Kan fibrations and so we call them \emph{uniform trivial Kan fibrations}.
Similarly, we will see that the category $\CSet$ also admits a suitable awfs $(\CC', \TF')$ algebraically-free on the category $\cal{M}'$ of monomorphisms classified by the face lattice $\Phi$ of~\cite{cohen-et-al:cubicaltt} and pullback squares (see \cref{nonalgebraic-cof}).
\end{example}

Let us now fix a suitable awfs $(\CC, \TF)$.
We need some notation.
For $u \co \cal{I} \to \catE^\to$ and $k \in \braces{0\,, 1}$, we define a functor $\kcyl \hatotimes u \co \cal{I} \to \catE^\to$ by letting
\[
(\kcyl \hatotimes u)_i \defeq \kcyl \hatotimes u_i  \defeq \hateval(\kcyl, u_i)
\, .\]
We adopt similar conventions for other natural transformations (or maps of such) written using the tensor notation.
Now let $\cal{I}_\otimes \defeq \cal{I} + \cal{I}$ and define $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ via the coproduct diagram
\begin{equation} \label{equ:u-tensor}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I}
  \ar[r]^{\iota_0}
  \ar[dr]_-{\lcyl \hatotimes u}
&
  \cal{I}_\otimes
  \ar[d]^(.4){u_\otimes}
&
  \cal{I}
  \ar[dl]^-{\rcyl \hatotimes u}
  \ar[l]_{\iota_1}
\\&
  \catE^\to
\rlap{.}}
\end{gathered}
\end{equation}
In the special case of $u \co \pCoalg{\LL} \to \cal{E}^\to$, we write $c \co \Cyl \to \cal{E}^\to$ for $u_\otimes \co \pCoalg{\LL}_\otimes \to \cal{E}^\to$.
The image of this functor are maps of the form $\kcyl \hatotimes i$, where $k \in \braces{0\,, 1}$ and $i$ is a pointed coalgebra for $\LL$.
These are the analogues of the open cylinder inclusions in~\eqref{equ:cylinc}.
We use comonad algebras for $\LL$ instead of uniform cofibrations here in order to ensure correctness of the following notion.

\begin{definition} \label{def:I-fibration} \leavevmode
\begin{enumerate}[(i)]
\item A \emph{uniform fibration} is a right $\Cyl$-map.
\item A \emph{morphism of uniform fibrations} is a morphism of right $\Cyl$-maps.
\end{enumerate}
\end{definition}

We write $\Fib$ for the category of uniform fibrations and their morphisms, which is given by~$\Fib  \defeq \liftr{\Cyl}$.
We now characterize uniform fibrations in terms of right $\Cof$-maps, analogously to how we characterized fibrations
in~\cref{thm:char-fib-nonalg}. The desired characterization of uniform fibration, stated in the next proposition, uses
the adjunction in~\eqref{equ:leibniz-prod-exp} and follows from the general results in \cref{sec:ortf}.



\begin{proposition} \label{prod-exp-general}
For a map $p \co X \to Y$ in $\catE$, the following are equivalent:
\begin{enumerate}[(i)]
\item uniform fibration structures on $p$,
\item uniform trivial fibration structures on $\hatexp(\bar{\delta}^0, p)$ and $\hatexp(\bar{\delta}^1, p)$.
\end{enumerate}
\end{proposition}

\begin{proof}
First recall that the right orthogonality functor is contravariant and part of the adjunction~\eqref{garner-adjunction}, hence sends coproducts to products of categories over $\catE^\to$.
The remainder of the claim follows from \cref{lift-of-leibniz-adjunction}, as applied in \cref{pitchfork-leibniz-most-general-example}, and the discussion above.
\end{proof}

We show that uniform fibrations are the right maps of an awfs, using Garner's small object argument~\cite{garner:small-object-argument} (see also~\cite[Proposition~16]{bourke-garner-I}).
For this, it is sufficient to establish that uniform fibrations can be defined equivalently by uniform right orthogonality with respect to a small category over $\catE$.

\begin{theorem} \label{thm:sset-cset-nwfs}
The category $\cal{E}$ admits an awfs $(\TC, \FF)$ such that the category of $\mathsf{F}$-maps is the category of uniform fibrations, \ie $\palg{\mathsf{F}} = \Fib$.
\end{theorem}

\begin{proof}
Let $\cal{I}$ be a small generating category for $(\CC, \TF)$, which exists since $(\CC, \TF)$ is suitable (condition~(S1) of \cref{thm:suitable-awfs}), and consider $\cal{I}_\otimes$ and $u_\otimes$, defined as in~\eqref{equ:u-tensor}.
Recall that $\liftr{\pCoalg{\LL}} = \liftr{\cal{I}}$.
Using preservation of coproducts by $\liftr{(-)}$ and \cref{lift-of-leibniz-adjunction}, we then also have $\Fib = \liftr{(\pCoalg{\LL}_\otimes)} = \liftr{(\cal{I}_\otimes)}$.
The claim now follows from the smallness of $\cal{I}_\otimes$, via Garner's small object argument.
\end{proof}

We let $\TrivCof \defeq \pcoalg{\TC}$ and refer to its elements as \emph{uniform trivial cofibrations}.

\begin{example} \label{unif-fib-sset}
If we start from the awfs's $(\CC, \TF)$ in~$\SSet$ and~$\CSet$ of \cref{unif-triv-fib-sset} and apply~\cref{thm:sset-cset-nwfs}, we obtain awfs's $(\TC, \FF)$ whose right maps are algebraic counterparts of Kan fibrations, and hence will be called \emph{uniform Kan fibrations}.
If instead in the case of $\CSet$, we start with the awfs $(\CC', \TF')$ of \cref{unif-triv-fib-sset}, we obtain an awfs $(\TC', \FF')$ whose right maps are exactly the uniform Kan fibrations considered in~\cite{cohen-et-al:cubicaltt}.
An application to a different version of cubical sets (not using connections) gives the awfs developed in~\cite{swan-awfs}.
\end{example}

\section{The functorial Frobenius property for uniform fibrations}
\label{sec:alg-frob}

We now continue to consider the fixed suitable awfs $(\CC, \TF)$ and the induced awfs $(\TC, \FF)$, in which the $\FF$-maps are exactly the uniform fibrations.
Our aim in this section is to show that $(\TC, \FF)$ satisfies the functorial Frobenius property.

For this, we follow a strategy analogous to the one we used in \cref{sec:frob}.
We begin by organizing strong $k$-oriented homotopy equivalences into a category $\cal{S}_k$.
Its objects are 4-tuples $(f, g, \phi, \psi)$ consisting of an arrow $f \co A \to B$ together with data $g \co B \to A$, $\phi \co \interval \otimes A \to A$, $\psi \co \interval \otimes B \to B$ making $f$ into a strong $k$-oriented homotopy equivalence in the sense of~\cref{def:strhe}.
A morphism $m \co (f, g, \phi, \psi) \to (f', g', \phi', \psi')$ consists of maps $s \co A \to A', t \co B \to B'$ such that the following diagrams commute:
\begin{align*}
\xymatrix{
  A
  \ar[r]^{s}
  \ar[d]_{f}
&
  A'
  \ar[d]^{f'}
\\
  B
  \ar[r]_{t}
&
  B'
\rlap{,}}
&&
\xymatrix{
  B
  \ar[r]^{t}
  \ar[d]_{g}
&
  B'
  \ar[d]^{g'}
\\
  A
  \ar[r]_{s}
&
  A'
\rlap{,}}
&&
\xymatrix{
  \interval \otimes A
  \ar[d]_{\phi}
  \ar[r]^{\interval \otimes s}
&
  I \otimes A'
  \ar[d]^{\phi'}
\\
  A
  \ar[r]_{s}
&
  A'
\rlap{,}}
&&
\xymatrix{
  \interval \otimes B
  \ar[d]_{\psi}
  \ar[r]^{\interval \otimes t}
&
  I \otimes B'
  \ar[d]^{\psi'}
\\
  B
  \ar[r]_{t}
&
  B'
\rlap{.}}
\end{align*}
There is an obvious first projection functor $p_k \co \cal{S}_k \to \catE^\to$.
\cref{strong-h-equiv-as-section} below extends the equivalence of \cref{strong-h-equiv-as-section-non-alg} to an isomorphism of categories.
In its statement, we refer to the maps~$\thetak \hatotimes f \co f \to \kcyl \hatotimes f$ in~\eqref{equ:thetak}.

\begin{lemma} \label{strong-h-equiv-as-section}
For $k \in \braces{0\,, 1}$, the category $\cal{S}_k$ of strong $k$-oriented homotopy equivalences can be described isomorphically as the category of arrows $f \in \catE^{\to}$ with a retraction $\rho$ of $\thetak \hatotimes f$.
In detail,
\begin{enumerate}[(i)]
\item objects are pairs $(f, \rho)$ consisting of $f \in \catE^\to$ and a retraction $\rho$ of $\thetak \hatotimes f$, as below:
\[
\xymatrix@C+2em{
  f
  \ar[r]^-{\thetak \hatotimes f}
  \ar@{=}[dr]
&
  \kcyl \hatotimes f \ar[d]^{\rho}
\\&
  f
\rlap{,}}
\]
\item morphisms $\tau \co (f, \rho) \to (f', \rho')$ are maps $\tau \co f \to f'$ such that the below diagram commutes:
\[
\xymatrix@C+2em{
  \kcyl \hatotimes f
  \ar[d]_-{\rho}
  \ar[r]^{\kcyl \hatotimes \tau}
&
 \kcyl \hatotimes f'
  \ar[d]^-{\rho'}
\\
  u_i
  \ar[r]_{\tau}
&
  u_{i'}
\rlap{.}}
\]
\end{enumerate}
\end{lemma}

\begin{proof}
The object part of the correspondence is essentially \cref{strong-h-equiv-as-section-non-alg}.
The morphism part is straightforward.
\end{proof}

\begin{remark} \label{theta}
As suggested by our notation, the maps~$\thetak \hatotimes f \co f \to \kcyl \hatotimes f$ are really given as the action on objects of a natural transformation $\thetak \hatotimes (-) \co \Id \to \delta^k \hatotimes (-)$ as follows.
Let $\theta^k \co \bot_{\Id} \to \delta^k \otimes (-)$ denote the arrow in $[\cal{E}, \cal{E}^\to] \iso [\cal{E}, \cal{E}]^\to$ given by the following square:
\[
\xymatrix@C+1em{
  0
  \ar[r]^{\bot_{\Id}}
  \ar[d]_{\bot_{\Id}}
&
  \Id
  \ar[d]^{\delta^k \otimes (-)}
\\
  \Id
  \ar[r]_{\delta^{1-k} \otimes (-)}
&
  I
\rlap{.}}
\]
Writing $(-) \otimes (-) \co [\cal{E}, \cal{E}] \times \cal{E} \to \cal{E}$ as an infix shorthand for functor application, the Leibniz construction~\cite{riehl-verity:reedy} induces a bifunctor $(-) \hatotimes (-) \co [\cal{E}, \cal{E}]^\to \times \cal{E}^\to \to \cal{E}^\to$ on the level of arrows.
The desired natural transformation is now precisely given by $\theta^k \hatotimes (-)$.
\end{remark}

\begin{remark} \label{thm:endpoint-are-she-functorially}
Recall from \cref{thm:endpoint-are-she} that the components of the endpoint inclusion $\kcyl \otimes (-)$ are strong $k$-oriented homotopy equivalences.
In fact, this is the action on objects of a factorization of $\kcyl \otimes (-)$ through $\cal{S}_k$:
\[
\xymatrix@C+3em{
&
  \cal{S}_k
  \ar[d]
\\
  \cal{E}
  \ar[r]_{\kcyl \otimes (-)}
  \ar[ur]^{\widetilde{\kcyl \otimes (-)}}
&
  \cal{E}^\to
\rlap{.}}
\]
\end{remark}

The next lemma is the analogue of \cref{thm:kcylf-is-she}.

\begin{lemma} \label{thm:kcylf-is-she-alg}
For $k \in \braces{0\,, 1}$, the functor $\kcyl \hatotimes (-) \co \cal{E}^\to \to \cal{E}^\to$ factors via $\cal{S}_k$, as follows,
\[
\xymatrix@C+3em{
&
  \cal{S}_k
  \ar[d]
\\
  \cal{E}^\to
  \ar[r]_-{\kcyl \hatotimes (-)}
  \ar[ur]^-{\widetilde{\kcyl \hatotimes (-)}\,}
&
  \cal{E}^\to
\rlap{.}}
\]
\end{lemma}

\begin{proof} We give a proof using the formalism of Leibniz constructions, as explained in~\cite{riehl-verity:reedy}.
For this, we use the description of $\cal{S}_k$ provided by \cref{strong-h-equiv-as-section} and the notation of \cref{theta},
thus writing simply $\delta^k$ for the natural transformation $\delta^k \otimes (-)$.
We apply the Leibniz construction to the endofunctor composition functor
$(-) \cc (-) \co [\cal{E}, \cal{E}] \times [\cal{E}, \cal{E}] \to [\cal{E}, \cal{E}]$, so as to obtain a functor
\[
(-) \mathbin{\hat{\cc}} (-) \co [\cal{E}, \cal{E}]^\to \times [\cal{E}, \cal{E}]^\to \to [\cal{E}, \cal{E}]^\to
.\]

Recall from \cref{thm:endpoint-are-she-functorially} that $\delta^k \co \cal{E} \to \cal{E}^\to$ factors via $\cal{S}_k \to \cal{E}^\to$, \ie that
the arrow
\[
\theta^k \hatotimes (\delta^k \otimes X) \co \delta^k \otimes X \to \delta^k \hatotimes (\delta^k \otimes X)
\]
exhibits $\delta^k \otimes X$ as a retract of $\delta^k \hatotimes (\delta^k \otimes X)$, functorially in $X \in \cal{E}$.
This amounts to saying that the map of natural transformations
\[
\theta^k \mathbin{\hat{\cc}} \delta^k \co \delta^k \to \delta^k \mathbin{\hat{\cc}} \delta^k
\]
exhibits $\delta^k$ as a retract of $\delta^k \mathbin{\hat{\cc}} \delta^k$ in $[\cal{E}, \cal{E}]^\to$.

Our goal is to show that $\delta^k \hatotimes (-) \co \cal{E}^\to \to \cal{E}^\to$ can be factored via $\cal{S}_k \to \cal{E}^\to$.
For this, we need to show
that the arrow
\[
\theta^k \hatotimes (\delta^k \hatotimes f) \co \delta^k \hatotimes f \to \delta^k \hatotimes (\delta^k \hatotimes f)
\]
exhibits $\delta^k \hatotimes f$ as a retract of $\delta^k \hatotimes (\delta^k \hatotimes f)$, functorially in $f \in \cal{E}^\to$.
But associativity of functor composition implies associativity of the corresponding Leibniz construction (since the involved functors preserve pushouts), and therefore we can restate our goal as asserting that the map
\[
(\theta^k \mathbin{\hat{\cc}} \delta^k) \hatotimes f \co \delta^k \hatotimes f \to (\delta^k \mathbin{\hat{\cc}} \delta^k) \hatotimes f
\]
exhibits $\delta^k \hatotimes f$ as a retract of $(\delta^k \mathbin{\hat{\cc}} \delta^k) \hatotimes f$, functorially in $f \in \cal{E}^\to$.
But functors, in this case the functor $(-) \hatotimes (-) \co [\cal{E}, \cal{E}]^\to \times \cal{E}^\to \to \cal{E}^\to$,
mapping $(\alpha, f)$ to $\alpha \hatotimes f$, preserve section-retraction pairs.
\end{proof}

The next lemma is the analogue of~\cref{thm:main-sheretract}.
Define $\cal{S} \defeq  \cal{S}_0 + \cal{S}_1$.

\begin{proposition} \label{thm:strong-hequiv} \leavevmode
\begin{enumerate}[(i)]
\item \label{thm:onedir} There is a functor
\[
\xymatrix@!C@C-2.5em{
  \Cyl
  \ar[dr]
  \ar[rr]^F
&&
  \Cof \times_{\cal{E}^\to} \cal{S}
  \ar[dl]
\\&
  \catE^\to
\rlap{.}}
\]
\item \label{thm:twodir} There is a functor
\[
\xymatrix@!C@C-2.5em{
  \Cof \times_{\cal{E}^\to} \cal{S}
  \ar[dr]
  \ar@<4pt>[rr]^{H}
&&
  \TrivCof
  \ar[dl]
\\&
  \catE^\to
\rlap{.}}
\]
\end{enumerate}
\end{proposition}

\begin{proof}
For~(i), we first show that there is a functor
\[
\xymatrix@!C@C-2em{
  \Cof
  \ar[dr]_{\kcyl \hatotimes u} \ar[rr]^{M_k}
&&
  \Cof \times_{\cal{E}^\to} \cal{S}_k
  \ar[dl]
\\&
   \catE^\to
\rlap{.}}
\]
The map to the first factor is given by the assumption that $\Cof$ is closed under Leibniz product with the endpoint inclusions, which is part of the hypotheses of a suitable awfs.
The map to the second factor is given by \cref{thm:kcylf-is-she-alg}.
The claim in~(i) then follows by combining the cases~$k = 0$ and~$k = 1$.

For~(ii), we first fix $k \in \braces{0\,, 1}$ and show that there is a functor
\begin{equation} \label{lem:from-strong-hequiv}
\begin{gathered}
\xymatrix@!C@C-2em{
  \Cof \times_{\cal{E}^\to} \cal{S}_k
  \ar[dr]
  \ar[rr]^{N_k}
&&
  \overline{\Cof}
  \ar[dl]^-{\overline{\kcyl \hatotimes u}}
\\&
  \catE^\to
\rlap{.}}
\end{gathered}
\end{equation}
We only describe the action of the functor $N_k$ on an object $(f, \rho)$, leaving the evident definition of the action on arrows to the reader.
Recall that $\rho$ is a retraction of $\thetak \hatotimes f \co f \to \kcyl \hatotimes f$, exhibiting~$f$ as a retract of~$\kcyl \hatotimes f$.
Thus, we may define $N_k(f, \rho) \defeq (f, f, \thetak \hatotimes f, \rho)$.
Observe that this definition makes the diagram for $N_k$ commute.
We then combine the cases $k = 0$ and $k = 1$ to get a functor $\Cof \times_{\cal{E}^\to} \cal{S}_k \to \overline{\Cyl}$ over $\cal{E}^\to$.
The claim in~(ii) then follows by composing with $\overline{\Cyl} \to \overline{\TrivCof} \to \TrivCof$, using \cref{retract-closure} to eliminate the retract closure (recall that $\TrivCof$ is a category of left maps).
\end{proof}

\begin{remark} \label{relating-strong-hequiv-and-uniform-fib}
We also have a pair of functors $\liftr{(\Cof \times_{\cal{E}^\to} \cal{S})} \leftrightarrow \Fib$ relating uniform fibrations with right $(\Cof \times_{\cal{E}^\to} \cal{S})$-maps.
This means that a map can be equipped with the structure of a uniform fibration if and only if it can be equipped with the structure of a right $(\Cof \times_{\cal{E}^\to} \cal{S})$-map.
This is the analogue of the equality between sets in \cref{fib-and-she}.
However, these functors do not in general form an equivalence.
\end{remark}

We are now ready to show that the awfs in which the right maps are the uniform fibrations (constructed in~\cref{thm:sset-cset-nwfs}) satisfies the functorial Frobenius property.
For this, we use our characterisation of the functorial Frobenius property in algebraically-free awfs's stated in \cref{thm:frobenius-comparison}.
As the main step, we show that that strong homotopy equivalences and uniform fibrations satisfy the generalized functorial Frobenius condition, \ie the algebraic analogue of \cref{thm:non-alg-frobenius-she}.

\begin{lemma} \label{technical}
The triple $(\cal{S}, \Fib, \cal{S})$ satisfies the generalized functorial Frobenius condition.
\end{lemma}

\begin{proof}
The core of the argument is to obtain, for $k \in \braces{0\,, 1}$, a lift $\tilde{P}$ in
\begin{equation} \label{strong-h-equiv-uniform-base-change:goal}
\begin{gathered}
\xymatrix@C+2em{
  \cal{S}_k \times_{\cal{E}} \Fib
  \ar@{.>}[r]^{\tilde{P}}
  \ar[d]
&
  \cal{S}_k
  \ar[d]
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P}
&
  \cal{E}^\to
\rlap{.}}
\end{gathered}
\end{equation}
where $P \co \cal{E}^\to \times_{\cal{E}} \cal{E}^\to \to \cal{E}^\to$ is the pullback functor, sending a cospan $(g, h)$ to $h^* g$.
The goal then follows from \cref{generalized-uniform-frob-nicer} upon combining the cases $k = 0$ and $k = 1$ using \cref{generalized-uniform-frob-product-u}.

So it remains to show how to obtain the lift in \eqref{strong-h-equiv-uniform-base-change:goal}.
Its action on objects is described in the proof of~\cref{thm:non-alg-frobenius-she}.
For the lift of the action on morphisms, suppose we are given a map $j \to j'$ in $\Fib$, inducing a square
\[
\xymatrix{
  X
  \ar[r]^{v_j}
  \ar[d]_{s}
&
  Y
  \ar[d]^{t}
\\
  X'
  \ar[r]_{v_{j'}}
&
  Y'
\rlap{,}}
\]
and a map $\tau \co (g, \rho) \to (g', \rho')$ in $\cal{S}_k$, with $\tau$ forming a square
\[
\xymatrix{
  B
  \ar[r]
  \ar[d]_{g}
&
  B'
  \ar[d]^{g'}
\\
  Y
  \ar[r]_-{t}
&
  Y'
\rlap{,}}
\]
such that $\tau$ commutes with the retractions $\rho$ and $\rho'$ as follows:
\[
\xymatrix{
  \kcyl \hatotimes g
  \ar[r]^-{\rho}
  \ar[d]_{\kcyl \hatotimes \tau}
&
  g
  \ar[d]^{\tau}
\\
  \kcyl \hatotimes g'
  \ar[r]_-{\rho'}
&
  g'
\rlap{.}}
\]
Let $(\bar{g}, \bar{\rho})$ and $(\bar{g}', \bar{\rho}')$ denote the respective action of $\tilde{P}$ on the objects $(g, \rho, j)$ and $(g', \rho', j')$ as constructed in \cref{thm:non-alg-frobenius-she}.
Recall that this includes pullback squares $\sigma \co \bar{g} \to g$ and $\sigma' \co \bar{g}' \to g'$ with bottom side $v_j \co X \to Y$ and $v_{j'} \co X' \to Y'$, respectively, as in~\eqref{non-alg-strong-h-equiv-uniform-base-change:0}.
The square $\tau \co g \to g'$ pulls back to a square $\bar{\tau} \co \bar{g} \to \bar{g'}$ with bottom side $v_{j'}$.
We want to show that $\bar{\tau}$ in addition forms a morphism of strong $k$-oriented homotopy equivalences from $(\bar{g}, \bar{\rho})$ to $(\bar{g}', \bar{\rho}')$.
For this, we have to verify commutativity of the following diagram:
\[
\xymatrix{
  \kcyl \hatotimes \bar{g}'
  \ar[r]^-{\bar{\rho}}
  \ar[d]_{\kcyl \hatotimes \bar{\tau}}
&
  \bar{g}
  \ar[d]^{\bar{\tau}}
\\
  \kcyl \hatotimes \bar{g}'
  \ar[r]_-{\bar{\rho}'}
&
  \bar{g}'
\rlap{.}}
\]
Recall the construction of $\bar{\rho}$ and $\bar{\rho}'$, omitting horizontal composite identities for readability:
\[
\xymatrix@!C{
  \bar{g}
  \ar[rr]^-{\thetak \hatotimes \bar{g}}
  \ar[dd]_{\sigma}
  \ar[dr]^{\bar{\tau}}
&&
  \kcyl \hatotimes \bar{g}
  \ar@{.>}[rr]^-{\bar{\rho}}
  \ar[dd]^(0.3){\kcyl \hatotimes \sigma}|!{[dl];[dr]}{\hole}
  \ar[dr]^{\kcyl \hatotimes \bar{\tau}}
&&
  \bar{g}
  \ar[dd]^(0.3){\sigma}|!{[dl];[dr]}{\hole}
  \ar[dr]^{\bar{\tau}}
\\&
  \bar{g}'
  \ar[rr]^-(0.3){\thetak \hatotimes \bar{g}'}
  \ar[dd]_(0.3){\sigma'}
&&
  \kcyl \hatotimes \bar{g}'
  \ar@{.>}[rr]^-(0.3){\bar{\rho}'}
  \ar[dd]^(0.3){\kcyl \hatotimes \sigma'}
&&
  \bar{g}'
  \ar[dd]^{\sigma'}
\\
  g
  \ar[rr]^-(0.25){\thetak \hatotimes g}|!{[ur];[dr]}{\hole}
  \ar[dr]^{\tau}
&&
  \kcyl \hatotimes g
  \ar[rr]^-(0.3){\rho}|!{[ur];[dr]}{\hole}
  \ar[dr]^{\kcyl \hatotimes \tau}
&&
  g
  \ar[dr]^{\tau}
\\&
  g'
  \ar[rr]^-{\thetak \hatotimes g'}
&&
  \kcyl \hatotimes g
  \ar[rr]^-{\rho'}
&&
  g
\rlap{.}}
\]
Our goal is to show that the top right square commutes.
Since that square commutes after composing it with the pullback square $\sigma'$, it suffices to show that the square commutes when projected to codomains, again omitting horizontal composite identities:
\[
\xymatrix@C+2em{
  X
  \ar[rr]^-{\kcylinv \otimes X}
  \ar[dd]_{v_j}
  \ar[dr]^{s}
&&
  \interval \otimes X
  \ar@{.>}[rr]^-{\cod(\bar{\rho})}
  \ar[dd]^(0.35){\interval \otimes v_j}|!{[dl];[dr]}{\hole}
  \ar[dr]^{\interval \otimes s}
&&
  X
  \ar[dd]^(0.35){v_j}|!{[dl];[dr]}{\hole}
  \ar[dr]^{s}
\\&
  X'
  \ar[rr]^-(0.3){\kcylinv \otimes X'}
  \ar[dd]^(0.3){v_{j'}}
&&
  \interval \otimes X'
  \ar@{.>}[rr]^-(0.3){\cod(\bar{\rho}')}
  \ar[dd]^(0.3){\interval \otimes v_{j'}}
&&
  X'
  \ar[dd]^{v_{j'}}
\\
  Y
  \ar[rr]^-(0.25){\kcylinv \otimes Y}|!{[ur];[dr]}{\hole}
  \ar[dr]^{t}
&&
  \interval \otimes Y
  \ar[rr]^-(0.3){\cod(\rho)}|!{[ur];[dr]}{\hole}
  \ar[dr]^{\interval \otimes t}
&&
  Y
  \ar[dr]^{t}
\\&
  Y'
  \ar[rr]^-{\kcylinv \otimes Y'}
&&
  \interval \otimes Y'
  \ar[rr]^-{\cod(\rho')}
&&
  Y'
\rlap{.}}
\]
But this follows from coherence of lifts in the following morphism of lifting problems:
\[
\xymatrix@C+1em{
  X
  \ar@{=}[rrrr]
  \ar[dd]_{\kcylinv \otimes X}
  \ar[dr]^{s}
&&&&
  X
  \ar[dd]_(0.3){v_j}|!{[dlll];[dr]}{\hole}|!{[dddlll];[dr]}{\hole}
  \ar[dr]^{s}
\\&
  X'
  \ar@{=}[rrrr]
  \ar[dd]^(0.66){\kcylinv \otimes X'}
&&&&
  X'
  \ar[dd]^{v_{j'}}
\\
  \interval \otimes X
  \ar[rr]^(0.7){I \otimes v_j}|!{[ur];[dr]}{\hole}
  \ar@{.>}[uurrrr]^(0.67){\cod(\bar{\rho})}|!{[ur];[dr]}{\hole}|!{[ur];[urrrrr]}{\hole} % bug: doesn't work?
  \ar[dr]_{I \otimes s}
&&
  \interval \otimes Y
  \ar[rr]_(0.7){\cod(\rho)}|!{[dl];[urrr]}{\hole}
  \ar[dr]^(0.7){\interval \otimes t}|!{[dl];[urrr]}{\hole}
&&
  Y
  \ar[dr]^{t}
\\&
  \interval \otimes X'
  \ar[rr]_{I \otimes v_{j'}}
  \ar@{.>}[uurrrr]^(0.67){\cod(\bar{\rho}')}
&&
  \interval \otimes Y'
  \ar[rr]_{\cod(\rho')}
&&
  Y'
\rlap{.}}
\]
Here, the left and right faces form morphisms in $\TrivCof$ and $\Fib$, respectively, making the lifts cohere as needed.
\end{proof}

\begin{theorem} \label{uniform-fibrations-uniform-frobenius}
The awfs $(\mathsf{C_t}, \mathsf{F})$ satisfies the functorial Frobenius condition.
\end{theorem}

\begin{proof}
First, we show that $(\Cof \times_{\cal{E}} \cal{S}, \Fib, \Cof \times_{\cal{E}} \cal{S})$ satisfies the generalized functorial Frobenius condition.
This follows from \cref{generalized-uniform-frob-product-u} since $(\Cof, \Fib, \Cof)$ satisfies the generalized functorial Frobenius condition by hypothesis~(S3) in the definition of a suitable awfs (\cref{thm:suitable-awfs}) and $(\cal{S}, \cal{S}, \Fib)$ satisfies the generalized Frobenius condition by \cref{technical}.

Let the awfs $(\mathsf{C_t}, \mathsf{F})$ be algebraically free on $\cal{I}_\otimes$ as in the proof of \cref{thm:sset-cset-nwfs}.
The generalized functorial Frobenius condition for $(\Cof \times_{\cal{E}} \cal{S}_k, \Fib, \Cof \times_{\cal{E}} \cal{S}_k)$ implies the generalized functorial Frobenius condition for $(\cal{I}_\otimes, \Fib, \TrivCof)$ using functoriality of generalized functorial Frobenius in the form of \cref{generalized-uniform-frob-functorial} with $F$ essentially the functor in part~\eqref{thm:onedir} of~\cref{thm:strong-hequiv} and $H$ the functor in part~\eqref{thm:twodir} of~\cref{thm:strong-hequiv}.
This implies the functorial Frobenius condition by \cref{thm:frobenius-comparison}.
\end{proof}

As special cases, we obtain the pushforward versions of the Frobenius and Beck-Chevalley condition for uniform fibrations.
First, pushforward lifts to slices of the category of uniform $\cal{I}$-fibrations.

\begin{corollary} \label{uniform-fibrations-frobenius-pushforward} \leavevmode
\begin{enumerate}[(i)]
\item For every uniform fibration
$p \co X \to Y$, pushforward along $p$ lifts to a functor
\[
\xymatrix@C+2em{
  \Fib_{/X}
  \ar[r]^{\widetilde{p_*}}
  \ar[d]
&
  \Fib_{/Y}
  \ar[d]
\\
  \catE_{/X}^\to
  \ar[r]_{p_*}
&
  \catE_{/Y}^\to
\rlap{.}}
\]
\item For every map of uniform $\cal{I}$-fibrations $(s, t) \co p \to q$ , where $p \co X \to Y$ and $q \co U \to V$, the canonical natural transformation $\psi \co t^* q_* \to p_* s^*$ lifts to a natural transformation
\[
\xymatrix@C+2em{
  \Fib_{/U}
  \ar[r]^{\widetilde{q_*}}
  \ar[d]_{\widetilde{s^*}}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle \widetilde{\psi}$}}
&
  \Fib_{/V}
  \ar[d]^{\widetilde{t^*}}
\\
  \Fib_{/X}
  \ar[r]_{\widetilde{p_*}}
&
  \Fib_{/Y}
\rlap{.}}
\]
If $(s, t) \co p \to q$ forms a pullback square, then $\widetilde{\psi}$ is a natural isomorphism.
\end{enumerate}
\end{corollary}

\begin{proof}
The claim follows from \cref{uniform-fibrations-uniform-frobenius} using \cref{thm:frobenius-comparison} and \cref{lift-pushforward}.
\end{proof}

\begin{example}
The application of \cref{uniform-fibrations-frobenius-pushforward} in $\SSet$ and $\CSet$ shows that pushforward along a uniform Kan fibration preserves uniform Kan fibrations.
Since exponentiation is a special case of pushforward, this result shows also that if $X$ is a uniform Kan complexes (defined in the evident way) then $Y^X$ is again a uniform Kan complex,
for every $Y$.
In fact, as usual, only the base needs to be assumed uniform Kan.
This can be seen as follows.
Let $p \co X \to A$ be a uniform Kan fibration and $i \co B \to Y$ be a monomorphism.
Recall that~$\cal{M} \times_{\cal{E}^\to} \cal{S}_k$ is closed under Leibniz product with~$i$, for $k \in \braces{0\,, 1}$, since it is true separately for $\cal{M}$ and $\cal{S}_k$.
By \cref{lift-of-leibniz-adjunction}, we have that~$\hatexp(i, p)$ is again a uniform Kan fibration.
The desired claim is then the special case~$A = 1$ and~$B = 0$.
\end{example}

\section{Uniform fibrations in presheaf categories}
\label{sec:fib-psh}

The aim of this final section is to study in more detail the notion of a uniform fibration in the case when $\cal{E}$ is a presheaf category.
Let us begin by fixing the setting in which we shall be working.
First, let $\mathbb{C}$ be a small category and fix $\cal{E} \defeq \Psh(\mathbb{C})$.
We write $\yon \co \mathbb{C} \to \cal{E}$ for the Yoneda embedding.
We assume that the functorial cylinder~$\interval \otimes (-) \co \cal{E} \to \cal{E}$ satisfies not only our standing assumptions of having contractions and connections and of possessing a right adjoint (see \cref{sec:bac}), but also the following two conditions:
\begin{enumerate}[({C}1)]
\item $\interval \otimes (-) \co \cal{E} \to \cal{E}$ preserves pullback squares,
\item the natural transformations $\kcyl \otimes (-) \co \id_\cal{E} \to \interval \otimes (-)$, for $k \in \braces{0\,, 1}$, are cartesian.
\end{enumerate}
Secondly, we let $\cal{M}$ be a full subcategory of $\cal{E}^\to_\cart$ satisfying the following assumptions:
\begin{enumerate}[({M}1)]
\item the elements of $\cal{M}$ are monomorphisms,
\item for every $X \in \cal{E}$, the unique map $\bot_X \co 0 \to X$ is in $\cal{M}$,
\item the elements of $\cal{M}$ are closed under pullbacks,
\item the elements of $\cal{M}$ are closed under Leibniz product with the endpoint inclusions,
\item the category $\cal{M}$ has colimits and the inclusion $\cal{M} \to \cal{E}^\to_\mathrm{cart}$ preserves them.%
\footnote{This assumption not used in the instantiation of our general results to this setting, but only for the separate \cref{partial-map-classifier,unif-vs-non-unif}.}
\end{enumerate}
The next result not only provides us with a wide class of examples of suitable awfs's, but also shows that there are situations in which object-wise assertions, as in (M2)-(M4) above, can be strengthened to functoriality properties, as required to obtain a suitable weak awfs (\cref{thm:suitable-awfs}).

\begin{theorem} \label{rem-lift-suitable}
There exists a suitable awfs $(\CC, \TF)$ on $\cal{E}$ that is algebraically-free on $\cal{M}$, \ie such that $\pAlg{\TF} = \liftr{\cal{M}}$.
\end{theorem}

\begin{proof}
Let $\cal{I}$ be the full subcategory of $\cal{M}$ spanned by maps with a representable presheaf as codomain.
Since $\cal{I}$ is small, by Garner's small object argument~\cite{garner:small-object-argument} it generates a cofibrantly generated awfs $(\CC, \TF)$ with~$\pAlg{\TF} = \liftr{\cal{I}}$.
Furthermore, we have~$\liftr{\cal{M}} = \liftr{\cal{I}}$.
This follows from \cref{awfs-on-arrows-into-representables} using that $\cal{M}$ is a full subcategory of~$\cal{E}^\to_\cart$.
Indeed, for a map $f \co X \to Y$ in $\catE$, to give a natural choice of fillers for all diagrams with an arbitrary element of $\cal{M}$ on the left is the same as to give a natural choice of fillers for only those diagrams which are the form
\[
\xymatrix{
  A
  \ar[r]
  \ar[d]
&
  X
  \ar[d]^f
\\
  \yon(x)
  \ar[r]
&
  Y
\rlap{,}}
\]
where $\yon(x)$ the Yoneda embedding of some $x \in \catC$.

It remains to check that $(\CC, \TF)$ satisfies conditions~(S2)-(S4) in~\cref{thm:suitable-awfs}.
These follow from the corresponding object-wise assumptions~(M2)-(M4) via standard diagram-chasing arguments, which we omit.
For condition~(S4), the crucial property being used in that proof is that elements of $\cal{M}$, being monomorphisms in a topos, are adhesive maps~\cite{garner-lack:adhesive}.
\end{proof}

\begin{remark}
\label{rem:colimit-decomp}
Let us point out that the reduction to the lifting problems against maps in $\cal{M}$ to those with a representable codomain in the proof of \cref{rem-lift-suitable} exploits the good behaviour of the right orthogonality functor with respect to colimits as described in~\cref{awfs-on-arrows-into-representables}, which is not available in the setting of ordinary wfs's.
\end{remark}

\begin{example} \label{justify-sset-cset-examples}
Since assumptions (C1)-(C2) and (M1)-(M5) are fulfilled in both $\SSet$ and~$\CSet$, with $\cal{M}$ the category of all monomorphisms and pullback squares (with (M5) a consequence of the existence of a subobject classifier), \cref{rem-lift-suitable} establishes the existence of the awfs $(\TC, \FF)$ of \cref{unif-fib-sset}.
The assumptions are also satisfied if instead in $\CSet$ we choose for $\cal{M}$ the category of $\cal{M}'$ of \cref{unif-triv-fib-sset} (with elements classified by the face lattice $\Phi$ of~\cite{cohen-et-al:cubicaltt}), establishing the existence of the awfs $(\TC', \FF')$ of \cref{unif-fib-sset}.
\end{example}

\begin{remark} \label{rem:constructive-small-object}
We discuss how, in the case of $\SSet$ and~$\CSet$, the existence of the awfs's $(\CC, \TF)$, having uniform trivial Kan fibrations as right maps, and $(\TC, \FF)$, having uniform Kan fibrations as right maps, and the Frobenius property for $(\TC, \FF)$ can can be proved constructively, \ie without using the law of excluded middle or the axiom of choice.

We begin by observing that \cref{rem-lift-suitable} can be proved constructively in $\SSet$ and $\CSet$.
In order to see why this is the case, first note that in these examples every subobject of a representable is finitely presentable and that the functorial cylinder $\interval \otimes (-) \co \cal{E} \to \cal{E}$ preserves finitely presentable objects.
Since subobjects of representables are finitely presentable, the values of the inclusion $u \co \cal{I} \to \cal{E}^\to$ are finitely presentable objects of $\cal{E}^\to$.
An inspection of the proof of \cite[Theorem~4.4]{garner:small-object-argument} shows that this suffices to construct the algebraically-free awfs $(\CC, \TF)$ on $u \co \cal{I} \to \cal{E}^\to$, and in fact the sequence constructing the appropriate free monad converges after $\omega$ steps.
Next, note that also \cref{thm:sset-cset-nwfs} can be proved constructively for $\SSet$ and $\CSet$, via a reasoning that is analogous to the one above, observing that also the values of $u_\otimes \co \Cyl \to \cal{E}^\to$ are finitely presentable by the assumption of the functorial cylinder and the fact that finitely presentable objects are closed under pushout.
Finally, the general proof of \cref{uniform-fibrations-uniform-frobenius} and \cref{uniform-fibrations-frobenius-pushforward}, establishing the functorial Frobenius condition for $(\TC, \FF)$ and its pushforward analogue, are constructive.

We have therefore obtained a constructive proof that pushforward along a uniform Kan fibration preserves uniform Kan fibrations in $\SSet$ and $\CSet$.
For $\SSet$, this result is a constructive counterpart of the fact that pushforward along a Kan fibration preserves Kan fibrations, which cannot be proved constructively without changes to the definition of Kan fibration~\cite{coquand-non-constructivity-kan}.

Finally, let us point out that if one adds the assumption that elements of $\cal{M}$ are \emph{decidable} monomorphisms, then the argument above carries over without relying on the Power Set axiom to establish the smallness of $\cal{I}$.
%We believe that this restriction is important also to treat constructively further aspects of the theory, such as the existence of fibrant universes~\cite{cohen-et-al:cubicaltt}.
\end{remark}

The rest of this section is devoted to giving a characterization of uniform trivial fibrations in terms of the partial map classifier, a result suggested to us by Thierry Coquand and Andr\'e Joyal.
We then use this characterization to relate non-algebraic and algebraic notions of (trivial) fibration.

\begin{remark}
A related, but different approach to generating an awfs $(\CC, \TF)$ from a class of monomorphisms is taken in \cite{bourke-garner-I}.
Recall from \cref{rem-lift-suitable} that $(\CC, \TF)$ is cofibrantly generated by the full category $\cal{M}$ of $\cal{E}^\cart$.
Instead, as done in \cite{bourke-garner-I}, one may assume that the chosen monomorphisms are closed under composition and view $\cal{M}$ as a double category.
This then cofibrantly generates an awfs $(\CC', \TF')$ in a double categorical sense.
The monad $\TF'$ in the slice over $Y \in \cal{E}$ is given by the $\cal{M}$-partial map classifier $P_Y$ relative to $Y$.
For us instead, as implies by \cref{thm:part-map-classifier}, the monad $\TF$ in the slice over $Y \in \cal{E}$ is freely generated by $P_Y$ seen as a pointed endofunctor.
It follows that the awfs $(\CC, \TF)$ and $(\CC', \TF')$ are different, but related by an isomorphism $\pAlg{\TF} \cong \palg{\TF'}$.
\notec{Compare the Frobenius properties for $(\TC, \FF)$ and $(\TC', \FF')$.}
\end{remark}

We begin with a simple lemma.

\begin{lemma} \label{identities-in-M}
For all $X \in \cal{E}$, $\id_X \in \cal{M}$ .
\end{lemma}

\begin{proof}
The claim follows by inspection of the following diagram:
\[
\xymatrix@C+3em{
  X
  \ar[r]
  \ar[d]_{\id_X}
  \pullback{dr}
&
  \Id \otimes X
  \ar[d]^{\delta^0 \hatotimes \bot_X}
\\
  \Id \otimes X
  \ar[r]_{\delta^0 \hatotimes \bot_X}
&
  I \otimes X
\rlap{.}}
\]
By conditions~(M2) and~(M4), the right map is in $\cal{M}$.
By condition~(C2), the square is a pullback.
With condition~(M3), the left map $\id_X$ is then in $\cal{M}$.
\end{proof}

Below, as usual, we write $\Omega$ for the subobject classifier of the topos $\cal{E}$ and $\top \co 1 \to \Omega$ for its `true' morphism.

\begin{lemma} \label{partial-map-classifier}
There exists a subobject $K \rightarrowtail \Omega$ and a factorization
\[
\xymatrix{
  1
  \ar[rr]^\top
  \ar[dr]
&&
  \Omega
\\
&
  K
  \ar@{>->}[ur]
}
\]
such that the map $1 \to K$ classifies maps in~$\cal{M}$, in the sense that a map
$i \co A \to B$ is in $\cal{M}$ if and only if there exists a pullback
\[
\xymatrix{
  A
  \ar[r]
  \ar[d]_i
  \drpullback
&
  1
  \ar[d]
\\
  B
  \ar[r]
&
  K
\rlap{.}}
\]
\end{lemma}

\begin{proof}
For $x \in \cat{C}$, define $K(x)$ to be the set of subobjects of~$\yon(x)$ that are elements of~$\cal{M}$.
The factorisation of $\top \co 1 \to \Omega$ through $K$ follows since identities are contained in $\cal{M}$ by \cref{identities-in-M}.

Any element $i \co A \to B$ of $\cal{M}$ arises as base change of $1 \to K$ along a unique map $B \to K$, sending an element $b \co \yon(x) \to B$, for $x \in \cat{C}$, to the subobject of $\yon(x)$ given by the base change of~$i \co A  \to B$ along $b$, which is in $K(x)$ since $i$ is in $\cal{M}$.
For the converse, it suffices to show that~$1 \to K$ is in $\cal{M}$, but this is equivalent to (M5).
\end{proof}

The axioms for the class $\cal{M}$ in (M1)-(M5) can then be rewritten in equivalent form as properties of the classifier $K$, see~\cite{PittsAM:aximct} for details and~\cite{HylandM:firssd,RosoliniG:phd} for related ideas in synthetic domain
theory.
Observe that the factorization of $\top \co 1 \to \Omega$ via $K$ gives us a pullback diagram
\begin{equation} \label{partial-map-classifier:0}
\begin{gathered}
\xymatrix{
  1
  \ar@{=}[r]
  \ar[d]
  \pullback{dr}
&
  1
  \ar[d]^{\top}
\\
  K
  \ar@{>->}[r]
&
  \Omega \rlap{,}
}
\end{gathered}
\end{equation}

Let us now fix $Y \in \cal{E}$ and work in the slice category $\cal{E}_{/Y}$.
Let $t \co Y \to K \times Y$ denote the classifier for $\cal{I}_{/Y}$.
Let $\pi \co K \times Y \to Y$ denote the map to the terminal object.
The \emph{$\cal{M}$-partial map classifier} $P_Y$ relative to $Y$ associated to~$\cal{M}$ is the polynomial endofunctor, in the sense of~\cite{gambino-kock}, on~$\cal{E}_{/Y}$ given by the data
\[
\xymatrix{
  Y
&
  Y
  \ar[l]_-{\id_K}
  \ar[r]^-{t}
&
  K \times Y
  \ar[r]^-{\pi}
&
  Y
}
\]
as $P_Y = \pi_! \cc t_*$~\cite[A2.4]{johnstone:elephant}.
Note that we have $t^* t_* = \Id$ since $t$ is monic, giving rise to a pullback square
\begin{equation} \label{partial-map-classifier:1}
\begin{gathered}
\xymatrix{
  X
  \ar[r]^-{\eta_X}
  \ar[d]
  \pullback{dr}
&
  P_Y X
  \ar[d]
\\
  Y
  \ar[r]_-{t}
&
  K \times Y
}
\end{gathered}
\end{equation}
for every $X \in \cal{E}_{/Y}$.



\begin{theorem} \label{thm:part-map-classifier}
Giving the structure of a uniform trivial fibration on a map $f \co X \to Y$ is equivalent to giving a diagonal filler for the diagram
\begin{equation*}
\begin{gathered}
\xymatrix{
  X
  \ar@{=}[r]
  \ar[d]_{\eta_X}
&
  X
  \ar[d]^{f}
\\
  P_Y X
  \ar[r]
  \ar@{.>}[ur]
&
  Y
\rlap{,}}
\end{gathered}
\end{equation*}
\ie a retraction of $\eta_X$ in $\cal{E}_{/Y}$.
\end{theorem}

\begin{proof}
Let $\cal{I}$ be the full subcategory of $\cal{M}$ spanned by maps with a representable presheaf as codomain
and recall from the proof of \cref{rem-lift-suitable} that we have $\liftr{\cal{M}} = \liftr{\cal{I}}$.
Let $u \co \cal{I} \to \cal{E}^\to$ denote the inclusion.
Following the first step of Garner's algebraic small object argument, a lift of a map $f \co X \to Y$ to an element of $\liftr{\cal{I}}$ is given by a diagonal filler in the canonical square $(\Lan_u u)(f) \to f$.
Developing the left Kan extension, we have
\begin{align*}
(\Lan_u u)(f)
&=
\colim_{i \in \cal{I}, u_i \to f} u_i
\\&=
\colim_{\sigma : y C \to K \times Y,\ \cal{E}_{/Y}(t^* \sigma, X)} \sigma^* t
\\&=
\colim_{\sigma : y C \to P_Y(X)} \sigma^* \eta_X
\\&=
\eta_X
.
\end{align*}
Here, the penultimate step uses the pullback square~\eqref{partial-map-classifier:1} and the last step uses the Yoneda lemma and preservation of colimits by pullback.
\end{proof}

\begin{theorem} \label{unif-vs-non-unif} \leavevmode
\begin{enumerate}[(i)]
\item A map can be equipped with the structure of a uniform trivial fibration if and only if it is a trivial fibration, \ie it has
the right lifting property with respect to the maps in $\cal{M}$.
\item A map can be equipped with the structure of a uniform trivial fibration if and only if it is a fibration, \ie it has the right
lifting property with respect to the open cylinder inclusions.
\end{enumerate}
\end{theorem}

\begin{proof}
For part (i), since $1 \to K$ is in $\cal{M}$, as proved in \cref{partial-map-classifier}, then also $\eta$ has components in $\cal{M}$ by~\eqref{partial-map-classifier:1}.
Part (ii) follows from part (i) and \cref{prod-exp-general}.
\end{proof}

\begin{example} \label{elegant-reedy}
\cref{unif-vs-non-unif} applies to $\SSet$ and $\CSet$, showing that a map can be equipped with the structure of a (trivial) Kan fibration if and only if it is a (trivial) Kan fibration in the usual sense.
\end{example}

\begin{remark} \label{why-uniform}
Since \cref{unif-vs-non-unif} is proved constructively, it is natural to wonder whether it is possible to develop constructively our theory in the non-algebraic setting, at least for $\SSet$ or~$\CSet$.
The key obstacle to this is that, while the special case of the algebraic result in \cref{rem-lift-suitable} admits a constructive proof in $\SSet$ and $\CSet$, as we explained in~\cref{rem:constructive-small-object}, its non-algebraic counterpart does not seem to provable be constructively, even in the case when $\cal{M}$ consists of all monomorphisms (\cf \cref{thm:generation-presheaf-cisinski} and \cref{rem:colimit-decomp}).
And such a result is essential for the development since it provides the suitable (algebraic) wfs on which the definition of the functorial Frobenius property is based.
\end{remark}

\bibliographystyle{plain}
\bibliography{../../common/uniform-kan-bibliography}

\end{document}
