\documentclass[reqno,10pt,a4paper,oneside,draft]{amsart}

\setcounter{tocdepth}{1}
%\usepackage[parfill]{parskip}

\usepackage{uniform-kan-prelude}

{
\newcommand{\LL}{\mathsf{L}}
\newcommand{\RR}{\mathsf{R}}


\title{The Frobenius condition and uniform fibrations}

\begin{document}

\begin{abstract}
We introduce and study the notion of a uniform fibration in categories with a functorial cylinder.
We show that in a wide class of presheaf categories, including simplicial sets and cubical sets with connections, uniform fibrations are the right class of an algebraic weak factorization system that satisfies the functorial Frobenius condition.
This implies that pushforward along a uniform fibration preserves uniform fibrations.
When instantiated in simplicial sets, this result solves the open problem of finding a constructive counterpart of one of the key facts underpinning Voevodsky's simplicial model of univalent foundations and gives a new proof of the right properness of the Quillen model structure for Kan complexes.
In cubical sets, it extends results by Coquand and others.
\end{abstract}

\author{Nicola Gambino}
\address{School of Mathematics, University of Leeds, Leeds LS2 9JT, UK}
\email{n.gambino@leeds.ac.uk}

\author{Christian Sattler}
\address{School of Mathematics, University of Leeds, Leeds LS2 9JT, UK}
\email{c.sattler@leeds.ac.uk}

% \date{\today}

\maketitle

%\tableofcontents

\newpage

\section*{Introduction}

Bousfield's weak factorization systems~\cite{bousfield-wfs} are a cornerstone of modern homotopical algebra~\cite{quillen-homotopical}, not least because they support a very elegant treatment of Quillen model categories~\cite{joyal-tierney-notes}.
Yet, they have some unsatisfactory aspects, such as the failure of left and right maps to be closed under all colimits.
These issues can be remedied by considering algebraic weak factorisation systems~\cite{garner:small-object-argument,grandis-tholen-nwfs}, which involve maps equipped with a suitably natural family of solutions for lifting problems, rather than maps merely satisfying a lifting property.
The presence of this additional structure on maps has proved to be crucial for applications of algebraic weak factorization systems in higher-dimensional category theory~\cite{batanin-cisinski-weber,garner:globular-operator-awfs,garner-homomorphisms} and in Voevodsky's univalent foundations programme~\cite{awodey-cubical,coquand-cubical-sets,cohen-et-al:cubicaltt,pitts-cubical-nominal,swan-awfs}.

Our general aim here is to develop further the theory of algebraic weak factorization systems and provide some new applications.
In particular, we introduce the notion of uniform (trivial) fibration in a category with a functorial cylinder and use it to construct algebraic weak factorization systems on presheaf categories, obtaining generalizations of some important results of Cisinski on Quillen model structures on presheaf categories~\cite{cisinski-asterisque}.
As applications of our results, we solve an open problem in the univalent foundations programme, namely that of proving a constructive version of the fact that pushforward along Kan fibrations preserves Kan fibrations ~\cite{coquand-non-constructivity-kan,voevodsky-simplicial-model}.
We also obtain a new proof of the right properness of the Quillen model structure for Kan complexes~\cite{quillen-homotopical}, which avoids entirely the use of topological realization~\cite{hovey-model-categories} and the theory of minimal fibrations~\cite{joyal-tierney:simplicial-homotopy-theory}.

We are particularly interested in the property of weak factorization systems known as the Frobenius condition~\cite[Definition~3.2.1]{garner:types-omega-groupoids}.\footnote{See~\cite{clementino:frobenius} for an explanation of the connection with Lawvere's Frobenius reciprocity condition~\cite{lawvere-equality}.} One reason for the interest in this condition, which asserts that pullback along a right map preserves left maps, is that it is closely related to the right properness condition for a Quillen model structure, which asserts that pullback along a fibration preserves weak equivalences.
Indeed, for a Quillen model structure in which the cofibrations are the monomorphisms, such as the Cisinski model structures~\cite{cisinski-asterisque}, right properness is equivalent to the Frobenius condition for the weak factorization system of acyclic cofibrations and fibrations.
Furthermore, when pushforward along right maps exists, \ie pullback along right maps has a right adjoint, the Frobenius condition is equivalent to the preservation of right maps by pushforward along a right map.
In the category of simplicial sets, this amounts exactly to the preservation of Kan fibrations by pushforward along Kan fibrations mentioned above, a result that plays an important role in the definition of the simplicial model of univalent foundations~\cite[Lemma~2.3.1]{voevodsky-simplicial-model}.
Furthermore, the Frobenius condition is intimately related to the homotopy-theoretic aspects of Martin-L\"of's rules for identity types~\cite{gambino-garner:idtypewfs}.
It was also studied for (strict) factorization systems in~\cite{rosicky-tholem-factorization} (see Proposition~3.5 and Remark~3.6 therein).

When working with algebraic weak factorization systems, it is natural to consider the functorial Frobenius condition introduced by Garner and van den Berg in~\cite{garner:topological-simplicial}.\footnote{In~\cite{garner:topological-simplicial}, the functorial Frobenius condition was actually formulated for cloven weak factorization systems, which are slighly more general then algebraic weak factorization systems.} Since algebraically-free algebraic weak factorization systems, such as those produced by Garner's small object argument~\cite{garner:small-object-argument}, play an important role in our development, we isolate conditions on the generating category of an algebraically-free algebraic weak factorization system that are necessary and sufficient for the algebraic weak factorization system to satisfy the functorial Frobenius condition.
In order to do so, we introduce what we call the uniform Frobenius condition, which involves both a version of the usual Frobenius condition for maps, but also a Beck-Chevalley condition~\cite{benabou-descente,lawvere-equality} for morphisms of maps (\ie commutative squares), and provides a convenient notion to organize our analysis.

The development in this paper leads up to the proof of the existence of algebraic weak factorization systems with the functorial Frobenius condition on presheaf categories equipped with a functorial cylinder (\cref{frobenius-uniform-presheaf}).
The right maps of these algebraic weak factorization systems are uniform (trivial) fibrations, which we define in the general setting of a category equipped with a functorial cylinder, building on ideas of Cisinski~\cite{cisinski-asterisque}: uniform trivial fibrations are defined by algebraic orthogonality (\ie by requiring a natural choice of diagonal fillers) with respect to a category~$\mathcal{M}$ of monomorphisms and pullback squares, while uniform fibrations are defined by algebraic orthogonality with respect to a category obtained by applying a Leibniz construction (in the sense of~\cite{riehl-verity:reedy}) to the endpoint inclusions of the functorial cylinder and~$\cal{M}$.

Our first main result (\cref{thm:sset-cset-nwfs}) is that uniform trivial fibrations and uniform fibrations in presheaf categories equipped with a functorial cylinder are the right maps of two algebraic weak factorization systems.
This is proved using Garner's small object argument~\cite{garner:small-object-argument}, after having shown that uniform (trivial) fibrations can be be defined equivalently by algebraic orthogonality with respect to a small category of maps (\cref{small-gen-triv-kan}).
Working with algebraic notions of fibrations is essential to prove this fact, since it allows us to rephrase a general lifting problem as a colimit of a functorial family of lifting problems, providing a further example of the good interaction between colimits and lifting problems in algebraic weak factorization systems.

Our second main result (\cref{thm:ac-kan-is-uniform}) shows in what sense the notion of a uniform (trivial) fibration subsumes the standard notion of a (trivial) fibration, defined by a weak orthogonality property.
In particular, we show that, in a presheaf category over an elegant Reedy category~\cite{bergner-rezk-elegant}, a map can be equipped with the structure of a uniform (trivial) fibration if and only if it satisfies the right lifting property (without any uniformity condition) with respect to the maps involved in the definition of a uniform (trivial) fibration.
In order to obtain this result, we develop a careful decomposition of the lifting problems involved in the uniformity condition.

For our third main result, we return to consider the general setting of categories equipped with a functorial cylinder with connections and show that, under mild assumptions, uniform fibrations satisfy the uniform Frobenius condition (\cref{uniform-fibrations-uniform-frobenius}).
As a direct application, we obtain that the algebraic weak factorization systems on presheaf categories with uniform fibrations as right maps constructed earlier in the paper satisfy the uniform Frobenius condition (\cref{frobenius-uniform-presheaf}).

When instantiated to simplicial sets, this result implies that the algebraic weak factorization system with uniform Kan fibrations as right maps satisfies the Frobenius property, and therefore pushforward along a uniform Kan fibration preserves uniform Kan fibrations.
Our proof of this fact is constructive, \ie avoids the use of the law of excluded middle and the axiom of choice, and therefore solves the open problem of obtaining a constructive counterpart of the fact, mentioned above, that pushforward along a Kan fibration preserves Kan fibrations.
This latter fact was shown in~\cite{coquand-non-constructivity-kan} to be unprovable constructively without modifications.
Because of our results, it seems natural to regard that independence result simply as an indication that the standard notion of a Kan fibration is not suitable for developing simplicial homotopy theory constructively, rather than as evidence that the simplicial setting is inherently non-constructive. 

When instantiated in the category of cubical sets with connections, instead, \cref{frobenius-uniform-presheaf} gives a new proof of the fact that pushforward along a uniform Kan fibration preserves uniform Kan fibrations~\cite{cohen-et-al:cubicaltt}.
This proof avoids entirely complex calculations with cubical sets (\cf~\cite{huber-thesis}).
Indeed, one of the initial motivations for this work was to explore whether the theory of uniform fibrations in cubical sets could be developed at a greater level of generality, so as to make it applicable also to simplicial sets.

In the setting of simplicial sets, \cref{frobenius-uniform-presheaf} provides also a new proof of the right properness of the Quillen model structure for Kan complexes that avoids the use of geometric realization and minimal fibrations (see \cref{rem:rightpropernessnew}).

\subsection*{Remarks}

For brevity, we do not always discuss the special cases of our results on algebraic weak factorization systems for standard weak factorization systems.
Such results can be readily obtained by replacing the existence of structure in the algebraic setting with the satisfaction of properties, functors between categories with inclusions between classes, pullbacks with intersections, and so on.
This idea is illustrated in a few examples in the first sections of the paper and then highlighted only when it is of particular interest.

In the hope of making the paper more widely accessible, we also confine comments on constructivity issues to a series of remarks and footnotes.
However, let us point out here for the interested readers that our development does not rely on the law of the excluded middle or the axiom of choice, apart from~\cref{thm:sset-cset-nwfs} and the results in~\cref{sec:non-alg}.
For~\cref{thm:sset-cset-nwfs}, we argue that the result holds constructively for simplicial sets and cubical sets separately, in~\cref{rem:constructive-small-object}.%
\footnote{A constructive proof of~\cref{thm:sset-cset-nwfs} in full generality would require an analysis of aspects of the theory of locally presentable categories and of Garner's small object argument which we leave for future investigation.}
For the results in~\cref{sec:non-alg}, where we show how the classical notion of a fibration is equivalent to the uniform one, the use of the axiom of choice seems unavoidable.

\subsection*{Organization of the paper}

Section~\ref{sec:ortf} establishes basic facts about orthogonality functors.
In Section~\ref{sec:frobc} we introduce the Frobenius, Beck-Chevalley, and uniform Frobenius conditions and relate them to the functorial Frobenius condition.
Section~\ref{sec:unif} introduces uniform fibrations, giving examples of these notions in presheaf categories in general and in simplicial and cubical sets in particular, and establishing the existence of algebraic weak factorization systems with uniform (trivial) fibrations as right maps.
The relationship between uniform fibrations and their standard counterparts is studied in \cref{sec:non-alg}.
After establishing some auxiliary results in \cref{sec:unifshe} on strong homotopy equivalences, we prove the uniform Frobenius property for uniform fibrations in~\cref{sec:frocuf}.
Appendix~\ref{app:tecp} contains the proof of a technical lemma.

\subsection*{Acknowledgements}

We are grateful to Steve Awodey, Simon Huber, Andrew Pitts, Emily Riehl and Andrew Swan for helpful discussions and comments on earlier versions of the paper; and to Richard Garner and Fosco Loregian for pointing us to useful references.

This material is based on research sponsored by the Air Force Research Laboratory, under agreement number FA8655-13-1-3038, by a grant from the John Templeton Foundation, and by an EPSRC grant (EP/M01729X/1).

\newpage

\section{Fibrations}

Throughout the paper, we work with a fixed locally presentable category $\catE$. We will illustrate our definitions and
results in two main examples. The first the is the category $\SSet$ of simplicial sets, defined as the category of 
presheaves over the simplex category $\Delta$. The second is the category $\CSet$ of cubical sets considered 
in~\cite{cohen-et-al:cubicaltt}, which is defined as the category of presheaves over 
the cube category $\Box$ with objects of the form $\Box^A$ with $|A| \in \mathbb{N}$ and morphisms~$\Box^A \to \Box^B$ given by functions from $B$ to the free de Morgan algebra on $A$. Thus, $\CSet$ has symmetries, diagonals, connections, and involutions.\footnote{Note that the presence of symmetries precludes $\Box$ from being a Reedy category.} We stress that the only feature of the cube category $\Box$ relevant for the main results  are connections and symmetries.
Thus, our results apply equally to many other variations of cubical sets, excluding however those considered in~\cite{coquand-cubical-sets,huber-thesis}, which do not have connections.





Recall from~\cite{kamps-porter:homotopy} that a \emph{functorial cylinder} in $\calE$ is an endofunctor $\interval \otimes (-) \co \catE \to \catE$  equipped with natural transformations 
\[
\lcyl \otimes (-) \co   \Id_\catE \to \interval \otimes (-) \, , \quad \rcyl \otimes (-) \co \Id_\catE \to \interval \otimes (-) \, , 
\] 
called the left and right \emph{endpoint inclusions}, respectively. Such a functorial cylinder is said to have \emph{contractions} if $\lcyl \otimes (-)$ and $\rcyl \otimes (-)$ have a common retraction $\ccyl \otimes (-) \co \interval \otimes (-) \to \Id_\catE$ making the following diagrams commute:
\[
\xymatrix@C+2em{
  \Id_\catE
  \ar[r]^-{\lcyl \otimes (-)}
  \ar@{=}[dr]
&
  \interval \otimes (-)
  \ar[d]^(0.4){\ccyl \otimes (-)}
&
  \Id_\catE
  \ar[l]_-{\rcyl \otimes (-)}
  \ar@{=}[dl]
\\&
  \Id_\catE
\rlap{.}}
\]
Further, a functorial cylinder with contractions as above has \emph{connections} if, for $k \in \braces{0, 1}$, there is a natural transformations $c^k \otimes (-) \co \interval \otimes \interval \otimes (-) \to \interval \otimes (-)$ such that the diagrams
\begin{equation} \label{connections:0}
\begin{gathered}
\xymatrix@C+3em{
  \interval \otimes (-)
  \ar[r]^-{\kcyl \otimes \interval \otimes (-)}
  \ar[d]_{\ccyl \otimes (-)}
&
  \interval \otimes \interval \otimes (-)
  \ar[d]^{c^k \otimes (-)}
&
  \interval \otimes (-)
  \ar[l]_-{\interval \otimes \kcyl \otimes (-)}
  \ar[d]^{\ccyl \otimes (-)}
\\
  \Id_\catE
  \ar[r]_{\kcyl \otimes (-)}
&
  \interval \otimes (-)
&
  \Id_\catE
  \ar[l]^{\kcyl \otimes (-)}
}
\end{gathered}
\end{equation}
and
\begin{equation} \label{connections:1}
\begin{gathered}
\xymatrix@C+3em{
  \interval \otimes (-)
  \ar[r]^-{\kcylinv \otimes \interval \otimes (-)}
  \ar@{=}[dr]
&
  \interval \otimes \interval \otimes (-)
  \ar[d]^(0.4){c^k \otimes (-)}
&
  \interval \otimes (-)
  \ar[l]_-{\interval \otimes \kcylinv \otimes (-)}
  \ar@{=}[dl]
\\&
  \interval \otimes (-)
}
\end{gathered}
\end{equation}
commute. We adopt the convention of associating the tensor product notation to the right.

Our main examples of functorial cylinders with  contractions and connections, discussed below, arise from a monoidal
structure on $\catE$, written $(\catE, \otimes, \top)$ and the presence of an \emph{interval object}, \ie an object~$\interval \in \catE$ 
equipped with maps~$\lcyl, \rcyl \co \top \to \interval$, called the left 
and right \emph{endpoint inclusions}, respectively. In such a situation, a functorial cylinder is given by tensoring with $\interval$. 
It is then immediate to isolate sufficient structure on the interval object that guarantees the presence of contractions and connections on the associated functorial cylinder: 
contractions can be given by a map $\ccyl \co \interval \to \top$, connections by maps for $k \in \braces{0, 1}$, $c^k \co \interval \otimes \interval \to \interval$,
all satisfying suitable axioms. Note that if the unit $\top$ of the monoidal structure is a terminal object, then an interval object  has contractions in a canonical way.





\begin{example}[Simplicial sets] \label{exa:cyl-in-sset}
In $\SSet$, considered as a monoidal category with respect to its cartesian structure, 
an interval object is given by $\Delta^1$ with endpoint inclusions~$\kcyl  \co \braces{k} \to \Delta^1$ given 
by special cases of horn inclusions, $\kcyl = h^1_k$, for $k \in \braces{ 0, 1}$. We have contractions, since the monoidal structure is cartesian,
and uniquely determined connections $c^k \co \Delta^1 \times \Delta^1 \to \Delta^1$, with $k \in \braces{0, 1}$, given on points by 
$c^0(x, y) = \min(x, y)$ and $c^1(x, y) = \max(x, y)$.
For this, note that~$\Delta^1$ and~$\Delta^1 \times \Delta^1$ are nerves of posets and that $\min$ and $\max$ are monotone.
\end{example}

\begin{example}[Cubical sets] \label{exa:cyl-in-cuset}
The category $\Box$ has a symmetric monoidal structure, which makes cubical sets into a symmetric monoidal closed category.
In $\CSet$, an interval object with contractions is given by $\Box^1$ with endpoint inclusions $\kcyl \co \braces{k} \to \Box^1$  given by the maps from a singleton set to the free de Morgan algebra 
on an empty set that pick the bottom element for $k = 0$ and the top element for $k =1$.
We have contractions since the unit of the monoidal structure  is a terminal object. 
Connection operations $c^k \co \Box^1 \otimes \Box^1 \iso \Box^2 \to \Box^1$ for $k \in \braces{0, 1}$ are induced by the conjunction and disjunction operations of de Morgan algebras:
they are given by the maps from a singleton set to the free de Morgan algebra on a two-element set $\braces{x, y}$ that pick $x \wedge y$ and $x \vee y$, respectively).
\end{example}




Let us now assume that $\catE$ is equipped with a functorial cylinder $\interval\otimes (-) \co \catE \to \catE$ with contractions and connections, and that the functor $\interval\otimes (-) \co \catE \to \catE$ has a right adjoint, which we write~$\exp(I, -) \co \catE \to \catE$.  We then obtain a \emph{functorial cocylinder} 
\[
(\exp(\interval, -), \exp(\bar{\delta}^0, -), \exp(\bar{\delta}^1, -)) \, ,
\]
\ie a functorial cylinder in the opposite category $\catE^{\op}$~\cite{kamps-porter:homotopy}.
 Contractions and (effective) connection carry over as well. Also note that $\interval\otimes (-) \co \catE \to \catE$ preserves colimits. 
 

In order to define the last ingredient of the axiomatic setting in which we will work, namely the the notion of a suitable weak factorisation system, we need to introduce some notation.  For $k \in \{ 0, 1\}$ and a map $i \co A \to B$ in $\catE$, we define the \emph{Leibniz product} of~$\kcyl$ and~$i$ to be the map 
\[
\kcyl \hatotimes i \co (\interval \otimes A) +_A B \to \interval \otimes B
\] 
determined uniquely by the following pushout diagram:
\begin{gather*}
\xymatrix@C=1.2cm{
  A
  \ar[r]^{i}
  \ar[d]_{\kcyl \otimes A}
&
  B
  \ar@/^2pc/[ddr]^{\kcyl \otimes B}
  \ar[d]
&\\
  \interval \otimes A
  \ar@/_1pc/[drr]_{\interval \otimes i}
  \ar[r]
&
  (\interval \otimes A) +_A B
  \ar[dr]^-{\delta^k \hatotimes i}
&\\&&
  \interval \otimes B
\rlap{.}}
\end{gather*}
We shall use Leibniz products with endpoint inclusions throughout the paper. 


\begin{definition} \label{uniform-fib-presheaf-cat} We say that a weak factorisation system $(L, R)$ on $\catE$ is \emph{suitable} if the following conditions hold:
\begin{enumerate}[(i)]
\item $(L, R)$  is cofibrantly generated,
\item for every $X \in \cal{E}$, the unique map $\bot_X \co 0 \to X$ is in $L$,
\item $L$ is closed under pullbacks, \ie for every pullback square
\[
\xymatrix{
B \ar[d]_j \ar[r]^q & A \ar[d]^i \\
Y \ar[r]_p & X }
\]
if $i \in L$ then $j \in L$, 
\item $L$ is closed under Leibniz product with the endpoint inclusions, \ie for every $i \in L$ we 
have~$\kcyl \hatotimes i \in L$.
\end{enumerate}
\end{definition}


\begin{example} \label{thm:generation-presheaf-cisinski} By a result of Cisinski, every presheaf category admits a suitable weak factorisation
system whose the left class consists of all mononomorphisms. 
\end{example} 


Let us now fix a suitable weak factorisation system $(L,R)$ in $\catE$, which we think of as consisting of cofibrations and trivial fibrations. 
We wish to define a new weak factorisation system, to be thought of as consisting of trivial cofibrations and fibrations. For this, we begin by defining the class of maps, called \emph{cylinder inclusions}, that determines the notion of a fibration. This class is defined by letting
\begin{equation}
\label{equ:cylinc}
\mathsf{Cyl}  \defeq \{ \kcyl \hatotimes i \ | \ k \in \{ 0, 1 \} \, , \; i \in L \}
\end{equation}
With a slight abuse of terminology, we consider $\mathsf{Cyl}$ to be closed under isomorphism. For example, for $X \in \catE$, we consider
the endpoint inclusion $\kcyl \otimes X \co X \to \interval \otimes X$ to be a cylinder inclusion, since we have $\kcyl \otimes X \iso 
\kcyl \hatotimes \bot_X$, where $\bot_X \co 0 \to X$ is the unique map from the initial object of $\catE$ into $X$, which is in $L$
by the assumption that $(L, R)$ is suitable.

\begin{definition} \label{def:fibration}
A \emph{fibration} is a map with the right lifting property with respect to all cylinder inclusions. 
\end{definition}

The next proposition is straightforward, but we state it explicitly it for future reference. 

\begin{proposition} \label{thm:wfstimes} $({}^\pitchfork \mathsf{Fib}, \mathsf{Fib})$ is weak factorisation system in $\cal{E}$.
\end{proposition}

\begin{proof} Let $S \subseteq L$ be a generating set for the weak factorisation system $(L, R)$, which exists since we assumed it to be cofibranly generated.
We define a set  $T \subseteq \mathsf{Cyl}$ by letting $T \defeq \{ \delta^k \hatotimes i \ | \ i \in I \}$. By the small object argument, 
we have a weak factorisation system $(L_\otimes, R_\otimes)$ cofibrantly generated by $T$, where
$L_\otimes$ is the saturation of $T$ (\ie its closure under isomorphisms, composition, retracts, pushouts and transfinite composition) 
and $R_\otimes = T^\pitchfork$. 
We claim that $R_\otimes$ is precisely the class of
fibrations, \ie that $T^\pitchfork = \mathsf{Cyl}^\pitchfork$. For this, it suffices to observe that, since~$L$ is the saturation of~$S$, the class
$\mathsf{Cyl}$ and the set~$T$ have the same saturation (since the Leibniz product $\kcyl \hatotimes (-)$ preserves all the operations involved
in saturation), and therefore they have the same right orthogonal class.
\end{proof}

Note that, since $L$ is  closed under Leibniz products with the endpoint inclusions, we have that~$L_\otimes \subseteq L$, which 
could be understood as saying that every trivial cofibration is a cofibration. 
We  illustrate these notions in simplicial sets and cubical sets.

\begin{example}[Simplicial sets] \label{thm:fib-is-kan}
In $\SSet$, let~$(L, R)$  be the weak factorisation system of monomorphisms and trivial Kan fibrations, which is cofibrantly generated
by the boundary inclusions. Then, a fibration in the sense of~\cref{def:fibration} is the same thing as a Kan fibration in the usual sense. 
Indeed, a fibration in our sense is a map with the right lifting property with respect to all maps of the form
\[
h_k^1 \hatotimes i \co   (\Delta^1 \times A) \cup (\braces{k} \times B) \to  \Delta^1 \times B \, ,
\]
given by the Leibniz product of the endopoint inclusion $h_k^1 \co \braces{k} \to \Delta^1$ with a monomorphism $i \co A \to B$. The equivalence between this notion and the standard notion of a Kan fibration is well-known and follows from the fact that an higher dimensional horn $h_i^n$ is a retract of the Leibniz product $\kcyl \hatotimes h_i^n$~\cite[Chap.~IV, Sec.~2]{gabriel-zisman:calculus-of-fractions}.
\end{example}

\begin{example}[Cubical sets]
In $\CSet$, let $(L, R)$ be the weak factorisation system in which~$L$  consists of all monomorphisms.
A  fibration in $\CSet$ will be called a \emph{Kan fibration}.
To illustrate the relationship with the standard Kan filling condition for cubes, let $i^n \co \partial \Box^n \to \Box^n$ for $n \in \mathbb{N}$ denote the boundary inclusion for~$\Box^n$, which is given by the $n$-fold Leibniz tensor of~$[\lcyl, \rcyl] \co \braces{0, 1} \to \Box^1$.
%\footnote{Note that for our choice of cube category, which is not Reedy, this will not be a maximal non-trivial subobject.}
Then $\lcyl \hatotimes i^n$ and $\rcyl \hatotimes i^n$ are the inclusions $\sqcup_1^{1+n} \to \Box^{1+n}$ and $\sqcap_1^{1+n} \to \Box^{1+n}$, respectively.
Since the cube category has symmetries, a Kan fibration in $\CSet$  has the left lifting property also with respect to open box inclusions, which are counterparts in cubical sets of the horn inclusions in simplicial sets.
%\footnote{Without symmetries, one should consider two-sided Leibniz tensors such as $i^a \hatotimes \lcyl \hatotimes i^b \co \sqcup_a^{a+1+b} \to \Box^{a+1+b}$.}
The fibrant cubical types defined in~\cite{cohen-et-al:cubicaltt} arise by considering the  $L'$-fibrations where~$L'$ is the
subclass of $L$ spanned by monomorphisms\footnote{Or decidable monomorphisms, if working constructively} classified by their face lattice~$\Phi$, \ie those arising as a pullback of $\braces{\top} \to \Phi$, excluding for example diagonals in cubes.
%Since the presence of symmetries, diagonals, and connections precludes the cube category from being Reedy, this may turn out to be a %natural restriction. 
Note that  $L'$ is the left class of a suitable weak factorisation system and is thus covered by our development.
\end{example}

\begin{remark} \label{cisinski-remark}
We also relate the notion of a fibration introduced here with the notion of a naive fibration introduced by Cisinski~\cite{cisinski-asterisque}.
For this, let $m \otimes (-)  \co \Id_\catE + \Id_\catE \to \interval \otimes (-)$ be given by
\[
  m \otimes (-) \defeq [\lcyl \otimes (-), \rcyl \otimes (-)] \, .
\]
A \emph{naive Cisinski fibration} would be defined as a map with the right lifting property with respect to the class
\[
\mathsf{Cyl}' \defeq \{ (m \hatotimes (-))^n ( \kcyl \hatotimes i ) \ | \ n \in \mathbb{N} \, , \;  i \in L \} 
\]
Informally, one could think of this set as the closure of $J$ under Leibniz product with $m$. 

Our reasons for working with~$\mathsf{Cyl}$ instead of this class are twofold. First, if the functorial cylinder is induced by tensoring with an interval object in a symmetric monoidal category and the class $L$ is closed under Leibniz product with the boundary inclusion $[\lcyl, \rcyl] \co 1 + 1 \to \interval$, then by permuting the Leibniz product one sees that every fibration also has canonically the structure of a  naive Cisinski fibration.
This is the case in our main examples, where $L$ consists of all monomorphisms, the map $[\lcyl, \rcyl]$ is a monomorphism, and Leibniz product preserves monomorphisms. For our second point, we use some notions introduced in~\cref{sec:frobprop}.
If we assume generalized connections (in the sense of $(1+n+1)$-ary operations that behave as connections for fixed middle~$n$ arguments), and that $L$ is closed under Leibniz product with $[\lcyl, \rcyl]$ (for example, this is the case if $[\lcyl, \rcyl]$ is a monomorphism and the maps in~$L$ are the monomorphisms in a presheaf category), then the maps in $\mathsf{Cyl}$ can still be shown to be strong homotopy equivalences. This gives rise to an inclusion $\mathsf{Cyl}' \to \mathsf{Cyl} \cap S$  (where $S$ is the class of strong homotopy equivalences that we define in \cref{sec:frobprop}). By \cref{thm:main-sheretract}, it then follows that every naive Cisinski fibration is a fibration.
\end{remark}

\newpage

\section{The Frobenius property}
\label{sec:frobprop}

Let us begin by recalling the Frobenius property for a weak factorisation system.

\begin{definition} We say that a weak factorisation system $(L, R)$ has the \emph{Frobenius property} if the pullback of an $L$-map along 
an $R$-map is again an $L$-map.
\end{definition} 

As mentioned in the introduction, a model structure~$(W, F, C)$ in which the cofibrations are the monomorphisms,
is right proper, \ie the pullback of a weak equivalence along a fibration is again a weak equivalence, 
if and only if the weak factorisation system~$(W \cap C, F)$ has the Frobenius property, \ie that the pullback of a trivial cofibrations along a fibration is again a trivial cofibration. In particular, the right properness of the model structure on $\SSet$ for Kan complexes is equivalent to the Frobenius property
for the weak factorisation system of trivial cofibrations and Kan fibrations, which asserts 
that the pullback of a trivial cofibration along a Kan fibration
is again a trivial cofibration. The next proposition is a straightforward observation, which follows by standard
properties of the interaction between lifting properties and adjoint functors. We include it since it will be useful
in the proof of~\cref{thm:non-alg-frobenius}.



\begin{proposition} 
\label{thm:frobenius-equivalence}
Let $(L, R)$ be a weak factorisation system. Let $I \subseteq L$ be a class of maps such that~$I^\pitchfork = R$. Then the following are equivalent:
\begin{enumerate}[(i)] 
\item $(L,R)$ has the Frobenius property. 
\item For every $p \co Y \to X$, the pushforward $p^* \co \cal{E}_{/Y} \to \cal{E}_{/X}$ preserves $R$-maps.
\item The pullback of an $I$-map along 
an $R$-map is an $L$-map.
\end{enumerate}
\end{proposition} 


Our aim in this section is to show that the weak factorisation system $(L_\otimes, R_\otimes)$ of  \cref{thm:wfstimes} satisfies the Frobenius property. By the above and~\cref{thm:fib-is-kan}, the application of this result in $\SSet$ gives a new proof of the right properness of the model structure for Kan complexes. 
Our proof of the Frobenius property uses the notion of a \emph{strong homotopy equivalence}, which we introduce in~\cref{def:strhe}, and consists of three main steps. First, in~\cref{strong-h-equiv-as-section-non-alg}, we give a characterization of strong homotopy equivalences as cetain retracts. Secondly, in~\cref{thm:main-sheretract}, we show that the maps in $L$ which are strong homotopy
equivalences are retracts of maps in $L_\otimes$ and that every map in $L_\otimes$ is both in $L$ and a strong homotopy equivalence. This implies that a map is
a fibration if and only if it has the right lifting property with respect to the strong homotopy equivalences in $L$. The third and final step of the proof, in~\cref{thm:non-alg-frobenius-she},  consists in showing that the pullback
of a strong homotopy equivalence along a fibration is again an strong homotopy equivalence, which easily implies 
the Frobenius condition for $(L_\otimes, R_\otimes)$.


Let $f, g \co X \to Y$ be maps in $\catE$.
Recall that a \emph{homotopy from $f$ to $g$}, denoted $\phi \co f \sim g$, is a morphism $\phi \co \interval \otimes X \to Y$ such that the following diagram commutes:
\begin{equation} \label{equ:homotopy}
\begin{gathered}
\xymatrix@C=1.2cm{
  X
  \ar[r]^-{\lcyl \otimes X}
  \ar[dr]_{f}
&
  \interval \otimes X
  \ar[d]^(0.4){\phi}
&
  X
  \ar[dl]^{g}
  \ar[l]_-{\rcyl \otimes X}
\\&
  Y
\rlap{.}}
\end{gathered}
\end{equation}
We say that a map $f \co X \to Y$ is called a \emph{left} (or {\emph{$0$-oriented}) \emph{homotopy equivalence} if there exist $g \co Y \to X$ and homotopies $\phi \co g \cc f \sim \id_X $, $\psi \co f \cc g \sim \id_Y$.
Dually, we have a \emph{right} (or {\emph{ $1$-oriented}) \emph{homotopy equivalence} if there exist $g \co Y \to X$ and homotopies  $\phi \co \id_X \sim g \cc f$, $\psi \co \id_Y \sim f \cc g$.  The notion of a strong
homotopy equivalence, defined below, is obtained by requiring an additional condition on the homotopies $\phi$ and $\psi$. 



\begin{definition} \label{def:strhe}
A map $f \co X \to Y$ is called a \emph{strong $k$-oriented homotopy equivalence} if there is a map $g$ and homotopies $\phi$ and $\psi$ making $f$ into a
$k$-oriented homotopy equivalence such that the following diagram commutes:
\[
\xymatrix{
  \interval \otimes X
  \ar[r]^{\interval \otimes f}
  \ar[d]_{\phi}
&
  \interval \otimes Y
  \ar[d]^{\psi}
\\
  X
  \ar[r]_{f}
&
  Y \, . 
}
\]
\end{definition}

For $k \in \braces{0, 1}$, we write $S_k$ for the class of strong $k$-oriented homotopy equivalences and let $S \defeq S_0 \cup S_1$.
Elements of $S$ will be called \emph{strong homotopy equivalences}. 

\begin{remark}  The components of the endpoint 
inclusion $\kcyl \otimes (-) \co \Id_\catE \to \interval \otimes (-)$
are strong $k$-oriented homotopy equivalences. In fact, they are 
strong $k$-oriented deformation retracts, \ie strong $k$-oriented homotopy equivalences for which 
the homotopy~$\phi$ is trivial, \ie  $\phi = \varepsilon \otimes X$, where $\varepsilon$ is the contraction of the functorial cylinder. 
To show this, one exploits crucially the assumption that the functorial cylinder has
connections. For $k = 0$, the retraction is given by~$\varepsilon \otimes X \co \interval \otimes X \to X$ and the homotopy 
$\psi \co (\lcyl \otimes X) \circ (\varepsilon \otimes X)  \sim 
1_{\interval \otimes X}$ is given by the connection~$c^0 \otimes X$. 
The axioms for the left and right endpoint of $\psi$ follow from the left sides of~\eqref{connections:0} and~\eqref{connections:1}, respectively.
The axiom for strength follows from the right part of~\eqref{connections:0}. 
\end{remark}




Our first step is to give an alternative characterization of strong $k$-oriented homotopy equivalences.
For this, observe that we have a commutative diagram 
\[
\xymatrix@C+2em{
  X
  \ar[r]^-{\kcylinv \otimes X}
  \ar[d]_{f}
&
 \interval \otimes X 
 \ar[r]^-{\iota_1} 
 &
  (\interval \otimes X) +_X Y \ar[d]^{\kcyl \hatotimes f} 
  \\
  Y
  \ar[rr]_-{\kcylinv \otimes Y}
  & 
&
  \interval \otimes Y
}
\]
for $k \in \braces{0, 1}$. This diagram gives us an arrow~$\thetak \hatotimes f \co f \to \kcyl \hatotimes f$ in the category of maps 
in~$\catE$, which we use in the next lemma to provide the following characterization of strong homotopy equivalences as retractions. 

\begin{lemma} \label{strong-h-equiv-as-section-non-alg}
A map $f \co X \to Y$ is a strong $k$-oriented equivalence 
if and only if  the map $\thetak \hatotimes f  \co f \to \kcyl \hatotimes f$ has a retraction, \ie there are
dotted arrows as follows:
\[
\xymatrix@C+4em{
  X
  \ar[r]^-{\iota_1 \cc (\kcylinv \otimes X)}
  \ar[d]_f
&
  (\interval \otimes X) +_X Y
  \ar[d]^{\kcyl \hatotimes f}
  \ar@{.>}[r]
&
  X
  \ar[d]^f
\\
  Y
  \ar[r]_-{\kcylinv \otimes Y}
&
  \interval \otimes Y
  \ar@{.>}[r]
&
  Y
\rlap{,}}
\]
such that the two horizontal composites are identities.
\end{lemma}

\begin{proof}
First, by a standard diagram-chasing argument, giving the square on the right is equivalent to giving maps $\phi \co \interval \otimes X \to X$, $g \co Y \to X$, $\psi \co \interval \otimes Y \to Y$ such that the following diagrams commute:
\begin{align} \label{equ:first-three}
\begin{gathered}
\xymatrix{
  X
  \ar[r]^-{\kcyl \otimes X}
  \ar[d]_f
&
  \interval \otimes X
  \ar[d]^{\phi}
\\
  Y \ar[r]_-{g}
&
  X
\rlap{,}}
\end{gathered}
&&
\begin{gathered}
\xymatrix{
  Y
  \ar[r]^-g
  \ar[d]_{\kcyl \otimes Y}
&
  X
  \ar[d]^f
\\
  \interval \otimes Y
  \ar[r]_-{\psi}
&
  Y
\rlap{,}}
\end{gathered}
&&
\begin{gathered}
\xymatrix{
  \interval \otimes X
  \ar[r]^-\phi
  \ar[d]_{I \otimes f}
&
  X
  \ar[d]^{f}
\\
  \interval \otimes Y
  \ar[r]_-{\psi}
&
  Y
\rlap{.}}
\end{gathered}
\end{align}
Second, requiring that the two horizontal composites are identities means that the diagrams
\begin{align} \label{equ:second-two}
\begin{gathered}
\xymatrix@C+2em{
  X
  \ar[r]^-{\kcylinv \otimes X}
  \ar@{=}[dr]
&
  \interval \otimes X
  \ar[d]^\phi
\\&
  X
\rlap{,}}
\end{gathered}
&&
\begin{gathered}
\xymatrix@C+2em{
  Y
  \ar[r]^-{\kcylinv \otimes Y}
  \ar@{=}[dr]
&
  \interval \otimes Y
  \ar[d]^{\psi}
\\&
  Y
}
\end{gathered}
\end{align}
commute.
With reference to the diagram in~\eqref{equ:homotopy}, the equations in~\eqref{equ:first-three} provide endpoint~$k$ for~$\phi$ and~$\psi$, and strength, respectively; while the equations in~\eqref{equ:second-two} provide endpoints~$1-k$ for~$\phi$ and~$\psi$, respectively.
\end{proof}


Note that \cref{strong-h-equiv-as-section} implies that strong $k$-oriented homotopy equivalences are closed under retracts.
Indeed, let $f$ be a strong homotopy equivalence and $g$ be a retract of $f$. Then, $\thetak \hatotimes g$ is a retract of 
$\thetak \hatotimes f$, since $\thetak \hatotimes (-) \co \catE^\to \to \catE^\to$ is a functor and functors preserve retracts.
Since~$f$ is a strong homotopy equivalence, $\thetak \hatotimes f$ is a section. But then $\thetak \hatotimes g$ is a also
a section, since
sections are closed under retracts, and this shows that $g$ is a strong $k$-oriented homotopy equivalence. 


\begin{remark} \label{thm:kcylf-is-she}
For every $f$, we have that $\kcyl \hatotimes f$ is a strong $k$-oriented homotopy equivalence. GIVE PROOF.
\end{remark} 

For our second step, we focus on the class $L \cap S$, \ie the class of $L$-maps that are strong homotopy equivalences. We begin by relating them to the cylinder inclusions, as defined in~\eqref{equ:cylinc}.

\begin{lemma}  \label{thm:main-sheretract} \hfill 
\begin{enumerate}[(i)] 
\item $L \cap S \subseteq \overline{\mathsf{Cyl}}$,
\item $\mathsf{Cyl} \subseteq L \cap S$. 
\end{enumerate}
\end{lemma}

\begin{proof} For part (i), let $f \in  L \cap S$. Since $f \in S$, \cref{strong-h-equiv-as-section-non-alg} implies that $f$ is a retract of~$\kcyl \hatotimes f$, for some $k \in \braces{0 \, , 1 }$. But since $f \in L$, we have $\kcyl \hatotimes f \in \mathsf{Cyl}$. For part~(ii), observe that since $L$ is closed under Leibniz product with~$\kcyl$, we have $L_\otimes  \subseteq L$.
Then, observe that the assumption that the functorial cylinder has connections implies that, 
for every $f \co X \to Y$, the map $\kcyl \hatotimes f$ is a strong $k$-oriented homotopy equivalence, as observed 
in~\cref{thm:kcylf-is-she}.
\end{proof}


Note that, by \cref{thm:main-sheretract}, a map is a fibration if and only if it has the right lifting property with respect to the maps in $L \cap S$.
The next lemma is the third main step of the proof of the Frobenius property for $(L_\otimes, R_\otimes)$. 

\begin{lemma} 
\label{thm:non-alg-frobenius-she}
The pullback of a strong $k$-oriented homotopy equivalence along a fibration is again a strong $k$-oriented 
homotopy equivalence.
\end{lemma} 

\begin{proof} Consider a pullback diagram
\begin{equation}
\label{non-alg-strong-h-equiv-uniform-base-change:0}
\begin{gathered}
\xymatrix{
 B \ar[d]_j \ar[r]^q & A \ar[d]^i \\ 
Y \ar[r]_p & X }
\end{gathered}
\end{equation}
where $i  \in S_k$ and $p \in R_\otimes$. We wish to show that $j \in  S_k$. Since $i \in S_k$, $\thetak \hatotimes i \co i \to \kcyl \hatotimes i$ has a retraction $\rho \co \kcyl \hatotimes i \to i$.  We show that $\thetak \hatotimes j \co j \to \kcyl \hatotimes j$ has a retraction 
$\tau \co  \kcyl \hatotimes j \to j$. We define the retraction $\tau$ so that the diagram below, where $\sigma \co j \to i$ is 
the pullback in~\eqref{non-alg-strong-h-equiv-uniform-base-change:0}, commutes:
\[
\xymatrix@C+2em{
j 
  \ar[r]^-{\thetak \hatotimes j}
  \ar[d]_{\sigma}
&
  \kcyl \hatotimes j 
  \ar@{.>}[r]^-{\tau}
  \ar[d]_{\kcyl \hatotimes \sigma}
&
 j 
  \ar[d]^{\sigma}
\\
  i
  \ar[r]_-{\thetak \hatotimes i}
&
  \kcyl \hatotimes i
  \ar[r]_-{\rho}
&
  i
\rlap{.}}
\]
Since the pullback square $\sigma$ is a Cartesian arrow with respect to the codomain fibration, it suffices to solve this problem on codomains, again omitting horizontal composite identities:
\[
\xymatrix@C+2em{
  Y
  \ar[r]^-{\kcylinv \otimes Y}
  \ar[d]_{p}
&
  \interval \otimes Y
  \ar@{.>}[r]^-{\cod(\tau)}
  \ar[d]^{\interval \otimes p}
&
  Y
  \ar[d]^{p}
\\
  X
  \ar[r]_-{\kcylinv \otimes X}
&
  \interval \otimes X
  \ar[r]_-{\cod(\rho)}
&
  X
\rlap{.}}
\]
To find the dotted arrow is to construct a diagonal filler in the following square:
\[
\xymatrix@C+2em{
  Y
  \ar@{=}[rr]
  \ar[d]_{\kcylinv \otimes Y}
&&
  Y
  \ar[d]^{p}
\\
  \interval \otimes Y
  \ar[r]_-{I \otimes p}
  \ar@{.>}[urr]^(0.4){\cod(\tau)}
&
  \interval \otimes X
  \ar[r]_-{\cod(\rho)}
&
  X
\rlap{.}}
\]
But we have such a filler since $\kcylinv \otimes Y \in \mathsf{Cyl}$ and $p \in R_\otimes$. 
\end{proof} 


\begin{theorem} \label{thm:non-alg-frobenius}
The weak factorisation system $(L_\otimes, R_\otimes)$ has the Frobenius property. 
\end{theorem}

\begin{proof} By~\cref{thm:frobenius-equivalence}, it suffices to show that, for a pullback of the form
\begin{equation*}
\begin{gathered}
\xymatrix{
 B \ar[d]_j \ar[r]^q & A \ar[d]^i \\ 
Y \ar[r]_p & X }
\end{gathered}
\end{equation*}
where $i  \in \mathsf{Cyl}$ and  $p \in R_\otimes$, we have $j \in L_\otimes$. 
By part (ii) of~\cref{thm:main-sheretract}, $i \in L \cap S$. By the closure of $L$ under pullbacks and~\cref{thm:non-alg-frobenius-she},
it follows that~$j \in L \cap S$. But $L \cap S \subseteq L_\otimes$ by part~(i) of~\cref{thm:main-sheretract} and 
the closure of $L_\otimes$ under retracts.
\end{proof}



When applied to the category of simplicial sets, \cref{thm:non-alg-frobenius} gives a new proof of the right properness of the Quillen model structure for Kan complexes. This proof avoids both the use of topological realization, which is used in~\cite[Theorem~13.1.13]{hirschhorn-model-localizations} to deduce the desired result from the right properness of the model structure on topological spaces in which the fibrations are the Serre fibrations. It also avoids the use of the theory of minimal fibrations, which is used in~\cite[Theorem~1.7.1]{joyal-tierney-notes} to establish the result working purely combinatorially.




\newpage

\section{Categories of uniformly orthogonal maps}
\label{sec:ortf}

% \subsection*{Orthogonal maps}
We are interested in algebraic generalizations of the weak orthogonality properties that are used in the definition of a weak factorization system.
For this, we do not consider a mere class of arrows in a category $\catE$ and define its left or right orthogonal class, but rather a category~$\cal{I}$, to be thought of as an indexing category, and a functor~$u \co \cal{I} \to \catE^\to$.
Such a functor assigns a morphism $u_i \co A_i \to B_i$ of $\catE$ to each object~$i \in \cal{I}$ (we use this notation systematically below).
Let us begin by recalling the following definition from~\cite{garner:small-object-argument}.

\begin{definition} \label{def:right-map}
Let $u \co \cal{I} \to \catE^\to$ be a functor.
\begin{enumerate}[(i)]
\item A \emph{right $\cal{I}$-map} $(f, \phi) \co X \to Y$ consists of a map $f \co X \to Y$ in $\catE$ and a function~$\phi$ that assigns to each $i \in \cal{I}$ and commuting square
\[
\xymatrix@C=2cm{
  A_i
  \ar[r]^{s}
  \ar[d]_{u_i}
&
  X
  \ar[d]^f
\\
  B_i
  \ar[r]_{t}
&
  Y
}
\]
a diagonal filler $\phi(i,s, t) \co B_i \to X$, satisfying the following naturality condition: for every diagram of the form
\[
\xymatrix{
  A_i
  \ar[r]^{a}
  \ar[d]_{u_i}
&
  A_j
  \ar[r]^{s}
  \ar[d]_{u_j}
&
  X
  \ar[d]^f
\\
  B_i
  \ar[r]_{b}
&
  B_j
  \ar[r]_{t}
&
  Y
\rlap{,}}
\]
where the left square is the image of $\sigma \co i \to j$ in $\cal{I}$ under $u$, we have that
\[
  \phi(j, s, t) \cc b = \phi(i, s \cc a, t \cc b) \, .
\]
\item A \emph{right $\cal{I}$-map morphism} $\alpha \co (f, \phi) \to (f', \phi')$ is a square $\alpha \co f \to f'$ in~$\catE$ satisfying an evident compatibility condition with respect to the choices of diagonal fillers, which we omit.
\end{enumerate}
\end{definition}

For a functor $u \co \cal{I} \to \catE^\to$, we write $\liftr{\cal{I}}$ for the category of right $\cal{I}$-maps and their morphisms.
There is a forgetful functor~$\liftr{u} \co \liftr{\cal{I}} \to \catE^\to$ mapping $(f, \phi)$ to $f$, which we call the \emph{right orthogonal} of $u \co \cal{I} \to \catE^\to$. Recall from~\cite{garner:small-object-argument} that the function mapping a functor $u \co \cal{I} \to \catE^\to$ to its right orthogonal $\liftr{u} \co \liftr{\cal{I}} \to \catE^\to$ defines the action on objects of a functor of categories over $\catE^\to$,
\[
  \liftr{\brarghole} \co \CAT_{/\catE^\to}^{\op} \to \CAT_{/\catE^\to} \rlap{.}
\]
See~\cite{garner:small-object-argument} for the action of this functor on arrows. 
As shown in~\cite[Proposition~3.8]{garner:small-object-argument}, analogously to the way in which standard orthogonality operations form a Galois connection, the orthogonality functors form an adjunction
\begin{equation} \label{garner-adjunction}
\begin{gathered}
\xymatrix@C+2em{
  \CAT_{/\catE^\to}
  \ar@<5pt>[r]^-{\liftl{\brarghole}}
  \ar@{}[r]|-{\bot}
&
  \CAT_{/\catE^\to}^{\op} \rlap{.}
  \ar@<5pt>[l]^-{\liftr{\brarghole}}
}
\end{gathered}
\end{equation}


The rest of this section is devoted to establishing some general facts regarding categories of right maps that will be useful in the remainder of the paper.
Most of these facts are expected generalizations of well-known statements for classes of weakly orthogonal classes in the standard setting.
They are probably known to experts, but we could not find them in the literature and hence we include them for completeness, omitting the most straightforward proofs. We begin with a simple observation.

\begin{proposition} \label{thm:orth-nat}
Consider a natural transformation between categories over $\catE^\to$ as below,
\[
\xymatrix{
  \cal{I}
  \rrtwocell_G^F{\sigma}
 \ar[dr]_{u}
&&
  \cal{J}
  \ar[dl]^{v}
\\&
  \catE^\to
\rlap{,}}
\]
satisfying in particular the condition that $v \sigma = \id_u$.
Then $\liftr{F} = \liftr{G}$ and $\liftl{F} = \liftl{G}$.
\end{proposition}



\subsection*{Retract closure} 
Given a functor $u \co \cal{I} \to \calE^\to$, we define its~\emph{retract closure} $\overline{u} \co \overline{\cal{I}} \to \catE^\to$ as follows.
An object of $\overline{\cal{I}}$ is a tuple~$(i, e, \sigma, \tau)$ consisting of an object $i \in \cal{I}$, an object $e \in \catE^\to$, and maps $\sigma \co e \rightarrow u_i$ $\rho \co u_i \rightarrow e$ in $\catE^\to$ which exhibit $e$ as a retract of $u_i$ in $\catE^\to$, \ie such that
\[
\xymatrix{
  e
  \ar[r]^{\sigma}
  \ar@{=}[dr]
&
  u_i
  \ar[d]^{\rho}
\\&
  e
\rlap{.}}
\]
A map $(f, \kappa) \co (i, e, \sigma, \tau) \to (i', e', \sigma', \tau')$ in $\overline{\cal{I}}$ consists of a map $f \co i \to i'$ in $\cal{I}$ and a map $\kappa \co e \rightarrow e'$ in $\catE^\to$ such that the following diagram in $\catE^\to$ commutes:
\[
\xymatrix{
  e
  \ar[r]^{\sigma}
  \ar[d]_{\kappa}
&
  u_i
  \ar[r]^{\rho}
  \ar[d]^{u_f}
&
  e
  \ar[d]^{\kappa}
\\
  e'
  \ar[r]_{\sigma'}
&
  u_{i'}
  \ar[r]_{\rho'}
&
  e'
\rlap{.}}
\]
The functor $\overline{u} \co \overline{\cal{I}} \to \catE^\to$ is then defined on objects by letting $\overline{u}(i, e, \sigma, \tau) \defeq e$, and on maps by letting $\overline{u}(f, \kappa) \defeq \kappa$.
The operation of retract closure gives a monad in an evident way. 

\begin{proposition} \label{retract-closure}
The orthogonality functors send the components of the unit and multiplication of the retract closure monad to natural isomorphisms, and so for every $u \co \cal{I} \to \catE^\to$, we have canonical isomorphisms of categories
\[
\begin{aligned}
  \liftr{(\overline{\cal{I}})} &\iso \liftr{\cal{I}}
\, ,&
  \liftr{(\overline{\overline{\cal{I}}})} &\iso \liftr{\overline{\cal{I}}}
\, ,&
  \liftl{(\overline{\cal{I}})} &\iso \liftl{\cal{I}}
\, ,&
 \liftl{(\overline{\overline{\cal{I}}})} &\iso \liftl{\overline{\cal{I}}}
\end{aligned}
\]
over $\catE^\to$.
\qed
\end{proposition}



\subsection*{Slicing and coslicing} 
Given a functor $u \co \cal{I} \to \catE^\to$ and $X \in \catE$, we define a slice category $\cal{I}_{/X}$ and functor $u_{/X} \co \cal{I}_{/X} \to \catE_{/X}^\to$ as follows.
The category $\cal{I}_{/X}$ has as objects pairs consisting of an object $i \in \cal{I}$ and a commutative triangle of the form
\[
\xymatrix@C-1em{
  A_i
  \ar[dr]
  \ar[rr]^{u_i}
&&
  B_i
  \ar[dl]
\\&
  X
\rlap{.}}
\]
The functor $u_{/X} \co \cal{I}_{/X} \to \catE_{/X}^\to$ sends such a pair to $u_i \co A_i \to B_i$, viewed as a morphism in~$\catE_{/X}$.
There is a also a \emph{coslice} category over $X$, described dually,  which we denote $u_{\backslash X} \co  \cal{I}_{\backslash X} 
\to \catE^\to$. With these definitions in place, the commutation between slicing and weak orthogonality functors in the setting of algebraic weak factorization systems can be stated as follows.

\begin{proposition} \label{pitchfork-slicing}
Let $u \co \cal{I} \to \catE^\to$ and $X \in \cal{E}$.
\begin{enumerate}[(i)]
\item The right orthogonality functor commutes with slicing, \ie we have $\liftr{(\cal{I}_{/X})} = (\liftr{\cal{I}})_{/X}$ 
as categories over $\catE^\to$.
\item The left orthogonality functor commutes with coslicing, \ie we have $\liftl{(\cal{I}_{\backslash X})} = (\liftl{\cal{I}})_{\backslash X}$
as categories over $\catE^\to$.
\qed
\end{enumerate}
\end{proposition}

In contrast to the right orthogonality functor, the left orthogonality functor does not commute with slicing in general.
However, it does under certain assumptions, as described in \cref{pitchfork-slicing-grothendieck} below.

\begin{proposition} \label{pitchfork-slicing-grothendieck}
Let $u \co \cal{I} \to \cal{E}^\to$ and assume that
\[
\xymatrix@C-1em{
  \cal{I}
  \ar[rr]^{u}
  \ar[dr]_{\cod_{\cal{E}} \cc u}
&&
  \cal{E}^\to
  \ar[dl]^{\cod_{\cal{E}}}
\\&
  \cal{E}
}
\]
is a morphism of Grothendieck fibrations.
Then the left orthogonality functor commutes with slicing on $u$, \ie for $X \in \cal{E}$ we have
$\liftl{(\cal{I}_{/X})} = (\liftl{\cal{I}})_{/X}$.
\end{proposition}

\begin{proof}
First note that the composite $\cod_{\cal{E}_{/X}} \cc u_{/X}$ is also a Grothendieck fibration.
When constructing the category of left maps for $\cal{I}$ or $\cal{I}_{/X}$, an application of base change and naturality of diagonal fillers shows that it is sufficient to consider lifting problems with the bottom arrow an identity.
But for such lifting problems the order of slicing makes no difference.
\end{proof}

There is an evident dual statement to \cref{pitchfork-slicing-grothendieck}, which we do not state explicitly.

\begin{corollary} \label{pitchfork-slicing-monad}
\leavevmode
\begin{enumerate}[(i)]
\item The monad $\liftl{(\liftr{(-)})}$ commutes with slicing.
\item The monad $\liftr{(\liftl{(-)})}$ commutes with coslicing.
\end{enumerate}
\end{corollary}

\begin{proof}
Use \cref{pitchfork-slicing} and note, for the first statement, that categories of right maps satisfy the assumptions of \cref{pitchfork-slicing-grothendieck}.
The second statement follows dually.
\end{proof}

\begin{proposition}
The retract closure commutes with slicing and coslicing, in the sense that for every $u \co \cal{I} \to \catE^\to$ we have
$\overline{\cal{I}_{/X}} = \overline{\cal{I}}_{/X}$ as categories over $\catE^\to$.
\qed
\end{proposition}

\subsection*{Adjunctions} 
Let us fix functors $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \cal{F}^\to$ for this and the next subsection.

\begin{proposition} \label{lift-of-adjunction}
For an adjunction $F \dashv G$ between $\cal{E}$ and $\cal{F}$, the following are equivalent:
\begin{enumerate}[(i)]
\item the functor $F \co \catE^\to \to \cal{F}^\to$ lifts to a functor $F \co \cal{I} \to \liftl{\cal{J}}$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \ar[r]^{F}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \catE^\to
  \ar[r]_-{F}
&
  \cal{F}^\to
\rlap{,}}
\]
\item the functor $G \co \cal{F}^\to \to \catE^\to$ lifts to a functor $G \co \cal{J} \to \liftr{\cal{I}}$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{J}
    \ar[d]_{v}
\ar[r]^{G}
&
  \liftr{\cal{I}}
  \ar[d]^{\liftr{u}}
\\
  \cal{F}^\to
   \ar[r]_{G}
&
  \catE^\to
\rlap{.}  }
\]
\end{enumerate}
\qed
\end{proposition}

The next proposition involves the notion of a mate~\cite{kelly-street}.

\begin{proposition} \label{lift-of-mates}
Let $F_1 \dashv G_1$ and $F_2 \dashv G_2$ be adjunctions between $\cal{E}$ and $\cal{F}$ satisfying the equivalent conditions of \cref{lift-of-adjunction}.
Let $m \co F_1 \to F_2$ and $n \co G_2 \to G_1$ be natural transformations forming mates.
Then the following are equivalent:
\begin{enumerate}[(i)]
\item
The natural transformation $m$ lifts as follows:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \rtwocell_{F_2}^{F_1}{m}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \catE^\to
  \rtwocell_{F_2}^{F_1}{m}
&
  \cal{F}^\to
\rlap{,}}
\]
\item
The natural transformation $n$ lifts as follows:
\[
\xymatrix@C=1.2cm{
  \cal{J}
  \rtwocell_{G_1}^{G_2}{n}
  \ar[d]_{u}
&
  \liftr{\cal{I}}
  \ar[d]^{\liftl{v}}
\\
  \cal{F}^\to
  \rtwocell_{G_1}^{G_2}{n}
&
  \cal{E}^\to
\rlap{.}}
\]
\end{enumerate}
\qed
\end{proposition}



\subsection*{Leibniz adjunctions}
We generalize \cref{lift-of-adjunction} to Leibniz adjunctions~\cite{riehl-verity:reedy}.
Let us fix bifunctors $F \co \cal{K} \times \catE \to \cal{F}$ and $G \co \cal{K}^{\op} \times \cal{F} \to \catE$ related pointwise, for $k \in \cal{K}$, by an adjunction:
\[
\xymatrix@C+1em{
  \catE
  \ar@<5pt>[r]^{F(k, \arghole)}
  \ar@{}[r]|{\bot}
&
  \cal{F}
  \ar@<5pt>[l]^{G(k, \arghole)}
\rlap{.}}
\]
Assume that $\catE$ has pushouts and $\cal{F}$ has pullbacks and
let $ \widehat{F} \co \cal{K}^\to \times \catE^\to \to \cal{F}^\to$, 
$ \widehat{G} \co (\cal{K}^{\op})^\to \times \cal{F}^\to \to \catE^\to$
denote the Leibniz constructions for $F$ and $G^{\op}$, using pullback instead of pushout for~$\widehat{G}$.

\begin{proposition} \label{lift-of-leibniz-adjunction}
Let $u \co \cal{I} \to \catE^\to$, $v \co \cal{J} \to \cal{F}^\to$ be functors.
Then the following are equivalent for $h \co X \to Y$ in $\cal{K}$:
\begin{enumerate}[(i)]
\item liftings $F' \co \cal{I} \to \liftl{\cal{J}}$ of $\widehat{F}(h, \arghole) \co \catE^\to \to \cal{F}^\to$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \ar[r]^{F'}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \catE^\to
  \ar[r]_-{\widehat{F}(h, \arghole)}
&
  \cal{F}^\to
\rlap{,}}
\]
\item liftings $G' \co \cal{J} \to \liftr{\cal{I}}$ of $\widehat{G}(h, \arghole) \co \cal{F}^\to \to \catE^\to$ making the following diagram commute:
\[
\xymatrix@C+2em{
  \cal{J}
  \ar[d]_{v}
  \ar[r]^{G'}
&
  \liftr{\cal{I}}
  \ar[d]^{\liftr{u}}
\\
  \cal{F}^\to
  \ar[r]_-{\widehat{G}(h, \arghole)}
&
  \catE^\to
\rlap{.}}
\]
\end{enumerate}
\end{proposition}



\cref{lift-of-adjunction} is the special case of \cref{lift-of-leibniz-adjunction} where $\cal{K}$ is the terminal category.

\begin{remark} \label{pitchfork-leibniz-most-general-example}
In \cref{lift-of-leibniz-adjunction}, let $\cal{K}$ be the category of adjunctions $U \dashv V$ with $U \co \catE \to \cal{F}$ and $V \co \cal{F} \to \catE$.
A morphism from $U_1 \dashv V_1$ to $U_2 \dashv V_2$ consists of natural transformations $u \co U_1 \to U_2$ and $v \co V_2 \to V_1$ forming mates.
Note that we have fully faithful forgetful functors $\cal{K} \to [\catE, \cal{F}]$ and $\cal{K} \to [\cal{F}, \catE]^{\op}$.
We also have functors $F \co \cal{K} \times \catE \to \cal{F}$ and~$G \co \cal{K}^{\op} \times \cal{F} \to \catE$ given by left and right adjoint application, respectively.
\end{remark}


\subsection*{Kan extensions}

We now establish some general facts about the interaction between orthogonality functors and Kan extensions along fully faithful functors. 

\begin{proposition} \label{kan-extension-closure}
Let $F \co \cal{I} \to \cal{J}$ be a fully faithful functor.
\begin{enumerate}[(i)]
\item Assume that the pointwise left Kan extension of $u \co \cal{I} \to \catE^\to$ along $F$ exists:
\[
\xymatrix@!C@C-1em{
  \cal{I}
  \ar[dr]_{u}
  \ar[rr]^{F}
&&
  \cal{J}
  \ar[dl]^{\Lan_F u}
\\&
  \catE^\to
\rlap{.}}
\]
Then the functor $\liftr{F} \co \liftr{\cal{J}} \to \liftr{\cal{I}}$, fitting in the diagram
\[
\xymatrix@!C@C-1em{
  \liftr{\cal{I}}
  \ar[dr]_{\liftr{u}}
&&
  \liftr{\cal{J}}
  \ar[ll]_{\liftr{F}}
  \ar[dl]^{\liftr{(\Lan_F u)}}
\\&
  \catE^\to
\rlap{,}}
\]
is an isomorphism.
\item Assume that the pointwise right Kan extension of $u \co \cal{I} \to \catE^\to$ along $F$ exists:
\[
\xymatrix@!C@C-1em{
  \cal{I}
  \ar[dr]_{u}
  \ar[rr]^{F}
&&
  \cal{J}
  \ar[dl]^{\Ran_F u}
\\&
  \catE^\to
\rlap{.}}
\]
Then the functor $\liftl{F} \co \liftl{\cal{J}} \to \liftl{\cal{I}}$, fitting in the diagram
\[
\xymatrix@!C@C-1em{
  \liftl{\cal{I}}
  \ar[dr]_{\liftl{u}}
&&
  \liftl{\cal{J}}
  \ar[ll]_{\liftl{F}}
  \ar[dl]^{\liftl{(\Ran_F u)}}
\\&
  \catE^\to
\rlap{,}}
\]
is an isomorphism.
\qed
\end{enumerate}
\end{proposition}


\subsection*{Restriction and extensions} 

We now consider some results in the case $\catE$ is a presheaf category. 

\begin{lemma} \label{left-kan-extension-of-representables}
Let $\cal{J}$ be a full subcategory of $\catE_{\cart}^\to$ closed under base change to representables, \ie closed under pullbacks along morphisms with domain a representable presheaf.
Let $\cal{I}$ denote its restriction to arrows into representables.
\[
\xymatrix@C-1em{
  \cal{I}
  \ar[rr]
  \ar[dr]
&&
  \cal{J}
  \ar[dl]
\\&
  \catE^\to
}
\]
Then the inclusion $\cal{J} \to \catE^\to$ is the left Kan extension of $\cal{I} \to \catE^\to$ along $\cal{I} \to \cal{J}$.
\end{lemma}

\begin{proof}
Since $\catE^\to$ is cocomplete, we can verify the claim using the colimit formula for left Kan extensions.
All of the following will be functorial in an object $j \co A \to B$ of $\cal{J}$.
We consider the diagram in $\catE^\to$ indexed by pullback squares of the form
\[
\xymatrix@C=1.2cm{
  A'
  \ar[r]
  \ar[d]_{i}
  \pullback{dr}
&
  A
  \ar[d]^{j}
\\
  \yon(x)
  \ar[r]_-{b}
&
  B
}
\]
with $i \co A' \to \yon(x)$ in $\cal{I}$ and valued $i$.
Our goal is to show that its colimit is $j$.
Using the assumption that $\cal{J}$ is closed under base change to representables, the given diagram can be described equivalently as the the diagram indexed by maps $b \co \yon(x) \to B$ and valued $b^*(j)$.
The claim can then be restated as $\colim_{b \co \yon(x) \to B} b^*(j) \iso j$, which holds since pullback commutes with colimits in presheaf categories, and $\colim_{b \co \yon(x) \to B} \yon(x) \iso B$.
\end{proof}

\begin{proposition} \label{awfs-on-arrows-into-representables}
Let~$\cal{J}$ be a full subcategory of $\catE_{\cart}^\to$ closed under base change to representables.
Let $\cal{I}$ denote its restriction to arrows into representables,
\[
\xymatrix@C-1em{
  \cal{I}
  \ar[rr]
  \ar[dr]
&&
  \cal{J}
  \ar[dl]
\\&
  \catE^\to
\rlap{.}}
\]
Then $\liftr{\cal{I}} = \liftr{\cal{J}}$.
\end{proposition}

\begin{proof}
The result follows by combining part~(i) of \cref{kan-extension-closure} and \cref{left-kan-extension-of-representables}.
\end{proof}

\newpage

\section{Uniform fibrations}
\label{sec:unif}

Recall from~\cite{bourke-garner-I} that an algebraic weak factorization system~$(\LL, \RR)$ on a category $\cal{E}$ consist of a pair of functors $\LL, \RR \co \cal{E}^\to \to \cal{E}^\to$ providing factorizations~$f = \RR f \cc \LL f$ functorially in~$f \in \cal{E}^\to$ and an extension of the evidently (co)pointed endofunctors $\LL, \RR$ to (co)monads such that the canonical natural transformation $\LL \RR \to \RR \LL$ is a distributive law.


We write $\pCoalg{\LL}$ and $\pAlg{\RR}$ for the categories of (co)monad algebras and $\pcoalg{\LL}$ and $\palg{\RR}$ for the categories of (co)pointed endofunctor (co)algebras over $\LL$ and $\RR$, respectively.
These come equipped with forgetful functors into $\cal{E}^\to$ and fulfill $\pcoalg{\LL} = \liftl{\pAlg{\RR}}$ and $\palg{\RR} = \liftr{\pCoalg{\LL}}$.
The underlying weak factorization system of $(\LL, \RR)$ has as left and right classes the maps that admit a lift to $\pcoalg{\LL}$ and $\palg{\RR}$, respectively.
Recall also that $(\LL, \RR)$ is said to be \emph{algebraically-free} on a category $\cal{I}$ of arrows if $\pAlg{\RR} = \liftr{\cal{I}}$.



\begin{definition} \label{uniform-fib-presheaf-cat}
An algebraic weak factorisation system $(\LL, \RR)$ is said to be \emph{suitable} if the following conditions hold.
\begin{enumerate}[(i)]
\item $(\LL, \RR)$ is algebraically-free on a small category.
\item The functor $\bot \co \cal{E} \to \cal{E}^\to$ mapping $X \in \cal{E}$ to $\bot_X \co 0_{\cal{E}} \to X$ factors through
$\pcoalg{\LL}$, as in the diagram
\[
\xymatrix@C+3em{
\catE \ar[r] \ar@/_1pc/[dr]_{\bot} & \pcoalg{\LL} \ar[d] \\
  & \catE^\to}
\]
\item For every $f \co Y \to X$, pullback lifts to $\pCoalg{\LL}$, 
\[
\xymatrix@C+3em{
  \pcoalg{\LL}
  \ar@{.>}[r]^{f^*}
  \ar[d]_{u}
&
  \pcoalg{\LL}
  \ar[d]^{u}
\\
  \catE^\to_{/Y}
  \ar[r]_{f^*}
&
  \catE^\to_{/X}
\rlap{.}}
\]
\item $\LL$-maps are closed under Leibniz product with endpoint inclusions, in the sense that the Leibniz product functor
lifts as follows:
\[
\xymatrix@C+3em{
  \pcoalg{\LL}
  \ar@{.>}[r]^{\kcyl \hatotimes (-)}
  \ar[d]_{u}
&
  \pcoalg{\LL}
  \ar[d]^{u}
\\
  \catE^\to
  \ar[r]_{\kcyl \hatotimes (-)}
&
  \catE^\to
\rlap{.}}
\]
\end{enumerate}
\end{definition}



\begin{example}[Presheaf case] In analogy with \cref{thm:generation-presheaf-cisinski}, we now fix a suitable category of monomorphisms $\cal{M}$ and write~$u \co \cal{M} \hookrightarrow \catE^\to$ to denote the inclusion. Let $\cal{N}$ be the full subcategory of $\cal{M}$ spanned by the mononorphisms with a representable presheaf as codomain. Then, there is an isomorphism 
$\TrivFib{\cal{M}} = \TrivFib{\cal{N}}$. This follows from \cref{awfs-on-arrows-into-representables} using condition~(i) of \cref{uniform-fib-presheaf-cat}. For a map $f \co X \to Y$ in $\catE$, to give a natural choice of fillers for all diagrams with an arbitrary element of $\cal{M}$ on the left is the same as to give a natural choice of fillers for only those diagrams which are the form
\[
\xymatrix{
  A
  \ar[r]
  \ar[d]
&
  X
  \ar[d]^f
\\
  \yon(x)
  \ar[r]
&
  Y
\rlap{,}}
\]
where $\yon(x)$ the Yoneda embedding of some $x \in \catC$.
The reduction to this type of diagrams relies essentially on the good behaviour of the right orthogonality functor with respect to colimits as described in~\cref{awfs-on-arrows-into-representables}, which is not available in the setting of standard weak factorisation systems. Let us point out that by \cref{small-gen-triv-kan} we have that $\TrivFib{\cal{M}} = \liftr{\cal{S}}$ for every full subcategory~$\cal{S} \subseteq \cal{M}$ containing~$\cal{N}$, since~$\cal{N}$ is then also the restriction to maps into representables of $\cal{S}$.
For example, one could consider for $\cal{S}$ the full subcategory of $\cal{M}$ spanned by maps with codomain a finite product of representables or, in the case of simplicial sets, a finite and finite-dimensional simplicial set.
These subcategories enjoy different closure properties.
Since they all have the same right category, one may consider different options according to the situation at hand.
Note that $\cal{N}$ has the key advantage of being a small category and hence guarantees that we have a
suitable algebraic weak factorisation system.
\end{example} 

\begin{remark}[OBJECT-WISE vs FUNCTORIAL]  \label{rem-lift-suitable} 
Since pushouts in presheaf categories are stable under base change, conditions~(iv) and~(v) allow us to strengthen the objectwise assertion of condition~(iii) to a lift of the Leibniz product functor $\kcyl \hatotimes (-)$ to $\cal{M}$ as indicated below ($k \in \braces{0, 1}$):%
\footnote{Abstracting from the setting of a presheaf category, the core property used here is adhesiveness~\cite{garner-lack:adhesive} of the elements of $\cal{M}$.}
\end{remark}



We now fix a suitable algebraic weak factorisation system.  For $u \co \cal{I} \to \catE^\to$ and $k \in \braces{0, 1}$, we define a functor $\kcyl \hatotimes u \co \cal{I} \to \catE^\to$ by letting
\[
  (\kcyl \hatotimes u)_i \defeq \kcyl \hatotimes u_i  \defeq \hateval(\kcyl, u_i) \, .
\]
We adopt similar conventions for other natural transformations (or maps of such) written using the tensor notation.
We now define the category~$\cal{I}_\otimes$ and the functor $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ that will be used to define the notion of a uniform $\cal{I}$-fibration in \cref{def:I-fibration} below.
First, let $\cal{I}_\otimes \defeq \cal{I} + \cal{I}$.
Then, define $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ via the coproduct diagram
\begin{equation} \label{equ:u-tensor}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I}
  \ar[r]^{\iota_0}
  \ar[dr]_-{\lcyl \hatotimes u}
&
  \cal{I}_\otimes
  \ar[d]^(.4){u_\otimes}
&
  \cal{I}
  \ar[dl]^-{\rcyl \hatotimes u}
  \ar[l]_{\iota_1}
\\&
  \catE^\to
\rlap{.}}
\end{gathered}
\end{equation}
Note that, even if $u \co \cal{I} \to \catE^\to$ is an inclusion, $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ is not.
With these definitions in place, the notion of a uniform $\cal{I}$-fibration can be stated very succinctly, as in \cref{def:I-fibration} below.

\begin{definition} \label{def:I-fibration}
Let $u \co \cal{I} \to \catE^\to$ be a functor.
\begin{enumerate}[(i)]
\item A \emph{uniform $\cal{I}$-fibration} is a right $\cal{I}_\otimes$-map.
\item A \emph{uniform $\cal{I}$-fibration morphism} is a morphism of right $\cal{I}_\otimes$-maps.
\end{enumerate}
\end{definition}



Uniform fibrations are defined to be the right $\cal{M}_\otimes$-maps and the category of uniform $\cal{M}$-fibrations is given by letting
\[
  \Fib{\cal{M}} \defeq \liftr{(\cal{M}_\otimes)} \rlap{.}
\]

Using the functorial cocylinder, we obtain a functor $\hatexp(\bar{\delta}^k, -)$, defined in terms of a pullback, dual to $\kcyl \hatotimes (-)$, which was defined in terms of a pushout, for~$k \in \braces{0, 1}$.
These form an adjunction as follows:
\[
\xymatrix@C+4em{
  \catE^\to
  \ar@<1ex>[r]^{\kcyl \hatotimes (-)}
  \ar@{}[r]|{\bot}
&
  \catE^\to
  \ar@<1ex>[l]^{\hatexp(\bar{\delta}^k, -)}
\rlap{.}}
\]
For a functor $u \co \cal{I} \to \catE^\to$, we can apply the results obtained above to characterize uniform $\cal{I}$-fibrations, which we introduced in \cref{def:I-fibration}, in terms of right $\cal{I}$-maps.

\begin{proposition} \label{prod-exp-general}
For a map $p \co X \to Y$ in $\catE$, the following are equivalent:
\begin{enumerate}[(i)]
\item $p$ admits the structure of a uniform $\cal{I}$-fibration,
\item $\hatexp(\bar{\delta}^0, p)$ and $\hatexp(\bar{\delta}^1, p)$ admit the structure of right $\cal{I}$-maps.
\end{enumerate}
\end{proposition}

\begin{proof}
First recall that the right orthogonality functor is contravariant and part of the adjunction~\eqref{garner-adjunction}, hence sends coproducts to products of categories over $\catE^\to$.
The remainder of the claim follows from \cref{lift-of-leibniz-adjunction} as applied in \cref{pitchfork-leibniz-most-general-example} and the preceeding discussion.
\end{proof}



We show that uniform  $\cal{M}$-fibrations are the right maps of an algebraic weak factorization system.
We will do so using Garner's small object argument~\cite{garner:small-object-argument} (see also~\cite[Proposition~16]{bourke-garner-I}). In order to apply it, we establish that uniform  fibrations can be defined equivalently by right uniform orthogonality with respect to a small category over $\catE$.









\begin{theorem} \label{thm:sset-cset-nwfs}
There exists an algebraic weak factorization systems $(\mathsf{L}_\otimes, \mathsf{R}_\otimes)$ in which right maps are the uniform $\cal{M}$-fibrations. In particular, every map $f \co X \to Y$ admits a functorial factorization of the form
\[
\xymatrix{
  X
  \ar[rr]^{f}
  \ar[dr]_{j_f}
&&
  Y
\\&
  P_f
  \ar[ur]_{p_f}
}
\]
where $p_f$ admits the structure of a uniform fibration and $j_f$ admits the structure of a $\mathsf{L}_\otimes$-coalgebra.
\end{theorem}

\begin{proof} Let $\cal{N}$ be a small generating category for $(\LL, \RR)$ and consider the category  $\LL_\otimes$.
By \cref{prod-exp-general}, there is an isomorphism $\Fib{\cal{M}} = \Fib{\cal{N}}$. The claim now follows 
from the smallness of  $\LL_\otimes$, via Garner's small object argument.
\end{proof}

\begin{remark} \label{rem:constructive-small-object}
\cref{thm:sset-cset-nwfs} applies to both $\SSet$ and $\CSet$.
In these cases, we explain why the result can be proved constructively, \ie without using the law of excluded middle or the axiom of choice.
First, observe that in these examples every subobject of a representable is finitely presentable and that the functorial cylinder $\interval \otimes (-) \co \cal{E} \to \cal{E}$ preserves finitely presentable objects.
For part~(i), by the assumption that subobjects of representables are finitely presentable, the values of the inclusion $u \co \cal{N} \to \cal{E}^\to$ are finitely presentable objects of $\cal{E}^\to$.
An inspection of the proof of \cite[Theorem~4.4]{garner:small-object-argument} shows that this suffices to construct the algebraically-free algebraic weak factorization system $(\mathsf{L}_1, \mathsf{R}_1)$ on $u \co \cal{N} \to \cal{E}^\to$, and in fact the sequence constructing the appropriate free monad converges after $\omega$ steps.
The fact that the category of $\mathsf{R}_1$-algebras is the category of uniform trivial $\cal{M}$-fibrations follows from part~(i) of \cref{small-gen-triv-kan}.
The reasoning for part~(ii) is analogous, noting that also the values of $u_\otimes$ are finitely presentable by the assumption of the functorial cylinder and the fact that finitely presentable objects are closed under pushout.

For this argument, the assumption of working with decidable monomorphisms in a constructive setting is used to obtain the smallness of $\cal{N}$ and $\cal{N}_\otimes$ without relying on the Power Set axiom.
We believe that this restriction is important also to treat constructively further aspects of the theory, such as universes~\cite{cohen-et-al:cubicaltt}.

\cref{thm:sset-cset-nwfs} suggests the possibility of defining constructively model structures on $\SSet$ and $\CSet$ having as (trivial) fibrations the maps that admit the structure of a uniform (trivial) Kan fibration.
We leave this question to further investigation.
\end{remark}


\newpage



\section{The uniform Frobenius condition}
\label{sec:frobc}

We now state the analogue for a algebraic weak factorisation systems of the the Frobenius condition for a weak factorisation system.
This condition, called the functorial Frobenius condition, was stated for cloven weak factorisation systems in~\cite{garner:topological-simplicial},
but applies without change to algebraic weak factorisation systems. For a category $\cal{E}$, we write $\cal{E}^\to \times_\cal{E} \cal{E}^\to$
for the pullback of $\cod \co \cal{E}^\to \to \cal{E}$ with itself. This is the category of cospans in
$\cal{E}$, \ie pairs of arrows with common codomain. Pullback gives a functor
$P \co  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to \to \cal{E}^\to$
sending a cospan $(g, h)$ to $h^*(g)$.

\begin{definition} \label{functorial-frobenius}
An algebraic weak factorization system $(\LL, \RR)$ satisfies the \emph{functorial Frobenius condition} if pullback along $\palg{\RR}$
preserves $\pcoalg{\LL}$, in the sense of a lift $\tilde{P}$ of $P$, as follows:
\[
\xymatrix@C+2em{
  \pcoalg{\LL} \times_{\cal{E}} \palg{\RR}
  \ar@{.>}[r]^{\tilde{P}}
  \ar[d]
&
  \pcoalg{\LL}
  \ar[d]
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P}
&
  \cal{E}^\to
\rlap{.}}
\]
\end{definition}

In this section we obtain an analogue of~\cref{thm:frobenius-equivalence} for algebraic weak factorisation systems, \ie 
a necessary and sufficient condition for a cofibrantly generated awfs  to satisfy the functorial Frobenius condition, expressed 
purely in terms of a generating category. In the next section, we apply this characterization  to prove that the algebraic weak 
factorization system~$(\mathsf{TrivCof}, \mathsf{Fib})$ of~\cref{thm:sset-cset-nwfs} has the functorial Frobenius property. 
In order to prove the desired characterization, it is convenient to work with a variant of the functorial Frobenius condition,
which we introduce in~\cref{uniform-frob-nice} below. 

For this, we  introduce some notation. Given $u \co \cal{I} \to \cal{E}^\to$, we write $\cal{I}_{/\cal{E}}^{\to}$ for the category of pairs~$(X, i)$,
where $X \in \cal{E}$ and $u_i \co A_i \to B_i$ is a map in $\cal{E}_{/X}$. We write $s \co \cal{I}_{/\cal{E}}^{\to} \to \cal{E}$ for the first projection. Then, for $v \co \cal{J} \to \cal{E}^\to$, we can form a pullback
\[
\xymatrix{
 \cal{I}_{/\cal{E}} \times_{\cal{E}} \cal{J} \ar[r] \ar[d] & 
 \cal{J} \ar[d]^v \\
  \cal{I}_{/\cal{E}} \ar[r]_s &
  \cal{E}^\to}
  \]
When $u$ is the identity on $\cal{E}^\to$ and $v$ is the codomain functor $\cod \co \cal{E}^\to \to \cal{E}$, we obtain
\[
\xymatrix{
 \cal{E}_{/\cal{E}} \times_{\cal{E}} \cal{E}^\to \ar[r] \ar[d] & 
 \cal{E} \ar[d]^{\cod} \\
  \cal{E}^\to_{/\cal{E}} \ar[r]_s &
  \cal{E}^\to}
  \]
Pullback gives a functor $Q \co  \cal{E}^\to_{/\cal{E}} \times_{\cal{E}} \cal{E}^\to \to \cal{E}_{/\cal{E}}^\to$
sending $(f, h)$ to $h^*(f)$. 



\begin{definition} \label{uniform-frob-nice}
We say that  $v \co \cal{J} \to \catE^\to$ satisfies the \emph{uniform Frobenius condition} with respect to $u \co \cal{I} \to \cal{E}^\to$ if
pullback along $\cal{J}$-maps sends $\cal{I}$-maps to ${}^\pitchfork(\cal{I}^\pitchfork)$-maps, \ie the functor $Q$ admits a lift $\tilde{Q}$ as below:
\begin{equation} \label{uniform-frob-nice:lift}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I}_{/\cal{E}} \times_{\cal{E}} \cal{J}
  \ar@{.>}[r]^{\tilde{Q}}
  \ar[d]_{u_{/\cal{E}} \times_{\cal{E}} v}
&
  \liftl{(\liftr{\cal{I}})}_{/\cal{E}}
  \ar[d]^{\liftl{(\liftr{u})}_{/\cal{E}}}
\\
  \cal{E}^\to_{/\cal{E}} \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{Q}
&
  \cal{E}_{/\cal{E}}^\to
\rlap{.}}
\end{gathered}
\end{equation}
\end{definition}

As the next proposition shows, the uniform Frobenius condition of \cref{uniform-frob-nice} can be simplified under some assumptions.

\begin{proposition}
\label{uniform-frob-even-nicer}
Let $v \co \cal{J} \to \cal{E}^\to$ be a functor such that
\begin{equation} \label{uniform-frob:comprehension}
\begin{gathered}
\xymatrix@C-1em{
  \cal{J}
  \ar[rr]^{v}
  \ar[dr]_{\cod_{\cal{E}} \cc v}
&&
  \cal{E}^\to
  \ar[dl]^{\cod_{\cal{E}}}
\\&
  \cal{E}
}
\end{gathered}
\end{equation}
is a morphism of Grothendieck fibrations. Then the following are equivalent:
\begin{enumerate}[(i)] 
\item  $v \co \cal{J} \to \cal{E}^\to$ satisfies the  uniform Frobenius condition with respect to $u \co \cal{I} \to \cal{E}^\to$,
\item there is a lift $\tilde{P}$ as below:
\begin{equation} \label{uniform-frob-even-nicer:lift}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I} \times_{\cal{E}} \cal{J}
  \ar@{.>}[r]^{\tilde{P}}
  \ar[d]_{u \times_{\cal{E}} v}
&
  \liftl{(\liftr{\cal{I}})}
  \ar[d]^{\liftl{(\liftr{u})}}
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P}
&
  \cal{E}^\to
\rlap{.}}
\end{gathered}
\end{equation}
\end{enumerate}
\end{proposition}

\begin{proof}
We will show that giving lifts $\tilde{Q}$ and $\tilde{P}$ as in~\eqref{uniform-frob-nice:lift} and \eqref{uniform-frob-even-nicer:lift}, respectively,
is equivalent.
The situation \eqref{uniform-frob-nice:lift} a priori represents a more general scenario: we are pulling back an arrow $u_i \co A \to B$ with $i \in \cal{I}$ over an object $Y$ along a map $v_j \co X \to Y$ with $j \in \cal{J}$.
In contrast, in \eqref{uniform-frob-even-nicer:lift} we restrict to the case that the map $B \to Y$ is the identity.
It follows that any lift $\tilde{Q}$ induces a lift $\tilde{P}$.
However, under the stated assumption, the lift $\tilde{Q}$ can be reconstructed from the lift $\tilde{P}$ by first pulling back $v_j$ along $B \to Y$ to a map $v_{j'} \co B \to D$ with $j' \to j$ a map in $\cal{J}$ in the above situation and then setting $\tilde{Q}(i, j) \defeq \tilde{P}(i, j')$.
Furthermore, this choice of $\tilde{Q}$ is forced upon us (up to isomorphism) by functoriality of $Q$ and the fact that $\liftl{(\liftr{u})}$ reflects isomorphisms.
\end{proof}

We can now restate the functorial Frobenius condition of~\cref{functorial-frobenius} equivalently in terms of
the uniform Frobenius condition of~\cref{uniform-frob-nice}. For this, we apply \cref{uniform-frob-even-nicer}
when $\cal{J}$ is a category of $\RR$-algebras of an algebraic weak factorization system $(\LL, \RR)$. 

\begin{proposition}
Let $(\mathsf{L}, \mathsf{R})$ be an algebraic weak factorization system on $\cal{E}$. Then the following are
equivalent:
\begin{enumerate}[(i)] 
\item $(\LL, \RR)$ satisfies the functorial Frobenius condition,
\item $\mathsf{R}$-$\mathsf{alg}$ satisfies the uniform Frobenius condition with respect to $\mathsf{L}$-$\mathsf{coalg}$.
\end{enumerate}
\end{proposition}

\begin{proof} The claim follows combining \cref{uniform-frob-even-nicer} and the fact that, $\pcoalg{\LL}$ is a category of left maps,
there are functors over $\cal{E}^\to$ back and forth between $\pcoalg{\LL}$ and $\liftl{(\liftr{(\pcoalg{\LL})})}$
\end{proof}


The reformulation of the functorial Frobenius condition as a uniform Frobenius condition is that the latter admits an 
equivalent rephrasing in terms of pushforward, rather than pullback, functors, which will be essential to our characterization of algebraically-free
algebraic weak factorisation systems satisfying the functorial Frobenius condition. As a first step towards the pushforward formulation,
we decompose the uniform Frobenius condition into an object part and a morphism part. For this, recall that, for an arrow $f \co X \to Y$, we have an adjunction~$f_{!} \dashv f^*$ between composition and pullback. 
Given a functor $u \co \cal{I} \to \catE^\to$, it is immediate to check that the left composition functor lifts as follows:
\[
\xymatrix@C+1em{
  \cal{I}_{/X}
  \ar[r]^-{f_!}
  \ar[d]_{u_{/X}}
&
  \cal{I}_{/Y}
  \ar[d]^{u_{/Y}}
\\
  \calE_{/X}^\to
  \ar[r]_-{f_!}
&
  \calE_{/Y}^\to
\rlap{.}}
\]
By \cref{lift-of-adjunction}, the pullback functor $f^* \co \catE_{/Y} \to \catE_{/X}$ then lifts to slices of the right orthogonality categories,
\[
\xymatrix@C=1.5cm{
  \liftr{\cal{I}}_{/Y}
  \ar[d]_{{\liftr{u}}_{/Y}}
  \ar[r]^{f^*}
&
  \liftr{\cal{I}}_{/X}
  \ar[d]^{{\liftr{u}}_{/X}}
\\
  {\catE}_{/Y}^\to
  \ar[r]_{f^*}
&
  \catE_{/X}^\to
\rlap{.}}
\]






\begin{proposition}  \label{def:uniFrobcond}
 Let $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \catE^\to$. Then $v$ satisfies the
uniform Frobenius property with respect to $u$ if and only if the following hold:
\begin{enumerate}[(i)]
\item for every  $j \in \cal{J}$, pullback along $v_j \co C_j \to D_j$ lifts to a functor
\[
\xymatrix@C+3em{
  \cal{I}_{/Y}
  \ar[r]^-{\widetilde{v_j^*}}
  \ar[d]_-{u_{/D_j}}
&
  \liftl{(\liftr{\cal{I}})}_{/C_j}
  \ar[d]^-{\liftl{(\liftr{u})}_{/C_j}}
\\
  \catE_{/D_j}^\to \ar[r]_-{v_j^*}
&
  \catE_{/C_j}^\to
\rlap{.}}
\]
\item for every $\tau \co j \to k$ in $\cal{J}$, the square $v_\tau \co v_j \to v_k$ in 
\begin{equation} 
\label{def:beck-chevalley:0}
\begin{gathered}
\xymatrix@C+3em{
  C_j
  \ar[r]^{v_j}
  \ar[d]_{s}
&
  D_j
  \ar[d]^{t}
\\
  C_{k}
  \ar[r]_-{v_{k}}
&
  D_{k}
\rlap{,}}
\end{gathered}
\end{equation}
is such that the canonical natural transformation
\[
\xymatrix@C+3em{
  \catE^\to_{/D_j}
  \ar[d]_{t_!}
  \ar[r]^{v_j^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\phi$}}
&
  \catE^\to_{/C_j}
  \ar[d]^{s_!}
\\
  \catE^\to_{/D_k}
  \ar[r]_{v_k^*}
&
  \catE^\to_{/C_k}
}
\]
lifts to a natural transformation
\[
\xymatrix@C+3em{
  \cal{I}_{/D_j}
  \ar[r]^{\widetilde{v_j^*}}
  \ar[d]_{t_!}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\tilde{\phi}$}}
&
  \liftl{(\liftr{\cal{I}})}_{/C_j}
  \ar[d]^{s_!}
\\
  \cal{I}_{/D_k}
  \ar[r]_{\widetilde{v_k^*}}
&
  \liftl{(\liftr{\cal{I}})}_{/C_k}
\rlap{.}}
\]
\end{enumerate}
\end{proposition}

\begin{proof}
Since the functor $\liftl{(\liftr{u})}$ is faithful, a lift $\widetilde{v_j^*}$ consists just of a lift of the action of $v_j^*$ on objects that is coherent with respect to the action of $v_j^*$ on morphisms, in the sense that the action of $v_j^*$ on morphisms determines uniquely the action of its
lift on morphisms.
Coherence in morphisms in $\cal{I}_{/\cal{E}} \times_{\cal{E}} \cal{J}$ of the action on objects of $\tilde{v^*}$ separates into two parts:
\begin{enumerate}[(1)] 
\item coherence in morphisms in $\cal{I}_{/D_j}$ for fixed $v_j \co C_j \to D_j$ with $j \in \cal{J}$,
\item coherence in morphisms in $\cal{J}$.
\end{enumerate}
The action of $\tilde{v^*}$ on objects together with coherence (1) constitutes part (i). Coherence (2) constitutes the  part (ii).
\end{proof}


The statement of~\cref{def:uniFrobcond} makes it clear that the uniform Frobenius condition requires the specification of additional structure, rather than the mere satisfaction of a property.
Explicitly, it requires that $v_j^*(u_i) \co v_j^* X_i \to v_j^* Y_i$ is equipped with the structure of a left $\liftr{\cal{I}}$-map for $i \in \cal{I}$ and $u_i \co X_i \to Y_i$ over $D_j$, such that morphisms in $\cal{I}_{/D_j}$ induce morphisms of left $\liftr{\cal{I}}$-maps. However, at the level of squares, 
 the  condition in part (ii) of \cref{def:uniFrobcond} is just a property, not additional structure.
Explicitly, it requires the components of the natural transformation $\phi$ to be morphisms of left $\liftr{\cal{I}}$-maps.
Also note that if the commutative square~\eqref{def:beck-chevalley:0} is a pullback, then the canonical natural transformation~$\phi$ is an isomorphism by the usual Beck-Chevalley condition, and so is~$\tilde{\phi}$ since $\liftl{(\liftr{u})}$ reflects isomorphisms.
\cref{def:uniFrobcond} has an immediate dual, expressed in terms of pushforward rather than pullback, which we state next.


\begin{proposition} \label{lift-pushforward} \label{lift-pushforward-BC}
 Let $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \catE^\to$. Then $v$ satisfies the
uniform Frobenius property with respect to $u$ if and only if the following hold:
\begin{enumerate}[(i)] 
\item for every  $j \in \cal{J}$, pushforward along $v_j \co C_j \to D_j$ lifts to a functor
\[
\xymatrix@C=1.5cm{
  {\liftr{\cal{I}}}_{/X}
  \ar[r]^{(v_j)_*}
  \ar[d]_{u_{/C_j}}
&
  {\liftr{\cal{I}}}_{/D_j}
  \ar[d]^{{\liftr{u}}_{/D_j}}
\\
  \catE_{/C_j}^\to
  \ar[r]_{(v_j)_*}
&
  \catE_{/D_j}^\to
\rlap{.}}
\]
\item for every $\tau \co j \to k$, the square $v_\tau \co v_j \to v_k$, as in~\eqref{def:beck-chevalley:0}, is such that the canonical natural transformation
\[
\xymatrix@C+2em{
  \catE^\to_{/C_k}
  \ar[r]^{(v_k)_*}
  \ar[d]_{s^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\psi$}}
&
  \catE^\to_{/D_k}
  \ar[d]^{t^*}
\\
  \catE^\to_{/C_j}
  \ar[r]_{(v_j)_*}
&
  \catE^\to_{/D_j}
}
\]
lifts to a natural transformation
\[
\xymatrix@C+2em{
  {\liftr{\cal{I}}}_{/C_k}
  \ar[r]^{(v_k)_*}
  \ar[d]_{s^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\tilde{\psi}$}}
&
  {\liftr{\cal{I}}}_{/D_k}
  \ar[d]^{t^*}
\\
  {\liftr{\cal{I}}}_{/C_j}
  \ar[r]_{(v_j)_*}
&
  {\liftr{\cal{I}}}_{/D_j}
\rlap{.}}
\]
\end{enumerate}
\end{proposition}

\begin{proof} For (i), apply \cref{lift-of-adjunction} to the adjunction $v_j^* \dashv (v_j)_*$ with $u = u_{/X}$ and $v = {\liftr{u}}_{/Y}$, using \cref{pitchfork-slicing-grothendieck} to permute slicing and the left orthogonality functor. For (ii), apply \cref{lift-of-mates} to  
the adjunctions $v_j^* s_! \dashv (v_j)_* s^*$ and $v_k^* t_! \dashv (v_k)_* t^*$ recalling that $\phi$ and $\psi$ are mates.
\end{proof}




We can now give the desired characterization of the functorial Frobenius condition for algebraically-free algebraic weak factorization systems.




\begin{theorem} \label{thm:frobenius-comparison}
Let $(\LL, \RR)$ be a algebraic weak factorisation system cofibrantly generated by a category $\cal{I}$ of arrows. Then the following
are equivalent:
\begin{enumerate}[(i)] 
\item  $(\LL, \RR)$ satisfies the functorial Frobenius condition,
\item $\liftr{\cal{I}}$ satisfies the uniform Frobenius condition with respect to $\cal{I}$.
\end{enumerate}
\end{theorem}

\begin{proof} First observe that there are functors over $\cal{E}^\to$ back and forth between $\pcoalg{\LL} = \liftl{(\liftr{\cal{I}})}$ and $\overline{\pCoalg{\LL}}$ (this is the case for (co)pointed endofunctor and (co)monad algebras over any (co)monad).
Applying $\liftr{(-)}$ and using \cref{retract-closure}, it follows that there are maps in $\CAT_{/\cal{E}^\to}$ back and forth between $\liftr{\cal{I}}$ and $\palg{\RR}$, and hence also between $\liftl{(\liftr{\cal{I}})}$ and $\pcoalg{\LL}$.

The functorial Frobenius condition for $(\LL, \RR)$ then takes the form of a lift
\begin{equation} 
\label{frobenius-comparison:0}
\begin{gathered}
\xymatrix@C+2em{
  \liftl{(\liftr{\cal{I}})} \times_{\cal{E}} \liftr{\cal{I}}
  \ar@{.>}[r]
  \ar[d]
&
  \liftl{(\liftr{\cal{I}})}
  \ar[d]
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P'}
&
  \cal{E}^\to
}
\end{gathered}
\end{equation}
By  \cref{uniform-frob-even-nicer}, the uniform Frobenius condition, instead, requires a lift 
\begin{equation}
\label{equ:spellout}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I} \times_{\cal{E}} \liftr{\cal{I}}
  \ar@{.>}[r]^{\tilde{P}}
  \ar[d] 
&
  \liftl{(\liftr{\cal{I}})}
  \ar[d]
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P}
&
  \cal{E}^\to
\rlap{.}}
\end{gathered}
\end{equation}
Note the subtle difference:  we are pulling back a map coming from  $\liftl{(\liftr{\cal{I}})}$ in~\eqref{frobenius-comparison:0},
one coming from $\cal{I}$ in~\eqref{equ:spellout}. We now need to show that a lift as in~\eqref{frobenius-comparison:0} is equivalent to 
one as in~\eqref{equ:spellout}.


In one direction, given a lift as in~\eqref{frobenius-comparison:0}, composition with the unit map from $\cal{I}$ to $\liftl{(\liftr{\cal{I}})}$ gives
a lift as in~\eqref{equ:spellout}. In the other direction, one first shows that \eqref{frobenius-comparison:0} implies a relativized version of itself, with arrows as in~\eqref{uniform-frob-nice:lift} and with $\liftl{(\liftr{\cal{I}})}$ instead of $\cal{I}$ on the left. We then use an analogue of \cref{lift-pushforward} to write it separately as two components, first lifts of pushforward
\[
\xymatrix@C=1.5cm{
  {\liftr{\cal{I}}}_{/X}
  \ar[r]^{f_*}
  \ar[d]_{u_{/X}}
&
  \liftr{(\liftl{({\liftr{\cal{I}}})})}_{/Y}
  \ar[d]^{{\liftr{u}}_{/Y}}
\\
  \catE_{/X}^\to
  \ar[r]_{f_*}
&
  \catE_{/Y}^\to
}
\]
along any fixed right $\cal{I}$-map $f \co X \to Y$, and second lifts of the canonical map $t^* g_* p \to f_* s^* p$ to a right $\liftl{(\liftr{\cal{I}})}$-map for $(s, t) \co f \to g$ a map between right $\cal{I}$-maps and $p$ a right $\cal{I}$-map.
These are provided by the uniform Frobenius condition in the form of part~(ii) of \cref{lift-pushforward} after postcomposing the lifts in there with the unit  $\liftr{\cal{I}} \to \liftr{(\liftl{(\liftr{\cal{I}})})}$ of the adjunction~\eqref{garner-adjunction}.
\end{proof}

We conclude the section with some results on the functorial Frobenius condition which will be used in \cref{sec:frocuf}.

\begin{proposition} \label{uniform-frobenius-functorial}
Consider categories $u_t \co \cal{I} \to \cal{E}^\to$ and $v_t \co \cal{J} \to \cal{E}^\to$, for $t \in \braces{1, 2}$, related as follows:
\begin{align*}
\xymatrix@!C@C-3em{
  \cal{I}_1
  \ar[rr]^{F}
  \ar[dr]_{u_1}
&&
  \liftl{(\liftr{\cal{I}_2})}
  \ar[dl]^{\liftl{(\liftr{u_2})}}
\\&
  \catE^\to
\rlap{,}}
&&
\xymatrix@C-1.5em{
  \cal{I}_2
  \ar[rr]^-{G}
  \ar[dr]_{u_2}
&&
  \cal{I}_1
  \ar[dl]^{u_1}
\\&
  \catE^\to
\rlap{,}}
&&
\xymatrix@C-1.5em{
  \cal{J}_2
  \ar[rr]^-{H}
  \ar[dr]_{v_2}
&&
  \cal{J}_1
  \ar[dl]^{v_1}
\\&
  \catE^\to
\rlap{.}}
\end{align*}
If $v_1$ satisfies the uniform Frobenius condition with respect to $u_1$, then $v_2$ satisfies the uniform Frobenius condition with respect to $u_2$.
\end{proposition}

\begin{proof}
We work with the formulation of the Frobenius condition in \cref{uniform-frob-nice}.
In the diagram $\cal{I}$, the premiss of the desired implication corresponds to a functor $Q_1$ making the inner square commute while the conclusion corresponds to a functor $Q_2$ making the lower trapezoid commute:
\[
\xymatrix{
&
  {\cal{I}_2}_{/\cal{E}} \times_{\cal{E}} \cal{J}_2
  \ar[rr]^{Q_1}
  \ar[dd]^(0.25){{u_1}_{/\cal{E}} \times_{\cal{E}} v_1}
&&
  \liftl{(\liftr{\cal{I}_2})}_{/\cal{E}}
  \ar[dr]
  \ar[dd]_(0.25){\liftl{(\liftr{u_1})}_{/\cal{E}}}
\\
  {\cal{I}_1}_{/\cal{E}} \times_{\cal{E}} \cal{J}_1
  \ar[ur]
  \ar[dr]_{{u_2}_{/\cal{E}} \times_{\cal{E}} v_2}
  \ar[rrrr]^{Q_2}
&&&&
  \liftl{(\liftr{\cal{I}_1})}_{/\cal{E}}
  \ar[dl]^{\liftl{(\liftr{u_2})}_{/\cal{E}}}
\\&
  \cal{E}^\to_{/\cal{E}} \times_{\cal{E}} \cal{E}^\to
  \ar[rr]_{P}
&&
  \cal{E}^\to_{/\cal{E}}
\rlap{.}}
\]
We may construct $Q_2$ from~$Q_1$ by pasting the inner square with the left triangle, given by $G$ and~$H$, and the right triangle, given by $F$ and the multiplication of the monad $\liftl{(\liftr{(-)})}$.
\end{proof}


\begin{remark}
In some applications, we need functoriality of the uniform Frobenius condition of~$\cal{J}$ with respect to~$\cal{I}$ in one of the parameters.
If only functoriality in $\cal{I}$ is desired, the map $H$ will default to an identity.
If only functoriality in $\cal{J}$ is desired, the maps $F$ and $G$ will default to a component of the unit of the monad $\liftl{(\liftr{(-)})}$ and an identity, respectively.
\end{remark}

\begin{proposition} \label{uniform-frobenius-product-u}
If $v \co \cal{J} \to \cal{E}^\to$ satisfies the uniform Frobenius condition with respect to functors $u_1 \co \cal{I}_1 \to \cal{E}^\to$ and $u_2 \co \cal{I}_2 \to \cal{E}^\to$, then also with respect to the pullback $\cal{I}_1 \times_{\cal{E}^\to} \cal{I}_2 \to \cal{E}^\to$ of $u_1$ and $u_2$.
\end{proposition}

\begin{proof}
Use the universal property of products in the category $\CAT_{/\cal{E}^\to}$, noting that we have a canonical map
\[
\liftl{(\liftr{\cal{I}_1})} \times_{\cal{E}^\to} \liftl{(\liftr{\cal{I}_2})} \to \liftl{(\liftr{(\cal{I}_1 \times_{\cal{E}^\to} \cal{I}_2)})}
\]
over $\cal{E}^\to$ given by the adjunction~\eqref{garner-adjunction}.
\end{proof}




\newpage


\section{The functorial Frobenius property for uniform fibrations}
\label{sec:frocuf}




Fixing $k \in \braces{0, 1}$, strong $k$-oriented homotopy equivalences can be organized into a category $\cal{S}_k$ as follows.
An object is a 4-tuple $(f, g, \phi, \psi)$ consisting of an arrow $f \co A \to B$ together with data $g \co B \to A$, $\phi \co \interval \otimes A \to A$, $\psi \co \interval \otimes B \to B$ making $f$ into a strong $k$-oriented homotopy equivalence.
A morphism $m \co (f, g, \phi, \psi) \to (f', g', \phi', \psi')$ consists of maps $s \co A \to A', t \co B \to B'$ such that the following diagrams commute:
\begin{align*}
\xymatrix{
  A
  \ar[r]^{s}
  \ar[d]_{f}
&
  A'
  \ar[d]^{f'}
\\
  B
  \ar[r]_{t}
&
  B'
\rlap{,}}
&&
\xymatrix{
  B
  \ar[r]^{t}
  \ar[d]_{g}
&
  B'
  \ar[d]^{g'}
\\
  A
  \ar[r]_{s}
&
  A'
\rlap{,}}
&&
\xymatrix{
  \interval \otimes A
  \ar[d]_{\phi}
  \ar[r]^{\interval \otimes s}
&
  I \otimes A'
  \ar[d]^{\phi'}
\\
  A
  \ar[r]_{s}
&
  A'
\rlap{,}}
&&
\xymatrix{
  \interval \otimes B
  \ar[d]_{\psi}
  \ar[r]^{\interval \otimes t}
&
  I \otimes B'
  \ar[d]^{\psi'}
\\
  B
  \ar[r]_{t}
&
  B'
\rlap{.}}
\end{align*}
There is an obvious forgetful functor $\cal{S}_k \to \catE^\to$ projecting to the first component.
Our first goal is to give an alternative characterization of strong left or right homotopy equivalences.


\begin{lemma} \label{strong-h-equiv-as-section}
For $k \in \braces{0, 1}$, the category $\cal{S}_k$ of strong $k$-oriented homotopy equivalences in $\catE$ can be described isomorphically as the category of arrows $f \in \catE^{\to}$ with a retraction $\rho$ of $\thetak \hatotimes f$.
In detail,
\begin{enumerate}[(i)]
\item objects are pairs $(f, \rho)$ consisting of $f \in \catE^\to$ and a retraction $\rho$ of $\thetak \hatotimes f$, as below:
\[
\xymatrix@C+2em{
  f
  \ar[r]^-{\thetak \hatotimes f}
  \ar@{=}[dr]
&
  \kcyl \hatotimes f \ar[d]^{\rho}
\\&
  f
\rlap{,}}
\]
\item morphisms $\tau \co (f, \rho) \to (f', \rho')$ are maps $\tau \co f \to f'$ such that the below diagram commutes:
\[
\xymatrix@C+2em{
  \kcyl \hatotimes f
  \ar[d]_-{\rho}
  \ar[r]^{\kcyl \hatotimes \tau}
&
 \kcyl \hatotimes f'
  \ar[d]^-{\rho'}
\\
  u_i
  \ar[r]_{\tau}
&
  u_{i'}
\rlap{.}}
\]
\end{enumerate}
\end{lemma}

\begin{proof} The object part of the correspondence is essentially \cref{strong-h-equiv-as-section-non-alg}. The morphism part is
straightforward. 
\end{proof}



We are now going to relate strong homotopy equivalences relative to $\cal{I}$ with the components of $\cal{I}_\otimes$ as defined in~\eqref{equ:u-tensor}.



\begin{proposition} \label{thm:strong-hequiv} \hfill 
\begin{enumerate}[(i)]
\item   \label{thm:onedir} There is a functor
\[
\xymatrix@!C@C-2.5em{
\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})
  \ar[dr]
  \ar@<4pt>[rr]
&&
  \liftl{(\Fib{\cal{I}})}
  \ar[dl]
\\&
  \catE^\to \, .
}
\]
\item  \label{thm:twodir} There is a functor
\[
\xymatrix@!C@C-2.5em{
    \cal{I}_\otimes
  \ar[dr]
  \ar[rr]
&&
\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})
  \ar[dl]
\\&
  \catE^\to
}
\]
\end{enumerate}
\end{proposition}

\begin{proof} For (i), let $k \in \braces{0 \, , 1 }$. We show that there is a functor
\begin{equation}
\label{lem:from-strong-hequiv}
\begin{gathered}
\xymatrix@!C@C-2em{
  \cal{S}_k(\cal{I})
  \ar[dr]_{\cal{S}_k(u)}
  \ar[rr]^{L_k}
&&
  \overline{\cal{I}}
  \ar[dl]^-{\overline{\kcyl \hatotimes u}}
\\&
  \catE^\to
\rlap{.}}
\end{gathered}
\end{equation}
We only describe the action of the functor $L_k$ on an object $(i, \rho)$, leaving the evident definition of the action on arrows to the reader.
Recall that $\rho$ is a retraction of $\thetak \hatotimes u_i \co u_i \to \kcyl \hatotimes u_i$, exhibiting $u_i$ as a retract of $\kcyl \hatotimes u_i$.
Thus, we may define $L_k(i, \rho) \defeq (i, u_i, \thetak \hatotimes u_i, \rho)$.
Observe that this definition makes the diagram for $L_k$ commute. The claim in (i) now follows by combining 
the cases $k = 0$ and $k = 1$ and composing with a component of the unit of the monad $\liftl{(\liftr{(-)})}$.
Note that the retract closure in~\eqref{lem:from-strong-hequiv} vanishes because of \cref{retract-closure}.


For (ii), we first show that there is a functor
\[
\xymatrix@!C@C-2em{
  \cal{I}
  \ar[dr]_{\kcyl \hatotimes u} \ar[rr]^{M_k}
&&
  \cal{S}_k(\cal{I})
  \ar[dl]^{\cal{S}_k(u)}
\\&
   \catE^\to
\rlap{.}}
\]
For this, recall from~\eqref{rel-strong-h-equiv-def} that $S_k(\cal{I})$ was defined as the product of $\cal{I}$ and $\cal{S}_k$ in $\CAT_{/\cal{E}^\to}$.
The map to the first factor is given by the assumption that $\cal{I}$ is closed under Leibniz product with the endpoint inclusions, which is
part of the hypotheses of a suitable algebraic weak factorisation system.
The map to the second factor is given by \cref{effective-connections-leibniz}.
The claim in (ii) follows by combining the cases $k = 0$ and $k = 1$.
\end{proof}



\begin{remark} \label{relating-strong-hequiv-and-uniform-fib}
We also have a pair of functors
\[
\xymatrix@!C@C-2.5em{
  \liftr{(\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I}))}
  \ar[dr]
  \ar@<4pt>[rr]^{\liftr{(M_0 + M_1)}}
&&
  \Fib{\cal{I}}
  \ar[dl]
  \ar@<4pt>[ll]^{\liftr{(L_0 + L_1)}}
\\&
  \catE^\to
}
\]
relating uniform $\cal{I}$-fibrations with right maps for strong homotopy equivalences relative to $\cal{I}$.
These are not, in general, inverses to each other in either way.
\end{remark}

We are now ready to show that the algebraic weak factorization system in which the right maps are the uniform fibrations (constructed in~\cref{thm:sset-cset-nwfs}) satisfies the functorial Frobenius property.
For this, we use our characterisation of the functorial Frobenius property in algebraically-free algebraic weak factorization systems
stated in \cref{thm:frobenius-comparison}.

As a preliminary step, we show that, under more general assumptions, uniform $\cal{I}$-fibrations satisfy the uniform Frobenius condition with respect to $u_\otimes \co \cal{I}_\otimes \to \cal{E}^\to$, in the sense of \cref{def:uniFrobcond}. We begin by establishing that, under mild assumptions, uniform $\cal{I}$-fibrations satisfy the uniform Frobenius condition with respect to to the category $\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})$ of strong homotopy equivalences relative to $\cal{I}$ (viewed as a category over $\cal{E}^\to$ in the evident way).





Let $k \in \braces{0, 1}$ and abbreviate $\liftr{(\kcylinv \otimes \id_{\cal{E}})} \co \cal{E} \to \cal{E}^\to$ by $v \co \cal{J} \to \cal{E}^\to$.
Strong $k$-oriented homotopy equivalences are uniformly stable under base change along maps in $\cal{J}$.





\begin{lemma} \label{technical}
Uniform $\cal{I}$-fibrations satisfy the uniform Frobenius condition with respect to $\cal{S}_0 + \cal{S}_1$.
\end{lemma}




\begin{proof} Let $k \in \braces{0, 1}$. First, we show that right $(\delta^{1-k} \hatotimes u')$-maps satisfy the uniform Frobenius condition with respect to strong $k$-oriented homotopy equivalences. For this,
recall that $u' \co \cal{I}' \to \cal{E}^\to$ is the functor with domain $\cal{E}$ that sends $X$ to $\bot_X$.
We use the characterization of uniform Frobenius given by \cref{uniform-frob-even-nicer}.
The required lift is provided by a lift $Q'$ in 
\begin{equation} \label{strong-h-equiv-uniform-base-change:goal}
\begin{gathered}
\xymatrix@C+2em{
  \cal{S}_k \times_{\cal{E}} \cal{J}
  \ar@{.>}[r]^{Q'}
  \ar[d]
&
  \cal{S}_k
  \ar[d]
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P'}
&
  \cal{E}^\to
\rlap{.}}
\end{gathered}
\end{equation}
where $P' \co \cal{E}^\to \times_{\cal{E}} \cal{E}^\to \to \cal{E}^\to$ be the pullback functor, sending a cospan $(g, h)$ to $h^* g$, 
after postcomposing it with a component of the unit of the monad $\liftl{(\liftr{(-)})}$.
Note that $\delta^{1-k} \hatotimes \bot_X = \delta^{1-k} \otimes \id_X$ for $X \in \cal{E}$.

So it remains to show how to obtain the lift in in \eqref{strong-h-equiv-uniform-base-change:goal}. Its action on objects is described
in the proof of~\cref{thm:non-alg-frobenius-she}. For the lift of the action on morphisms, suppose we are given a map $j \to j'$ in $\cal{J}$ forming a square
\[
\xymatrix{
  X
  \ar[r]^{v_j}
  \ar[d]_{s}
&
  Y
  \ar[d]^{t}
\\
  X'
  \ar[r]_{v_{j'}}
&
  Y'
}
\]
and a map $(g, \rho) \to (g', \rho')$ in $\cal{S}_k$ with $\tau \co g \to g'$ forming a square
\[
\xymatrix{
  B
  \ar[r]
  \ar[d]_{g}
&
  B'
  \ar[d]^{g'}
\\
  Y
  \ar[r]_-{t}
&
  Y'
}
\]
such that $\tau$ commutes with the retractions $\rho$ and $\rho'$ as follows:
\[
\xymatrix{
  \kcyl \hatotimes g
  \ar[r]^-{\rho}
  \ar[d]_{\kcyl \hatotimes \tau}
&
  g
  \ar[d]^{\tau}
\\
  \kcyl \hatotimes g'
  \ar[r]_-{\rho'}
&
  g'
\rlap{.}}
\]
Let $(\bar{g}, \bar{\rho})$ and $(\bar{g}', \bar{\rho}')$ denote the respective action of $Q$ on the objects $(g, \rho, j)$ and $(g', \rho', j')$ as constructed in the first part of the proof.
Recall that this includes pullback squares $\sigma \co \bar{g} \to g$ and $\sigma' \co \bar{g}' \to g'$ with bottom side $v_j \co X \to Y$ and $v_{j'} \co X' \to Y'$, respectively, as in~\eqref{strong-h-equiv-uniform-base-change:0}.
The square $\tau \co g \to g'$ pulls back to a square $\bar{\tau} \co \bar{g} \to \bar{g'}$ with bottom side $v_{j'}$.
We want to show that $\bar{\tau}$ in addition forms a morphism of strong $k$-oriented homotopy equivalences from $(\bar{g}, \bar{\rho})$ to $(\bar{g}', \bar{\rho}')$.
For this, we have to verify commutativity of the following diagram:
\[
\xymatrix{
  \kcyl \hatotimes \bar{g}'
  \ar[r]^-{\bar{\rho}}
  \ar[d]_{\kcyl \hatotimes \bar{\tau}}
&
  \bar{g}
  \ar[d]^{\bar{\tau}}
\\
  \kcyl \hatotimes \bar{g}'
  \ar[r]_-{\bar{\rho}'}
&
  \bar{g}'
\rlap{.}}
\]
Recall the construction of $\bar{\rho}$ and $\bar{\rho}'$, omitting horizontal composite identities for readability:
\[
\xymatrix@!C{
  \bar{g}
  \ar[rr]^-{\thetak \hatotimes \bar{g}}
  \ar[dd]_{\sigma}
  \ar[dr]^{\bar{\tau}}
&&
  \kcyl \hatotimes \bar{g}
  \ar@{.>}[rr]^-{\bar{\rho}}
  \ar[dd]^(0.3){\kcyl \hatotimes \sigma}|!{[dl];[dr]}{\hole}
  \ar[dr]^{\kcyl \hatotimes \bar{\tau}}
&&
  \bar{g}
  \ar[dd]^(0.3){\sigma}|!{[dl];[dr]}{\hole}
  \ar[dr]^{\bar{\tau}}
\\&
  \bar{g}'
  \ar[rr]^-(0.3){\thetak \hatotimes \bar{g}'}
  \ar[dd]_(0.3){\sigma'}
&&
  \kcyl \hatotimes \bar{g}'
  \ar@{.>}[rr]^-(0.3){\bar{\rho}'}
  \ar[dd]^(0.3){\kcyl \hatotimes \sigma'}
&&
  \bar{g}'
  \ar[dd]^{\sigma'}
\\
  g
  \ar[rr]^-(0.25){\thetak \hatotimes g}|!{[ur];[dr]}{\hole}
  \ar[dr]^{\tau}
&&
  \kcyl \hatotimes g
  \ar[rr]^-(0.3){\rho}|!{[ur];[dr]}{\hole}
  \ar[dr]^{\kcyl \hatotimes \tau}
&&
  g
  \ar[dr]^{\tau}
\\&
  g'
  \ar[rr]^-{\thetak \hatotimes g'}
&&
  \kcyl \hatotimes g
  \ar[rr]^-{\rho'}
&&
  g
\rlap{.}}
\]
Our goal is to show that the top right square commutes.
Since that square commutes after composing it with the pullback square $\sigma'$, it suffices to show that the square commutes when projected to codomains, again omitting horizontal composite identities:
\[
\xymatrix@C+2em{
  X
  \ar[rr]^-{\kcylinv \otimes X}
  \ar[dd]_{v_j}
  \ar[dr]^{s}
&&
  \interval \otimes X
  \ar@{.>}[rr]^-{\cod(\bar{\rho})}
  \ar[dd]^(0.35){\interval \otimes v_j}|!{[dl];[dr]}{\hole}
  \ar[dr]^{\interval \otimes s}
&&
  X
  \ar[dd]^(0.35){v_j}|!{[dl];[dr]}{\hole}
  \ar[dr]^{s}
\\&
  X'
  \ar[rr]^-(0.3){\kcylinv \otimes X'}
  \ar[dd]^(0.3){v_{j'}}
&&
  \interval \otimes X'
  \ar@{.>}[rr]^-(0.3){\cod(\bar{\rho}')}
  \ar[dd]^(0.3){\interval \otimes v_{j'}}
&&
  X'
  \ar[dd]^{v_{j'}}
\\
  Y
  \ar[rr]^-(0.25){\kcylinv \otimes Y}|!{[ur];[dr]}{\hole}
  \ar[dr]^{t}
&&
  \interval \otimes Y
  \ar[rr]^-(0.3){\cod(\rho)}|!{[ur];[dr]}{\hole}
  \ar[dr]^{\interval \otimes t}
&&
  Y
  \ar[dr]^{t}
\\&
  Y'
  \ar[rr]^-{\kcylinv \otimes Y'}
&&
  \interval \otimes Y'
  \ar[rr]^-{\cod(\rho')}
&&
  Y'
\rlap{.}}
\]
But this follows from coherence of lifts in the following morphism of lifting problems:
\[
\xymatrix@C+1em{
  X
  \ar@{=}[rrrr]
  \ar[dd]_{\kcylinv \otimes X}
  \ar[dr]^{s}
&&&&
  X
  \ar[dd]_(0.3){v_j}|!{[dlll];[dr]}{\hole}|!{[dddlll];[dr]}{\hole}
  \ar[dr]^{s}
\\&
  X'
  \ar@{=}[rrrr]
  \ar[dd]^(0.66){\kcylinv \otimes X'}
&&&&
  X'
  \ar[dd]^{v_{j'}}
\\
  \interval \otimes X
  \ar[rr]^(0.7){I \otimes v_j}|!{[ur];[dr]}{\hole}
  \ar@{.>}[uurrrr]^(0.67){\cod(\bar{\rho})}|!{[ur];[dr]}{\hole}|!{[ur];[urrrrr]}{\hole} % bug: doesn't work?
  \ar[dr]_{I \otimes s}
&&
  \interval \otimes Y
  \ar[rr]_(0.7){\cod(\rho)}|!{[dl];[urrr]}{\hole}
  \ar[dr]^(0.7){\interval \otimes t}|!{[dl];[urrr]}{\hole}
&&
  Y
  \ar[dr]^{t}
\\&
  \interval \otimes X'
  \ar[rr]_{I \otimes v_{j'}}
  \ar@{.>}[uurrrr]^(0.67){\cod(\bar{\rho}')}
&&
  \interval \otimes Y'
  \ar[rr]_{\cod(\rho')}
&&
  Y'
\rlap{.}}
\]
Here, the left and right faces form morphisms in $\kcylinv \otimes \id_\catE$ and $\liftr{(\kcylinv \otimes \id_\catE)}$, respectively, making the lifts cohere as needed.


By combining the cases $k = 0$ and $k = 1$, we obtain that uniform $\cal{I}'$-fibrations satisfy the uniform Frobenius condition with respect to $\cal{S}_0 + \cal{S}_1$. The claim now follows by functoriality of uniform Frobenius in the form of \cref{uniform-frobenius-functorial} with $H$ the functor $\Fib{\cal{I}} \to \Fib{\cal{I}'}$ obtained in the evident way fromhypothesis (iii) in the definition of a suitable algebraic weak factorisation
system.
\end{proof}





\begin{theorem} \label{uniform-fibrations-uniform-frobenius}
$\Fib{\cal{I}}$ satisfies the uniform Frobenius condition with respect to $\cal{I}_{\otimes}$.
\end{theorem}


\begin{proof} First, we show that uniform $\cal{I}$-fibrations satisfy the uniform Frobenius condition with respect to $\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})$. Recall with the definition of strong homotopy equivalences relative to $\cal{I}$ that $\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})$ is the strict pullback of $\cal{S}_0 + \cal{S}_1 \to \cal{E}$ and $\cal{I} \to \cal{E}$.
Using \cref{uniform-frobenius-product-u}, we may combine the uniform Frobenius conditions for uniform $\cal{I}$-fibrations with respect to $\cal{S}_0 + \cal{S}_1$, provided by \cref{technical}, and with respect to $\cal{I}$, provided by assumption (3).

The fact that uniform $\cal{I}$-fibrations satisfy the uniform Frobenius condition with respect to $\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})$
implies the desired claim, by applying functoriality of uniform Frobenius in the form of \cref{uniform-frobenius-functorial} with $F$ the functor in part~(\ref{thm:onedir}) of~\cref{thm:strong-hequiv} and $G$ the functor in part~(\ref{thm:twodir}) of ~\cref{thm:strong-hequiv}. 
\end{proof}


As special cases, we obtain the pushforward versions of the Frobenius and Beck-Chevalley condition for uniform~$\cal{I}$-fibrations.
First, pushforward lifts to slices of the category of uniform $\cal{I}$-fibrations.

\begin{corollary} \label{uniform-fibrations-frobenius-pushforward} \label{uniform-fibrations-BC-pushforward}
\hfill
\begin{enumerate}[(i)] 
\item For every uniform $\cal{I}$-fibration
$p \co X \to Y$, pushforward along $p$ lifts to a functor
\[
\xymatrix@C+2em{
  \Fib{\cal{I}}_{/X}
  \ar[r]^{p_*}
  \ar[d]
&
  \Fib{\cal{I}}_{/Y}
  \ar[d]
\\
  \catE_{/X}^\to
  \ar[r]_{p_*}
&
  \catE_{/Y}^\to
\rlap{.}}
\]
\item For every map of uniform $\cal{I}$-fibrations $(s, t) \co p \to q$ , where $p \co X \to Y$ and $q \co U \to V$, the canonical natural transformation $\psi \co t^* q_* \to p_* s^*$ lifts to a natural transformation
\[
\xymatrix@C+2em{
  \Fib{\cal{I}}_{/U}
  \ar[r]^{q_*}
  \ar[d]_{s^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle \psi'$}}
&
  \Fib{\cal{I}}_{/V}
  \ar[d]^{t^*}
\\
  \Fib{\cal{I}}_{/X}
  \ar[r]_{p_*}
&
  \Fib{\cal{I}}_{/Y}
\rlap{.}}
\]
If $(s, t) \co p \to q$ forms a pullback square, then $\psi'$ is a natural isomorphism.
\end{enumerate}
\end{corollary}


\begin{proof}
For (i), the claim follows from~\cref{uniform-fibrations-uniform-frobenius}. For (ii), the claim follows from \cref{lift-pushforward-BC}.
and \cref{uniform-fibrations-uniform-frobenius}.
\end{proof}




\begin{theorem} \label{frobenius-uniform-presheaf}
Let $\catE$ be a presheaf category equipped with a functorial cylinder $I \otimes (-) \co \catE \to \catE$ with 
contractions and connections. Let $\cal{M}$ be a category of monomorphisms.
Then uniform $\cal{M}$-fibrations are the right maps of an algebraic weak factorization system that satisfies the functorial Frobenius property.
\end{theorem}

\begin{proof}
This follows from~\cref{thm:frobenius-comparison} and~\cref{uniform-fibrations-uniform-frobenius}, recalling that $\cal{M}$ gives rise to a suitable algebraic weak factorisation
system.
\end{proof}

In particular, in the setting of~\cref{frobenius-uniform-presheaf}, for a uniform $\cal{M}$-fibration $p \co X \to Y$, pushforward along $p$ lifts to a functor $p_* \co \Fib{\cal{M}}_{/X} \to \Fib{\cal{M}}_{/Y}$, 
and so the pushforward of a uniform $\cal{M}$-fibration along a uniform $\cal{M}$-fibration is again a uniform $\cal{M}$-fibration.

\begin{example}[The uniform Frobenius condition for uniform Kan fibrations in simplicial sets]
Noting that the assumptions of \cref{frobenius-uniform-presheaf} are fulfilled in simplicial sets with $\cal{M}$ the category of all
monomorphisms and pullback squares, we obtain that pushforward along a uniform Kan fibration preserves uniform Kan fibrations in $\SSet$.
We consider this a constructive counterpart of the result that the pushforward along a Kan fibration preserves Kan fibrations (a fact that is equivalent to right properness for the model structure, see also \cite[Lemma 4.3.1]{voevodsky-simplicial-model}), which cannot be proved constructively~\cite{coquand-non-constructivity-kan}.

Since exponentiation is a special case of pushforward, this result shows also that the exponential of two uniform Kan complexes (defined in the evident way) is again a uniform Kan complex.
In fact, as usual, only the base needs to be assumed uniform Kan.
This can be seen as follows.
Let $p \co Y \to X$ be a uniform Kan fibration and $i \co A \to B$ be a monomorphism.
Recall that $\cal{S}_k(\cal{M})$ is closed under Leibniz product with $i$ for $k \in \braces{0, 1}$ (it is true separately for $\cal{S}_k$ and $\cal{M}$).
By Leibniz adjointness (\cref{lift-of-leibniz-adjunction}), we have that $\hatexp(i, p)$ is again a uniform Kan fibration.
The above statement is then the special case $X \defeq 1$ and $A \defeq 0$.
\end{example}

\begin{example}[The uniform Frobenius condition for uniform Kan fibrations in cubical sets]
Noting that the assumptions of \cref{frobenius-uniform-presheaf} are fulfilled in cubical sets, we obtain that pushforward along a uniform Kan fibration preserves uniform Kan fibrations in $\CSet$.
Insufficiency of the standard notion of cubical Kan fibration for a constructive proof of this statement should follow by an argument analogous to the one used for simplicial sets in~\cite{coquand-non-constructivity-kan}.
\end{example}


\newpage

\section{Relating fibrations and uniform fibrations}
\label{sec:non-alg}

The aim of this section%
\footnote{Readers interested in constructive aspects should note that the law of excluded middle and the axiom of choice are used in this section.}
is to study the notion of a uniform (trivial) $\cal{M}$-fibration in the context of presheaf categories over elegant Reedy presheaves, in the sense of \cite{bergner-rezk-elegant}, equipped with a functorial cylinder whose endofunctor has a right adjoint.%
\footnote{It might be possible to adapt our arguments to a weaker setting where instead of having a right adjoint, the functorial cylinder only preserves certain colimits, but we do not pursue this direction here since our examples satisfy the stronger condition.}
In particular, we introduce the notion of a (trivial) fibration and fibration in that setting, generalizing in an essentially straightforward way the definitions of the notion of a (trivial) Kan fibration in simplicial sets.
We then show that every (trivial) fibration admits the structure of a uniform (trivial) $\cal{M}$-fibration for any choice of~$\cal{M}$ as a full subcategory of monomorphisms of $\cal{E}_{\cart}^\to$, thereby establishing how our notions relate to more familiar ones.
The primary role of elegancy is to allow us to factor any map in $\cal{M}$ into a series of cobase changes of boundary inclusions, allowing us to decompose lifting problems for uniform trivial $\cal{M}$-fibrations into lifting problems for trivial fibrations.
Let us begin by reviewing some terminology.

\begin{definition}
A \emph{Reedy category} $(\R, \deg, \Rp, \Rm)$ is a category $\R$ equipped with a \emph{degree function} $\deg \co \obj(\R) \to \alpha$, where $\alpha$ is some ordinal, and wide subcategories $\Rp, \Rm$ satisfying the following properties:
\begin{enumerate}[(i)]
\item the maps of $\Rp$, called \emph{cofaces}, are monotone with respect to $\deg$,
\item the maps of $\Rm$, called \emph{codegeneracies}, are antimonotone with respect to $\deg$,
\item every map in $\R$ is assumed to factor uniquely as a codegeneracy followed by a coface,
\item the only isomorphisms in $\R$ are identities.
\end{enumerate}
\end{definition}

For every degree $n < \alpha$, we have a \emph{skeleton} comonad $\Sk_{<n}$ and a \emph{coskeleton} monad $\Cosk_{<n}$ on $\catE = \Psh(\R)$ (both idempotent) forming an adjunction $\Sk_{<n} \dashv \Cosk_{<n}$ derived from left and right Kan extension along the full embedding $\R_{<n} \to \R$ of objects of degree less than $n$.
Given a presheaf $F$ on $R$, an element $x \in F(A)$ is called \emph{degenerate} and a \emph{degeneracy of} $y \in F(B)$ if there is non-identity $d \co A \to B$ in $\Rm$ such that $x = Fd(y)$.
The notion of an elegant Reedy category, recalled below, was introduced originally in~\cite{bergner-rezk-elegant}.

\begin{definition}
A Reedy category~$\R$ is said to be \emph{elegant} if every element in any presheaf on~$\R$ is a degeneracy in a unique way.
\end{definition}

For example, the simplex category $\Delta$ is an elegant Reedy category.
In an elegant Reedy category $\R$, the action of $\Sk_{<n}$ can be described as keeping only the non-degenerate elements of degree strictly less than $n$: for any $X \in \Psh(\R)$, the counit $\Sk_{<n}(X) \to X$ of the skeleton comonad on $X$ is a monomorphism.
Given $A \in \R$, the \emph{boundary} of $A$ is defined as $\partial A \defeq \Sk_{<\deg(A)}(\yon A)$.
The counit of $\Sk_{<\deg(A)}$ induces a \emph{boundary inclusion} monomorphism $i^A \co \partial A \to \yon A$.

\medskip

For the remainder of this section, we fix an elegant Reedy category~$\R$ and consider the category~$\calE \defeq \Rhat$ of presheaves over it.%
\footnote{Note that our use of elegant Reedy presheaves is different from the one considered in~\cite{shulman:reedy} since here presheaves are valued in the category of sets, not in simplicial sets.}
We start by defining the following notion of a (trivial) fibration (\cf also \cref{cisinski-remark}).

\begin{definition}
Let $\cal{I}$ be the discrete subcategory of $\catE^{\to}$ consisting of boundary inclusions $\partial A \to \yon A$.
We define:
\begin{enumerate}[(i)]
\item a \emph{trivial fibration} is a right $\cal{I}$-map,
\item a \emph{fibration} is a right $\cal{I}_\otimes$-map.
\end{enumerate}
\end{definition}

Using the axiom of choice, a map is a trivial fibration if and only if it has the right lifting property against boundary inclusions.
In the case of simplicial sets, these notions then coincide with the classical notions of trivial Kan fibration and Kan fibration~\cite[Chap.~IV, Sec.~2]{gabriel-zisman:calculus-of-fractions}.

\medskip

We first establish the equivalence between trivial fibrations and uniform trivial $\cal{M}$-fibrations (note that \cref{awfs-on-arrows-into-representables} cannot be applied here since the class of boundary inclusions as a discrete category does not represent the added coherence of $\cal{N}$).
For this, we require an auxiliary notion.

\begin{definition}
A \emph{regular trivial fibration} is a right $\cal{J}$-map, where $\cal{J}$ is the subcategory of~$\catE^{\to}$ that has as objects boundary inclusions $\partial A \to \yon A$ and identity maps $\id_{\yon A} \co \yon A \to \yon A$, and as non-identity morphisms commutative squares
\[
\xymatrix{
  \partial A_1
  \ar[r]
  \ar[d]
&
  \yon A_2
  \ar[d]
\\
  \yon A_1
  \ar[r]_{\yon(d)}
&
  \yon A_2
}
\]
where $d \co A_1 \to A_2$ is in $\Rm$ and non-trivial, \ie not an identity map.
\end{definition}

In the above definition, the category $\cal{J}$ has been chosen so that a regular trivial fibration consists of a map equipped with a choice of right lifts against boundary inclusions such that the lifts are given by degenerate elements whenever those already constitute a lift.
In particular, any two degenerate lifts must coincide.
This explains why we have to restrict $d \co A_1 \to A_2$ to non-identity maps: without this restriction, regular trivial fibrations would have unique lifts against boundary inclusions, which is too restrictive.

Below, we start by proving that every trivial fibration admits the structure of a regular trivial fibration (\cref{trivial-fibration-to-regular}).
Then, we show that every regular trivial fibration admits the structure of a uniform trivial fibration~(\cref{regular-trivial-fibration-to-uniform}).
The combination of these facts shows that every trivial fibration can be equipped with the structure of a uniform trivial fibration, from which the corresponding result for fibrations follows easily.

\begin{proposition} \label{trivial-fibration-to-regular}
Every trivial fibration can be equipped with the structure of a regular trivial fibration.
\end{proposition}

\begin{proof}
Consider a lifting problem as follows:
\begin{equation} \label{trivial-fibration-to-regular:0}
\begin{gathered}
\xymatrix{
  \partial A
  \ar[d]_{i^A}
  \ar[r]^{s}
&
  X
  \ar[d]^{p}
\\
  \yon A
  \ar[r]^{t}
&
  Y
\rlap{.}}
\end{gathered}
\end{equation}
We need to choose a filler for it such that for every non-trivial codegeneracy $d \co A \to B$ and factorization of~\eqref{trivial-fibration-to-regular:0} as below,
\begin{equation} \label{trivial-fibration-to-regular:1}
\begin{gathered}
\xymatrix@C+3em{
  \partial A
  \ar[r]^{\yon(d) \cc i^A}
  \ar[d]_{i^A}
  %\ar@/^2em/[rr]^{s}
&
  \yon B
  \ar@{.>}[r]^{s'}
  \ar@{=}[d]
&
  X
  \ar[d]^{p}
\\
  \yon A
  \ar[r]_{\yon(d)}
  %\ar@/_2em/[rr]_{t}
&
  \yon B
  \ar@{.>}[r]_{t'}
&
  Y
\rlap{,}}
\end{gathered}
\end{equation}
the chosen filler for the now composite square coheres with the unique filler for the right square.

We do this by case distinction on whether a factorization~\eqref{trivial-fibration-to-regular:1} exists at all.
If none exist, we choose the filler provided to us by $p$ being a trivial fibration.
If one exists, we choose $s' \cc \yon(d)$ as filler.

It only remains to justify that the latter choice is independent of the particular factorization.
This is where we use the assumption that the Reedy category $\R$ is elegant.
\cref{pushout-non-trivial-deg-boundary} below shows that any two factorings through non-trivial codegeneracies $d_1$ and $d_2$ extend to a common factoring through the pushout of $d_1$ and $d_2$, yielding independence as required.
Note this also shows the existence of a unique largest factoring since $\alpha$ is well-founded.
\end{proof}

\begin{lemma} \label{pushout-non-trivial-deg-boundary}
Let $d_i \co A \to B_i$ be a non-trivial codegeneracy for $i \in \braces{1, 2}$.
Then the span $(d_1, d_2)$ has a pushout $(e_1, e_2)$ with $e_i \co B_i \to C$ a codegeneracy for $i \in \braces{1, 2}$.
The image of this square under the Yoneda embedding is again a pushout.
Furthermore, this pushout is stable under right composition with the boundary inclusion $i^A \co \partial A \to \yon A$.
\end{lemma}

\begin{proof}
Everything up until the last sentence is part of the characterization of elegancy in~\cite[Proposition~3.8]{bergner-rezk-elegant}.
For the remaining claim, note that right composing the pushout square under consideration with $\partial A \to \yon A$ is tantamount to applying $\Sk_{<\deg(A)}$ to the square since we assumed $d_1, d_2$ to be non-trivial, \ie degree reducing.
But $\Sk_{<\deg(A)}$ is a left adjoint and hence preserves pushouts.
\end{proof}

Note that the construction of \cref{trivial-fibration-to-regular} does not seem to extend to a functor from the category of trivial fibrations to the category of regular trivial fibrations over $\catE^{\to}$.

\medskip

We now relate regular trivial fibrations with uniform trivial $\cal{M}$-fibrations.
For this, we review how to reduce a lifting problem involving a monomorphism to lifting problems involving boundary inclusions.

\begin{definition} \hfill
\begin{enumerate}[(i)]
\item A \emph{cellular presentation} of a monomorphism $i \co U \to V$ in $\catE$ is a cocontinuous ordinal-indexed diagram $F \co \gamma \to \catE_{\backslash U}$ with colimit $i$
\[
\xymatrix{
  U = F 0
  \ar[r]^-{F s_0}
&
  F 1
  \ar[r]^{F s_1}
&
  \ldots
  \ar[r]
&
  V
}
\]
such that for $\beta + 1 < \gamma$, the image of a successor step $s_{\beta} \co \beta \to \beta + 1$ under $F$ is a (possibly infinite) coproduct of boundary inclusions.
\item A \emph{morphism of cellular presentations} from $F \co \gamma \to \cal{E}_{\backslash U}$ to $G \co \delta \to \cal{E}_{\backslash U}$ is a map $h \co \delta \to \gamma$ such that $F \simeq G \cc h$.
\end{enumerate}
\end{definition}

Note that a transfinite composition of cobase changes of coproducts of cellular presentations can be flattened to a single cellular presentation.

\begin{remark} \label{elegant-reedy-lift-independent-of-cellular-presentation}
Let $p \co X \to Y$ be a trivial fibration and $i \co A \to B$ a monomorphism.
Any cellular presentation of $i$ induces a lifts of $i$ against $p$.
If $R$ is elegant, such a lift exists and is uniquely determined independent of chosen the cellular presentation.

Existence follows by using the \emph{canonical cellular presentation} $F \co \alpha \to \cal{E}$ of $i$, in which the $\beta$-th successor step adds the non-degenerate representables of degree $\beta$ in $V$ not contained in $U$ (see \cite{riehl-verity:reedy} for a categorical exposition).
For uniqueness, we may for example show that any other cellular presentation $G \co \gamma \to \cal{E}$ of $i$ induces the same lift against $p$ as $F$.
Given $\beta \leq \alpha$, we may restrict the coproduct index set in each pushout step in $G$ to objects of degree less than $\beta$ so as to obtain a cellular presentation $G'_\beta$ of $A \to F \beta$.
By transfinite induction over $\beta$, standard reasoning in the theory of Reedy presheaves (via a nested transfinite induction in the successor case) may then be applied to show that $G'$ induces the same lift of $A \to F \beta$ against $p$ as $F|_{\beta}$.
\end{remark}

\begin{proposition} \label{regular-trivial-fibration-to-uniform}
Every regular trivial fibration can be equipped with the structure of a uniform trivial $\cal{M}$-fibration.
\end{proposition}

\begin{proof}
Let $p \co X \to Y$ be a regular trivial fibration.
Let $i \co U \to V$ be a monomorphism in $\cal{M}$ and consider a lifting problem as follows:
\begin{equation} \label{regular-trivial-fibration-is-uniform:0}
\begin{gathered}
\xymatrix{
  U
  \ar[d]_{i}
  \ar[r]
&
  X
  \ar[d]^{p}
\\
  V
  \ar[r]
  \ar@{.>}[ur]
&
  Y
\rlap{.}}
\end{gathered}
\end{equation}
We use the regular trivial fibration structure of $p$ to construct the filler in~\eqref{regular-trivial-fibration-is-uniform:0} via any cellular presentation of $i$ following \cref{elegant-reedy-lift-independent-of-cellular-presentation} (using that $\R$ is elegant).

It remains to verify coherence of fillers with respect to pullback squares between monomorphisms in $\cal{M}$:
\begin{equation} \label{regular-trivial-fibration-is-uniform:1}
\begin{gathered}
\xymatrix{
  U'
  \ar[d]_{i'}
  \ar[r]
  \pullback{dr}
&
  U
  \ar[d]_(0.3){i}
  \ar[r]
&
  X
  \ar[d]^{p}
\\
  V'
  \ar[r]
  \ar@{.>}[urr]
&
  V
  \ar[r]
  \ar@{.>}[ur]
&
  Y
\rlap{.}}
\end{gathered}
\end{equation}
Choose a cellular presentation for $i$.
Pullback along $V' \to V$ induces a corresponding transfinite decomposition of $i'$ into cobase changes of coproducts of monomorphisms.
Since the fillers for squares~\eqref{regular-trivial-fibration-is-uniform:0} are independent of the chosen cellular presentation, it suffices to verify coherence of fillers in~\eqref{regular-trivial-fibration-is-uniform:1} with $i$ replaced by a single boundary inclusion as in~\eqref{regular-trivial-fibration-is-uniform:2} below and apply transfinite induction to the chosen cellular presentation for $i$.

It remains to verify coherence of fillers with respect to base changes of boundary inclusions as follows:
\begin{equation} \label{regular-trivial-fibration-is-uniform:2}
\begin{gathered}
\xymatrix{
  U'
  \ar[d]_{i'}
  \ar[r]
  \pullback{dr}
&
  \partial A
  \ar[d]_(0.3){i^A}
  \ar[r]
&
  X
  \ar[d]^{p}
\\
  V'
  \ar[r]_{m}
  \ar@{.>}[urr]^(0.3){e'}
&
  \yon A
  \ar[r]
  \ar@{.>}[ur]_{e}
&
  Y
\rlap{.}}
\end{gathered}
\end{equation}
Choose a cellular presentation $F \co \gamma \to \catE \backslash U'$ for $i'$.
For $\beta < \gamma$, let $e_{\beta}' \co F(\beta) \to X$ denote the $\beta$-th stage of the construction of the composite filler $e'$ in~\eqref{regular-trivial-fibration-is-uniform:2} and write $t_{\beta} \co F(\beta) \to V'$ for the leg of the colimiting cocone of $V'$ under $F$.
Note that $e_{\beta}' = e' t_{\beta}$.
We will show that $e' t_{\beta} = e m t_{\beta}$ by transfinite induction on $\beta$.
Passing to the colimit, it will then follow that $e' m = e$ as required.

For the actual induction, the limit step similarly follows by passing to the colimit.
For the successor step, let $\beta$ with $\beta + 1 < \gamma$ be given.
We want to show $e_{\beta+1}' = e m t_{\beta+1}$ assuming that $e_{\beta}' = e m t_{\beta}$, \ie
\begin{equation} \label{regular-trivial-fibration-is-uniform:ih}
  e_{\beta+1}' \cc F(s_{\beta}) = e m t_{\beta+1} \cc F(s_{\beta}) \, .
\end{equation}
Here we have recalled that $e_{\beta}' = e_{\beta+1}' \cc F(s_{\beta})$ and $t_{\beta} = t_{\beta+1} \cc F(s_{\beta})$ where $F(s_{\beta})$ is given as a cobase change of a coproduct of boundary inclusions.
It will suffice to focus on one such boundary inclusion as shown below:
\begin{equation} \label{regular-trivial-fibration-is-uniform:3}
\begin{gathered}
\xymatrix{
  \bullet
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  U'
  \ar[rr]
  \ar[d]
  \pullback{dr}
&&
  \partial A
  \ar[r]
  \ar[dd]_(0.6){i^A}
&
  X
  \ar[dd]^{p}
\\
  \partial B
  \ar[r]^{b'}
  \ar[d]_{i^B}
  \pullback{dr}
&
  F(\beta)
  \ar[d]_{F(s_{\beta})}
  \ar@{.>}[urrr]^(0.4){e_{\beta}'}
\\
  \yon B
  \ar[r]_-{b}
&
  F(\beta+1)
  \ar[r]_-{t_{\beta+1}}
  \ar@{.>}[uurrr]_(0.4){e_{\beta+1}'}
&
  V'
  \ar[r]_{m}
&
  \yon A
  \ar[r]
  \ar@{.>}[uur]^{e}
&
  Y
\rlap{,}}
\end{gathered}
\end{equation}
and verify that $e_{\beta+1}' b = e m t_{\beta+1} b$, which will be our goal for the remainder of this proof.
Here, the right pullback is derived from the pullback in~\eqref{regular-trivial-fibration-is-uniform:2} using that $t_{\beta+1}$ is mono.
Recall that $e_{\beta+1}' b$ is by construction the filler for the above lifting problem from $i^B$ to $p$ provided by the given right lifting structure of $p$.

Write $m t_{\beta+1} b = \yon(d)$ with $d \co B \to A$.
Note that $d$ has to be codegenerate.
For otherwise, we would have $\yon(d)$ lifting through $i^A \co \partial A \to \yon A$.
Recalling that the base change of $i^A$ along itself is an isomorphism since $i^A$ is mono, it would follow that the base change of $i^A$ along $\yon(d)$ is an isomorphism as well.
But as seen in~\eqref{regular-trivial-fibration-is-uniform:3}, this isomorphism would lift through $i^B$, making $i^B$ a retraction and hence an isomorphism, a contradiction.

We proceed by case distinction on whether $d$ is the identity on $A$, \ie $B = A$ and $m t_{\beta+1} b = \id_A$.
If that is the case, then the goal reduces to $e_{\beta+1}' b = e$.
But $e$ and $e_{\beta+1}' b$ are fillers for the same lifting problem from $i^A$ to $p$.
Since they have both been provided by the given right lifting structure of $p$, they are equal.

The remaining and main case is that $d$ is non-trivially codegenerate.
But then we can make use of $\cal{J}$-coherence in the following comparison of lifting problems:
\[
\xymatrix{
  \partial B
  \ar[r]
  \ar[d]_{i^B}
  \pullback{dr}
&
  F(\beta)
  \ar[rr]
  \ar[d]_{F(s_{\beta})}
&&
  \yon A
  \ar[r]^{e}
  \ar@{=}[d]
&
  X
  \ar[d]^{p}
\\
  \yon B
  \ar[r]_-{b}
  \ar@{.>}[urrrr]_(0.6){e_{\beta+1}' b}
&
  F(\beta+1)
  \ar[r]_-{t_{\beta+1}}
&
  V'
  \ar[r]_-{m}
&
  \yon A
  \ar[r]
  \ar@{.>}[ur]_{e}
&
  Y
\rlap{.}}
\]
Commutativity of the top triangle of the composite square follows from the induction hypothesis~\eqref{regular-trivial-fibration-is-uniform:ih}.
Recalling that the dotted fillers are provided by the given right lifting structure of $p$ as a regular trivial fibration, they cohere as needed.
\end{proof}

\begin{theorem} \label{thm:ac-kan-is-uniform}
Let $\catE$ be the category of presheaves over an elegant Reedy category, equipped with a functorial cylinder $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes(-))$ such that the functor $\interval \otimes (-) \co \catE \to \catE$ has a right adjoint.
Let $\cal{M}$ be a full subcategory of $\cal{E}_{\cart}^\to$ of monomorphisms.
\begin{enumerate}[(i)]
\item Every trivial fibration admits the structure of a uniform trivial $\cal{M}$-fibration,
\item Every fibration admits the structure of a uniform $\cal{M}$-fibration.
\end{enumerate}
\end{theorem}

\begin{proof}
Part~(i) follows by \cref{trivial-fibration-to-regular} and \cref{regular-trivial-fibration-to-uniform}.
For part~(ii), let $p \co X \to Y$ be a fibration.
By the standard counterpart of \cref{prod-exp-general}, it follows that $\hatexp(\bar{\delta}^k, p)$ is a trivial fibration for $k \in \braces{0, 1}$, and hence a uniform trivial $\cal{M}$-fibration by part~(i).
The claim then follows by \cref{prod-exp-general}.
\end{proof}





\bibliographystyle{plain}
\bibliography{../../common/uniform-kan-bibliography}

\end{document}
