\documentclass[reqno,10pt,a4paper,oneside,draft]{amsart}

\setcounter{tocdepth}{1}
% \usepackage[parfill]{parskip}

\usepackage{uniform-kan-prelude}

\title{Uniform fibrations and the Frobenius condition}

\begin{document}

\begin{abstract}
We introduce and study the notion of a uniform fibration in categories with a functorial cylinder.
We show that in a wide class of presheaf categories, including simplicial sets and cubical sets with connections, uniform fibrations are the right class of an algebraic weak factorization system that satisfies the functorial Frobenius condition.
This implies that pushforward along a uniform fibration preserves uniform fibrations.
When instantiated in simplicial sets, this result solves the open problem of
finding a constructive counterpart of one of the key facts underpinning Voevodsky's simplicial model of univalent foundations and gives a new proof of the right properness of
the Quillen model structure for Kan complexes. In cubical sets, it extends results by Coquand and others.
\end{abstract}

\author{Nicola Gambino}
\address{School of Mathematics, University of Leeds, Leeds LS2 9JT, UK}
\email{n.gambino@leeds.ac.uk}

\author{Christian Sattler}
\address{School of Mathematics, University of Leeds, Leeds LS2 9JT, UK}
\email{c.sattler@leeds.ac.uk}

\date{\today}

\maketitle

%\tableofcontents

\section*{Introduction}

Bousfield's weak factorization systems~\cite{bousfield-wfs} are a cornerstone of 
modern homotopical algebra~\cite{quillen-homotopical}, not least because they support a very elegant treatment 
of Quillen model categories~\cite{joyal-tierney-notes}. Yet, they have some unsatisfactory 
aspects, such as the failure of left and right maps to be closed under all colimits.
These issues can be
remedied by considering algebraic weak factorisation  systems~\cite{garner:small-object-argument,grandis-tholen-nwfs}, 
which involve maps equipped with a suitably natural
family of solutions for lifting problems, rather than maps merely satisfying
a lifting property. Remarkably, the presence of this additional algebraic structure on maps has proved to be crucial  for  applications of algebraic weak factorization systems in
hi\-gher-di\-men\-sional category theory~\cite{batanin-cisinski-weber,garner:globular-operator-awfs,garner-homomorphisms}
and in Voevodsky's univalent foundations programme~\cite{awodey-cubical,coquand-cubical-sets,cohen-et-al:cubicaltt,pitts-cubical-nominal,swan-awfs}.  
  
 Our general aim here is to develop further the theory of algebraic weak factorization systems and provide some new 
 applications. In particular, we introduce the 
 notion of uniform (trivial) fibration in  a category with a functorial cylinder
and use it to construct algebraic weak factorization systems on presheaf categories, obtaining 
  algebraic generalizations of some important results of Cisinski 
on Quillen model structures on presheaf categories~\cite{cisinski-asterisque}.
As applications of our results, we  solve an open problem in the univalent foundations programme, namely that of proving a constructive version of the
 fact that pushforward along Kan fibrations preserves Kan fibrations ~\cite{coquand-non-constructivity-kan,voevodsky-simplicial-model}. We also obtain a new proof of the right 
 properness of the Quillen model structure for Kan complexes~\cite{quillen-homotopical}, 
 which avoids entirely the use of topological realization~\cite{hovey-model-categories} and
 the theory of minimal fibrations~\cite{joyal-tierney:simplicial-homotopy-theory}.

We are particularly  interested in the property of weak factorization systems  
known as the Frobenius 
condition~\cite[Definition~3.2.1]{garner:types-omega-groupoids}.\footnote{See~\cite{clementino:frobenius}
for an explanation of the connection with Lawvere's Frobenius reciprocity 
condition~\cite{lawvere-equality}.}
One of the reasons for the interest in this condition, 
which asserts that  the pullback along a right map preserves left maps, is that it is closely related to the
right properness condition for a Quillen model structure, which asserts that pullback along a fibration preserves weak 
equivalences. Indeed, for 
a Quillen model structure in which the cofibrations are the monomorphisms, such as the Cisinski model structures~\cite{cisinski-asterisque},   
right properness  is equivalent to the Frobenius condition for the  weak factorization system of acyclic cofibrations and fibrations. 
Furthermore, when  pushforwards along right maps exist, \ie pullbacks along  right maps have right adjoints, the Frobenius condition
is equivalent to the preservation of right maps by pushforward along a right map. In the category of simplicial sets, this amounts exactly to the preservation of Kan fibrations by pushforward along Kan fibrations mentioned above, 
a result that plays an important role in the definition of the simplicial model of univalent foundations~\cite[Lemma~2.3.1]{voevodsky-simplicial-model}. The Frobenius condition is also intimately related to the homotopy-theoretic aspects of Martin-L\"of rules for identity types~\cite{gambino-garner:idtypewfs}.

When working with algebraic weak factorization systems, it is natural to consider the functorial
Frobenius condition introduced by Garner and van den Berg in~\cite{garner:topological-simplicial}, which involves
both a version of the usual Frobenius condition for maps, but  also a Beck-Chevalley condition~\cite{benabou-descente,lawvere-equality} for morphisms of maps (\ie commutative squares).\footnote{In~\cite{garner:topological-simplicial},
the functorial Frobenius condition was actually formulated for cloven weak factorization systems,
which are slighly more general then algebraic weak factorization systems.} Since algebraically-free algebraic 
weak factorization systems, such as those produced by Garner's small object
argument~\cite{garner:small-object-argument}, 
play an important role in our development, we  
isolate conditions on the generating category of an algebraically-free algebraic weak factorization system that are necessary and sufficient for the algebraic weak factorization system to satisfy the functorial Frobenius condition. 
In order to do so, we introduce what we call the uniform Frobenius condition, which provides a convenient and flexible
concept to organize our analysis.

The development in this paper leads up to the proof of the existence of algebraic weak factorization systems 
with the functorial Frobenius condition on presheaf categories equipped with a functorial cylinder  (\cref{frobenius-uniform-presheaf}). The right maps of these algebraic
weak factorization systems are uniform (trivial) fibrations, which we define  in the general setting of a  category equipped with a functorial cylinder, building on
ideas of Cisinski~\cite{cisinski-asterisque}:
uniform trivial fibrations are defined by algebraic  orthogonality (\ie by requiring a choice
of diagonal fillers satisfying a naturality condition) with respect to a category~$\mathcal{M}$ of monomorphisms and pullback squares, while uniform fibrations are defined by algebraic orthogonality  with respect to a category obtained by applying a Leibniz construction 
(in the sense of~\cite{riehl-verity:reedy}) to the endpoint inclusions of the functorial cylinder and~$\cal{M}$.

Our first main result (\cref{thm:sset-cset-nwfs}) is that uniform trivial fibrations and uniform fibrations in presheaf categories equipped with a functorial cylinder
are the right maps of two algebraic weak factorization systems.
This is proved using Garner's small object argument~\cite{garner:small-object-argument}, after having shown that uniform (trivial) fibrations can be be defined equivalently by algebraic orthogonality with respect to a small category of maps (\cref{small-gen-triv-kan}).
Working with algebraic notions of fibrations is essential to prove this fact, since it allows us to rephrase a general lifting problem as a colimit of a functorial family of lifting problems, providing
a further example of the good interaction between colimits and lifting problems
in algebraic weak factorization systems.

Our second main result (\cref{thm:ac-kan-is-uniform}) shows in what sense the notion of a uniform (trivial) fibration subsumes the standard notion of a (trivial) fibration, defined by 
a weak orthogonality property. In particular, we show that, in a presheaf category over an elegant Reedy category~\cite{bergner-rezk-elegant}, a map can be equipped with the structure of a uniform (trivial) fibration if and only if it satisfies the right lifting property (without any uniformity condition) with respect to the maps involved in the definition of a uniform (trivial) fibration.
In order to obtain this result, we will need to develop a careful decomposition of the lifting problems involved in the uniformity condition.

For our third main result, we return to consider the general setting categories equipped with a functorial cylinder with connections and show that, under mild assumptions, uniform fibrations satisfy the uniform Frobenius condition (\cref{uniform-fibrations-uniform-frobenius}). As a direct application, we obtain that the algebraic weak factorization systems on presheaf categories with uniform fibrations as right maps constructed earlier in the paper satisfy the uniform Frobenius condition (\cref{frobenius-uniform-presheaf}).

When instantiated to simplicial sets, this result implies that 
the algebraic weak factorization system 
with uniform Kan fibrations as right maps satisfies the 
Frobenius property, and therefore pushforward along a uniform Kan fibration
preserves uniform Kan fibrations. 
Since our proof is constructive, \ie avoids the the use of the law of excluded middle and the axiom of choice, 
this solves the open problem of obtaining a constructive counterpart of the fact, mentioned above, that pushforward along a  Kan fibration preserves  Kan fibrations, which cannot be proved constructively~\cite{coquand-non-constructivity-kan}. Because of this, it seems therefore natural to regard the independence result in~\cite{coquand-non-constructivity-kan} simply as an indication that the standard notion of a Kan fibration is not suitable for developing simplicial homotopy theory constructively, rather than as evidence that the simplicial setting is inherently non-constructive. Furthermore, we obtain a new, purely combinatorial proof of the right properness of the Quillen model structure for Kan complexes that avoids the use of minimal fibrations.
When instantiated in the category of cubical sets with connections, instead, \cref{frobenius-uniform-presheaf} gives  a new  
proof of the fact that pushforward along a uniform Kan fibration preserves uniform Kan fibrations~\cite{cohen-et-al:cubicaltt}. This proof avoids entirely complex calculations with cubical sets (\cf~\cite{huber-thesis}). Indeed, one of the initial motivations for this work was to explore whether the theory of uniform fibrations
in cubical sets could be developed at a greater level of generality, so as to make it applicable also to simplicial sets. 


\subsection*{Remarks} For brevity, we do not always discuss the special cases  of our results on algebraic
weak factorization systems  for standard weak factorization systems.
Such results can be readily obtained  by replacing 
the existence of structure in the algebraic setting with the satisfaction of properties,
functors between categories with inclusions between
classes, pullbacks with intersections, and so on. This idea is illustrated in 
a few examples in the first sections of the paper and then highlighted only 
when it is of particular interest.

In the hope of making the paper more widely accessible, we also
confine comments on constructivity issues to a series of remarks and footnotes.
However,
let us point out here for the interested readers  that
 our development does not rely on the law of the excluded middle or the axiom of choice, apart  from~\cref{thm:sset-cset-nwfs} and the results in~\cref{sec:non-alg}. For~\cref{thm:sset-cset-nwfs}, we argue that the result holds constructively for simplicial sets and
cubical sets separately, in~\cref{rem:constructive-small-object}.\footnote{A constructive proof 
of~\cref{thm:sset-cset-nwfs} in full generality would require an analysis of aspects
of the theory of locally presentable categories and of Garner's small object argument 
which we leave for future investigation.} For the results in~\cref{sec:non-alg}, where we show how the classical notion of a fibration is equivalent to the uniform one, the use of the axiom of choice seems unavoidable.


\subsection*{Organization of the paper}
Section~\ref{sec:ortf} establishes basic facts about orthogonality functors.  In Section~\ref{sec:frobc}
we introduce the Frobenius, Beck-Chevalley, and uniform Frobenius conditions and relate them
to the functorial Frobenius condition. Section~\ref{sec:unif} introduces uniform fibrations, giving examples of these notions in presheaf categories in general and in simplicial and cubical sets in particular,
and establishing the existence of algebraic weak factorization systems with uniform (trivial) fibrations as right maps.
The relationship between uniform fibrations and their standard counterparts
 is studied in \cref{sec:non-alg}.
After establishing some auxiliary results in \cref{sec:unifshe} on strong homotopy equivalences, we prove the uniform Frobenius property for 
uniform fibrations in~\cref{sec:frocuf}.
Appendix~\ref{app:tecp} contains the proof of a technical lemma.

\subsection*{Acknowledgements}
We are grateful to Steve Awodey, Simon Huber, and Andrew Swan for helpful discussions on the cubical model of type theory; to Emily Riehl for insightful comments on algebraic weak factorization systems; and to Richard Garner for pointing us to useful references.

This material is based on research sponsored by the Air Force Research Laboratory, under agreement number FA8655-13-1-3038, by a grant from the John Templeton Foundation, and by an EPSRC grant (EP/M01729X/1).





\section{Categories of orthogonal maps}
\label{sec:ortf}

Let us begin by fixing some notation. For a category $\catE$, we write $\cal{E}^\to$ for the category of arrows and commutative squares in $\cal{E}$, and $\cal{E}^\to_{\cart}$ for the
subcategory of $\cal{E}^\to$ with pullback squares as maps. 
We are interested in algebraic generalizations of the weak orthogonality properties that are used in the definition of a weak factorization system. For this, we do not consider a mere class of arrows in a category $\catE$ and defining its left or right orthogonal class, but rather a category~$\cal{I}$, to be thought of as an indexing category, and a functor~$u \co \cal{I} \to \catE^\to$.
Such a functor assigns a morphism $u_i \co A_i \to B_i$ of $\catE$ to each object~$i \in \cal{I}$ (we  use this notation systematically below).
The additional generality obtained by allowing~$u$ to be an arbitrary functor, rather than just an inclusion,  plays an important role in our development.
Let us begin by recalling the following definition from~\cite{garner:small-object-argument}.

\begin{definition} \label{def:right-map}
Let $u \co \cal{I} \to \catE^\to$ be a functor.
\begin{enumerate}[(i)]
\item A \emph{right $\cal{I}$-map} $(f, \phi) \co X \to Y$ consists of a map $f \co X \to Y$ in $\catE$ and a
 function~$\phi$ that assigns to each $i \in \cal{I}$ and commuting square
\[
\xymatrix@C=2cm{
  A_i
  \ar[r]^{s}
  \ar[d]_{u_i}
&
  X
  \ar[d]^f
\\
  B_i
  \ar[r]_{t}
&
  Y
}
\]
a diagonal filler $\phi(i,s, t) \co B_i \to X$, satisfying the following naturality condition: for every diagram of the form
\[
\xymatrix{
  A_i
  \ar[r]^{a}
  \ar[d]_{u_i}
&
  A_j
  \ar[r]^{s}
  \ar[d]_{u_j}
&
  X
  \ar[d]^f
\\
  B_i
  \ar[r]_{b}
&
  B_j
  \ar[r]_{t}
&
  Y
\rlap{,}}
\]
where the left square is the image of $\sigma \co i \to j$ in $\cal{I}$ under $u$, we have that
\[
  \phi(j, s, t) \cc b = \phi(i, s \cc a, t \cc b) \, .
\]
\item A \emph{right $\cal{I}$-map morphism} $\alpha \co (f, \phi) \to (f', \phi')$ is a square $\alpha \co f \to f'$ in~$\catE$ satisfying an evident compatibility condition with respect to the choices of diagonal fillers, which we omit.
\end{enumerate}
\end{definition}




For a functor $u \co \cal{I} \to \catE^\to$, we write $\liftr{\cal{I}}$ for the category of right $\cal{I}$-maps and their morphisms.
There is a forgetful functor~$\liftr{u} \co \liftr{\cal{I}} \to \catE^\to$ mapping $(f, \phi)$ to $f$, which we 
call   the \emph{right orthogonal} of $u \co \cal{I} \to \catE^\to$. The rest of this section is devoted to establishing some general facts regarding categories of right maps that will be useful in the remainder of the paper.
Most of these facts are expected generalizations of well-known statements for classes of weakly orthogonal classes in the standard setting.
They are probably known to experts, but we could not find them in the literature and hence we include them for completeness, omitting the most straightforward proofs.


First of all, recall from~\cite{garner:small-object-argument} that the function mapping a functor $u \co \cal{I} \to \catE^\to$ to its right orthogonal $\liftr{u} \co \liftr{\cal{I}} \to \catE^\to$ defines the action on objects of a functor of categories over $\catE^\to$, 
\[
  \liftr{\brarghole} \co \CAT_{/\catE^\to}^{\op} \to \CAT_{/\catE^\to} \rlap{.}
\]
In view of its use in the proof of~\cref{thm:orth-nat}, let us recall the action of this functor on arrows, 
\[
\begin{aligned}
\xymatrix@C-1em{
  \cal{I}
  \ar[dr]_{u}
  \ar[rr]^{F}
&&
  \cal{J}
  \ar[dl]^{v}
\\&
  \catE^\to
}
&&
\xymatrix{
  \ar@{}[d]|{\textstyle\longmapsto} \\
  {}
}
&&
\xymatrix@C-1em{
  \liftr{\cal{J}}
  \ar[dr]_{\liftr{v}}
  \ar[rr]^{\liftr{F}}
&&
  \liftr{\cal{I}}
  \ar[dl]^{\liftr{u}}
\\&
  \catE^\to \rlap{.}
}
\end{aligned}
\]
For $F \co \cal{I} \to \cal{J}$ over $\catE^\to$, we let $\liftr{F}(f,\phi) \defeq (f, \phi_F)$ where $\phi_F(i, s, t) \defeq \phi(Fi, s, t)$.
As shown in~\cite[Proposition~3.8]{garner:small-object-argument}, analogously to the way in which standard orthogonality operations form a Galois connection, the orthogonality functors form an adjunction
\begin{equation} \label{garner-adjunction}
\begin{gathered}
\xymatrix@C+2em{
  \CAT_{/\catE^\to}
  \ar@<5pt>[r]^-{\liftl{\brarghole}}
  \ar@{}[r]|-{\bot}
&
  \CAT_{/\catE^\to}^{\op} \rlap{.}
  \ar@<5pt>[l]^-{\liftr{\brarghole}}
}
\end{gathered}
\end{equation}

\subsection*{Natural transformations}

We begin with a simple observation.

\begin{proposition} \label{thm:orth-nat}
Consider a natural transformation between categories over $\catE^\to$ as below,
\[
\xymatrix{
  \cal{I}
  \rrtwocell_G^F{\sigma}
 \ar[dr]_{u}
&&
  \cal{J}
  \ar[dl]^{v}
\\&
  \catE^\to
\rlap{,}}
\]
satisfying in particular the condition that $v \sigma = \id_u$.
Then $\liftr{F} = \liftr{G}$ and $\liftl{F} = \liftl{G}$:
\begin{align*}
\xymatrix{
  \liftr{\cal{I}}
  \ar[dr]_{\liftr{u}}
&&
  \liftr{\cal{J}}
  \lltwocell_{\liftr{F}}^{\liftr{G}}{=}
  \ar[dl]^{\liftr{v}}
\\&
  \catE^\to
\rlap{,}}
&&
\xymatrix{
  \liftl{\cal{I}}
  \ar[dr]_{\liftl{u}}
&&
  \liftl{\cal{J}}
  \lltwocell_{\liftl{F}}^{\liftl{G}}{=}
  \ar[dl]^{\liftl{v}}
\\&
  \catE^\to
\rlap{.}}
\end{align*}
\end{proposition}

\begin{proof} Using the notation introduced above, for $(f, \phi) \in \liftr{\cal{J}}$, we have $\liftr{F}(f, \phi) = (f, \phi_F)$ and~$\liftr{G}(f, \phi) = (f, \phi_G)$.
We claim that the functions $\phi_F$ and $\phi_G$ coincide.
Observe that for every $i \in \cal{I}$, we have that $\sigma_i \co v_{Fi} \to v_{Gi}$ is the identity square on $u_i \co A_i \to B_i$.
Hence, by the naturality condition for $\phi$, applied to the diagram
\[
\xymatrix{
  A_i
  \ar@{=}[r]
  \ar[d]_{v_{Fi}}
&
  A_i
  \ar[d]^{v_{Gi}}
  \ar[r]^{s}
&
  X
  \ar[d]^{f}
\\
  B_i
  \ar@{=}[r]
&
  B_i
  \ar[r]_{t}
&
  Y
\rlap{,}}
\]
we have that $\phi_F(i, s, t) = \phi_G(i, s, t)$, as required.
\end{proof}

\subsection*{Retract closure}
In the setting of standard weak orthogonality operations,  applying the left (or right) orthogonality operation to a class of morphisms produces the same result as applying it to its retract closure.
In order to generalize  this fact in our algebraic setting, we need some definitions.
Given a functor $u \co \cal{I} \to \calE^\to$, we define its~\emph{retract closure} $\overline{u} \co \overline{\cal{I}} \to \catE^\to$ as follows.
An object of $\overline{\cal{I}}$ is a tuple~$(i, e, \sigma, \tau)$ consisting of an object $i \in \cal{I}$, an object $e \in \catE^\to$, and maps $\sigma \co e \rightarrow u_i$ $\rho \co u_i \rightarrow e$ in $\catE^\to$ which exhibit $e$ as a retract of $u_i$ in $\catE^\to$, \ie such that
\[
\xymatrix{
  e
  \ar[r]^{\sigma}
  \ar@{=}[dr]
&
  u_i
  \ar[d]^{\rho}
\\&
  e
\rlap{.}}
\]
A map $(f, \kappa) \co (i, e, \sigma, \tau) \to (i', e', \sigma', \tau')$ in $\overline{\cal{I}}$ consists of a map $f \co i \to i'$ in $\cal{I}$ and a map $\kappa \co e \rightarrow e'$ in $\catE^\to$ such that the following diagram in $\catE^\to$ commutes:
\[
\xymatrix{
  e
  \ar[r]^{\sigma}
  \ar[d]_{\kappa}
&
  u_i
  \ar[r]^{\rho}
  \ar[d]^{u_f}
&
  e
  \ar[d]^{\kappa}
\\
  e'
  \ar[r]_{\sigma'}
&
  u_{i'}
  \ar[r]_{\rho'}
&
  e'
\rlap{.}}
\]
The functor $\overline{u} \co \overline{\cal{I}} \to \catE^\to$ is then defined on objects by letting $\overline{u}(i, e, \sigma, \tau) \defeq e$, and on maps by letting $\overline{u}(f, \kappa) \defeq \kappa$.
The operation of retract closure gives a monad, as follows. For $u \co \cal{I} \to \catE^\to$, the components of the multiplication and unit
\[
\begin{aligned}
  \mu_\cal{I} &\co \overline{\overline{\cal{I}}} \to \overline{\cal{I}}
\, , &
  \eta_\cal{I} &\co \cal{I} \to \overline{\cal{I}}
\end{aligned}
\]
are defined by letting
\[
\begin{aligned}
  \mu_\cal{I}((i, e, \sigma, \rho), e', \sigma', \rho') &\defeq (i, e', \sigma \cc \sigma', \rho' \cc \rho)
\, , &
  \eta_\cal{I}(i) &\defeq (i, u_i, \id_{u_i}, \id_{u_i})
\, .
\end{aligned}
\]

\begin{proposition} \label{retract-closure}
The orthogonality functors send the components of the unit and multiplication of the retract closure monad to natural isomorphisms, and so for every $u \co \cal{I} \to \catE^\to$, we have canonical isomorphisms of categories
\[
\begin{aligned}
  \liftr{(\overline{\cal{I}})} &\iso \liftr{\cal{I}}
\, ,&
  \liftr{(\overline{\overline{\cal{I}}})} &\iso \liftr{\overline{\cal{I}}}
\, ,&
  \liftl{(\overline{\cal{I}})} &\iso \liftl{\cal{I}}
\, ,&
 \liftl{(\overline{\overline{\cal{I}}})} &\iso \liftl{\overline{\cal{I}}}
\end{aligned}
\]
over $\catE^\to$.
\qed
\end{proposition}

\begin{remark}
Let $\ret$ denote the \emph{walking retract}, \ie the category with objects $\retA, \retB$ and morphisms generated by $s \co \retA \to \retB$ and $r \co \retB \to \retA$ under the relation $r \cc s = \id_{\retA}$.
The retract closure of $u \co \cal{I} \to \catE^\to$ is given by the composite left arrow in the following diagram involving a strict pullback:
\[
\xymatrix@C+1em{
  \overline{\cal{I}}
  \ar[r]
  \ar[d]_v
  \pullback{dr}
&
  \cal{I}
  \ar[d]^{u}
\\
  (\catE^\to)^{\ret}
  \ar[r]_-{(\catE^\to)^{\retB}}
  \ar[d]_{(\catE^\to)^\retA}
&
  \catE^\to
\\
  \catE^\to
}
\]
The unit and multiplication of the monad are induced by
\[
\begin{aligned}
  (\catE^\to)^{\canonical} &\co \catE^\to \to (\catE^\to)^{\ret}
\, ,&
  (\catE^\to)^{\Delta} &\co (\catE^\to)^{\ret \times \ret} \to (\catE^\to)^{\ret}
\rlap{,}
\end{aligned}
\]
respectively.
\end{remark}

\subsection*{Slicing and coslicing}
In the setting of weak factorization systems, the right orthogonality operation commutes with slicing, while the left orthogonality operation commutes with coslicing. For our generalization of this fact, we need 
again some auxiliary definitions.
Given a functor $u \co \cal{I} \to \catE^\to$ and $X \in \catE$, we define a slice category $\cal{I}_{/X}$ and functor $u_{/X} \co \cal{I}_{/X} \to \catE_{/X}^\to$ as follows.
The category $\cal{I}_{/X}$ has as objects pairs consisting of an object $i \in \cal{I}$ and a commutative triangle of the form
\[
\xymatrix@C-1em{
  A_i
  \ar[dr]
  \ar[rr]^{u_i}
&&
  B_i
  \ar[dl]
\\&
  X
\rlap{.}}
\]
The functor $u_{/X} \co \cal{I}_{/X} \to \catE_{/X}^\to$ sends such a pair to $u_i \co A_i \to B_i$, viewed as a morphism in~$\catE_{/X}$.
This category fits into the pullback diagram
\[
\xymatrix{
  \cal{I}_{/X}
  \ar[r]
  \ar[d]_{u_{/X}}
  \pullback{dr}
&
  \cal{I}
  \ar[d]^{u}
\\
  \catE_{/X}^\to
  \ar[r]
&
  \catE^\to
\rlap{,}}
\]
where we used the functor on arrow categories induced by the forgetful functor $\dom \co \catE_{/X} \to \catE$.
Dually, taking the strict pullback along the map on arrows induced by the forgetful functor $\operatorname{cod} \co \catE_{\backslash X} \to \catE$ constructs the \emph{coslice} over $X$:
\[
\xymatrix{
  \cal{I}_{\backslash X}
  \ar[r]
  \ar[d]_{u_{\backslash X}}
  \pullback{dr}
&
  \cal{I}
  \ar[d]^{u}
\\
  \catE_{\backslash X}^\to
  \ar[r]
&
  \catE^\to
\rlap{,}}
\]
which also admits an explicit description, dual to the one given above for $\cal{I}_{/X}$.
With these definitions in place, the commutation between 
slicing and weak orthogonality functors in the setting of algebraic weak factorization 
systems can be stated as follows.

\begin{proposition} \label{pitchfork-slicing}
Let $u \co \cal{I} \to \catE^\to$ and $X \in \cal{E}$.
\begin{enumerate}[(i)]
\item The right orthogonality functor commutes with slicing, \ie we have
\[
  \liftr{(\cal{I}_{/X})} = (\liftr{\cal{I}})_{/X}
\]
as categories over $\catE^\to$.
\item The left orthogonality functor commutes with coslicing, \ie we have
\[
  \liftl{(\cal{I}_{\backslash X})} = (\liftl{\cal{I}})_{\backslash X}
\]
as categories over $\catE^\to$.
\qed
\end{enumerate}
\end{proposition}

In contrast to the right orthogonality functor, the left orthogonality functor does not commute with slicing in general.
However, it does under certain assumptions, as described in \cref{pitchfork-slicing-grothendieck} below.

\begin{proposition} \label{pitchfork-slicing-grothendieck}
Let $u \co \cal{I} \to \cal{E}^\to$ and assume that
\[
\xymatrix@C-1em{
  \cal{I}
  \ar[rr]^{u}
  \ar[dr]_{\cod_{\cal{E}} \cc u}
&&
  \cal{E}^\to
  \ar[dl]^{\cod_{\cal{E}}}
\\&
  \cal{E}
}
\]
is a morphism of Grothendieck fibrations.
Then the left orthogonality functor commutes with slicing on $u$, \ie for $X \in \cal{E}$ we have
\[
  \liftl{(\cal{I}_{/X})} = (\liftl{\cal{I}})_{/X}
.\]
\end{proposition}

\begin{proof}
First note that the composite $\cod_{\cal{E}_{/X}} \cc u_{/X}$ is also a Grothendieck fibration.
When constructing the category of left maps for $\cal{I}$ or $\cal{I}_{/X}$, an 
application of base change and naturality of diagonal fillers shows that
it is sufficient  to consider lifting problems with the bottom arrow an identity.
But for such lifting problems the order of slicing makes no difference.
\end{proof}

There is an evident dual statement to \cref{pitchfork-slicing-grothendieck}, which we do not state explicitly.

\begin{corollary} \label{pitchfork-slicing-monad}
\leavevmode
\begin{enumerate}[(i)]
\item The monad $\liftl{(\liftr{(-)})}$ commutes with slicing.
\item The monad $\liftr{(\liftl{(-)})}$ commutes with coslicing.
\end{enumerate}
\end{corollary}

\begin{proof}
Use \cref{pitchfork-slicing} and note, for the first statement, that categories of right maps satisfy the assumptions of \cref{pitchfork-slicing-grothendieck}. The second statement
follows dually.
\end{proof}

\begin{proposition}
The retract closure commutes with slicing and coslicing, in the sense that for every $u \co \cal{I} \to \catE^\to$ we have
\[
  \overline{\cal{I}_{/X}} = \overline{\cal{I}}_{/X}
\]
as categories over $\catE^\to$.
\qed
\end{proposition}

\subsection*{Adjunctions}

Next, we discuss the interaction between the orthogonality functors and adjunctions.
In the standard setting of weak factorization systems, given an
 adjunction $F \dashv G$ between categories $\cal{E}$ and $\cal{F}$ ,  if we have classes of maps $\cal{I} \subseteq \catE^\to$ and~$\cal{J} \subseteq \cal{F}^\to$, then $F(\cal{I}) \subseteq \liftl{\cal{J}}$ if and only if $\liftr{\cal{I}} \subseteq G(\cal{J})$. To provide a generalization of this fact in our setting, let us fix functors $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \cal{F}^\to$ for this and the next subsection.

\begin{proposition} \label{lift-of-adjunction}
For an adjunction $F \dashv G$ between $\cal{E}$ and $\cal{F}$, the following are equivalent:
\begin{enumerate}[(i)]
\item the functor $F \co \catE^\to \to \cal{F}^\to$ lifts to a functor $F \co \cal{I} \to \liftl{\cal{J}}$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \ar[r]^{F}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \catE^\to
  \ar[r]_-{F}
&
  \cal{F}^\to
\rlap{,}}
\]
\item the functor $G \co \cal{F}^\to \to \catE^\to$ lifts to a functor $G \co \cal{J} \to \liftr{\cal{I}}$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{J}
    \ar[d]_{v}
\ar[r]^{G}
&
  \liftr{\cal{I}}
  \ar[d]^{\liftr{u}}
\\
  \cal{F}^\to
   \ar[r]_{G}
&
  \catE^\to
\rlap{.}  } 
\]
\end{enumerate}
\qed
\end{proposition}

The next proposition involves the notion of a mate, defined in~\cite{kelly-street}.

\begin{proposition} \label{lift-of-mates}
Let $F_1 \dashv G_1$ and $F_2 \dashv G_2$ be adjunctions between $\cal{E}$ and $\cal{F}$ satisfying the equivalent conditions of \cref{lift-of-adjunction}.
Let $m \co F_1 \to F_2$ and $n \co G_2 \to G_1$ be natural transformations forming mates. Then the following are equivalent:
\begin{enumerate}[(i)]
\item
The natural transformation $m$ lifts as follows:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \rtwocell_{F_2}^{F_1}{m}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \catE^\to
  \rtwocell_{F_2}^{F_1}{m}
&
  \cal{F}^\to
\rlap{,}}
\]
\item
The natural transformation $n$ lifts as follows:
\[
\xymatrix@C=1.2cm{
  \cal{J}
  \rtwocell_{G_1}^{G_2}{n}
  \ar[d]_{u}
&
  \liftr{\cal{I}}
  \ar[d]^{\liftl{v}}
\\
  \cal{F}^\to
  \rtwocell_{G_1}^{G_2}{n}
&
  \cal{E}^\to
\rlap{.}}
\]
\end{enumerate}
\qed
\end{proposition}

\cref{exa:composition-pullback-lift} below is used in~\cref{sec:frobc} when we introduce the Beck-Chevalley conditions.

\begin{remark} \label{exa:composition-pullback-lift}
If $\cal{E}$ has pullbacks, for an arrow $f \co X \to Y$, we have an adjunction
\[
\xymatrix{
  \catE_{/X}
  \ar@<1ex>[r]^{f_!}
  \ar@{}[r]|{\bot}
&
  \catE_{/Y}
  \ar@<1ex>[l]^{f^*}
}
\]
where the left adjoint is the left composition functor and the right adjoint is the pullback functor.
Given a functor $u \co \cal{I} \to \catE^\to$, it is immediate to check that the left composition functor lifts as follows:
\[
\xymatrix@C+1em{
  \cal{I}_{/X}
  \ar[r]^-{f_!}
  \ar[d]_{u_{/X}}
&
  \cal{I}_{/Y}
  \ar[d]^{u_{/Y}}
\\
  \calE_{/X}^\to
  \ar[r]_-{f_!}
&
  \calE_{/Y}^\to
\rlap{.}}
\]
By \cref{lift-of-adjunction}, the pullback functor $f^* \co \catE_{/Y} \to \catE_{/X}$ then lifts to slices of the right orthogonality categories,
\[
\xymatrix@C=1.5cm{
  \liftr{\cal{I}}_{/Y}
  \ar[d]_{{\liftr{u}}_{/Y}}
  \ar[r]^{f^*}
&
  \liftr{\cal{I}}_{/X}
  \ar[d]^{{\liftr{u}}_{/X}}
\\
  {\catE}_{/Y}^\to
  \ar[r]_{f^*}
&
  \catE_{/X}^\to
\rlap{.}}
\]
\end{remark}

\subsection*{Leibniz adjunctions}

We  now generalize \cref{lift-of-adjunction} to Leibniz adjunctions~\cite{riehl-verity:reedy}.
Let us fix bifunctors $F \co \cal{K} \times \catE \to \cal{F}$ and $G \co \cal{K}^{\op} \times \cal{F} \to \catE$ related pointwise, for $k \in \cal{K}$, by an adjunction:
\[
\xymatrix@C+1em{
  \catE
  \ar@<5pt>[r]^{F(k, \arghole)}
  \ar@{}[r]|{\bot}
&
  \cal{F}
  \ar@<5pt>[l]^{G(k, \arghole)}
\rlap{.}}
\]
Assume that $\catE$ has pushouts and $\cal{F}$ has pullbacks and 
let
\[
\begin{aligned}
  \widehat{F} &\co \cal{K}^\to \times \catE^\to \to \cal{F}^\to
\, ,&
  \widehat{G} &\co (\cal{K}^{\op})^\to \times \cal{F}^\to \to \catE^\to
\end{aligned}
\]
denote the respective Leibniz constructions for $F$ and $G^{\op}$, using pullback instead of pushout for~$\widehat{G}$.
In the standard setting, it is well known that if we have classes of maps $\cal{I} \subseteq \catE^\to$ and~$\cal{J} \subseteq \cal{F}^\to$, then for each $h \in \cal{K}^\to$ we have $\widehat{F}(h, \cal{I}) \subseteq \liftl{\cal{J}}$ if and only if $\liftr{\cal{I}} \subseteq \widehat{G}(h, \cal{J})$.
The next statement generalize this fact in the algebraic setting.

\begin{proposition} \label{lift-of-leibniz-adjunction}
Let $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \cal{F}^\to$ be functors.
Then the following are equivalent for $h \co X \to Y$ in $\cal{K}$:
\begin{enumerate}[(i)]
\item liftings $F' \co \cal{I} \to \liftl{\cal{J}}$ of the functor $\widehat{F}(h, \arghole) \co \catE^\to \to \cal{F}^\to$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \ar[r]^{F'}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \catE^\to
  \ar[r]_-{\widehat{F}(h, \arghole)}
&
  \cal{F}^\to
\rlap{,}}
\]
\item liftings $G' \co \cal{J} \to \liftr{\cal{I}}$ of the functor $\widehat{G}(h, \arghole) \co \cal{F}^\to \to \catE^\to$ making the following diagram commute:
\[
\xymatrix@C+2em{
  \cal{J}
  \ar[d]_{v}
  \ar[r]^{G'}
&
  \liftr{\cal{I}}
  \ar[d]^{\liftr{u}}
\\
  \cal{F}^\to
  \ar[r]_-{\widehat{G}(h, \arghole)}
&
  \catE^\to
\rlap{.}}
\]
\end{enumerate}
\end{proposition}

\begin{proof}
Giving a functor $F' \co \cal{I} \to \liftl{\cal{J}}$ as above is the same thing as giving fillers for diagrams of the form
\[
\xymatrix@C+2em{
  F(X,B) +_{F(X,A)} F(Y,A)
  \ar[d]_{\widehat{F}(h, u_i)}
  \ar[r]
&
  C_j
  \ar[d]^{v_j}
\\
  F(Y, B)
  \ar[r]
&
  D_j
\rlap{,}}
\]
natural in $i \in \cal{I}$ and $j \in \cal{J}$.
Similarly, giving a functor $G' \co \cal{J} \to \liftl{\cal{I}}$ as above is the same thing as giving fillers for squares of the form
\[
\xymatrix@C+2em{
  A_i
  \ar[d]_{u_i}
  \ar[r]
&
  G(Y, C)
  \ar[d]^{\widehat{G}(h, v_j)}
\\
  B
  \ar[r]
&
  G(Y, D) \times_{G(X,D)} G(X, D)
\rlap{,}}
\]
natural in $i \in \cal{I}$ and $j \in \cal{J}$.
Since $F(X, \arghole) \dashv G(X, \arghole)$ and $F(Y, \arghole) \dashv G(Y, \arghole)$, a diagram chasing argument typical of Leibniz constructions shows that these situations are
equivalent.
\end{proof}

Note that \cref{lift-of-adjunction} can be seen as a special case of \cref{lift-of-leibniz-adjunction} where $\cal{K}$ is the terminal category. We do not need  the evident generalization of \cref{lift-of-mates} to Leibniz constructions.

\begin{remark} \label{pitchfork-leibniz-most-general-example}
In \cref{lift-of-leibniz-adjunction}, let $\cal{K}$ be the category of adjunctions $U \dashv V$ with $U \co \catE \to \cal{F}$ and $V \co \cal{F} \to \catE$.
A morphism from $U_1 \dashv V_1$ to $U_2 \dashv V_2$ consists of natural transformations $u \co U_1 \to U_2$ and $v \co V_2 \to V_1$ forming mates.
Note that we have fully faithful forgetful functors $\cal{K} \to [\catE, \cal{F}]$ and $\cal{K} \to [\cal{F}, \catE]^{\op}$.
We also have functors $F \co \cal{K} \times \catE \to \cal{F}$ and~$G \co \cal{K}^{\op} \times \cal{F} \to \catE$ given by left and right adjoint application, respectively.
This is, in some sense, the most general instantiation of \cref{lift-of-leibniz-adjunction}.
\end{remark}

If $\interval \otimes (-)$ has a right adjoint $\exp(I, -)$, we obtain a \emph{functorial cocylinder} \[
(\exp(\interval, -), \exp(\bar{\delta}^0, -), \exp(\bar{\delta}^1, -)) \, ,
\] 
\ie a functorial cylinder in the opposite category $\catE^{\op}$~\cite{kamps-porter:homotopy}.
Structures on the functorial cylinder such as contractions and (effective) connections, to
be introduced in~\cref{sec:unifshe}, carry over as well.
If $\calE$ has finite limits, we obtain a functor $\hatexp(\bar{\delta}^k, -)$, defined in terms of a pullback, dual to $\kcyl \hatotimes (-)$, which was defined in terms of a pushout, for~$k \in \braces{0, 1}$.
These form an adjunction as follows:
\[
\xymatrix@C+4em{
  \catE^\to
  \ar@<1ex>[r]^{\kcyl \hatotimes (-)}
  \ar@{}[r]|{\bot}
&
  \catE^\to
  \ar@<1ex>[l]^{\hatexp(\bar{\delta}^k, -)}
\rlap{.}}
\]
For a functor $u \co \cal{I} \to \catE^\to$, we can apply the results obtained above to characterize uniform $\cal{I}$-fibrations, which we introduced in \cref{def:I-fibration}, in terms of right $\cal{I}$-maps.

\begin{proposition} \label{prod-exp-general}
For a map $p \co X \to Y$ in $\catE$, the following are equivalent:
\begin{enumerate}[(i)]
\item $p$ admits the structure of a uniform $\cal{I}$-fibration,
\item $\hatexp(\bar{\delta}^0, p)$ and $\hatexp(\bar{\delta}^1, p)$ admit the structure of right $\cal{I}$-maps.
\end{enumerate}
\end{proposition}

\begin{proof}
First recall that the right orthogonality functor is contravariant and part of the adjunction~\eqref{garner-adjunction}, hence sends coproducts to products of categories over $\catE^\to$.
The remainder of the claim follows from \cref{lift-of-leibniz-adjunction} as applied in \cref{pitchfork-leibniz-most-general-example} and the preceeding discussion.
\end{proof}

\subsection*{Kan extensions}

We now establish some general facts about the interaction between orthogonality functors and Kan extensions along fully faithful functors. These are applied in \cref{sec:unif} to show that uniform (trivial) Kan fibrations are the right maps of an algebraic weak factorization system.

\begin{proposition} \label{kan-extension-closure}
Let $F \co \cal{I} \to \cal{J}$ be a fully faithful functor.
\begin{enumerate}[(i)]
\item Assume that the pointwise left Kan extension of $u \co \cal{I} \to \catE^\to$ along $F$ exists:
\[
\xymatrix@!C@C-1em{
  \cal{I}
  \ar[dr]_{u}
  \ar[rr]^{F}
&&
  \cal{J}
  \ar[dl]^{\Lan_F u}
\\&
  \catE^\to
\rlap{.}}
\]
Then the functor $\liftr{F} \co \liftr{\cal{J}} \to \liftr{\cal{I}}$, fitting in the diagram
\[
\xymatrix@!C@C-1em{
  \liftr{\cal{I}}
  \ar[dr]_{\liftr{u}}
&&
  \liftr{\cal{J}}
  \ar[ll]_{\liftr{F}}
  \ar[dl]^{\liftr{(\Lan_F u)}}
\\&
  \catE^\to
\rlap{,}}
\]
is an isomorphism.
\item Assume that the pointwise right Kan extension of $u \co \cal{I} \to \catE^\to$ along $F$ exists:
\[
\xymatrix@!C@C-1em{
  \cal{I}
  \ar[dr]_{u}
  \ar[rr]^{F}
&&
  \cal{J}
  \ar[dl]^{\Ran_F u}
\\&
  \catE^\to
\rlap{.}}
\]
Then the functor $\liftl{F} \co \liftl{\cal{J}} \to \liftl{\cal{I}}$, fitting in the diagram
\[
\xymatrix@!C@C-1em{
  \liftl{\cal{I}}
  \ar[dr]_{\liftl{u}}
&&
  \liftl{\cal{J}}
  \ar[ll]_{\liftl{F}}
  \ar[dl]^{\liftl{(\Ran_F u)}}
\\&
  \catE^\to
\rlap{,}}
\]
is an isomorphism.
\qed
\end{enumerate}
\end{proposition}


\section{The Frobenius and Beck-Chevalley conditions}
\label{sec:frobc}


The aim of this section is to obtain a necessary and sufficient condition for an algebraically-free algebraic weak
factorization system~\cite{garner:small-object-argument} to satisfy the functorial Frobenius condition~\cite{garner:topological-simplicial}, expressed purely in terms of its generating category. We will use this characterization 
in~\cref{sec:frocuf} to prove that algebraic weak factorization systems with uniform fibrations as right maps
have the functorial Frobenius property. 

We begin by introducing the Frobenius condition for a map $f \co X \to Y$ with respect to a functor $u \co \cal{I} \to \catE^\to$ for a category $\cal{E}$ will pullbacks, and a corresponding Beck-Chevalley condition for squares. We combination of these conditions is what we call the uniform Frobenius condition, which we then relate to the functorial Frobenius
condition and use to obtain the required characterisation. 


\subsection*{The Frobenius condition}

For this section, we fix a functor $u \co \cal{I} \to \catE^\to$.

\begin{definition}[Frobenius condition] \label{thm:frobenius-def}
We say that a map $f \co X \to Y$ \emph{satisfies the Frobenius condition} with respect to $u \co \cal{I} \to \cal{E}^\to$ if pullback along $f$ lifts to a functor
\[
\xymatrix@C=1.5cm{
  \cal{I}_{/Y}
  \ar[r]^{f^*}
  \ar[d]_{u_{/Y}}
&
  \liftl{(\liftr{\cal{I}})}_{/X}
  \ar[d]^{\liftl{(\liftr{u})}_{/X}}
\\
  \catE_{/Y}^\to \ar[r]_{f^*}
&
  \catE_{/X}^\to
\rlap{.}}
\]
\end{definition}

\begin{remark} \label{frobenius-no-coherence}
Note that the Frobenius condition requires the specification of additional structure, rather than the mere satisfaction of a property. Explicitly,  it requires that $f^* u_i \co f^* X_i \to f^* Y_i$ is provided with the structure of a left $\liftr{\cal{I}}$-map for $i \in \cal{I}$ and $u_i \co X_i \to Y_i$ as below,
\[
\xymatrix{
  X_i
  \ar[dr]
  \ar[rr]^{u_i}
&&
  Y_i
  \ar[dl]
\\&
   Y
\rlap{,}}
\]
such that morphisms in $\cal{I}_{/Y}$ induce morphisms of left $\liftr{\cal{I}}$-maps.
\end{remark}

\begin{remark} Recall that the Frobenius condition for a weak factorization system states that pullback along a right map preserves left maps~\cite{garner:types-omega-groupoids,gambino-garner:idtypewfs}. Given a weak factorization system $(\cal{L}, \cal{R})$ on a category $\catE$, we have that it satisfies the Frobenius condition  in this sense if and only if every right map satisfies the Frobenius condition with respect to the inclusion $\cal{L} \hookrightarrow \catE^\to$
in the sense of~\cref{thm:frobenius-def}.
\end{remark} 


For a weak factorization system in a category with pushforward functors, \ie right adjoints to pullback functors, the standard Frobenius condition is equivalent to saying that pushforward along a right map preserves right maps.
The generalization of this equivalence in our setting is provided by the next proposition.

\begin{proposition} \label{lift-pushforward}
For a map $f \co X \to Y$ admitting pushforward,
\[
\xymatrix@C+1em{
  \catE_{/Y}
  \ar@<5pt>[r]^{f^*}
  \ar@{}[r]|{\bot}
&
  \catE_{/X}
  \ar@<5pt>[l]^{f_*}
\rlap{,}}
\]
the following are equivalent:
\begin{enumerate}[(i)]
\item $f$ satisfies the Frobenius condition with respect to $u \co \cal{I} \to \cal{E}^\to$, 
\item pushforward along $f$ lifts to a functor
\[
\xymatrix@C=1.5cm{
  {\liftr{\cal{I}}}_{/X}
  \ar[r]^{f_*}
  \ar[d]_{u_{/X}}
&
  {\liftr{\cal{I}}}_{/Y}
  \ar[d]^{{\liftr{u}}_{/Y}}
\\
  \catE_{/X}^\to
  \ar[r]_{f_*}
&
  \catE_{/Y}^\to
\rlap{.}}
\]

\end{enumerate}
\end{proposition}

\begin{proof}
Apply \cref{lift-of-adjunction} to the adjunction $p^* \dashv p_*$ with $u = u_{/X}$ and $v = {\liftr{u}}_{/Y}$, using \cref{pitchfork-slicing-grothendieck} to permute slicing and the left orthogonality functor.
\end{proof}

\subsection*{The Beck-Chevalley condition}

In order to introduce the Beck-Chevalley condition, recall from \cref{exa:composition-pullback-lift} that for a functor $u \co \cal{I} \to \catE^\to$ and a map $f \co X \to Y$ in~$\catE$, left composition~$f_! \co \calE/X \to \calE/Y$ lifts to a functor between slices of~$u$.

\begin{definition}[Beck-Chevalley condition] \label{def:beck-chevalley}
Let $f \co X \to Y$ and $g \co U \to V$ be maps that satisfy the Frobenius condition with respect to $u \co \cal{I} \to \cal{E}^\to$.
We say that a commutative square
\begin{equation} \label{def:beck-chevalley:0}
\begin{gathered}
\xymatrix{
  X
  \ar[r]^{f}
  \ar[d]_{s}
&
  Y
  \ar[d]^{t}
\\
  U
  \ar[r]_{g}
&
  V
}
\end{gathered}
\end{equation}
satisfies the \emph{Beck-Chevalley condition} with respect to $u$ if the canonical natural transformation
\[
\xymatrix{
  \catE^\to_{/Y}
  \ar[d]_{t_!}
  \ar[r]^{f^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\phi$}}
&
  \catE^\to_{/X}
  \ar[d]^{s_!}
\\
  \catE^\to_{/V}
  \ar[r]_{g^*}
&
  \catE^\to_{/U}
}
\]
lifts to a natural transformation
\[
\xymatrix@C+3em{
  \cal{I}_{/Y}
  \ar[r]^{f^*}
  \ar[d]_{t_!}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\phi'$}}
&
  \liftl{(\liftr{\cal{I}})}_{/X}
  \ar[d]^{s_!}
\\
  \cal{I}_{/V}
  \ar[r]_{g^*}
&
  \liftl{(\liftr{\cal{I}})}_{/U}
\rlap{.}}
\]
\end{definition}

\begin{remark} \label{beck-chevalley-no-coherence}
In contrast to the Frobenius condition, the Beck-Chevalley condition is just a property, not additional structure.
Explicitly, it requires the components of the natural transformation $\phi$ to be morphisms of left $\liftr{\cal{I}}$-maps.
\end{remark}

\begin{remark} \label{beck-chevalley-iso}
If the given commutative square is a pullback, then the canonical natural transformation $\phi \co s_! f^* \to g^* t_!$ is an isomorphism (by the usual Beck-Chevalley condition), and so is~$\phi'$ since $\liftl{(\liftr{u})}$ reflects isomorphisms.
\end{remark}

In analogy with \cref{lift-pushforward}, we provide a characterization of the Beck-Chevalley condition of \cref{def:beck-chevalley} in terms of pushforward functors.
In order to state this, recall from \cref{exa:composition-pullback-lift} that for a functor $u \co \cal{I} \to \catE^\to$ and a map $s \co X \to U$, the pullback functor $s^* \co \catE^\to_{/U} \to \catE^\to_{/X}$ lifts to a functor $s^* \co {\liftr{\cal{I}}}_{/U} \to {\liftr{\cal{I}}}_{/X}$.

\begin{proposition} \label{lift-pushforward-BC}
Let $f \co X \to Y$ and $g \co U \to V$ be maps that satisfy the Frobenius condition with respect to $u \co \cal{I} \to \cal{E}^\to$ and admit pushforward.
A commuting square as in~\eqref{def:beck-chevalley:0} satisfies the Beck-Chevalley condition with respect to $u$ if and only if the canonical natural transformation
\[
\xymatrix@C+2em{
  \catE^\to_{/U}
  \ar[r]^{g_*}
  \ar[d]_{s^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\psi$}}
&
  \catE^\to_{/V}
  \ar[d]^{t^*}
\\
  \catE^\to_{/X}
  \ar[r]_{f_*}
&
  \catE^\to_{/Y}
}
\]
lifts to a natural transformation
\[
\xymatrix@C+2em{
  {\liftr{\cal{I}}}_{/U}
  \ar[r]^{g_*}
  \ar[d]_{s^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\psi'$}}
&
  {\liftr{\cal{I}}}_{/V}
  \ar[d]^{t^*}
\\
  {\liftr{\cal{I}}}_{/X}
  \ar[r]_{f_*}
&
  {\liftr{\cal{I}}}_{/Y}
\rlap{.}}
\]
\end{proposition}

\begin{proof}
Apply \cref{lift-of-mates} to the adjunctions $g^* t_! \dashv t^* g_*$ and $s_! f^* \dashv s^* t_!$.
\end{proof}


\subsection*{The uniform Frobenius condition} 
We conclude this section by introducing a combination of the Frobenius and Beck-Chevalley conditions,
which we call the uniform Frobenius condition, and showing how it relates to the functorial Frobenius
condition of~\cite{garner:topological-simplicial}. We then use the uniform Frobenius condition to give
a characterization of the functorial Frobenius condition for algebraically-free algebraic weak factorization systems.



\begin{definition}[Uniform Frobenius condition] \label{def:uniFrobcond}
We say that a functor $v \co \cal{J} \to \catE^\to$ satisfies the \emph{uniform Frobenius condition} with respect to $u \co \cal{I} \to \cal{E}^\to$ if:
\begin{enumerate}[(i)]
\item for every object $j \in \cal{J}$, the morphism $v_j \co C_j \to D_j$ satisfies the Frobenius condition with respect to $u$,
\item for every morphism $\tau \co j \to j'$ in $\cal{J}$, the square $v_\tau$:
\[
\xymatrix{
  C_j
  \ar[r]^{v_j}
  \ar[d]_{s}
&
  D_j
  \ar[d]^{t}
\\
  C_{j'}
  \ar[r]_-{v_{j'}}
&
  D_{j'}
\rlap{,}}
\]
satisfies the Beck-Chevalley condition with respect to $u$.
\end{enumerate} 
\end{definition}

In order relate the uniform Frobenius condition introduced above with the functorial Frobenius condition~\cite{garner:topological-simplicial}, it is convenient 
to assemble all the ingredients of the uniform Frobenius condition into a single global functor, as we do in~\cref{uniform-frob-nice}, which seems the most natural way to phrase the condition.
Given a functor $w \co \cal{K} \to \cal{E}^\to$, we write $\cal{K}_{/\cal{E}}^{\to}$ for the category of 
pairs $(k, X)$, with $k \in \cal{K}$ and $X \in \cal{E}$ such that $w_k$ is over $X$, \ie the result of
the opposite Grothendieck construction applied to the functor sending $X \in \cal{E}$ to the slice category $\cal{K}_{/X}^{\to}$.

\begin{proposition}
\label{uniform-frob-nice}
The uniform Frobenius condition of a functor $v \co \cal{J} \to \cal{E}^\to$ with respect to $u \co \cal{I} \to \cal{E}^\to$ is equivalent to a lift $Q$ as below:
\begin{equation} \label{uniform-frob-nice:lift}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I}_{/\cal{E}} \times_{\cal{E}} \cal{J}
  \ar@{.>}[r]^{Q}
  \ar[d]_{u_{/\cal{E}} \times_{\cal{E}} v}
&
  \liftl{(\liftr{\cal{I}})}_{/\cal{E}}
  \ar[d]^{\liftl{(\liftr{u})}_{/\cal{E}}}
\\
  \cal{E}^\to_{/\cal{E}} \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P}
&
  \cal{E}_{/\cal{E}}^\to
\rlap{.}}
\end{gathered}
\end{equation}
Here, the pullbacks are with respect to the slicing part of the left factor and the codomain part of the right factor, and $P$ denotes base change of arrows over objects, sending $(f, h)$ to $h^*(f)$.
\end{proposition}

\begin{proof}
Since the functor $\liftl{(\liftr{u})}$ is faithful, a lift $Q$ consists just of a lift of the action of $P$ on objects that is coherent with respect to the action of $P$ on morphisms (in the sense that the action of $P$ on morphisms lifts to a necessarily unique action of $Q$ on morphisms).
Coherence in morphisms in $\cal{I}_{/\cal{E}} \times_{\cal{E}} \cal{J}$ of the action on objects of $Q$ separates into two parts:
\begin{enumerate}[(i)]
\item coherence in morphisms in $\cal{I}_{/D_j}$ for fixed $v_j \co C_j \to D_j$ with $j \in \cal{J}$,
\item coherence in morphisms in $\cal{J}$.
\end{enumerate}
The action of $Q$ on objects together with coherence (i) constitutes the Frobenius part of the uniform Frobenius condition.
Coherence (ii) constitutes the Beck-Chevalley part of the uniform Frobenius condition.
\end{proof}

For future reference,  in the following two propositions we make explicit some categorical properties of the uniform Frobenius condition evident in the phrasing given by \cref{uniform-frob-nice}.

\begin{proposition}[Functoriality of uniform Frobenius condition] \label{uniform-frobenius-functorial}
Consider categories $u_t \co \cal{I} \to \cal{E}^\to$ and $v_t \co \cal{J} \to \cal{E}^\to$ for $t \in \braces{1, 2}$ related as follows:
\begin{align*}
\xymatrix@!C@C-3em{
  \cal{I}_1
  \ar[rr]^{F}
  \ar[dr]_{u_1}
&&
  \liftl{(\liftr{\cal{I}_2})}
  \ar[dl]^{\liftl{(\liftr{u_2})}}
\\&
  \catE^\to
\rlap{,}}
&&
\xymatrix@C-1.5em{
  \cal{I}_2
  \ar[rr]^-{G}
  \ar[dr]_{u_2}
&&
  \cal{I}_1
  \ar[dl]^{u_1}
\\&
  \catE^\to
\rlap{,}}
&&
\xymatrix@C-1.5em{
  \cal{J}_2
  \ar[rr]^-{H}
  \ar[dr]_{v_2}
&&
  \cal{J}_1
  \ar[dl]^{v_1}
\\&
  \catE^\to
\rlap{.}}
\end{align*}
If $v_1$ satisfies the uniform Frobenius condition with respect to $u_1$, then
$v_2$ satisfies the uniform Frobenius condition with respect to $u_2$.
\end{proposition}


\begin{proof}
We work with the characterization of the uniform Frobenius condition given by \cref{uniform-frob-nice}.
In the below diagram, the premise corresponds to a functor $Q_1$ making the inner square commute while the conclusion corresponds to a functor $Q_2$ making the lower trapezoid commute:
\[
\xymatrix{
&
  {\cal{I}_2}_{/\cal{E}} \times_{\cal{E}} \cal{J}_2
  \ar[rr]^{Q_1}
  \ar[dd]^(0.25){{u_1}_{/\cal{E}} \times_{\cal{E}} v_1}
&&
  \liftl{(\liftr{\cal{I}_2})}_{/\cal{E}}
  \ar[dr]
  \ar[dd]_(0.25){\liftl{(\liftr{u_1})}_{/\cal{E}}}
\\
  {\cal{I}_1}_{/\cal{E}} \times_{\cal{E}} \cal{J}_1
  \ar[ur]
  \ar[dr]_{{u_2}_{/\cal{E}} \times_{\cal{E}} v_2}
  \ar[rrrr]^{Q_2}
&&&&
  \liftl{(\liftr{\cal{I}_1})}_{/\cal{E}}
  \ar[dl]^{\liftl{(\liftr{u_2})}_{/\cal{E}}}
\\&
  \cal{E}^\to_{/\cal{E}} \times_{\cal{E}} \cal{E}^\to
  \ar[rr]_{P}
&&
  \cal{E}^\to_{/\cal{E}}
\rlap{.}}
\]
We may construct $Q_2$ from~$Q_1$ by pasting the inner square with the left triangle, given by $G$ and~$H$, and the right triangle, given by $F$ and the multiplication of the monad $\liftl{(\liftr{(-)})}$.
\end{proof}

In the context of standard weak factorization systems, \cref{uniform-frobenius-functorial} implies that,
for classes of maps $\cal{I}_t$ and $\cal{J}_t$, for $t \in \{ 1, 2 \}$, if $\cal{I}_1 \subseteq \liftl{(\liftr{I_2})}$,
$\cal{I}_2 \subseteq \cal{I}_1$ and $\cal{J}_2 \subseteq \cal{J}_1$, if pullback along maps in $\cal{J}_1$
preserves maps in $\cal{I}_1$, then pullback along maps in $\cal{J}_2$ preserves maps in $\cal{I}_2$. 


\begin{remark} 
 In some applications, we need functoriality of the uniform Frobenius condition of $\cal{J}$ with respect to $\cal{I}$ in one of the parameters.
If only functoriality in $\cal{I}$ is desired, the map $H$ will default to an identity.
If only functoriality in $\cal{J}$ is desired, the maps $F$ and $G$ will default to a component of the unit of the monad $\liftl{(\liftr{(-)})}$ and an identity, respectively.
\end{remark} 

\begin{proposition} \label{uniform-frobenius-product-u}
If $v \co \cal{J} \to \cal{E}^\to$ satisfies the uniform Frobenius condition with respect to functors $u_1 \co \cal{I}_1 \to \cal{E}^\to$ and $u_2 \co \cal{I}_2 \to \cal{E}^\to$, then also with respect to the strict pullback $\cal{I}_1 \times_{\cal{E}^\to} \cal{I}_2 \to \cal{E}^\to$ of $u_1$ and $u_2$.
\end{proposition}

\begin{proof}
Use the universal property of products in the category $\CAT_{/\cal{E}^\to}$ with respect to the characterization of uniform Frobenius in \cref{uniform-frob-nice}, noting that we have a canonical map
\[
\liftl{(\liftr{\cal{I}_1})} \times_{\cal{E}^\to} \liftl{(\liftr{\cal{I}_2})} \to \liftl{(\liftr{(\cal{I}_1 \times_{\cal{E}^\to} \cal{I}_2)})}
\]
over $\cal{E}^\to$ given by the adjunction~\eqref{garner-adjunction}.
\end{proof}

\begin{remark} \label{uniform-frobenius-limit-u}
The previous proposition holds true analogously for arbitrary limits in the category $\CAT_{/\cal{E}^\to}$, not just binary products.
\end{remark}

\begin{proof}
For relating the Frobenius conditions of $\cal{J}$ with respect to $\cal{I}$ and $\liftl{(\liftr{\cal{I}})}$, we note that there are maps over $\cal{E}^\to$ back and forth between $\liftr{\cal{I}}$ and $\liftr{(\liftl{(\liftr{\cal{I}})})}$ given by the unit and counit of the the adjunction \eqref{garner-adjunction}.

\end{proof}

For the below result, fix a functor $v \co \cal{J} \to \cal{E}^\to$ such that
\begin{equation} \label{uniform-frob:comprehension}
\begin{gathered}
\xymatrix@C-1em{
  \cal{J}
  \ar[rr]^{v}
  \ar[dr]_{\cod_{\cal{E}} \cc v}
&&
  \cal{E}^\to
  \ar[dl]^{\cod_{\cal{E}}}
\\&
  \cal{E}
}
\end{gathered}
\end{equation}
is a morphism of Grothendieck fibrations.
This is for example the case if $\cal{J}$ is a category of right maps as in \cref{strong-h-equiv-uniform-base-change} or the category of algebras in an algebraic weak factorization system.
Under this assumption, the characterization of \cref{uniform-frob-nice} can be simplified even further.

\begin{proposition}
\label{uniform-frob-even-nicer}
The uniform Frobenius condition of $v \co \cal{J} \to \cal{E}^\to$ with respect to $u \co \cal{I} \to \cal{E}^\to$ is equivalent to a lift $Q'$ as below:
\begin{equation} \label{uniform-frob-even-nicer:lift}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I} \times_{\cal{E}} \cal{J}
  \ar@{.>}[r]^{Q'}
  \ar[d]_{u \times_{\cal{E}} v}
&
  \liftl{(\liftr{\cal{I}})}
  \ar[d]^{\liftl{(\liftr{u})}}
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P'}
&
  \cal{E}^\to
\rlap{.}}
\end{gathered}
\end{equation}
Here $P'$ denotes the pullback functor, sending a cospan $(g, h)$ to $h^* g$.
\end{proposition}

\begin{proof}
We will show that the structure of the respective lifts $Q$ and $Q'$ in \eqref{uniform-frob-nice:lift} and \eqref{uniform-frob-even-nicer:lift} is the same.
The situation \eqref{uniform-frob-nice:lift} a priori represents a more general scenario: we are pulling back an arrow $u_i \co A \to B$ with $i \in \cal{I}$ over an object $Y$ along a map $v_j \co X \to Y$ with $j \in \cal{J}$.
In contrast, in \eqref{uniform-frob-even-nicer:lift} we restrict to the case that the map $B \to Y$ is the identity.
It follows that any lift $Q$ induces a lift $Q'$.
However, under the assumption that \eqref{uniform-frob:comprehension} forms a morphism of Grothendieck fibrations, the lift $Q$ can be reconstructed from the lift $Q'$ by first pulling back $v_j$ along $B \to Y$ to a map $v_{j'} \co B \to D$ with $j' \to j$ a map in $\cal{J}$ in the above situation and then setting $Q(i, j) \defeq Q'(i, j')$.
Furthermore, this choice of $Q$ is forced upon us (up to isomorphism) by functoriality of $Q$ and the fact that $\liftl{(\liftr{u})}$ reflects isomorphisms.
\end{proof}

{
\newcommand{\LL}{\mathsf{L}}
\newcommand{\RR}{\mathsf{R}}

We will now compare the uniform Frobenius condition with the functorial Frobenius condition of~\cite{garner:topological-simplicial}.
Recall from~\cite{bourke-garner-I} that an algebraic weak factorization system~$(\LL, \RR)$ on a category $\cal{E}$ consist of a pair of functors $\LL, \RR \co \cal{E}^\to \to \cal{E}^\to$ providing factorizations~$f = \RR f \cc \LL f$ functorially in~$f \in \cal{E}^\to$ and an extension of the evidently (co)pointed endofunctors $\LL, \RR$ to (co)monads such that the canonical natural transformation $\LL \RR \to \RR \LL$ is a distributive law.
We write $\pCoalg{\LL}$ and $\pAlg{\RR}$ for the categories of (co)monad algebras and $\pcoalg{\LL}$ and $\palg{\RR}$ for the categories of (co)pointed endofunctor (co)algebras over $\LL$ and $\RR$, respectively.
These come equipped with forgetful functors into $\cal{E}^\to$ and fulfill $\pcoalg{\LL} = \liftl{\pAlg{\RR}}$ and $\palg{\RR} = \liftr{\pCoalg{\LL}}$.
The underlying weak factorization system of $(\LL, \RR)$ has as left and right classes the maps that admit a lift to $\pcoalg{\LL}$ and $\palg{\RR}$, respectively.
Recall also that $(\LL, \RR)$ is said to be algebraically-free on a category $\cal{I}$ of arrows if $\pAlg{\R} = \liftr{\cal{I}}$.

\begin{definition}[Functorial Frobenius condition] \label{functorial-frobenius}
An algebraic weak factorization system is called \emph{functorially Frobenius} if $\pcoalg{\LL}$ is stable under pullback along $\palg{\RR}$ in the sense of a lift $Q'$ as follows:
\[
\xymatrix@C+2em{
  \pcoalg{\LL} \times_{\cal{E}} \palg{\RR}
  \ar@{.>}[r]^{Q'}
  \ar[d]
&
  \pcoalg{\LL}
  \ar[d]
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P'}
&
  \cal{E}^\to
\rlap{.}}
\]
Here $P'$ denotes the pullback functor, sending a cospan $(g, h)$ to $h^* g$.
\end{definition}

\begin{theorem} \label{thm:frobenius-comparison}
Let $(\mathsf{L}, \mathsf{R})$ be an algebraic weak factorization system on a category $\cal{E}$.
\begin{enumerate}[(i)] 
\item
The functorial Frobenius condition for $(\LL, \RR)$ holds if and only if $\mathsf{R}$-$\mathsf{alg}$ satisfies the uniform Frobenius condition with respect to $\mathsf{L}$-$\mathsf{coalg}$.
\item
Assume that $\cal{E}$ is locally Cartesian closed and that $(\LL, \RR)$ is cofibrantly generated by a category $\cal{I}$ of arrows.
The functorial Frobenius condition for $(\LL, \RR)$ holds if and only if $\liftr{\cal{I}}$ satisfies the uniform Frobenius condition with respect to $\cal{I}$.
\end{enumerate}
\end{theorem} 

\begin{proof}
Part (i) follows from \cref{uniform-frob-even-nicer}: there are functors over $\cal{E}^\to$ back and forth between $\pcoalg{\LL}$ and $\liftl{(\liftr{(\pcoalg{\LL})})}$ since $\pcoalg{\LL}$ is a category of left maps.

Part (ii) is more complicated.
First observe that there are functors over $\cal{E}^\to$ back and forth between $\pcoalg{\LL} = \liftl{(\liftr{\cal{I}})}$ and $\overline{\pCoalg{\LL}}$ (this is the case for (co)pointed endofunctor and (co)monad algebras over any (co)monad).
Applying $\liftr{(-)}$ and using \cref{retract-closure}, it follows that there are maps in $\CAT_{/\cal{E}^\to}$ back and forth between $\liftr{\cal{I}}$ and $\palg{\RR}$, and hence also between $\liftl{(\liftr{\cal{I}})}$ and $\pcoalg{\LL}$.
With this, the functorial Frobenius condition for $(\LL, \RR)$ takes the form of a lift
\begin{equation} \label{frobenius-comparison:0}
\begin{gathered}
\xymatrix@C+2em{
  \liftl{(\liftr{\cal{I}})} \times_{\cal{E}} \liftr{\cal{I}}
  \ar@{.>}[r]
  \ar[d]
&
  \liftl{(\liftr{\cal{I}})}
  \ar[d]
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P'}
&
  \cal{E}^\to
}
\end{gathered}
\end{equation}
emulating the form of uniform Frobenius of \cref{uniform-frob-even-nicer}, with a subtle difference: we are pulling back a map coming from $\liftl{(\liftr{\cal{I}})}$ instead of $\cal{I}$.
Since we have a map from the latter to the former, functorial Frobenius implies uniform Frobenius.

For the other direction, we first generalize the goal \eqref{frobenius-comparison:0} to relativized arrows as in~\eqref{uniform-frob-nice:lift} (with $\liftl{(\liftr{\cal{I}})}$ instead of $\cal{I}$ on the left) and then use analogues of \cref{uniform-frob-nice}, \cref{lift-pushforward,lift-pushforward} to write it separately as two components, first lifts of pushforward
\[
\xymatrix@C=1.5cm{
  {\liftr{\cal{I}}}_{/X}
  \ar[r]^{f_*}
  \ar[d]_{u_{/X}}
&
  \liftr{(\liftl{({\liftr{\cal{I}}})})}_{/Y}
  \ar[d]^{{\liftr{u}}_{/Y}}
\\
  \catE_{/X}^\to
  \ar[r]_{f_*}
&
  \catE_{/Y}^\to
}
\]
along any fixed right $\cal{I}$-map $f \co X \to Y$, and second lifts of the canonical map $t^* g_* p \to f_* s^* p$ to a right $\liftl{(\liftr{\cal{I}})}$-map for $(s, t) \co f \to g$ a map between right $\cal{I}$-maps and $p$ a right $\cal{I}$-map.
These are provided by the uniform Frobenius condition in the form of part~(ii) of both \cref{lift-pushforward,lift-pushforward-BC} after postcomposing the lifts in there with the map $\liftr{\cal{I}} \to \liftr{(\liftl{(\liftr{\cal{I}})})}$ provided by the unit of the adjunction~\eqref{garner-adjunction}.
\end{proof}
}

\section{Uniform fibrations}
\label{sec:unif}

We introduce uniform (trivial) fibrations and establish some basic properties.
Our main examples will be in categories of simplicial sets and cubical sets. 

\subsection*{Functorial cylinders}
Let $\catE$ be a fixed category with finite colimits. For our purposes, it will be convenient to 
work with a modified version of the standard definition of a functorial cylinder~\cite{kamps-porter:homotopy}, obtained by requiring also preservation of finite colimits.

\begin{definition} \hfill 
\begin{enumerate}[(i)]
\item A  \emph{functorial cylinder} $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ in $\calE$ is an endofunctor $\interval \otimes (-) \co \catE \to \catE$ preserving finite colimits
equipped with natural transformations $\lcyl \otimes (-), \rcyl \otimes (-) \co \Id_\catE \to \interval \otimes (-)$ called the \emph{left} and \emph{right endpoint inclusions}, respectively.
\item  We say the functorial cylinder as above has \emph{contractions} if there is a common retraction $\ccyl \otimes (-) \co \interval \otimes (-) \to \Id_\catE$ of $\lcyl \otimes (-)$ and $\rcyl \otimes (-)$, making the following diagram commute:
\[
\xymatrix@C+2em{
  \Id_\catE
  \ar[r]^-{\lcyl \otimes (-)}
  \ar@{=}[dr]
&
  \interval \otimes (-)
  \ar[d]^(0.4){\ccyl \otimes (-)}
&
  \Id_\catE
  \ar[l]_-{\rcyl \otimes (-)}
  \ar@{=}[dl]
\\&
  \Id_\catE
\rlap{.}}
\]
\end{enumerate}
\end{definition}

The notation $\interval \otimes (-)$ adopted here is deliberately suggestive of the fact that, in many examples, a functorial cylinder is defined using a monoidal structure and an interval object as in \cref{exa:cyl-via-int} below.
However, it is convenient to develop our theory without making this extra assumption.
We adopt the convention of associating the tensor product notation to the right in order to avoid excessive bracketing.

\begin{example} \label{exa:cyl-via-int}
Let $(\catE, \otimes, \top)$ be a monoidal category.
An \emph{interval object} $(\interval, \lcyl, \rcyl)$ in $\calE$ is an object~$\interval \in \catE$ equipped with maps $\lcyl, \rcyl \co \top \to \interval$ called the \emph{left} and \emph{right endpoint inclusions}, respectively, such that $I \otimes (-)$ preserves finite colimits.
It has \emph{contractions} if there is a common retraction $\ccyl \co \interval \to \top$ of $\lcyl$ and $\rcyl$, making the following diagram commute:
\[
\xymatrix@C+1em{
  \top
  \ar[r]^-{\lcyl}
  \ar@{=}[dr]
&
  \interval
  \ar[d]^(0.4){\ccyl}
&
  \top
  \ar[l]_-{\rcyl}
  \ar@{=}[dl]
\\&
  \top
\rlap{.}}
\]
If the unit $\top$ of the monoidal structure is also terminal, an interval object canonically has contractions.
Tensoring with an interval object (with contractions) evidently induces a functorial cylinder (with contractions).
\end{example}

Our main examples will have functorial cylinders induced by interval objects.







\begin{example}[Functorial cylinder in simplicial sets] \label{exa:cyl-in-sset}
We write $\SSet$ for the category of simplicial sets, defined as the category of presheaves $\Psh(\Delta)$ over the simplex category $\Delta$.
The category $\SSet$ has a cartesian closed structure. An interval object with contractions is given by $\Delta^1$ with endpoint inclusions $\lcyl = h_0^1 \co \braces{0} \to \Delta^1$ and $\rcyl = h_1^1 \co \braces{1} \to \Delta^1$.
Note that these are special cases of the horn inclusions $h_k^n \co \Lambda_k^n \to \Delta^n$.
As in \cref{exa:cyl-via-int}, taking the Cartesian product with $\Delta^1$ provides a functorial cylinder with contractions.
\end{example}

\begin{example}[Functorial cylinder in cubical sets] \label{exa:cyl-in-cuset}

Categories of cubical sets are defined as presheaves $\CSet = \Psh(\Box)$ over a cube category $\Box$ that encodes the specific variant of cubical sets under consideration.
The specific category $\Box$ considered in~\cite{cohen-et-al:cubicaltt} has objects $\Box^A$ with $|A| \in \mathbb{N}$ and morphisms $\Box^A \to \Box^B$ given by functions from $B$ to the free de Morgan algebra on $A$.
Thus, the corresponding category $\CSet$ of cubical sets has symmetries, diagonals, connections, and involutions.
The category $\Box$ has a symmetric monoidal structure, which makes cubical sets into a symmetric monoidal closed category $(\CSet, \otimes, \top)$.
Note that the presence of symmetries precludes $\Box$ from being a Reedy category as it has non-trivial isomorphisms.%
\footnote{
Something far less trivial is true in the joint presence of symmetries, diagonals, and connections: the morphism $\Box^{\braces{a, b}} \to \Box^{\braces{x, y}}$ that sends $x$ to $a \wedge b$ and $y$ to $a \vee b$ is neither an isomorphism nor does it factor through $\Box^1$; hence, the cube category in this case is not even a generalized Reedy category in the sense of~\cite{berger-moerdijk:generalized-reedy}.
}

We stress that the only feature of the cube category $\Box$ relevant for the main
results on the uniform Frobenius condition are connections and symmetries (although we speculate a two-sided version should carry over to classical cube categories with connections, but no symmetries).
Thus, our results apply equally to many other variations of cubical sets, excluding however 
those considered in~\cite{coquand-cubical-sets,huber-thesis}, which do not have connections.

The category of cubical sets $\CSet$ as studied in \cite{cohen-et-al:cubicaltt} has a monoidal structure with unit coinciding with the terminal object.
An interval object with contractions is given by $\Box^1$ with endpoint inclusions $\lcyl = \braces{0} \to \Box^1$ and $\rcyl \co \braces{1} \to \Box^1$ (formally given by the maps from a singleton set to the free de Morgan algebra on an empty set that pick false and true, respectively).
As in \cref{exa:cyl-via-int}, tensoring with $\Box^1$ provides a functorial cylinder with contractions.
\end{example}


\subsection*{Uniform fibrations} 

Let us now fix a functorial cylinder $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ in $\calE$.
Given a functor $u \co \cal{I} \to \catE^\to$ (which we think of as the counterpart of a set of generating cofibrations), we will define a functor $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ (which we think of as the counterpart of a set of generating trivial cofibrations) and use it to define the notion of a uniform $\cal{I}$-fibration.
The definition of $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ involves a special case of the so-called Leibniz construction~\cite{riehl-verity:reedy}), which we already reviewed 
in~\cref{sec:ortf}.

Given a natural transformation $\phi \co F \to G$ and a map $f \co X \to Y$, we define $\hateval(\phi, f) \co \catE^\to \to \catE^\to$ by the universal property of pushouts as in the following diagram:
\begin{equation} \label{definition-of-hateval}
\begin{aligned}
\xymatrix@C=1.2cm{
  FX
  \ar[r]^{Ff}
  \ar[d]_{\phi_X}
&
  FY
  \ar@/^2pc/[ddr]^{\phi_Y}
  \ar[d]
&\\
  GX
  \ar@/_1pc/[drr]_{Gf}
  \ar[r]
&
  GX +_{FX} FY
  \ar[dr]^-{\hateval(\phi, f)}
&\\&&
  GY
\rlap{.}}
\end{aligned}
\end{equation}
In this way, one obtains a functor $\hateval \co [\catE, \catE]^\to \times \catE^\to \to \catE^\to$.
Our choice of notation is due to appying the Leibniz construction to the evaluation functor $\eval \co [\catE,\catE] \times \calE \to \catE$.

For $u \co \cal{I} \to \catE^\to$ and $k \in \braces{0, 1}$, we define a functor $\kcyl \hatotimes u \co \cal{I} \to \catE^\to$ by letting
\[
  (\kcyl \hatotimes u)_i \defeq \kcyl \hatotimes u_i  \defeq \hateval(\kcyl, u_i) \, .
\]
We adopt similar conventions for other natural transformations (or maps of such) written using the tensor notation.
We now define the category~$\cal{I}_\otimes$ and the functor $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ that will be used to define the notion of a uniform $\cal{I}$-fibration in \cref{def:I-fibration} below.
First, let $\cal{I}_\otimes \defeq \cal{I} + \cal{I}$.
Then, define $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ via the coproduct diagram
\begin{equation}
\label{equ:u-tensor}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I}
  \ar[r]^{\iota_0}
  \ar[dr]_-{\lcyl \hatotimes u}
&
  \cal{I}_\otimes
  \ar[d]^(.4){u_\otimes}
&
  \cal{I}
  \ar[dl]^-{\rcyl \hatotimes u}
  \ar[l]_{\iota_1}
\\&
  \catE^\to
\rlap{.}}
\end{gathered}
\end{equation}
Note that, even if $u \co \cal{I} \to \catE^\to$ is an inclusion, $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ is not.
With these definitions in place, the notion of a uniform $\cal{I}$-fibration can be stated very succinctly, as in \cref{def:I-fibration} below.

\begin{definition} \label{def:I-fibration}
Let $u \co \cal{I} \to \catE^\to$ be a functor.
\begin{enumerate}[(i)]
\item A \emph{uniform $\cal{I}$-fibration} is a right $\cal{I}_\otimes$-map.
\item A \emph{uniform $\cal{I}$-fibration morphism} is a morphism of right $\cal{I}_\otimes$-maps.
\end{enumerate}
\end{definition}

We write $\Fib{\cal{I}}$ for the category of uniform $\cal{I}$-fibrations and their morphisms, \ie
\[
  \Fib{\cal{I}} \defeq \liftr{(\cal{I}_\otimes)} \, .
\]
One readily sees that the notion of a uniform $\cal{I}$-fibration involves diagonal fillers for diagrams having on the left maps obtained by pushouts of the form
\begin{gather*}
\xymatrix@C=1.2cm{
  A_i
  \ar[r]^{u_i}
  \ar[d]_{\kcyl \otimes A_i}
&
  B_i
  \ar@/^2pc/[ddr]^{\kcyl \otimes B_i}
  \ar[d]
&\\
  \interval \otimes A_i
  \ar@/_1pc/[drr]_{\interval \otimes u_i}
  \ar[r]
&
  (\interval \otimes A_i) +_{A_i} B_i
  \ar[dr]^-{\delta^k \hatotimes u_i}
&\\&&
  \interval \otimes B_i
\rlap{.}}
\end{gather*}
where $i \in \cal{I}$ and $k \in \{0, 1 \}$.


\subsection*{Uniform fibrations in presheaf categories} 


We now introduce and study  uniform  (trivial) fibrations  in presheaf categories. Let us fix a presheaf category $\catE = \Psh(\cat{C})$, where $\cat{C}$ is a small category, and
write $\yon \co \catC \to \catE$ for the Yoneda embedding. We assume that $\catE$ is equipped with a functorial cylinder $( \interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ and that the endofunctor $ \interval\otimes (-) \co \catE \to \catE$ has a right adjoint.\footnote{The latter assumption allows us to transport statements about uniform trivial fibrations to uniform fibrations via \cref{prod-exp-general}.}
In this setting, the analogy with the theory developed by Cisinski in~\cite{cisinski-asterisque}, it is 
natural to consider $\cal{I}$ to be a category of monomorphisms. Rather than taking all monomorphisms, we work making only some assumptions on this category, so as to recover
as a special case also the notion of uniform fibration in~\cite{cohen-et-al:cubicaltt}. 
We isolate the appropriate assumptions in the next definition.


\begin{definition} \label{uniform-fib-presheaf-cat}
A full subcategory $\cal{M}$ of $\catE_\cart^\to$ of monomorphisms is said
to be \emph{suitable} if the following conditions hold.
\begin{enumerate}[(i)]
\item For all $i$ in $\cal{M}$, any base change of $i$ is also in $\cal{M}$.
\item We have $\lcyl \hatotimes i \in \cal{M}$ and $\rcyl \hatotimes i \in \cal{M}$ for $i \in \cal{M}$.
\item We have $\bot_X \co 0_{\cal{E}} \to X$ in $\cal{M}$ for $X \in \cal{E}$.
\item The functor $I \otimes (-)$ preserves pullbacks for squares of the form $i \to j$ with $i, j \in \cal{M}$.
\item The naturality squares of $\lcyl \otimes (-)$ and $\rcyl \otimes (-)$ are pullbacks.
\end{enumerate}
\end{definition}

\begin{remark} \label{rem-lift-suitable}
Since pushouts in presheaf categories are stable under base change, conditions~(iv) and~(v) allow us to strengthen the objectwise assertion of condition~(iii) to a lift of the Leibniz product functor $\kcyl \hatotimes (-)$ to $\cal{M}$ as indicated below ($k \in \braces{0, 1}$):%
\footnote{Abstracting from the setting of a presheaf category, the core property used here is adhesiveness~\cite{garner-lack:adhesive} of the elements of $\cal{M}$.}
\[
\xymatrix{
  \cal{M}
  \ar@{.>}[r]^{\kcyl \hatotimes (-)}
  \ar[d]_{u}
&
  \cal{M}
  \ar[d]^{u}
\\
  \catE^\to
  \ar[r]_{\kcyl \hatotimes (-)}
&
  \catE^\to
\rlap{.}}
\]
\end{remark}

If one takes $\cal{M}$ to be the full subcategory of $\catE_\cart^\to$ of all monomorphisms, the 
conditions~(i) to~(v) are inherited from the setting of $\calE \defeq \Set$. This choice of $\cal{M}$
is particularly natural for presheaf categories over an elegant Reedy category~\cite{bergner-rezk-elegant} , where the right lifting property
with respect to boundary inclusions implies the right lifting property with respect to all monomorphisms
(see also~\cref{sec:non-alg}).  

We now fix a suitable category of monomorphisms $\cal{M}$ and write~$u \co \cal{M} \hookrightarrow \catE^\to$ to denote the inclusion. In analogy with the work of Cisinski~\cite{cisinski-asterisque}, where trivial fibrations as the maps having the right lifting properties with respect to monomorphisms, we refer to a  right $\cal{M}$-map as a \emph{uniform trivial $\cal{M}$-fibration} and define the category of uniform trivial $\cal{M}$-fibrations  by letting
\[
  \TrivFib{\cal{M}} \defeq \liftr{\cal{M}} \rlap{.}
\]
The compatibility condition for a uniform trivial $\cal{M}$-fibration $(f, \phi) \co X \to Y$ involves diagrams of the form
\[
\xymatrix{
  A
  \ar[r]^{h}
  \ar[d]_{i}
  \pullback{dr}
&
  C \ar[d]^{j}
  \ar[r]^{s}
&
  X \ar[d]^f
\\
  B
  \ar[r]_{k}
&
  D \ar[r]_{t}
&
  Y
\rlap{,}}
\]
where $i$ and $j$ are in $\cal{M}$ and the square on the left is a pullback. Uniform fibrations are defined to be
the right $\cal{M}_\otimes$-maps (as an instance of~\cref{def:I-fibration}) and the category of uniform  $\cal{M}$-fibrations
 is given by letting
\[
  \Fib{\cal{M}} \defeq \liftr{(\cal{M}_\otimes)} \rlap{.}
\]
Below, we illustrate the notion of a uniform (trivial) $\cal{M}$-fibration in the special cases of simplicial sets and cubical sets.


\begin{example}[Uniform  Kan fibrations in simplicial sets] In the category $\SSet$  of simplicial sets, we consider $\cal{M}$ to consist of all monomorphisms.\footnote{When working constructively, it is appropriate to restrict the attention to decidable  monomorphisms, \ie natural transformations whose components are injective functions with decidable image. See~\cref{rem:constructive-small-object} for further comments on this issue.} A uniform (trivial) $\cal{M}$-fibration will be called a \emph{uniform (trivial) Kan fibration}.
Explicitly, a uniform Kan fibration $(p, \phi) \co X \to Y$ consists of a simplicial map $p \co X \to Y$ and a function $\phi$ that provides diagonal fillers for diagrams of the form
\[
\xymatrix{
  (\Delta^1 \times A) \cup (\braces{k} \times B)
  \ar[r]
  \ar[d]
&
  X
  \ar[d]^{p}
\\
  \Delta^1 \times B
  \ar[r]
&
  Y
\rlap{,}}
\]
where the map on the left is the Leibniz product of the horn inclusion $h_k^1 \co \braces{k} \to \Delta^1$ mentioned in \cref{exa:cyl-in-sset} with a  monomorphism $i \co A \to B$.
Note that higher-dimensional horns are not involved explicitly here.
However, they are included indirectly since they are retracts of the Leibniz product of a one-dimensional horn inclusion with themselves~\cite[Chap.~IV, Sec.~2]{gabriel-zisman:calculus-of-fractions}.
We will show in \cref{thm:ac-kan-is-uniform} that every Kan fibration in the usual sense admits the structure of a uniform Kan fibration.
\end{example}

\begin{example}[Uniform Kan fibrations in cubical sets] Also in the category $\CSet$  of cubical sets, we consider $\cal{M}$ to consist of all monomorphisms. A uniform (trivial) $\cal{M}$-fibration in $\CSet$ will be called a \emph{uniform (trivial) Kan fibration}.
To illustrate the relationship with the standard Kan filling condition for cubes, let $i^n \co \partial \Box^n \to \Box^n$ for $n \in \mathbb{N}$ denote the boundary inclusion for~$\Box^n$, given as the $n$-fold Leibniz tensor of $[\lcyl, \rcyl] \co \braces{0, 1} \to \Box^1$.%
\footnote{Note that for our choice of cube category, which is not Reedy, this will not be a maximal non-trivial subobject.}
Then~$\lcyl \hatotimes i^n$ and $\rcyl \hatotimes i^n$ equal the inclusions $\sqcup_1^{1+n} \to \Box^{1+n}$ and $\sqcap_1^{1+n} \to \Box^{1+n}$, respectively.
Since our cube category has symmetries, a uniform Kan fibration in $\CSet$ is a right map (in the algebraic sense) also to open box inclusions, which are
counterparts in cubical sets of the horn inclusions in simplicial sets.%
\footnote{Without symmetries, one should consider two-sided Leibniz tensors such as $i^a \hatotimes \lcyl \hatotimes i^b \co \sqcup_a^{a+1+b} \to \Box^{a+1+b}$.}

The fibrant cubical types defined in~\cite{cohen-et-al:cubicaltt} arise by considering the uniform $\cal{M}'$-fibrations where~$\cal{M}'$ is the full subcategory of $\cal{M}$ spanned by (decidable) monomorphisms classified by their face lattice $\mathbb{F}$, \ie those arising as a base change of $\braces{\top} \to \mathbb{F}$, excluding for example diagonals in cubes.
Since the presence of symmetries, diagonals, and connections precludes the cube category being Reedy, this may turn out to be a natural restriction.
Note that this choice $\cal{M}'$ also satisfies the properties~(i) to~(v) of \cref{uniform-fib-presheaf-cat} and is thus covered by our development.
\end{example}

\begin{remark} \label{cisinski-remark}
We briefly relate the notion of a uniform $\cal{I}$-fibration with that of a naive fibration, intoduced by Cisinski~\cite{cisinski-asterisque}.
For this, let $m \otimes (-)  \co \Id_\catE + \Id_\catE \to \interval \otimes (-)$ be given by
\[
  m \otimes (-) \defeq [\lcyl \otimes (-), \rcyl \otimes (-)] \, .
\]
Then a uniform naive Cisinski $\cal{I}$-fibration would be defined as a right map for the functor $u_\otimes' \co \cal{I}_\otimes' \to \catE^\to$, where $\cal{I}_\otimes' \defeq \mathbb{N} \times \cal{I}_\otimes$ and $u_\otimes'(n, i) \defeq (m \hatotimes (-))^n(u_\otimes(i))$.
Informally, one can think of
$\cal{I}_\otimes'$ as the closure of $\cal{I}_\otimes$ under Leibniz product with $m$.
Our reasons for working with~$\Fib{\cal{I}}$ instead of $\liftr{(\cal{I}_\otimes')}$ are twofold.

First, if the functorial cylinder is induced by tensoring with an interval object in a symmetric monoidal category and the functor $u \co \cal{I} \to \catE^\to$ is closed under Leibniz product with the boundary inclusion $[\lcyl, \rcyl] \co 1 + 1 \to \interval$, then by permuting the Leibniz product one sees that every uniform $\cal{I}$-fibration also has canonically the structure of a uniform naive Cisinski $\cal{I}$-fibration.
This is the case in our main examples of simplicial and cubical sets where $u \co \cal{I} \to \catE^\to$ is the subcategory of all monomorphisms, the map $[\lcyl, \rcyl]$ is a  monomorphism, and Leibniz product preserves  monomorphisms.

For our second point, we use some notions introduced in~\cref{sec:unifshe}.
If we assume generalized connections (in the sense of $(1+n+1)$-ary operations that behave as connections for fixed middle~$n$ arguments), and that $\cal{I}$ is closed under Leibniz product not just with endpoint inclusions, but also with $[\lcyl, \rcyl]$ (this is the case if $[\lcyl, \rcyl]$ is a  monomorphism and the maps in~$\cal{I}$ are the  monomorphisms in a presheaf category), then the maps in $\cal{I}_\otimes'$ can still be shown to be strong homotopy equivalences in a uniform way.
This gives rise to a functor $\cal{I}_\otimes' \to \cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})$ over~$\catE^\to$ (where $\cal{S}_k(\cal{I})$ for $k \in \{0,1\}$ are the categories of strong homotopy equivalences relative to~$\cal{I}$ that we will define in \cref{sec:unifshe}).
By \cref{relating-strong-hequiv-and-uniform-fib}, it then follows that every uniform naive Cisinski $\cal{I}$-fibration is a uniform $\cal{I}$-fibration in a functorial way.
\end{remark}







We wish to establish that uniform trivial $\cal{M}$-fibrations and uniform $\cal{M}$-fibrations are the right maps of two algebraic weak factorization systems.
We will do so using Garner's small object argument~\cite{garner:small-object-argument}.
In order to apply it, we establish that uniform (trivial) fibrations can be defined equivalently by right uniform 
orthogonality 
with respect to small categories over $\catE$. We begin with some general facts.

\begin{lemma} \label{left-kan-extension-of-representables}
Let $\cal{J}$ be a full subcategory of $\catE_{\cart}^\to$ closed under base change to representables, \ie closed under pullbacks along morphisms with domain a representable presheaf.
Let $\cal{I}$ denote its restriction to arrows into representables.
\[
\xymatrix@C-1em{
  \cal{I}
  \ar[rr]
  \ar[dr]
&&
  \cal{J}
  \ar[dl]
\\&
  \catE^\to
}
\]
Then the inclusion $\cal{J} \to \catE^\to$ is the left Kan extension of $\cal{I} \to \catE^\to$ along $\cal{I} \to \cal{J}$.
\end{lemma}

\begin{proof}
Since $\catE^\to$ is cocomplete, we can verify the claim using the colimit formula for left Kan extensions.
All of the following will be functorial in an object $j \co A \to B$ of $\cal{J}$.
We consider the diagram in $\catE^\to$ indexed by pullback squares of the form
\[
\xymatrix@C=1.2cm{
  A'
  \ar[r]
  \ar[d]_{i}
  \pullback{dr}
&
  A
  \ar[d]^{j}
\\
  \yon(x)
  \ar[r]_-{b}
&
  B
}
\]
with $i \co A' \to \yon(x)$ in $\cal{I}$ and valued $i$.
Our goal is to show that its colimit is $j$.
Using the assumption that $\cal{J}$ is closed under base change to representables, the given diagram can be described equivalently as the the diagram indexed by maps $b \co \yon(x) \to B$ and valued $b^*(j)$.
The claim can then be restated as $\colim_{b \co \yon(x) \to B} b^*(j) \iso j$, which holds since pullback commutes with colimits in presheaf categories, and $\colim_{b \co \yon(x) \to B} \yon(x) \iso B$.
\end{proof}

\begin{proposition} \label{awfs-on-arrows-into-representables}
Let~$\cal{J}$ be a full subcategory of $\catE_{\cart}^\to$ closed under base change to representables.
Let $\cal{I}$ denote its restriction to arrows into representables,
\[
\xymatrix@C-1em{
  \cal{I}
  \ar[rr]
  \ar[dr]
&&
  \cal{J}
  \ar[dl]
\\&
  \catE^\to
\rlap{.}}
\]
Then $\liftr{\cal{I}} = \liftr{\cal{J}}$.
\end{proposition}

\begin{proof}
The result follows by combining part~(i) of \cref{kan-extension-closure} and \cref{left-kan-extension-of-representables}.
\end{proof}

\begin{lemma} \label{small-gen-triv-kan}
Let $\cal{N}$ be the full subcategory of $\cal{M}$ spanned by the mononorphisms with a representable presheaf as codomain.
\begin{enumerate}[(i)]
\item There is an isomorphism $\TrivFib{\cal{M}} = \TrivFib{\cal{N}}$.
\item There is an isomorphism $\Fib{\cal{M}} = \Fib{\cal{N}}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (i) follows from \cref{awfs-on-arrows-into-representables} using condition~(i) of \cref{uniform-fib-presheaf-cat}, while part (ii) follows from part (i) and \cref{prod-exp-general}.
\end{proof}

In particular, part (i) of \cref{small-gen-triv-kan} says that, for a map $f \co X \to Y$ in $\catE$, to give a natural choice of fillers for all diagrams with an arbitrary element of $\cal{M}$ on the left is the same as to give a natural choice of fillers for only those diagrams which are  the form
\[
\xymatrix{
  A
  \ar[r]
  \ar[d]
&
  X
  \ar[d]^f
\\
  \yon(x)
  \ar[r]
&
  Y
\rlap{,}}
\]
where $\yon(x)$ the Yoneda embedding of some $x \in \catC$.
The reduction to this type of diagrams relies essentially on the good behaviour of the right orthogonality functor with respect to colimits as described in~\cref{awfs-on-arrows-into-representables}, which is not available in the setting of standard
weak factorisation systems.

\begin{remark}
Let us point out that by \cref{small-gen-triv-kan} we have that $\TrivFib{\cal{M}} = \liftr{\cal{S}}$ for every full subcategory~$\cal{S} \subseteq \cal{M}$ containing~$\cal{N}$, since~$\cal{N}$ is then also the restriction to maps into representables of $\cal{S}$.
For example, one could consider for $\cal{S}$ the full subcategory of $\cal{M}$ spaned by maps with codomain a finite product of representables or, in the case of simplicial sets, a finite and finite-dimensional simplicial set.
These subcategories enjoy different closure properties.
Since they all have the same right category, one may consider different options according to the situation at hand.
Note that $\cal{N}$ has the key advantage of being a small category.
We expoit this fact to obtain our second main results, \cref{thm:sset-cset-nwfs}, in the rest of this section.
\end{remark}

\cref{small-gen-triv-kan} allows us to apply Garner's small object argument~\cite[Theorem~4.4]{garner:small-object-argument} (see 
also~\cite[Proposition~16]{bourke-garner-I}) and obtain the desired algebraic weak factorization systems.

\begin{theorem} \label{thm:sset-cset-nwfs} Let $\catE$ be a presheaf category
equipped with a functorial cylinder $I \otimes (-) \co \catE \to \catE$ that has a right adjoint
and a suitable category $\cal{M}$ of monomorphisms (in the sense of~\cref{uniform-fib-presheaf-cat}).
\begin{enumerate}[(i)]
\item There exists an algebraic weak factorization systems $(\mathsf{L}_1, \mathsf{R}_1)$ in which right maps are the uniform trivial $\cal{M}$-fibrations.
In particular, every map $f \co X \to Y$ admits a functorial factorization of the form
\[
\xymatrix{
  X
  \ar[rr]^{f}
  \ar[dr]_{i_f}
&&
  Y
\\&
  C_f
  \ar[ur]_{q_f}
}
\]
where $q_f$ admits the structure of a uniform trivial $\cal{M}$-fibration and $i_f$ admits the structure of a $\mathsf{L}_1$-coalgebra.
\item There exists an algebraic weak factorization systems $(\mathsf{L}_2, \mathsf{R}_2)$ in which right maps are the uniform $\cal{M}$-fibrations.
In particular, every map $f \co X \to Y$ admits a functorial factorization of the form
\[
\xymatrix{
  X
  \ar[rr]^{f}
  \ar[dr]_{j_f}
&&
  Y
\\&
  P_f
  \ar[ur]_{p_f}
}
\]
where $p_f$ admits the structure of a uniform $\cal{M}$-fibration and $j_f$ admits the structure of a $\mathsf{L}_2$-coalgebra.
\end{enumerate}
\end{theorem}

\begin{proof} For (i), one applies Garner's small object argument, using  part (i) of~\cref{small-gen-triv-kan} and smallness of $\cal{N}$.
Similarly, for (ii), one uses part (ii) of~\cref{small-gen-triv-kan} and smallness of $\cal{N}_\otimes$.
\end{proof} 





\begin{remark} \label{rem:constructive-small-object}
\cref{thm:sset-cset-nwfs} applies to both $\SSet$ and $\CSet$. In these cases, we explain why the result can be proved
 constructively, \ie without using 
the law of excluded middle or the axiom of choice. 
First, observe that in these examples every subobject of a representable is finitely presentable and that the functorial cylinder $\interval \otimes (-) \co \cal{E} \to \cal{E}$ preserves finitely presentable objects. For part~(i), by the assumption that subobjects of representables are finitely presentable, the values of the inclusion $u \co \cal{N} \to \cal{E}^\to$ are finitely presentable objects of $\cal{E}^\to$.
An inspection of the proof of \cite[Theorem~4.4]{garner:small-object-argument} shows that this suffices to construct the algebraically-free algebraic weak factorization system $(\mathsf{L}_1, \mathsf{R}_1)$ on $u \co \cal{N} \to \cal{E}^\to$, and in fact the sequence constructing the appropriate free monad converges after $\omega$ steps. 
The fact that the category of $\mathsf{R}_1$-algebras is the category of uniform trivial $\cal{M}$-fibrations follows from part~(i) of \cref{small-gen-triv-kan}.
The reasoning for part (ii) is analogous, noting that also the values of $u_\otimes$ are finitely presentable by the assumption of the functorial cylinder and the fact that finitely presentable objects are closed under pushout. 

For this argument, the assumption of working with decidable monomorphisms in a constructive setting is used
to obtain the smallness of $\cal{N}$ and $\cal{N}_\otimes$ without relying on the Power Set axiom. We believe 
that this restriction is important also to treat constructively further aspects of the theory, such as universes~\cite{cohen-et-al:cubicaltt}.

\cref{thm:sset-cset-nwfs} suggests the possibility of defining constructively model structures on $\SSet$ and $\CSet$ having as (trivial) fibrations the maps that admit the structure of a uniform (trivial) Kan fibration.
We leave this question to further investigation. 


\end{remark} 





\section{Uniform fibrations in elegant Reedy presheaf categories}
\label{sec:non-alg}

The aim of this section\footnote{Readers interested in constructive aspects should note that  the law of excluded middle and the axiom of choice are used in this section.} is to study the notion of a uniform (trivial) $\cal{M}$-fibration in the context of presheaf categories over elegant Reedy presheaves, in the sense of \cite{bergner-rezk-elegant}, equipped with a functorial cylinder whose endofunctor has a right adjoint.%
\footnote{It might be possible to adapt our arguments to a weaker setting where instead of having a right adjoint, the functorial cylinder only preserves certain colimits, but we do not pursue this direction here since our examples satisfy the stronger condition.}
In particular, we introduce the notion of a (trivial) fibration and fibration in that setting,  generalizing in an
essentially straightforward way the definitions of the notion of a (trivial) Kan fibration in simplicial sets.
We then show that every (trivial) fibration admits the structure of a uniform (trivial) $\cal{M}$-fibration for any choice of~$\cal{M}$ as a full subcategory of monomorphisms of $\cal{E}_{\cart}^\to$, thereby establishing how our notions relate to more familiar ones.
The primary role of elegancy is to allow us to factor any map in $\cal{M}$ into a series of cobase changes of boundary inclusions, allowing us to decompose lifting problems for uniform trivial $\cal{M}$-fibrations into lifting problems for trivial fibrations. Let us begin by reviewing some terminology.

\begin{definition} A \emph{Reedy category} $(\R, \deg, \Rp, \Rm)$ is a category $\R$ equipped with a \emph{degree function} $\deg \co \obj(\R) \to \alpha$, where $\alpha$ is some ordinal, and wide subcategories $\Rp, \Rm$ satisfying the following properties:
\begin{enumerate}[(i)]
\item the maps of $\Rp$, called \emph{cofaces}, are monotone with respect to $\deg$,
\item the maps of $\Rm$, called \emph{codegeneracies}, are antimonotone with respect to $\deg$,
\item every map in $\R$ is assumed to factor uniquely as a codegeneracy followed by a coface,
\item the only isomorphisms in $\R$ are identities.
\end{enumerate}
\end{definition}

For every degree $n < \alpha$, we have a \emph{skeleton} comonad $\Sk_{<n}$ and a \emph{coskeleton} monad $\Cosk_{<n}$ on $\catE = \Psh(\R)$ (both idempotent) forming an adjunction $\Sk_{<n} \dashv \Cosk_{<n}$ derived from left and right Kan extension along the full embedding $\R_{<n} \to \R$ of objects of degree less than $n$.
Given a presheaf $F$ on $R$, an element $x \in F(A)$ is called \emph{degenerate} and a \emph{degeneracy of} $y \in F(B)$ if there is non-identity $d \co A \to B$ in $\Rm$ such that $x = Fd(y)$. The notion of an elegant Reedy category,
recalled below, was introduced originally in~\cite{bergner-rezk-elegant}.

\begin{definition} A Reedy category~$\R$ is said to be \emph{elegant} if every element in any presheaf on~$\R$ is a degeneracy in a unique way.
\end{definition} 

For example, the simplex category $\Delta$ is an elegant Reedy category.
In an elegant Reedy category $\R$, the action of $\Sk_{<n}$ can be described as keeping only the non-degenerate elements of degree strictly less than $n$: for any $X \in \Psh(\R)$, the counit $\Sk_{<n}(X) \to X$ of the skeleton comonad on $X$ is a monomorphism.
Given $A \in \R$, the \emph{boundary} of $A$ is defined as $\partial A \defeq \Sk_{<\deg(A)}(\yon A)$.
The counit of $\Sk_{<\deg(A)}$ induces a \emph{boundary inclusion} monomorphism $i^A \co \partial A \to \yon A$.

\medskip

For the remainder of this section, we fix an elegant Reedy category~$\R$ and consider the category~$\calE \defeq \Rhat$ of presheaves over it.%
\footnote{Note that our use of elegant Reedy presheaves is different from the one considered in~\cite{shulman:reedy} since here presheaves are valued in the category of sets, not in simplicial sets.}
We start by defining the following notion of a (trivial) fibration (\cf also \cref{cisinski-remark}).

\begin{definition}
Let $\cal{I}$ be the discrete subcategory of $\catE^{\to}$ consisting of boundary inclusions $\partial A \to \yon A$.
We define:
\begin{enumerate}[(i)]
\item a \emph{trivial fibration} is a right $\cal{I}$-map,
\item a \emph{fibration} is a right $\cal{I}_\otimes$-map.
\end{enumerate}
\end{definition}

Using the axiom of choice, a map is a trivial fibration if and only if it has the right lifting property against boundary inclusions.
In the case of simplicial sets, these notions then coincide with the classical notions of trivial Kan fibration and Kan fibration~\cite[Chap.~IV, Sec.~2]{gabriel-zisman:calculus-of-fractions}.

\medskip

We first establish the equivalence between trivial fibrations and uniform trivial $\cal{M}$-fibrations (note that \cref{awfs-on-arrows-into-representables} cannot be applied here since the class of boundary inclusions as a discrete category does not represent the added coherence of $\cal{N}$).
For this, we require an auxiliary notion.

\begin{definition}
A \emph{regular trivial fibration} is a right $\cal{J}$-map, where $\cal{J}$ is the subcategory of~$\catE^{\to}$ that has as objects boundary inclusions $\partial A \to \yon A$ and identity maps $\id_{\yon A} \co \yon A \to \yon A$, and as non-identity morphisms commutative squares
\[
\xymatrix{
  \partial A_1
  \ar[r]
  \ar[d]
&
  \yon A_2
  \ar[d]
\\
  \yon A_1
  \ar[r]_{\yon(d)}
&
  \yon A_2
}
\]
where $d \co A_1 \to A_2$ is in $\Rm$ and non-trivial, \ie not an identity map.
\end{definition}

In the above definition, the category $\cal{J}$ has been chosen so that a regular trivial fibration consists of a 
map equipped with the choice of right lifts against boundary inclusions, such that the lifts are given by degenerate 
elements whenever those already constitute a lift. In particular, any two degenerate lifts must coincide.
This explains why we have to restrict $d \co A_1 \to A_2$ to non-identity maps: without this restriction, regular trivial fibrations would have unique lifts against boundary inclusions, which is too restrictive.


Below, we start by proving that every trivial fibration admits the structure of a regular trivial fibration (\cref{trivial-fibration-to-regular}).
Then, we show that every regular trivial fibration admits the structure of a uniform trivial  fibration~(\cref{regular-trivial-fibration-to-uniform}). The combination of these facts shows that every trivial fibration  can be equipped with the structure of a uniform trivial fibration, from which the corresponding result for fibrations follows easily.




\begin{proposition} \label{trivial-fibration-to-regular}
Every trivial fibration can be equipped with the structure of a regular trivial fibration.
\end{proposition}

\begin{proof}
Consider a lifting problem as follows:
\begin{equation}  \label{trivial-fibration-to-regular:0}
\begin{gathered}
\xymatrix{
  \partial A
  \ar[d]_{i^A}
  \ar[r]^{s}
&
  X
  \ar[d]^{p}
\\
  \yon A
  \ar[r]^{t}
&
  Y
\rlap{.}}
\end{gathered}
\end{equation}
We need to choose a filler for it such that for every non-trivial codegeneracy $d \co A \to B$ and factorization of~\eqref{trivial-fibration-to-regular:0} as below,
\begin{equation} \label{trivial-fibration-to-regular:1}
\begin{gathered}
\xymatrix@C+3em{
  \partial A
  \ar[r]^{\yon(d) \cc i^A}
  \ar[d]_{i^A}
  %\ar@/^2em/[rr]^{s}
&
  \yon B
  \ar@{.>}[r]^{s'}
  \ar@{=}[d]
&
  X
  \ar[d]^{p}
\\
  \yon A
  \ar[r]_{\yon(d)}
  %\ar@/_2em/[rr]_{t}
&
  \yon B
  \ar@{.>}[r]_{t'}
&
  Y
\rlap{,}}
\end{gathered}
\end{equation}
the chosen filler for the now composite square coheres with the unique filler for the right square.

We do this by case distinction  on whether a factorization~\eqref{trivial-fibration-to-regular:1} exists at all.
If none exist, we choose the filler provided to us by $p$ being a trivial fibration.
If one exists, we choose $s' \cc \yon(d)$ as filler.

It only remains to justify that the latter choice is independent of the particular factorization.
This is where we use the assumption that the Reedy category $\R$ is elegant.
\cref{pushout-non-trivial-deg-boundary} below shows that any two factorings through non-trivial codegeneracies $d_1$ and $d_2$ extend to a common factoring through the pushout of $d_1$ and $d_2$, yielding independence as required.
Note this also shows the existence of a unique largest factoring since $\alpha$ is well-founded.
\end{proof}

\begin{lemma}
\label{pushout-non-trivial-deg-boundary}
Let $d_i \co A \to B_i$ be a non-trivial codegeneracy for $i \in \braces{1, 2}$.
Then the span $(d_1, d_2)$ has a pushout $(e_1, e_2)$ with $e_i \co B_i \to C$ a codegeneracy for $i \in \braces{1, 2}$.
The image of this square under the Yoneda embedding is again a pushout.
Furthermore, this pushout is stable under right composition with the boundary inclusion $i^A \co \partial A \to \yon A$.
\end{lemma}

\begin{proof}
Everything up until the last sentence is part of the characterization of elegancy in~\cite[Proposition~3.8]{bergner-rezk-elegant}.
For the remaining claim, note that right composing the pushout square under consideration with $\partial A \to \yon A$ is tantamount to applying $\Sk_{<\deg(A)}$ to the square since we assumed $d_1, d_2$ to be non-trivial, \ie degree reducing.
But $\Sk_{<\deg(A)}$ is a left adjoint and hence preserves pushouts.
\end{proof}

Note that the construction of \cref{trivial-fibration-to-regular} does not seem to extend to a functor from the category of trivial fibrations to the category of regular trivial fibrations over $\catE^{\to}$.

\medskip

We  now relate regular trivial fibrations with uniform trivial $\cal{M}$-fibrations.
For this, we review how to reduce a lifting problem involving a monomorphism to lifting problems involving boundary inclusions.

\begin{definition} \hfill 
\begin{enumerate}[(i)] 
\item A \emph{cellular presentation} of a monomorphism $i \co U \to V$ in $\catE$ is a cocontinuous ordinal-indexed diagram $F \co \gamma \to \catE_{\backslash U}$ with colimit $i$
\[
\xymatrix{
  U = F 0
  \ar[r]^-{F s_0}
&
  F 1
  \ar[r]^{F s_1}
&
  \ldots
  \ar[r]
&
  V
}
\]
such that for $\beta + 1 < \gamma$, the image of a successor step $s_{\beta} \co \beta \to \beta + 1$ under $F$ is a (possibly infinite) coproduct of boundary inclusions.
\item A \emph{morphism of cellular presentations} from $F \co \gamma \to \cal{E}_{\backslash U}$ to $G \co \delta \to \cal{E}_{\backslash U}$ is a map $h \co \delta \to \gamma$ such that $F \simeq G \cc h$.
\end{enumerate}
\end{definition}

Note that a transfinite composition of cobase changes of coproducts of cellular presentations can be flattened to a single cellular presentation.

\begin{remark}
\label{elegant-reedy-lift-independent-of-cellular-presentation}
Let $p \co X \to Y$ be a trivial fibration and $i \co A \to B$ a monomorphism.
Any cellular presentation of $i$ induces a lifts of $i$ against $p$.
If $R$ is elegant, such a lift exists and is uniquely determined independent of chosen the cellular presentation.

Existence follows by using the \emph{canonical cellular presentation} $F \co \alpha \to \cal{E}$ of $i$, in which the $\beta$-th successor step adds the non-degenerate representables of degree $\beta$ in $V$ not contained in $U$ (see \cite{riehl-verity:reedy} for a categorical exposition).
For uniqueness, we may for example show that any other cellular presentation $G \co \gamma \to \cal{E}$ of $i$ induces the same lift against $p$ as $F$.
Given $\beta \leq \alpha$, we may restrict the coproduct index set in each pushout step in $G$ to objects of degree less than $\beta$ so as to obtain a cellular presentation $G'_\beta$ of $A \to F \beta$.
By transfinite induction over $\beta$, standard reasoning in the theory of Reedy presheaves (via a nested transfinite induction in the successor case) may then be applied to show that $G'$ induces the same lift of $A \to F \beta$ against $p$ as $F|_{\beta}$.
\end{remark}

\begin{proposition} \label{regular-trivial-fibration-to-uniform}
Every regular trivial fibration can be equipped with the structure of a uniform trivial $\cal{M}$-fibration.
\end{proposition}

\begin{proof}
Let $p \co X \to Y$ be a regular trivial fibration.
Let $i \co U \to V$ be a monomorphism in $\cal{M}$ and consider a lifting problem as follows:
\begin{equation} \label{regular-trivial-fibration-is-uniform:0}
\xycenter{
  U
  \ar[d]_{i}
  \ar[r]
&
  X
  \ar[d]^{p}
\\
  V
  \ar[r]
  \ar@{.>}[ur]
&
  Y
\rlap{.}}
\end{equation}
We use the regular trivial fibration structure of $p$ to construct the filler in~\eqref{regular-trivial-fibration-is-uniform:0} via any cellular presentation of $i$ following \cref{elegant-reedy-lift-independent-of-cellular-presentation} (using that $\R$ is elegant).

It remains to verify coherence of fillers with respect to pullback squares between monomorphisms in $\cal{M}$:
\begin{equation} \label{regular-trivial-fibration-is-uniform:1}
\xycenter{
  U'
  \ar[d]_{i'}
  \ar[r]
  \pullback{dr}
&
  U
  \ar[d]_(0.3){i}
  \ar[r]
&
  X
  \ar[d]^{p}
\\
  V'
  \ar[r]
  \ar@{.>}[urr]
&
  V
  \ar[r]
  \ar@{.>}[ur]
&
  Y
\rlap{.}}
\end{equation}
Choose a cellular presentation for $i$.
Pullback along $V' \to V$ induces a corresponding transfinite decomposition of $i'$ into cobase changes of coproducts of monomorphisms.
Since the fillers for squares~\eqref{regular-trivial-fibration-is-uniform:0} are independent of the chosen cellular presentation, it suffices to verify coherence of fillers in~\eqref{regular-trivial-fibration-is-uniform:1} with $i$ replaced by a single boundary inclusion as in~\eqref{regular-trivial-fibration-is-uniform:2} below and apply transfinite induction to the chosen cellular presentation for $i$.

It remains to verify coherence of fillers with respect to base changes of boundary inclusions as follows:
\begin{equation} \label{regular-trivial-fibration-is-uniform:2}
\xycenter{
  U'
  \ar[d]_{i'}
  \ar[r]
  \pullback{dr}
&
  \partial A
  \ar[d]_(0.3){i^A}
  \ar[r]
&
  X
  \ar[d]^{p}
\\
  V'
  \ar[r]_{m}
  \ar@{.>}[urr]^(0.3){e'}
&
  \yon A
  \ar[r]
  \ar@{.>}[ur]_{e}
&
  Y
\rlap{.}}
\end{equation}
Choose a cellular presentation $F \co \gamma \to \catE \backslash U'$ for $i'$.
For $\beta < \gamma$, let $e_{\beta}' \co F(\beta) \to X$ denote the $\beta$-th stage of the construction of the composite filler $e'$ in~\eqref{regular-trivial-fibration-is-uniform:2} and write $t_{\beta} \co F(\beta) \to V'$ for the leg of the colimiting cocone of $V'$ under $F$.
Note that $e_{\beta}' = e' t_{\beta}$.
We will show that $e' t_{\beta} = e m t_{\beta}$ by transfinite induction on $\beta$.
Passing to the colimit, it will then follow that $e' m = e$ as required.

For the actual induction, the limit step similarly follows by passing to the colimit.
For the successor step, let $\beta$ with $\beta + 1 < \gamma$ be given.
We want to show $e_{\beta+1}' = e m t_{\beta+1}$ assuming that $e_{\beta}' = e m t_{\beta}$, \ie
\begin{equation} \label{regular-trivial-fibration-is-uniform:ih}
  e_{\beta+1}' \cc F(s_{\beta}) = e m t_{\beta+1} \cc F(s_{\beta}) \, .
\end{equation}
Here we have recalled that $e_{\beta}' = e_{\beta+1}' \cc F(s_{\beta})$ and $t_{\beta} = t_{\beta+1} \cc F(s_{\beta})$ where $F(s_{\beta})$ is given as a cobase change of a coproduct of boundary inclusions.
It will suffice to focus on one such boundary inclusion as shown below:
\begin{equation} \label{regular-trivial-fibration-is-uniform:3}
\xycenter{
  \bullet
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  U'
  \ar[rr]
  \ar[d]
  \pullback{dr}
&&
  \partial A
  \ar[r]
  \ar[dd]_(0.6){i^A}
&
  X
  \ar[dd]^{p}
\\
  \partial B
  \ar[r]^{b'}
  \ar[d]_{i^B}
  \pullback{dr}
&
  F(\beta)
  \ar[d]_{F(s_{\beta})}
  \ar@{.>}[urrr]^(0.4){e_{\beta}'}
\\
  \yon B
  \ar[r]_-{b}
&
  F(\beta+1)
  \ar[r]_-{t_{\beta+1}}
  \ar@{.>}[uurrr]_(0.4){e_{\beta+1}'}
&
  V'
  \ar[r]_{m}
&
  \yon A
  \ar[r]
  \ar@{.>}[uur]^{e}
&
  Y
\rlap{,}}
\end{equation}
and verify that $e_{\beta+1}' b = e m t_{\beta+1} b$, which will be our goal for the remainder of this proof.
Here, the right pullback is derived from the pullback in~\eqref{regular-trivial-fibration-is-uniform:2} using that $t_{\beta+1}$ is mono.
Recall that $e_{\beta+1}' b$ is by construction the filler for the above lifting problem from $i^B$ to $p$ provided by the given right lifting structure of $p$.

Write $m t_{\beta+1} b = \yon(d)$ with $d \co B \to A$.
Note that $d$ has to be codegenerate.
For otherwise, we would have $\yon(d)$ lifting through $i^A \co \partial A \to \yon A$.
Recalling that the base change of $i^A$ along itself is an isomorphism since $i^A$ is mono, it would follow that the base change of $i^A$ along $\yon(d)$ is an isomorphism as well.
But as seen in~\eqref{regular-trivial-fibration-is-uniform:3}, this isomorphism would lift through $i^B$, making $i^B$ a retraction and hence an isomorphism, a contradiction.

We proceed  by case distinction on whether $d$ is the identity on $A$, \ie $B = A$ and $m t_{\beta+1} b = \id_A$.
If that is the case, then the goal reduces to $e_{\beta+1}' b = e$.
But $e$ and $e_{\beta+1}' b$ are fillers for the same lifting problem from $i^A$ to $p$.
Since they have both been provided by the given right lifting structure of $p$, they are equal.

The remaining and main case is that $d$ is non-trivially codegenerate.
But then we can make use of $\cal{J}$-coherence in the following comparison of lifting problems:
\[
\xymatrix{
  \partial B
  \ar[r]
  \ar[d]_{i^B}
  \pullback{dr}
&
  F(\beta)
  \ar[rr]
  \ar[d]_{F(s_{\beta})}
&&
  \yon A
  \ar[r]^{e}
  \ar@{=}[d]
&
  X
  \ar[d]^{p}
\\
  \yon B
  \ar[r]_-{b}
  \ar@{.>}[urrrr]_(0.6){e_{\beta+1}' b}
&
  F(\beta+1)
  \ar[r]_-{t_{\beta+1}}
&
  V'
  \ar[r]_-{m}
&
  \yon A
  \ar[r]
  \ar@{.>}[ur]_{e}
&
  Y
\rlap{.}}
\]
Commutativity of the top triangle of the composite square follows from the induction hypothesis~\eqref{regular-trivial-fibration-is-uniform:ih}.
Recalling that the dotted fillers are provided by the given right lifting structure of $p$ as a regular trivial fibration, they cohere as needed.
\end{proof}

\begin{theorem} \label{thm:ac-kan-is-uniform}
Let $\catE$ be the category of presheaves over an elegant Reedy category, equipped with a functorial cylinder $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes(-))$ such that the functor $\interval \otimes (-) \co \catE \to \catE$ has a right adjoint.
Let $\cal{M}$ be a full subcategory of $\cal{E}_{\cart}^\to$ of monomorphisms.
\begin{enumerate}[(i)]
\item Every trivial fibration admits the structure of a uniform trivial $\cal{M}$-fibration,
\item Every fibration admits the structure of a uniform $\cal{M}$-fibration.
\end{enumerate}
\end{theorem}

\begin{proof}
Part (i) follows by \cref{trivial-fibration-to-regular} and \cref{regular-trivial-fibration-to-uniform}.
For part (ii), let $p \co X \to Y$ be a fibration.
By the standard counterpart of \cref{prod-exp-general}, it follows that $\hatexp(\bar{\delta}^k, p)$ is a trivial fibration for $k \in \braces{0, 1}$, and hence a uniform trivial $\cal{M}$-fibration by part (i).
The claim then follows by \cref{prod-exp-general}.
\end{proof}




\section{Uniform fibrations and strong homotopy equivalences}
\label{sec:unifshe}

This section and the next one lead to the
proof that the algebraic weak factorization system on presheaf categories
with uniform fibrations as right maps satisfies the functorial Frobenius condition.
This section contains the main technical results needed to establish 
our main results, which are then presented in~\cref{sec:frocuf}. The key ingredient is the notion of a 
strong homotopy equivalence, which we introduce in~\cref{def:strhe}, and the possibility 
of defining functors transforming uniform fibrations into right maps for  categories of
strong homotopy equivalences, in~\cref{thm:onedir,thm:twodir}. This, in turn, 
relies in part on the characterization of strong homotopy equivalences
 as particular sections (\cref{strong-h-equiv-as-section}). 



\subsection*{Strong homotopy equivalences}
Let $f, g \co X \to Y$ be maps in $\catE$.
Recall that a \emph{homotopy from $f$ to $g$}, denoted $\phi \co f \sim g$, is a morphism $\phi \co \interval \otimes X \to Y$ such that the following diagram commutes:
\begin{equation}
\label{equ:homotopy}
\begin{gathered}
\xymatrix@C=1.2cm{
  X
  \ar[r]^-{\lcyl \otimes X}
  \ar[dr]_{f}
&
  \interval \otimes X
  \ar[d]^(0.4){\phi}
&
  X
  \ar[dl]^{g}
  \ar[l]_-{\rcyl \otimes X}
\\&
  Y
\rlap{.}}
\end{gathered}
\end{equation}
A map $f \co X \to Y$ is called a \emph{left} (or \emph{0-oriented}) \emph{homotopy equivalence} if there exist $g \co Y \to X$ and homotopies $\phi \co g \cc f \sim \id_X $ and $\psi \co f \cc g \sim \id_Y$.
Dually, a map $f \co X \to Y$ is called a \emph{right} (or \emph{1-oriented}) \emph{homotopy equivalence} if there exist $g \co Y \to X$ and homotopies $\phi \co \id_X \sim g \cc f$ and $\psi \co \id_Y \sim f \cc g$.
If the functorial cylinder has contractions, the notion of a (\emph{left/0-oriented} or \emph{right/1-oriented}) \emph{strong deformation retract} is obtained by requiring also that the homotopy~$\phi$ is trivial, \ie $\phi = \varepsilon_X$, where $\varepsilon \co I \otimes (-)
\to \Id_\catE$ is the contraction of the functorial cylinder.
The following generalization of strong deformation retracts is  very important in our development.

\begin{definition} \label{def:strhe}
A (left or right) homotopy equivalence as above is said to be \emph{strong} if the diagram
\[
\xymatrix{
  \interval \otimes X
  \ar[r]^{\interval \otimes f}
  \ar[d]_{\phi}
&
  \interval \otimes Y
  \ar[d]^{\psi}
\\
  X
  \ar[r]_{f}
&
  Y
}
\]
commutes, and \emph{co-strong} if the diagram
\[
\xymatrix{
  \interval \otimes Y
  \ar[r]^{\interval \otimes g}
  \ar[d]_{\psi}
&
  \interval \otimes X
  \ar[d]^{\phi}
\\
  Y
  \ar[r]_{g}
&
  X
}
\]
commutes.
\end{definition}

The notion of homotopy equivalence is symmetric and admits an evident duality, and a homotopy equivalence is strong if and only if its dual is co-strong.
Fixing $k \in \braces{0, 1}$, strong $k$-oriented homotopy equivalences can be organized into a category $\cal{S}_k$ as follows.
An object is a 4-tuple $(f, g, \phi, \psi)$ consisting of an arrow $f \co A \to B$ together with data $g \co B \to A$, $\phi \co \interval \otimes A \to A$, $\psi \co \interval \otimes B \to B$ making $f$ into a strong $k$-oriented homotopy equivalence.
A morphism $m \co (f, g, \phi, \psi) \to (f', g', \phi', \psi')$ consists of maps $s \co A \to A', t \co B \to B'$ such that the following diagrams commute:
\begin{align*}
\xymatrix{
  A
  \ar[r]^{s}
  \ar[d]_{f}
&
  A'
  \ar[d]^{f'}
\\
  B
  \ar[r]_{t}
&
  B'
\rlap{,}}
&&
\xymatrix{
  B
  \ar[r]^{t}
  \ar[d]_{g}
&
  B'
  \ar[d]^{g'}
\\
  A
  \ar[r]_{s}
&
  A'
\rlap{,}}
&&
\xymatrix{
  \interval \otimes A
  \ar[d]_{\phi}
  \ar[r]^{\interval \otimes s}
&
  I \otimes A'
  \ar[d]^{\phi'}
\\
  A
  \ar[r]_{s}
&
  A'
\rlap{,}}
&&
\xymatrix{
  \interval \otimes B
  \ar[d]_{\psi}
  \ar[r]^{\interval \otimes t}
&
  I \otimes B'
  \ar[d]^{\psi'}
\\
  B
  \ar[r]_{t}
&
  B'
\rlap{.}}
\end{align*}
There is an obvious forgetful functor $\cal{S}_k \to \catE^\to$ projecting to the first component.






Our first goal is to give an alternative characterization of strong left or right homotopy equivalences.
For this, we need some definitions.
Let $0_\catE \co \catE \to \catE$ be the functor with constant value the initial object $0 \in \catE$, and let $\bot \co 0_\catE \rightarrow \Id_\catE$ be the natural transformation with components given by the unique maps $\bot_X \co 0 \to X$.
Observe that for every $f \co X \to Y$, we have an isomorphism
\begin{equation}
\label{equ:bot-hatotimes-f}
\hateval(\bot, f) \iso f
\end{equation}
where $\hateval$ is defined as in~\eqref{definition-of-hateval}.
We have a commutative square of functors and natural transformations
\begin{equation} \label{the-trivial-square}
\begin{gathered}
\xymatrix@C+2em{
  0_\catE
  \ar[r]^{\bot}
  \ar[d]_{\bot}
&
  \id_\catE
  \ar[d]^{\rcyl \otimes (-)}
\\
  \id_\catE
  \ar[r]_{\lcyl \otimes (-)}
&
  \interval \otimes (-)
\rlap{.}}
\end{gathered}
\end{equation}
This diagram determines two maps in $[\catE, \catE]^\to$:
\begin{equation} \label{equ:thetas}
\begin{aligned}
  \thetal \otimes (-) &\co \bot \rightarrow \lcyl \otimes (-)
\, ,&
  \thetar \otimes (-) &\co \bot \rightarrow \rcyl \otimes (-)
\rlap{,}
\end{aligned}
\end{equation}
which are defined by letting $\thetal \otimes (-) \defeq (\bot, \rcyl \otimes (-))$ and $\thetar \otimes (-) \defeq (\bot, \lcyl \otimes (-))$.
By functoriality of the Leibniz construction and the isomorphisms in~\eqref{equ:bot-hatotimes-f}, the maps in~\eqref{equ:thetas} give us two maps
\begin{equation*}
\begin{aligned}
  \thetal \hatotimes f &\co f \to \lcyl \hatotimes f
\, ,&
  \thetar \hatotimes f &\co f \to \rcyl \hatotimes f
\end{aligned}
\end{equation*}
in $\catE^\to$ for $f \co X \to Y$, which consist of squares of the form
\[
\xymatrix@C+3em{
  X
  \ar[r]^-{\inl \cc (\kcylinv \otimes X)}
  \ar[d]_{f}
&
  (\interval \otimes X) +_X Y \ar[d]^{\kcyl \hatotimes f}
\\
  Y
  \ar[r]_-{\kcylinv \otimes Y}
&
  \interval \otimes Y
}
\]
for $k \in \braces{0, 1}$.
We use these maps to provide the following characterization of strong homotopy equivalences.

\begin{lemma}[Strong homotopy equivalences as sections] \label{strong-h-equiv-as-section}
For $k \in \braces{0, 1}$, the category $\cal{S}_k$ of strong $k$-oriented homotopy equivalences in $\catE$ can  be described
isomorphically as the category of arrows $f \in \catE^{\to}$ with a retraction $\rho$ of $\thetak \hatotimes f$.
In detail,
\begin{enumerate}[(i)]
\item objects are pairs $(f, \rho)$ consisting of $f \in \catE^\to$ and a retraction $\rho$ of $\thetak \hatotimes f$, as below:
\[
\xymatrix@C+2em{
  f
  \ar[r]^-{\thetak \hatotimes f}
  \ar@{=}[dr]
&
  \kcyl \hatotimes f \ar[d]^{\rho}
\\&
  f
\rlap{,}}
\]
\item morphisms $\tau \co (f, \rho) \to (f', \rho')$ are maps $\tau \co f \to f'$ such that the below diagram commutes:
\[
\xymatrix@C+2em{
  \kcyl \hatotimes f
  \ar[d]_-{\rho}
  \ar[r]^{\kcyl \hatotimes \tau}
&
 \kcyl \hatotimes f'
  \ar[d]^-{\rho'}
\\
  u_i
  \ar[r]_{\tau}
&
  u_{i'}
\rlap{.}}
\]
\end{enumerate}
\end{lemma}

\begin{proof}
We will only do the object part of the correspondence.
To say that $\thetak \hatotimes f \co f \to \kcyl \hatotimes f$ has a retraction $\rho$ means to have dotted arrows as follows:
\[
\xymatrix@C+3em{
  X
  \ar[r]^-{\inl \cc (\kcylinv \otimes X)}
  \ar[d]_f
&
  (\interval \otimes X) +_X Y
  \ar[d]^{\kcyl \hatotimes f}
  \ar@{.>}[r]
&
  X
  \ar[d]^f
\\
  Y
  \ar[r]_-{\kcylinv \otimes Y}
&
  \interval \otimes Y
  \ar@{.>}[r]
&
  Y
\rlap{,}}
\]
where the two horizontal composites should be identities.
First, by a standard diagram-chasing argument, giving the square on the right is equivalent to giving maps $\phi \co \interval \otimes X \to X$, $g \co Y \to X$, $\psi \co \interval \otimes Y \to Y$ such that the following diagrams commute:
\begin{align} \label{equ:first-three}
\xycenter{
  X
  \ar[r]^-{\kcyl \otimes X}
  \ar[d]_f
&
  \interval \otimes X
  \ar[d]^{\phi}
\\
  Y \ar[r]_-{g}
&
  X
\rlap{,}}
&&
\xycenter{
  Y
  \ar[r]^-g
  \ar[d]_{\kcyl \otimes Y}
&
  X
  \ar[d]^f
\\
  \interval \otimes Y
  \ar[r]_-{\psi}
&
  Y
\rlap{,}}
&&
\xycenter{
  \interval \otimes X
  \ar[r]^-\phi
  \ar[d]_{I \otimes f}
&
  X
  \ar[d]^{f}
\\
  \interval \otimes Y
  \ar[r]_-{\psi}
&
  Y
\rlap{.}}
\end{align}
Second, requiring that the two horizontal composites are identities means that the diagrams
\begin{align} \label{equ:second-two}
\begin{gathered}
\xymatrix@C+2em{
  X
  \ar[r]^-{\kcylinv \otimes X}
  \ar@{=}[dr]
&
  \interval \otimes X
  \ar[d]^\phi
\\&
  X
\rlap{,}}
\end{gathered}
&&
\begin{gathered}
\xymatrix@C+2em{
  Y
  \ar[r]^-{\kcylinv \otimes Y}
  \ar@{=}[dr]
&
  \interval \otimes Y
  \ar[d]^{\psi}
\\&
  Y
}
\end{gathered}
\end{align}
commute.
With reference to the diagram in~\eqref{equ:homotopy}, the equations in~\eqref{equ:first-three} provide endpoint $k$ for $\phi$ and $\psi$, and strength, respectively; while the equations in~\eqref{equ:second-two} provide endpoints $1-k$ for $\phi$ and $\psi$, respectively.
\end{proof}

\begin{remark}
\cref{strong-h-equiv-as-section} implies that strong left or right homotopy equivalences are closed under retracts since functors, in this case $\delta^0 \hatotimes (-)$ and $\delta^1 \hatotimes (-)$, preserve retracts and sections are closed under retracts.
\end{remark}

We now fix $k \in \braces{0, 1}$ and identify the category $\cal{S}_k$ with the isomorphic category defined in \cref{strong-h-equiv-as-section}.
If the functorial cylinder is induced by tensoring with an interval object in a monoidal category, then \cref{strong-h-equiv-as-section} shows that strong left or right homotopy equivalences are closed under Leibniz tensoring from the right with arbitrary maps since functors preserve section-retraction pairs.
We have an analogue of this also in the general setting, which we will examine next.

\begin{lemma} \label{leibniz-lift}
Let $u \co \bracks{\cal{D}, \cal{E}}^\to$ be a natural transformation.
If $\eval(u, -) \co \cal{D} \to \cal{E}^\to$ lifts through $\cal{S}_k \to \catE^\to$, then so does $\hateval(u, -) \co \cal{D}^\to \to \catE^\to$.
\end{lemma}

\begin{proof}
This is a formal argument in the theory of Leibniz constructions~\cite{riehl-verity:reedy}.
In order to make this argument more readable, we will use infix notation for several important bifunctors.
Let first $[\catE, \catE]'$ denote the pushout preserving endofunctors on $\catE$.
By assumption, we have that~$\thetak$ is a map in $[\catE, \catE]'^{\to}$.
We write $(-) {\cc} (-)  \co [\catE, \catE]' \times [\cal{D}, \catE] \to [\cal{D}, \catE]$ for functor composition as well as~$(-) \otimes_\catE (-) \co [\catE, \catE]' \times \catE \to \catE$ and $(-) \otimes_{\cal{D}} (-) \co [\cal{D}, \catE] \times \cal{D} \to \catE$ for functor application (previously denoted $\eval$).
Of course, we have an isomorphism
\begin{equation} \label{leibniz-lift:0}
  (U \cc F) \otimes_{\cal{D}} X = U \otimes_\catE (F \otimes_{\cal{D}} X)
\end{equation}
natural $U \in [\catE, \catE]'$, $F \in [\cal{D}, \catE]$, and $X \in \cal{D}$.

Recall that $\catE$ has pushouts so that we have the Leibniz construction available and pushouts in the relevant functor categories are computed pointwise.
From~\eqref{leibniz-lift:0}, it follows that we have an isomorphism
\begin{equation} \label{leibniz-lift:1}
  (\thetak \cchat u) \otimes_{\cal{D}} X = \thetak \hatotimes_\catE (u \otimes_{\cal{D}} X)
\end{equation}
natural in $X \in \cal{D}^\to$.
Since $\otimes_{\cal{D}} \co [\cal{D}, \catE] \times \cal{D} \to \catE$ and $\otimes_\catE \co [\catE, \catE]' \times \catE \to \catE$ preserve pushouts in their first and second argument, respectively, it also follows that we have an isomorphism
\begin{equation} \label{leibniz-lift:2}
  (\thetak \cchat u) \hatotimes_{\cal{D}} f = \thetak \hatotimes_\catE (u \hatotimes_{\cal{D}} f)
\end{equation}
natural in $f \in \cal{D}^\to$.

The assumption of $u \otimes_{\cal{D}} (-) \co \cal{D} \to \catE^\to$ lifting through $\cal{S}_k \to \catE^\to$ is equivalent to having a retraction of~$\thetak \hatotimes_\catE (u \otimes_{\cal{D}} (-))$.
By~\eqref{leibniz-lift:1}, this map is isomorphic to~$(\thetak \cchat u) \otimes_{\cal{D}} (-) = \thetak \cchat u$.
The goal of $u \hatotimes_{\cal{D}} (-) \co \cal{D}^\to \to \catE^\to$ lifting through $\cal{S}_k \to \catE^\to$ is equivalent to a retraction of the map~$\thetak \hatotimes_\catE (u \hatotimes_{\cal{D}} (-))$.
By~\eqref{leibniz-lift:2}, this map is isomorphic to $(\thetak \cchat u) \hatotimes_{\cal{D}} (-)$.
But functors, in this case~$m \mapsto m \hatotimes_{\cal{D}} (-)$, preserve section-retraction pairs.
\end{proof}



Let $u \co \cal{I} \to \catE^\to$ be a functor.
For $k \in \braces{0, 1}$, we define $\cal{S}_k(u) \co \cal{S}_k(\cal{I}) \to \catE^\to$,
the category of strong $k$-oriented homotopy equivalences relative to $\cal{I}$,
by the following strict pullback of categories:
\begin{equation} \label{rel-strong-h-equiv-def}
\xycenter{
  \cal{S}_k(\cal{I})
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  \cal{I}
  \ar[d]^{u}
\\
  \cal{S}_k
  \ar[r]
&
  \catE^\to
}
\end{equation}
This means that an object of $\cal{S}_k(\cal{I})$ consists of an object $i \in \cal{I}$ together with data $(g, \phi, \psi)$ making~$u_i$ into a strong $k$-oriented homotopy equivalence.

For the remainder of this section, we fix $k \in \braces{0, 1}$ and identify the category $\cal{S}_k$ with the isomorphic category defined in \cref{strong-h-equiv-as-section}.
Under this identification, an object of $\cal{S}_k(\cal{I})$ consists of an object $i \in \cal{I}$ together with a retraction of $\thetak \hatotimes u_i$.
We are now going to relate strong homotopy equivalences relative to $\cal{I}$ with the components of $\cal{I}_\otimes$ as defined in~\eqref{equ:u-tensor}.

\begin{lemma} \label{lem:from-strong-hequiv}
There is a functor
\[
\xymatrix@!C@C-2em{
  \cal{S}_k(\cal{I})
  \ar[dr]_{\cal{S}_k(u)}
  \ar[rr]^{L_k}
&&
  \overline{\cal{I}}
  \ar[dl]^-{\overline{\kcyl \hatotimes u}}
\\&
  \catE^\to
\rlap{.}}
\]
\end{lemma}

\begin{proof}
We only describe the action of the functor $L_k$ on an object $(i, \rho)$, leaving the evident definition of the action on arrows to the reader.
Recall that $\rho$ is a retraction of $\thetak \hatotimes u_i \co u_i \to \kcyl \hatotimes u_i$, exhibiting $u_i$ as a retract of $\kcyl \hatotimes u_i$.
Thus, we may define $L_k(i, \rho) \defeq (i, u_i, \thetak \hatotimes u_i, \rho)$.
Observe that this definition makes the diagram for $L_k$ commute.
\end{proof}

\begin{proposition} \label{thm:onedir} There is a functor
\[
\xymatrix@!C@C-2.5em{
\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})
  \ar[dr]
  \ar@<4pt>[rr] 
&&
  \liftl{(\Fib{\cal{I}})}
  \ar[dl]
\\&
  \catE^\to \, .
}
\]
\end{proposition}



\begin{proof} Combine the cases $k = 0$ and $k = 1$ of~\cref{lem:from-strong-hequiv} and compose
with  a component of the unit of the monad $\liftl{(\liftr{(-)})}$.  Note that the retract closure of \cref{lem:from-strong-hequiv} vanishes because of \cref{retract-closure}.
\end{proof} 


\subsection*{Connections} We now need to introduce some additional assumptions
which will be used in our development. We begin by recalling a definition.

\begin{definition} \label{def:connections}
A functorial cylinder $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ with contractions $\ccyl \otimes (-)$ has \emph{connections} if, for $k \in \braces{0, 1}$, there is a natural transformations $c^k \otimes (-) \co \interval \otimes \interval \otimes (-) \to \interval \otimes (-)$ such that the diagrams
\begin{equation} \label{connections:0}
\xymatrix@C+3em{
  \interval \otimes (-)
  \ar[r]^-{\kcyl \otimes \interval \otimes (-)}
  \ar[d]_{\ccyl \otimes (-)}
&
  \interval \otimes \interval \otimes (-)
  \ar[d]^{c^k \otimes (-)}
&
  \interval \otimes (-)
  \ar[l]_-{\interval \otimes \kcyl \otimes (-)}
  \ar[d]^{\ccyl \otimes (-)}
\\
  \Id_\catE
  \ar[r]_{\kcyl \otimes (-)}
&
  \interval \otimes (-)
&
  \Id_\catE
  \ar[l]^{\kcyl \otimes (-)}
}
\end{equation}
and
\begin{equation} \label{connections:1}
\xymatrix@C+3em{
  \interval \otimes (-)
  \ar[r]^-{\kcylinv \otimes \interval \otimes (-)}
  \ar@{=}[dr]
&
  \interval \otimes \interval \otimes (-)
  \ar[d]^(0.4){c^k \otimes (-)}
&
  \interval \otimes (-)
  \ar[l]_-{\interval \otimes \kcylinv \otimes (-)}
  \ar@{=}[dl]
\\&
  \interval \otimes (-)
}
\end{equation}
commute.
\end{definition}

The notation $c^k \otimes (-)$ is once again suggestive of an interval object (see \cref{exa:connections-for-interval} below).
We use the notion of strong homotopy equivalence to introduce a structure on a functorial cylinder that is strictly weaker than connections, but encapsulates more economically the requirements needed for proving some of the next results.

\begin{definition} \label{def:effective-connections}
A functorial cylinder $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ has \emph{effective connections} if the endpoint inclusion $\kcyl \otimes X$ is a $k$-oriented strong homotopy equivalences for $k \in \braces{0, 1}$, naturally in $X \in \catE$.
More formally, for $k \in \braces{0, 1}$, the functor $\kcyl \otimes (-) \co \catE \to \catE^\to$ is required to lift through the forgetful functor $\cal{S}_k \to \catE^\to$.
\end{definition}

\begin{remark} \label{connections-are-effective}
Effective connections, in contrast to connections, do not presuppose contractions.
But if a functorial cylinder $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ has contractions $\varepsilon \otimes (-)$, then having connections $c^k \otimes (-)$ for $k \in \braces{0, 1}$ implies having effective connections.
To verify this, we only show that $\lcyl \otimes (-) \co \catE \to \catE^\to$ lifts through $\cal{S}_0 \to \catE^\to$.
Given $X \in \catE$, observe that $\lcyl \otimes X \co X \to \interval \otimes X$ is a strong left deformation retract with retraction given by contraction $\ccyl \otimes X \co I \otimes X \to X$ and homotopy $\psi \co \ccyl \cc (\lcyl \otimes X) \sim \id_{I \otimes X}$ given by connection $\psi = c^0 \otimes X$.
The left and right endpoints of $\psi$ follow from the left parts of~\eqref{connections:0} and~\eqref{connections:1}, respectively, and the strength follows from the right part of~\eqref{connections:0}. Then, it suffices to 
recall that strong left deformation retracts are special cases of strong left homotopy equivalences.
The above assignment of a strong left homotopy equivalence is functorial in $X \in \catE$ since $\ccyl \otimes (-)$ and $c^0 \otimes (-)$ are natural transformations.
\end{remark}

\begin{example} \label{exa:connections-for-interval}
Let $(\catE, \otimes, \top)$ be a monoidal category.
An interval object $(\interval, \lcyl, \rcyl)$ with contractions $\ccyl$ has \emph{connections} if, for $k \in \braces{0, 1}$, there is a map $c^k \co \interval \otimes \interval \to \interval$ such the following diagrams commute:
\begin{align} \label{connections-for-interval:0}
\begin{aligned}
\xymatrix@C+1em{
  \interval
  \ar[r]^-{\kcyl \otimes \interval}
  \ar[d]_{\ccyl}
&
  \interval \otimes \interval
  \ar[d]^{c^k}
&
  \interval
  \ar[l]_-{\interval \otimes \kcyl}
  \ar[d]^{\ccyl}
\\
  \top
  \ar[r]_{\kcyl}
&
  \interval
&
  \top
  \ar[l]^{\kcyl}
\rlap{,}}
\end{aligned}
&&
\begin{aligned}
\xymatrix@C+2em{
  \interval
  \ar[r]^-{\kcylinv \otimes \interval}
  \ar@{=}[dr]
&
  \interval \otimes \interval
  \ar[d]^(0.4){c^k}
&
  \interval
  \ar[l]_-{\interval \otimes \kcylinv}
  \ar@{=}[dl]
\\&
  \interval
\rlap{.}}
\end{aligned}
\end{align}
The maps $c^0$ and $c^1$ can be seen as analogous to the minimum and maximum operations for the real line interval, or as conjunction and disjunction in a bounded distributive lattice.
An interval object $(\interval, \lcyl, \rcyl)$ has \emph{effective connections} if $\lcyl$ and $\rcyl$ are left and right homotopy equivalences, respectively.

Assuming connections, we see in~\eqref{connections-for-interval:0} that the map $c^0$, seen as a homotopy from~$\id_I$ 
to~$\lcyl \cc \ccyl$, makes $\lcyl$ into a strong left deformation retract with left inverse $\ccyl$.
Dually, the map $c^1$ makes $\rcyl$ into a strong right deformation retract with left inverse $\ccyl$.
Note that this is not an equivalent characterization of connections as commutativity of the right triangle in the second diagram in~\eqref{connections-for-interval:0} is not captured.
Since strong deformation retracts are special cases of strong homotopy equivalences, we have effective connections.
This all is analogous to \cref{connections-are-effective}.

As in \cref{exa:cyl-via-int}, tensoring with an interval object with (effective) connections induces a functorial cylinder with (effective) connections.
\end{example}

\begin{example}[Connections in simplicial sets]
The interval object $(\Delta^1, h_0^1, h_1^1)$ in simplicial sets of~\cref{exa:cyl-in-sset} sets has uniquely determined connections $c^k \co \Delta^1 \times \Delta^1 \to \Delta^1$ with $k \in \braces{0, 1}$ given on points by $c^0(x, y) = \min(x, y)$ and $c^1(x, y) = \max(x, y)$.
For this, note that~$\Delta^1$ and~$\Delta^1 \times \Delta^1$ are nerves of posets and that $\min$ and $\max$ are monotonous with respect to their orderings.
\end{example}

\begin{example}[Connections in cubical sets]
Connection operations $c^k \co \Box^1 \otimes \Box^1 \iso \Box^2 \to \Box^1$ for $k \in \braces{0, 1}$ are induced by the conjunction and disjunction operations of de Morgan algebras.
In detail, they are given by the maps from a singleton set to the free de Morgan algebra on a two-element set $\braces{x, y}$ that pick $x \wedge y$ and $x \vee y$, respectively).
\end{example}




By \cref{leibniz-lift}, it is possible to give an equivalent characterization of effective connections in terms of the functors $\delta^k \hatotimes (-)$ instead of the functors $\delta^k \otimes (-)$, as stated in \cref{effective-connections-leibniz} below.

\begin{corollary} \label{effective-connections-leibniz}
The functorial cylinder has effective connections if and only if $\kcyl \hatotimes f$ is a strong $k$-oriented homotopy equivalence naturally in $f \in \catE^\to$ for $k \in \braces{0, 1}$, \ie the functor $\kcyl \hatotimes (-) \co \catE^\to \to \catE^\to$ lifts through the forgetful functor $\cal{S}_k \to \catE^\to$.
\qed
\end{corollary}

\begin{remark}[Fillers and compositions] \label{retraction-for-connections}
By \cref{effective-connections-leibniz}, the functorial cylinder has effective connections if and only if, for $k \in \braces{0, 1}$, there exists a natural transformation $\rho \co \kcyl \hatotimes \kcyl \hatotimes (-) \to \kcyl \hatotimes (-)$ in the arrow category whose components provide retractions as follows:
\begin{equation} \label{retraction-for-connections:0}
\xymatrix@C+3em{
  \kcyl \hatotimes f
  \ar[r]^-{\thetak \hatotimes \kcyl \hatotimes f}
  \ar@{=}[dr]
&
  \kcyl \hatotimes \kcyl \hatotimes f
  \ar[d]^{\rho_f}
\\&
  \kcyl \hatotimes f
\rlap{.}}
\end{equation}
This retract situation is the categorical reason why in~\cite{cohen-et-al:cubicaltt} 
it is possible to reduce the Kan filling operation to what is called there composition.
This idea can be translated to our setting as follows. Let us consider a lifting problem of the form $\kcyl \hatotimes f \to p$.
A \emph{filling} consists of a diagonal filler for that square.
A \emph{composition} consists of a diagonal filler for the composite square $f \to \kcyl \hatotimes f \to p$ obtained by prefixing $\theta^k \hatotimes f$.
Using the retract situation of \eqref{retraction-for-connections:0}, filling for a lifting 
problem~$\kcyl \hatotimes f \to p$ reduces to composition for~$\kcyl \hatotimes \kcyl \hatotimes f \to p$.
Uniformity in the sense of~\cite{cohen-et-al:cubicaltt} means naturality in $f$.
\end{remark}






\begin{lemma} \label{lem:to-strong-hequiv}
Assume that $\cal{I}$ is closed under Leibniz tensor with $\kcyl$ in the sense that the functor $\kcyl \hatotimes (-) \co \catE^\to \to \catE^\to$ lifts as follows:
\begin{equation}
\label{to-strong-hequiv:0}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I}
  \ar[d]_{u}
  \ar@{.>}[r]^{\kcyl \hatotimes (-)}
&
  \cal{I}
  \ar[d]^{u}
\\
  \catE^\to
  \ar[r]_{\kcyl \hatotimes (-)}
&
  \catE^\to
\rlap{.}}
\end{gathered}
\end{equation}
Assume further that the functorial cylinder has effective connections.
Then there is a functor
\[
\xymatrix@!C@C-2em{
  \cal{I}
  \ar[dr]_{\kcyl \hatotimes u} \ar[rr]^{M_k}
&&
  \cal{S}_k(\cal{I})
  \ar[dl]^{\cal{S}_k(u)}
\\&
   \catE^\to
\rlap{.}}
\]
\end{lemma}

\begin{proof}
Recall from~\eqref{rel-strong-h-equiv-def} that $S_k(\cal{I})$ was defined as the product of $\cal{I}$ and $\cal{S}_k$ in $\CAT_{/\cal{E}^\to}$.
The map to the first factor is the assumed lift~\eqref{to-strong-hequiv:0}.
The map to the second factor is given by effective connections in the form of \cref{effective-connections-leibniz}.
\end{proof}


\begin{proposition} \label{thm:twodir}
Under the assumptions of~\cref{lem:to-strong-hequiv}, there is a functor 
\[
\xymatrix@!C@C-2.5em{
    \cal{I}_\otimes
  \ar[dr]
  \ar[rr]
&&
\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})
  \ar[dl]
\\&
  \catE^\to
}
\]
\end{proposition} 

\begin{proof} Combine the cases $k = 0$ and $k = 1$ of~\cref{lem:to-strong-hequiv}.
\end{proof} 

\begin{remark} \label{relating-strong-hequiv-and-uniform-fib}
By~\cref{lem:from-strong-hequiv,lem:to-strong-hequiv},
we also have a pair of functors
\[
\xymatrix@!C@C-2.5em{
  \liftr{(\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I}))}
  \ar[dr]
  \ar@<4pt>[rr]^{\liftr{(M_0 + M_1)}}
&&
  \Fib{\cal{I}}
  \ar[dl]
  \ar@<4pt>[ll]^{\liftr{(L_0 + L_1)}}
\\&
  \catE^\to
}
\]
relating uniform $\cal{I}$-fibrations with right maps for strong homotopy equivalences relative to $\cal{I}$. These are not, in general, inverses to each other in either way.
\end{remark}


\section{The functorial Frobenius condition for uniform fibrations}
\label{sec:frocuf}

In this section we show that the algebraic weak factorization system in which the right maps
are the uniform fibrations (constructed in~\cref{thm:sset-cset-nwfs}) satisfies the functorial Frobenius property.
For this, we use our characterisation of the functorial Frobenius property in 
algebraically-free algebraic weak factorization systems, in~\cref{thm:frobenius-comparison}. 

As a preliminary step, we show that, under more general assumptions, uniform $\cal{I}$-fibrations satisfy the uniform Frobenius condition with respect to $u_\otimes \co \cal{I}_\otimes \to \cal{E}^\to$, in the sense of \cref{def:uniFrobcond}. Here, $\catE$ is a category with finite colimits equipped with a functorial cylinder functor $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ with effective connections and  $u \co \cal{I} \to \catE^\to$ is a functor.
In particular, we  have that for every uniform $\cal{I}$-fibration $(p, \phi) \co X \to Y$, pullback along $p$ lifts as follows:
\[
\xymatrix@C+2em{
  (\cal{I}_\otimes)_{/Y}
  \ar[r]^{p^*}
  \ar[d]
&
  \liftl{(\liftr{\cal{I}_\otimes})}_{/X}
  \ar[d]
\\
  \cal{E}^\to_{/Y}
  \ar[r]_{p^*}
&
  \cal{E}^\to_{/X}
\rlap{.}}
\]
Since $\Fib{\cal{I}}  = \liftr{\cal{I}_\otimes}$, this will imply that pushforward along $p$ lifts as in \cref{lift-pushforward}.

We begin by establishing that,  under mild assumptions, uniform $\cal{I}$-fibrations satisfy the uniform Frobenius condition with respect to to the category $\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})$ of strong homotopy equivalences relative to $\cal{I}$ (viewed as a category over $\cal{E}^\to$ in the evident way).
By the close relationship between uniform $\cal{I}$-fibrations and the right maps for $\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})$ established in \cref{thm:onedir,thm:twodir}, this will enable us to establish the uniform Frobenius condition for uniform $\cal{I}$-fibrations with respect to $\cal{I}_\otimes$, as desired.


The central technical tool of our development is the following statement, where
$u' \co \cal{I}' \to \cal{E}^\to$ is the functor with domain $\cal{E}$ that sends $X$ to $\bot_X$.

\begin{lemma} \label{technical}
Let $k \in \braces{0, 1}$.
Right $(\delta^{1-k} \hatotimes u')$-maps satisfy the uniform Frobenius condition with respect to strong $k$-oriented homotopy equivalences.
\end{lemma}

\begin{proof}
See~\cref{app:tecp}.
\end{proof}

We now make explicit the assumptions we will be working with for the rest of this section:
\begin{enumerate}[(1)]
\item 
there is a map from $\cal{I}'$ to $\cal{I}$ of categories over $\cal{E}^\to$,
\item
the functor $u \co \cal{I} \to \catE^\to$ is closed with respect to Leibniz product with endpoint inclusions,
\item
uniform $\cal{I}$-fibrations satisfy the uniform Frobenius condition with respect to $\cal{I}$.
\end{enumerate}
In our examples, these assumptions will be satisfied, with in fact all of $\catE^\to$ satisfying the uniform Frobenius condition with respect to $\cal{I}$ (see~\cref{frobenius-uniform-presheaf}).
We can now begin our main line of reasoning.

\begin{proposition} Under the assumptions $(1)$-$(3)$ stated above, 
we have the following:
\begin{enumerate}[(i)]
\item 
Uniform $\cal{I}'$-fibrations satisfy the uniform Frobenius condition with respect to $\cal{S}_0 + \cal{S}_1$.
\item
Uniform $\cal{I}$-fibrations satisfy the uniform Frobenius condition with respect to $\cal{S}_0 + \cal{S}_1$.
\item
Uniform $\cal{I}$-fibrations satisfy the uniform Frobenius condition with respect to $\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})$.
\item
Uniform $\cal{I}$-fibrations satisfy the uniform Frobenius condition with respect to $\cal{I}_\otimes$.
\end{enumerate}
\end{proposition}

\begin{proof} We begin by proving (i) and then show that the other claims hold by a linear sequence of implications.
We start by noting that (i) is just the combination of the cases $k = 0$ and $k = 1$ of \cref{technical}.
For the step from (i) to (ii), apply functoriality of uniform Frobenius in the form of \cref{uniform-frobenius-functorial} with $H$ the functor $\Fib{\cal{I}} \to \Fib{\cal{I}'}$ obtained in the evident way from assumption~(1).
For the step from (ii) to (iii), recall with the definition~\eqref{rel-strong-h-equiv-def} of strong homotopy equivalences relative to $\cal{I}$ that $\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})$ is the strict pullback of $\cal{S}_0 + \cal{S}_1 \to \cal{E}$ and $\cal{I} \to \cal{E}$.
Using \cref{uniform-frobenius-product-u}, we may combine the uniform Frobenius conditions for uniform $\cal{I}$-fibrations with respect to $\cal{S}_0 + \cal{S}_1$, provided by (ii), and with respect to $\cal{I}$, provided by assumption (3).
For the step from (iii) to (iv), apply functoriality of uniform Frobenius in the form of \cref{uniform-frobenius-functorial} with $F$ the functor $\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I}) \to \liftl{(\liftr{\cal{I}_\otimes})}$ of \cref{thm:onedir} and $G$ the functor $\cal{I}_\otimes \to \cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})$ of \cref{thm:twodir}.
Note that the latter one uses assumption~(2).
\end{proof}

Let us summarize the main conclusion of result above as a theorem, for reference.

\begin{theorem} \label{uniform-fibrations-uniform-frobenius}
Under the assumptions $(1)$-$(3)$ stated above, we have that $\Fib{\cal{I}} $ satisfies the uniform Frobenius condition with respect to $\cal{I}_{\otimes}$.
\qed
\end{theorem}

As special cases, we obtain the pushforward versions of the Frobenius and Beck-Chevalley condition for uniform~$\cal{I}$-fibrations.
First, pushforward lifts to slices of the category of uniform $\cal{I}$-fibrations.

\begin{corollary} \label{uniform-fibrations-frobenius-pushforward}
Under the assumptions $(1)$-$(3)$ stated above,  for every uniform $\cal{I}$-fibration
$p \co X \to Y$, pushforward along $p$ lifts to a functor
\[
\xymatrix@C+2em{
  \Fib{\cal{I}}_{/X}
  \ar[r]^{p_*}
  \ar[d]
&
  \Fib{\cal{I}}_{/Y}
  \ar[d]
\\
  \catE_{/X}^\to
  \ar[r]_{p_*}
&
  \catE_{/Y}^\to
\rlap{.}}
\]
\end{corollary}

\begin{proof}
The claim follows from~\cref{uniform-fibrations-uniform-frobenius}.
\end{proof}

Second, pushforward behaves coherently with respect to pullback.

\begin{corollary} \label{uniform-fibrations-BC-pushforward} Under the assumptions $(1)$-$(3)$ stated above, 
for every map of uniform $\cal{I}$-fibrations $(s, t) \co p \to q$ , where  $p \co X \to Y$ and $q \co U \to V$,  the canonical natural transformation $\psi \co t^* q_* \to p_* s^*$ lifts to a natural transformation
\[
\xymatrix@C+2em{
  \Fib{\cal{I}}_{/U}
  \ar[r]^{q_*}
  \ar[d]_{s^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle \psi'$}}
&
  \Fib{\cal{I}}_{/V}
  \ar[d]^{t^*}
\\
  \Fib{\cal{I}}_{/X}
  \ar[r]_{p_*}
&
  \Fib{\cal{I}}_{/Y}
\rlap{.}}
\]
If $(s, t) \co p \to q$ forms a pullback square, then $\psi'$ is a natural isomorphism.
\end{corollary}

\begin{proof}
The claim follows from \cref{uniform-fibrations-uniform-frobenius} and \cref{lift-pushforward-BC} (see also \cref{beck-chevalley-iso})
\end{proof}

We can now bring together the main lines of development in this paper, and 
combine the results above with our earlier work 
on uniform fibrations in presheaf categories,  studied in~\cref{sec:unif}.

\begin{theorem} 
\label{frobenius-uniform-presheaf}
Let $\catE$ be a presheaf category equipped with a functorial cylinder
$I \otimes (-) \co \catE \to \catE$ with effective connections. 
Let $\cal{M}$ be a suitable category of monomorphisms in $\catE$. 
Then the algebraic weak factorization system 
whose right maps are the uniform $\cal{M}$-fibrations satisfies
the functorial Frobenius property. 
\end{theorem}

\begin{proof} 
By \cref{thm:frobenius-comparison}, it will suffice to establish the uniform Frobenius property of uniform $\cal{M}$-fibrations with respect to $\cal{M}$.
For this, we will apply \cref{uniform-fibrations-uniform-frobenius} with $\cal{I} \defeq \cal{M}$.
Assumption (1) is guaranteed by condition (iii) of \cref{uniform-fib-presheaf-cat}. 
By~\cref{rem-lift-suitable}, $\cal{M}$ is closed under Leibniz product with endpoint inclusions, thus assumption (2) is satisfied. For assumption (3), we need to show that $\liftr{\cal{M}}$ satisfies the uniform Frobenius condition with respect to $\cal{M}$.
In fact, we show something stronger, namely that $\catE^\to$ itself satisfies the uniform Frobenius condition with respect to $\cal{M}$.
This follows using the criterion of \cref{uniform-frob-even-nicer} since pulling back preserves objects of $\cal{M}$ by condition~(i) of \cref{uniform-fib-presheaf-cat} and morphisms between them since those are just pullback squares. Thus, assumption (3) is satisfied.
\end{proof} 

In particular, in the setting of~\cref{frobenius-uniform-presheaf}, for  a uniform $\cal{M}$-fibration $p \co X \to Y$, pushforward along $p$ lifts to a functor 
\[
p_* \co \Fib{\cal{M}}_{/X} \to \Fib{\cal{M}}_{/Y} \, .
\]
and so the pushforward of a uniform $\cal{M}$-fibration along a uniform $\cal{M}$-fibration is again a uniform $\cal{M}$-fibration.


\begin{example}[The uniform Frobenius condition for uniform Kan fibrations in simplicial sets]
Noting that the assumptions of \cref{frobenius-uniform-presheaf} are fulfilled in simplicial sets, we obtain that pushforward along a uniform Kan fibration preserves uniform Kan fibrations in $\SSet$.
We consider this a constructive counterpart of the result that the pushforward along a Kan fibration preserves Kan fibrations (a fact that is equivalent to right properness for the model structure, see also \cite[Lemma 4.3.1]{voevodsky-simplicial-model}), which cannot be proved constructively~\cite{coquand-non-constructivity-kan}.


Since exponentiation is a special case of pushforward, this result shows also that the exponential of two uniform Kan complexes (defined in the evident way) is again a uniform Kan complex.
In fact, as usual, only the base needs to be assumed uniform Kan.
This can be seen as follows. Let $p \co Y \to X$ be a uniform Kan fibration and $i \co A \to B$ be a  monomorphism.
Recall that $\cal{S}_k(\cal{M})$ is closed under Leibniz product with $i$ for $k \in \braces{0, 1}$ (it is true separately for $\cal{S}_k$ and $\cal{M}$).
By Leibniz adjointness (\cref{lift-of-leibniz-adjunction}), we have that $\hatexp(i, p)$ is again a uniform Kan fibration.
The above statement is then the special case $X \defeq 1$ and $A \defeq 0$.
\end{example}

\begin{example}[The uniform Frobenius condition for uniform Kan fibrations in cubical sets]
Noting that the assumptions of \cref{frobenius-uniform-presheaf} are fulfilled in cubical sets, we obtain that pushforward along a uniform Kan fibration preserves uniform Kan fibrations in $\CSet$.
Insufficiency of the standard notion of cubical Kan fibration for a constructive proof 
of this statement should follow by an argument analogous to the one used for simplicial sets in~\cite{coquand-non-constructivity-kan}.
\end{example}

We conclude the paper by describing how our results give also a new proof of the
right properness of the Quillen model structure for Kan complexes. 

\begin{remark}[Right properness of the model structure for Kan complexes]
As explained in the introduction, the Frobenius condition for a weak factorization system is closely related to the right properness condition for a model structure. In particular, when applied to the category of simplicial sets, our results give a new
proof of the right properness of the Quillen model structure for Kan complexes. This follows from
\cref{frobenius-uniform-presheaf}
simply by recalling that a map of simplicial sets is a Kan fibration if and only if it admits
the structure of a uniform Kan fibration (\cref{thm:ac-kan-is-uniform}). 
Our proof of right properness avoids both the use of topological realization, which is used 
in~\cite[Theorem~13.1.13]{hirschhorn-model-localizations} to deduce
the desired result from the right properness of the model structure on topological spaces in which the fibrations are the Serre fibrations, and the use of the theory of minimal fibrations,
which is used in~\cite[Theorem~1.7.1]{joyal-tierney-notes} to establish the result 
working purely combinatorially\footnote{Note that, by the independence result in~\cite{coquand-non-constructivity-kan}, these arguments cannot be constructive.}.

Finally, let us remark that it is possible to prove right properness also without taking the algebraic approach adopted in 
this paper, by going through the development presented here and replacing the algebraic notions and results with their
standard counterparts. For example, one would consider the classes, rather than categories, of strong homotopy equivalences 
and show that a map is a Kan fibration if and only if it has the right lifting property with respect to the class of strong homotopy
equivalences that are monomorphisms (\cf~\cref{relating-strong-hequiv-and-uniform-fib}).
The core of the argument, corresponding to \cref{technical}, then reduces to showing that strong homotopy equivalences are stable under pullback along Kan fibrations.
\end{remark}


\appendix

\section{A technical proof}
\label{app:tecp}

We give the proof of \cref{technical} that was omitted in \cref{sec:frocuf}.
Recall that $u' \co \cal{I}' \to \cal{E}^\to$ is the functor with domain $\cal{E}$ that sends $X$ to $\bot_X$.

\begin{replemma}{technical}
Let $k \in \braces{0, 1}$.
Right $(\delta^{1-k} \hatotimes u')$-maps have the uniform Frobenius condition with respect to strong $k$-oriented homotopy equivalences.
\end{replemma}

\begin{proof}
We use the characterization of uniform Frobenius given by \cref{uniform-frob-even-nicer}.
The required lift is provided by the lift $Q'$ in \cref{strong-h-equiv-uniform-base-change} below after postcomposing it with a component of the unit of the monad $\liftl{(\liftr{(-)})}$.
Note that $\delta^{1-k} \hatotimes \bot_X = \delta^{1-k} \otimes \id_X$ for $X \in \cal{E}$.
\end{proof}

Let $P' \co \cal{E}^\to \times_{\cal{E}} \cal{E}^\to \to \cal{E}^\to$ be the pullback functor, sending a cospan $(g, h)$ to $h^* g$.

\begin{lemma} \label{strong-h-equiv-uniform-base-change}
Let $k \in \braces{0, 1}$ and abbreviate $\liftr{(\kcylinv \otimes \id_{\cal{E}})} \co \cal{E} \to \cal{E}^\to$ by $v \co \cal{J} \to \cal{E}^\to$.
Strong $k$-oriented homotopy equivalences are uniformly stable under base change along maps in $\cal{J}$.
More precisely, the pullback functor $P'$ lifts to $Q'$ as depicted below:
\begin{equation} \label{strong-h-equiv-uniform-base-change:goal}
\begin{gathered}
\xymatrix@C+2em{
  \cal{S}_k \times_{\cal{E}} \cal{J}
  \ar@{.>}[r]^{Q'}
  \ar[d]
&
  \cal{S}_k
  \ar[d]
\\
  \cal{E}^\to \times_{\cal{E}} \cal{E}^\to
  \ar[r]_{P'}
&
  \cal{E}^\to
\rlap{.}}
\end{gathered}
\end{equation}
\end{lemma}

\begin{proof}
For the lift of the action on objects in \eqref{strong-h-equiv-uniform-base-change:goal}, suppose we are given $v_j \co X \to Y$ with $j \in \cal{J}$ and $g \co B \to Y$ such that $g$ is a strong $k$-oriented homotopy equivalence over $Y$.
This means we have a retraction $\rho$ of $\thetak \hatotimes g$ as follows:
\begin{align*}
\xymatrix@C+1em{
  g
  \ar[r]^-{\thetak \hatotimes g}
  \ar@{=}[dr]
&
  \kcyl \hatotimes g \ar[d]^{\rho}
\\&
  g
\rlap{.}}
\end{align*}
We construct the pullback square $\sigma \co \bar{g} \to g$ of $g$ along $v_j$:
\begin{equation} \label{strong-h-equiv-uniform-base-change:0}
\xycenter{
  A
  \ar[r]^-{s}
  \ar[d]_{\bar{g}}
  \pullback{dr}
&
  B
  \ar[d]^{g}
\\
  X
  \ar[r]_{v_j}
&
  Y
\rlap{.}}
\end{equation}
We want to make $\bar{g}$ into a strong $k$-oriented homotopy equivalence.
This means to find a retraction $\bar{g}$ of $\thetak \hatotimes \bar{g}$ as follows:
\[
\xymatrix@C+1em{
  \bar{g}
  \ar[r]^-{\thetak \hatotimes \bar{g}}
  \ar@{=}[dr]
&
  \kcyl \hatotimes \bar{g}
  \ar@{.>}[d]^{\bar{\rho}}
\\&
  \bar{g}
\rlap{.}}
\]
We will define the retraction $\bar{\rho}$ such that the below diagram commutes and its two horizontal composites are identities:
\[
\xymatrix@C+2em{
  \bar{g}
  \ar[r]^-{\thetak \hatotimes \bar{g}}
  \ar[d]_{\sigma}
&
  \kcyl \hatotimes \bar{g}
  \ar@{.>}[r]^-{\bar{\rho}}
  \ar[d]_{\kcyl \hatotimes \sigma}
&
  \bar{g}
  \ar[d]^{\sigma}
\\
  g
  \ar[r]_-{\thetak \hatotimes g}
&
  \kcyl \hatotimes g
  \ar[r]_-{\rho}
&
  g
\rlap{.}}
\]
Since the pullback square $\sigma$ is a Cartesian arrow with respect to the codomain fibration, it suffices to solve this problem on codomains, again omitting horizontal composite identities:
\[
\xymatrix@C+2em{
  X
  \ar[r]^-{\kcylinv \otimes X}
  \ar[d]_{v_j}
&
  \interval \otimes X
  \ar@{.>}[r]^-{\cod(\bar{\rho})}
  \ar[d]^{\interval \otimes v_j}
&
  X
  \ar[d]^{v_j}
\\
  Y
  \ar[r]_-{\kcylinv \otimes Y}
&
  \interval \otimes Y
  \ar[r]_-{\cod(\rho)}
&
  Y
\rlap{.}}
\]
To find the dotted arrow is to construct a diagonal filler in the following square:
\[
\xymatrix@C+2em{
  X
  \ar@{=}[rr]
  \ar[d]_{\kcylinv \otimes X}
&&
  X
  \ar[d]^{v_j}
\\
  \interval \otimes X
  \ar[r]_-{I \otimes v_j}
  \ar@{.>}[urr]^(0.4){\cod(\bar{\rho})}
&
  \interval \otimes Y
  \ar[r]_-{\cod(\rho)}
&
  Y
\rlap{.}}
\]
But we have such a filler since $j \in \liftr{(\kcylinv \otimes \id_\catE)}$.

\medskip

For the lift of the action on morphisms in \eqref{strong-h-equiv-uniform-base-change:goal}, suppose we are given a map $j \to j'$ in $\cal{J}$ forming a square
\[
\xymatrix{
  X
  \ar[r]^{v_j}
  \ar[d]_{s}
&
  Y
  \ar[d]^{t}
\\
  X'
  \ar[r]_{v_{j'}}
&
  Y'
}
\]
and a map $(g, \rho) \to (g', \rho')$ in $\cal{S}_k$ with $\tau \co g \to g'$ forming a square
\[
\xymatrix{
  B
  \ar[r]
  \ar[d]_{g}
&
  B'
  \ar[d]^{g'}
\\
  Y
  \ar[r]_-{t}
&
  Y'
}
\]
such that $\tau$ commutes with the retractions $\rho$ and $\rho'$ as follows:
\[
\xymatrix{
  \kcyl \hatotimes g
  \ar[r]^-{\rho}
  \ar[d]_{\kcyl \hatotimes \tau}
&
  g
  \ar[d]^{\tau}
\\
  \kcyl \hatotimes g'
  \ar[r]_-{\rho'}
&
  g'
\rlap{.}}
\]
Let $(\bar{g}, \bar{\rho})$ and $(\bar{g}', \bar{\rho}')$ denote the respective action of $Q$ on the objects $(g, \rho, j)$ and $(g', \rho', j')$ as constructed in the first part of the proof.
Recall that this includes pullback squares $\sigma \co \bar{g} \to g$ and $\sigma' \co \bar{g}' \to g'$ with bottom side $v_j \co X \to Y$ and $v_{j'} \co X' \to Y'$, respectively, as in~\eqref{strong-h-equiv-uniform-base-change:0}.
The square $\tau \co g \to g'$ pulls back to a square $\bar{\tau} \co \bar{g} \to \bar{g'}$ with bottom side $v_{j'}$.
We want to show that $\bar{\tau}$ in addition forms a morphism of strong $k$-oriented homotopy equivalences from $(\bar{g}, \bar{\rho})$ to $(\bar{g}', \bar{\rho}')$.
For this, we have to verify commutativity of the following diagram:
\[
\xymatrix{
  \kcyl \hatotimes \bar{g}'
  \ar[r]^-{\bar{\rho}}
  \ar[d]_{\kcyl \hatotimes \bar{\tau}}
&
  \bar{g}
  \ar[d]^{\bar{\tau}}
\\
  \kcyl \hatotimes \bar{g}'
  \ar[r]_-{\bar{\rho}'}
&
  \bar{g}'
\rlap{.}}
\]
Recall the construction of $\bar{\rho}$ and $\bar{\rho}'$, omitting horizontal composite identities for readability:
\[
\xymatrix@!C{
  \bar{g}
  \ar[rr]^-{\thetak \hatotimes \bar{g}}
  \ar[dd]_{\sigma}
  \ar[dr]^{\bar{\tau}}
&&
  \kcyl \hatotimes \bar{g}
  \ar@{.>}[rr]^-{\bar{\rho}}
  \ar[dd]^(0.3){\kcyl \hatotimes \sigma}|!{[dl];[dr]}{\hole}
  \ar[dr]^{\kcyl \hatotimes \bar{\tau}}
&&
  \bar{g}
  \ar[dd]^(0.3){\sigma}|!{[dl];[dr]}{\hole}
  \ar[dr]^{\bar{\tau}}
\\&
  \bar{g}'
  \ar[rr]^-(0.3){\thetak \hatotimes \bar{g}'}
  \ar[dd]_(0.3){\sigma'}
&&
  \kcyl \hatotimes \bar{g}'
  \ar@{.>}[rr]^-(0.3){\bar{\rho}'}
  \ar[dd]^(0.3){\kcyl \hatotimes \sigma'}
&&
  \bar{g}'
  \ar[dd]^{\sigma'}
\\
  g
  \ar[rr]^-(0.25){\thetak \hatotimes g}|!{[ur];[dr]}{\hole}
  \ar[dr]^{\tau}
&&
  \kcyl \hatotimes g
  \ar[rr]^-(0.3){\rho}|!{[ur];[dr]}{\hole}
  \ar[dr]^{\kcyl \hatotimes \tau}
&&
  g
  \ar[dr]^{\tau}
\\&
  g'
  \ar[rr]^-{\thetak \hatotimes g'}
&&
  \kcyl \hatotimes g
  \ar[rr]^-{\rho'}
&&
  g
\rlap{.}}
\]
Our goal is to show that the top right square commutes.
Since that square commutes after composing it with the pullback square $\sigma'$, it suffices to show that the square commutes when projected to codomains, again omitting horizontal composite identities:
\[
\xymatrix@C+2em{
  X
  \ar[rr]^-{\kcylinv \otimes X}
  \ar[dd]_{v_j}
  \ar[dr]^{s}
&&
  \interval \otimes X
  \ar@{.>}[rr]^-{\cod(\bar{\rho})}
  \ar[dd]^(0.35){\interval \otimes v_j}|!{[dl];[dr]}{\hole}
  \ar[dr]^{\interval \otimes s}
&&
  X
  \ar[dd]^(0.35){v_j}|!{[dl];[dr]}{\hole}
  \ar[dr]^{s}
\\&
  X'
  \ar[rr]^-(0.3){\kcylinv \otimes X'}
  \ar[dd]^(0.3){v_{j'}}
&&
  \interval \otimes X'
  \ar@{.>}[rr]^-(0.3){\cod(\bar{\rho}')}
  \ar[dd]^(0.3){\interval \otimes v_{j'}}
&&
  X'
  \ar[dd]^{v_{j'}}
\\
  Y
  \ar[rr]^-(0.25){\kcylinv \otimes Y}|!{[ur];[dr]}{\hole}
  \ar[dr]^{t}
&&
  \interval \otimes Y
  \ar[rr]^-(0.3){\cod(\rho)}|!{[ur];[dr]}{\hole}
  \ar[dr]^{\interval \otimes t}
&&
  Y
  \ar[dr]^{t}
\\&
  Y'
  \ar[rr]^-{\kcylinv \otimes Y'}
&&
  \interval \otimes Y'
  \ar[rr]^-{\cod(\rho')}
&&
  Y'
\rlap{.}}
\]
But this follows from coherence of lifts in the following morphism of lifting problems:
\[
\xymatrix@C+1em{
  X
  \ar@{=}[rrrr]
  \ar[dd]_{\kcylinv \otimes X}
  \ar[dr]^{s}
&&&&
  X
  \ar[dd]_(0.3){v_j}|!{[dlll];[dr]}{\hole}|!{[dddlll];[dr]}{\hole}
  \ar[dr]^{s}
\\&
  X'
  \ar@{=}[rrrr]
  \ar[dd]^(0.66){\kcylinv \otimes X'}
&&&&
  X'
  \ar[dd]^{v_{j'}}
\\
  \interval \otimes X
  \ar[rr]^(0.7){I \otimes v_j}|!{[ur];[dr]}{\hole}
  \ar@{.>}[uurrrr]^(0.67){\cod(\bar{\rho})}|!{[ur];[dr]}{\hole}|!{[ur];[urrrrr]}{\hole} % bug: doesn't work?
  \ar[dr]_{I \otimes s}
&&
  \interval \otimes Y
  \ar[rr]_(0.7){\cod(\rho)}|!{[dl];[urrr]}{\hole}
  \ar[dr]^(0.7){\interval \otimes t}|!{[dl];[urrr]}{\hole}
&&
  Y
  \ar[dr]^{t}
\\&
  \interval \otimes X'
  \ar[rr]_{I \otimes v_{j'}}
  \ar@{.>}[uurrrr]^(0.67){\cod(\bar{\rho}')}
&&
  \interval \otimes Y'
  \ar[rr]_{\cod(\rho')}
&&
  Y'
\rlap{.}}
\]
Here, the left and right faces form morphisms in $\kcylinv \otimes \id_\catE$ and $\liftr{(\kcylinv \otimes \id_\catE)}$, respectively, making the lifts cohere as needed.
\end{proof}

\bibliographystyle{plain}
\bibliography{../../common/uniform-kan-bibliography}

\end{document}
