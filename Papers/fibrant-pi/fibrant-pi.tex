\documentclass[reqno,10pt,a4paper,oneside]{amsart}

\setcounter{tocdepth}{1}

\usepackage{uniform-kan-prelude}




\title{Uniform fibrations and
the Frobenius condition}

\begin{document}

\begin{abstract}
We introduce the notion of a uniform fibration in categories of elegant Reedy presheaves
with a functorial cylinder 
and show that, under mild assumptions, these form the right category of a natural weak
factorisation system that satisfies what we call the Frobenius property, \ie in which the
pullback along a right map preserves left maps. As an application, we obtain that in
simplicial sets,  the pushforward along a uniform Kan
fibration preserves uniform Kan fibrations, thereby contributing to giving a constructive
version of Voevodsky's simplicial model of univalent foundations. When applied
to cubical sets, our results  subsume some of the existing work on the cubical
model of type theory.
\end{abstract}

\author{Nicola Gambino}
\address{School of Mathematics, University of Leeds, Leeds LS2 9JT, UK}
\email{n.gambino@leeds.ac.uk}

\author{Christian Sattler}
\address{School of Mathematics, University of Leeds, Leeds LS2 9JT, UK}
\email{c.sattler@leeds.ac.uk}

\date{\today}

\maketitle

 \tableofcontents


\section*{Introduction}

The study of variants and generalizations of the classical notion of a Kan fibration has developed
in at least two significant directions in recent years. One direction of research, originating with the work of
Cisinski~\cite{cisinski-asterisque}, is concerned with the development of  parts of the theory of Kan fibrations in
general presheaf categories~\cite{cisinski-univalence,moerdijk-minimal}.  Another direction of
research, starting with the work of Bezem, Coquand and Huber~\cite{coquand-cubical-sets},
 is concerned with 
analogues of Kan fibrations in categories of cubical sets,
with a view towards applications to Voevodsky's univalence foundations programme~\cite{awodey-cubical,coquand-cubical-sets,coquand-variation,huber-thesis,pitts-cubical-nominal,swan-awfs}. A typical feature of this second line of research is  the focus on algebraic notions of fibrations, in which the diagonal fillers are given as part of the structure, rather than merely required to
exist, and are subject to naturality conditions, just as 
in the theory of natural weak factorisation 
systems~\cite{grandis-tholen-nwfs}.


Our aim here is to introduce and study the notion of a uniform fibration in the general context of
a category of elegant Reedy presheaves with a functorial cylinder, somehow combining the two lines of development mentioned above. 
On the one hand, working  at this level of generality allows us  
to obtain simultaneously results about simplicial sets and the cubical sets as special cases. On the other hand, we work with algebraic notions of a fibration,
which allows us to work constructively, \ie without assuming the law of excluded middle and the axiom of choice. Our motivation for working constructively is mathematical, not philosophical: one of our goals is to contribute to the ongoing efforts to define a constructive version of Voevodsky's simplicial model of univalent foundations~\cite{voevodsky-simplicial-model}, which would represent a step towards establishing his canonicity conjecture for the univalence axiom. 



Working in a category of elegant Reedy presheaves with a functorial cylinder,
we introduce algebraic notions of a uniform trivial fibration and of a uniform fibration.
In analogy with the way trivial fibrations of simplicial sets are defined in classical homotopy theory,
uniform trivial fibrations are defined by orthogonality with respect to decidable monomorphisms. Uniform fibrations, instead, are defined by orthogonality with respect to the maps obtained by 
applying a Leibniz construction (in the sense of~\cite{riehl-verity:reedy}) to decidable monomorphisms and cylinder face inclusions. In order to support this choice of definition, we show that, in the case of simplicial sets, under the assumption of the axiom of choice, every Kan fibration can be equipped with the structure of a uniform Kan fibration.

Our first main theorem shows that, under mild conditions, it is possible to apply Garner's small
object argument~\cite{garner:small-object-argument}  and define two natural weak algebraic factorisation systems, one in which 
the right maps are the uniform trivial fibrations and another in which the right maps are the 
uniform fibrations. Here, the algebraic approach is exploited crucially in order to 
reduce an arbitrary lifting problem to a functorial family of lifting problems. This 
type of good behaviour of the left maps of a natural algebraic weak factorisation systems with 
colimits was already emphasised in~\cite{riehl-cat-homotopy}. When applied to 
simplicial and cubical sets, the existence of a natural weak factorisation system 
in which the right maps are the uniform Kan fibrations can be applied to give an interpretation to
the basic rules for identity types, and in particular the judgemental equality in the 
conclusion of the computation rule.

Our second main theorem shows that the weak factorisation system in which the right class consists of the uniform fibrations satisfies the condition that that the pullback along a right map preserves 
left maps.  This condition, which we call the Frobenius property by  analogy with 
Lawvere's Frobenius reciprocity condition~\cite{lawvere-1969}, is closely connected to the axioms for identity types in Martin-L\"of type theories~\cite[Section~4]{gambino-garner:idtypewfs}.
By adjointness,  the Frobenius property implies that the pushforward (the right adjoint to
pullback) along a uniform fibration preseves uniform fibrations. 

Thus, when instanciated to the category of simplicial sets, our second main result implies that the  pushforward along a uniform Kan fibration preseves uniform Kan fibrations, which is a constructive counterpart of 
one of the key lemmas in the development of the simplicial model of univalent foundations~\cite[Lemma 2.3.1]{voevodsky-simplicial-model}. 
This result may appear surprising since the statement that the pushforward  along a Kan fibration 
preserves Kan fibrations cannot be proved constructively, as shown in~\cite{coquand-non-constructivity-kan}.
As our results show, this independence result
should be seen  simply as an indication that the standard notion of a Kan 
fibration is not suitable for developing simplicial homotopy theory constructively, rather than 
as an inherent non-constructivity of the simplicial setting. 

When instanciated to the category of cubical
sets considered in~\cite{coquand-variation}, our second main theorem provides a new proof, free from
complex combinatorial calculations, of the fact that also in that setting uniform Kan fibrations  the  
pushforward along a uniform Kan fibration preseves uniform Kan fibrations. 

Let us conclude these introductory remarks by pointing out that the Frobenius property for a 
weak factorisation system is closely related to the right properness condition for a model 
structure. Indeed, in any right proper model structure where the cofibrations are stable under
pullback (which is the case if they are the monomorphisms), the weak factorisation system 
given by trivial cofibrations and fibrations has the Frobenius property. For example, the weak factorisation system on simplicial sets in which the right maps are the Kan fibrations has the Frobenius property. 
The standard proof of this fact follows from the right properness of the Kan model structure on simplicial
sets, which in turn can be established either using the right properness of the model structure on topological spaces in which  the fibrations are the Serre fibrations~\cite[Theorem~13.1.13]{hirschhorn-model-localizations} or purely combinatorially, via the theory of minimal fibrations~\cite[Theorem~1.7.1]{joyal-tierney-notes}. However,
by the independence result in~\cite{coquand-non-constructivity-kan}, these arguments must use classical reasoning.



\smallskip

\noindent
\textbf{Organization of the paper.} Section~\ref{sec:preliminaries} recalls some preliminary notions,
such as the Leibniz construction.
Section~\ref{sec-orthog-functors} establishes basic facts about orthogonality functors.
Section~\ref{sec:frobenius} defines the Frobenius property for natural weak factorisation
systems and provides alternative characterizations of it. 
Section~\ref{sec:uniform-fibrations} defines uniform trivial fibrations and uniform fibrations and
establishes the existence of natural weak factorisation systems in which they are the 
right maps.
Section~\ref{section-kan-fib} shows that, assuming the axiom of choice, every Kan fibration
can be equipped with the structure of a uniform Kan fibration.
Finally, in Section~\ref{sec:frobenius-uniform-fibration} we show that the weak factorisation system with
uniform fibrations as right maps satisfies the Frobenius property.


  


\section{Categories of orthogonal maps} 
\label{sec-orthog-functors}



 We will interested in algebraic counterparts of the familiar weak orthogonality properties that are used
 in the definition of a weak factorisation system~\cite{bousfield-wfs}. Furthermore, 
 instead of starting from a mere set of arrows in $\catE$ and define its left or right orthogonal, 
 we consider a category~$\cal{I}$, to be thought of an indexing category (but not assumed to be small), and a functor~$u \co \cal{I} \to \catE^\to$, which assigns an arrow $u_i \co A_i \to B_i$ in $\catE$ to each object $i \in \cal{I}$. The  additional generality obtained by allowing $u$ to be an arbitrary functor,
 rather than just an inclusion,  will play an important role in our development. 
 

 \begin{definition} Let $u \co \cal{I} \to \catE^\to$ be a functor. 
 \begin{enumerate}[(i)] 
 \item  A \emph{right $\cal{I}$-map}
 is a pair $(f, \phi)$ consisting of a map $f \co X \to Y$ in $\cal{E}$ and a right lifting function~$\phi$ for $\cal{I}$, \ie 
 a function that assigns to each $i \in \cal{I}$ and commuting square
\[
\xymatrix@C=2cm{
A_i \ar[r]^{s}   \ar[d]_{u_i} & X \ar[d]^f \\
B_i \ar[r]_{t} & Y}
\]
a diagonal filler $\phi(i,s, t) \co B_i \to X$, satisfying the following naturality 
condition: for every diagram of the form
\[
\xymatrix{
A_i \ar[r]^a \ar[d]_{u_i} & A_j \ar[r]^{s}  \ar[d]_{u_j} & X \ar[d]^f   \\
B_i \ar[r]_{b}  & B_j  \ar[r]_{t}  & Y }
\]
where the left-hand side square is the image of $\sigma \co i \to j$ in $\cal{I}$ under $u$, 
we have that 
\[
\phi(j, s, t) \, b = \phi(i, s  a, t  b) \, .
\]
\item A \emph{morphism} of right $\cal{I}$-maps $\alpha \co (f, \phi) \to (f', \phi')$ is a 
square $\alpha \co f \to f'$ in~$\catE$ satisfying an evident compatibility condition 
with respect to the right lifting functions, which we omit. 
\end{enumerate}
\end{definition}

For a functor $u \co \cal{I} \to \catE^\to$, we write $\liftr{\cal{I}}$ for the category  of 
right $\cal{I}$-maps and their morphisms. There is a forgetful functor~$\liftr{u} \co \liftr{\cal{I}} \to \catE^\to$
mapping $(f, \phi)$ to $f$. Note that the naturality condition becomes vacouos when $\cal{I}$ is a discrete category. Even in this case, however, in order to have a right $\cal{I}$-map it is necessary to define a function $\phi$ providing 
diagonal fillers, and this is sometimes a non-trivial problem without assuming the axiom of choice.



\begin{example}  \label{exa-triv-kan-fib}
Let $\cal{M}$ be the full subcategory of $\cal{E}^\to$ spanned by decidable monomorphisms, \ie
monomorphisms $i \co A \to B$ such that, for all $n$, the function $i_n \co A_n \to B_n$ has decidable
image. A \emph{uniform trivial fibration} is defined to be a right $\cal{M}$-map. We will unfold this
definition and study the notion of uniform  fibration in Section~\ref{sec:uniform-fibrations}.
\end{example}




We now study categories of left and right maps. First of all, recall from~\cite{garner:small-object-argument} that the function mapping $u \co \cal{I} \to \catE^\to$ to its right orthogonal $\liftr{u} \co \liftr{\cal{I}} \to \cal{E}^\to$ defines the action on objects of the right orthogonality functor
\[
\liftr{\brarghole} \co  (\CAT/\catE^{\to})^{\op} \to \CAT/\catE^{\to} \, .
\]
In view of its use in \cref{thm:orth-nat}, we recall the action of this functor on arrows. Given a commutative triangle of the form
\[
\xymatrix{
\cal{I} \ar[dr]_u \ar[rr]^F & & \cal{J} \ar[dl]^{v} \\
 & \catE^\to }
 \]
we define 
\[
\xymatrix{
\liftr{\cal{J}} \ar[dr]_{\liftr{u}} \ar[rr]^{\liftr{F}} & & \liftr{\cal{J}} \ar[dl]^{\liftr{v}} \\
 & \catE^\to }
\]
as follows. For $(f, \phi) \in \liftr{J}$, we let $\liftr{F}(f,\phi) \defeq (f, \phi_F)$, where $\phi_F(i, s, t) \defeq \phi(Fi, s, t)$. 
As shown in~\cite{garner:small-object-argument}, 
just as the standard orthogonality operations determine a Galois connection between the poset of subsets of arrows in~$\catE$ and its opposite, the orthogonality functors form an adjunction 
\begin{equation}
\label{garner-adjunction}
\begin{gathered}
\xymatrix@C+2em{
  \CAT/\catE^{\to}
  \ar@<5pt>[r]^-{\liftl{\brarghole}}
  \ar@{}[r]|-{\bot}
&
  (\CAT/\catE^{\to})^{\op} \, .
  \ar@<5pt>[l]^-{\liftr{\brarghole}}
}
\end{gathered}
\end{equation}
We now extend some useful facts about orthogonality operations to orthogonality functors.






\begin{proposition} \label{thm:orth-nat}
Consider a natural transformation between categories over $\catE^{\to}$:
\[
\xymatrix{
  \cal{I}
  \rrtwocell_G^F{\sigma}
 \ar[dr]_{u}
&&
  \cal{J}
  \ar[dl]^{v}
\\&
  \catE^{\to}
}
\]
Note that this includes the condition $v \sigma = \id_u$.
Then $\liftr{F} = \liftr{G}$ and $\liftl{F} = \liftl{G}$, 
\begin{mathpar}
\xymatrix{
  \liftr{\cal{I}}
  \ar[dr]_{\liftr{u}}
&&
  \liftr{\cal{J}}
  \lltwocell_{\liftr{F}}^{\liftr{G}}{=}
  \ar[dl]^{\liftr{v}}
\\&
  \catE^{\to}
}
\and
\xymatrix{
  \liftl{\cal{I}}
  \ar[dr]_{\liftl{u}}
&&
  \liftl{\cal{J}}
  \lltwocell_{\liftl{F}}^{\liftl{G}}{=}
  \ar[dl]^{\liftl{v}}
\\&
  \catE^{\to}
}
\end{mathpar}
\end{proposition}

\begin{proof} For $(f, \phi) \in \liftr{\cal{J}}$, we have $\liftr{F}(f, \phi) = (f, \phi_F)$ and $\liftr{G}(f, \phi) = (f, \phi_G)$.
We claim that the functions $\phi_F$ and $\phi_G$ coincide. Observe that 
for every $i \in \cal{I}$, we have that $\sigma_i \co v_{Fi}  \Rightarrow v_{Gi}$ is the identity square on $u_i
\co A_i \to B_i$. Hence, by the naturality condition for $\phi$, applied to the diagram 
\[
\xymatrix{
A_i \ar[r]^{\id_{A_i}} \ar[d]_{v_{Fi}}  & A_i \ar[d]^{v_{Gi}} \ar[r]^{s}  & X \ar[d]^{f} \\
B_i \ar[r]_{\id_{B_i}} & B_i \ar[r]_{t} & Y \, ,}
\]
we have  that $\phi_F(i, s, t) = \phi_G(i, s, t)$, as required.
\end{proof} 


We now consider the interaction between the orthogonality functors and the operation of retract closure. 
In the setting of standard weak factorisation systems, it is well-known that
applying the left (or right) orthogonality operation to a class of morphisms produces the same result as applying it to its retract closure. 
In order to establish a counterpart of this fact, we need again some definitions. 
Given a  functor $u \co \cal{I} \to \catE^{\to}$, we define its retract closure $\overline{u} \co \overline{\cal{I}} \to \catE^{\to}$ as follows. 
An object of $\overline{\cal{I}}$ is a tuple~$(i, e, \sigma, \tau)$ consisting of an object $i \in \cal{I}$, an arrow $e \in \cal{E}^\to$ together with squares $\sigma \co e \Rightarrow u_i$ and $\rho \co u_i \Rightarrow e$,
which exhibit $e$ as a retract of $u_i$ in  $\catE^{\to}$,  \ie such that $\sigma \cc \rho = \id_e$. 
A morphism $(f, \kappa) \co (i, e, \sigma, \tau) \to (i', e', \sigma', \tau')$ of $\overline{\cal{I}}$  consists of a morphism $f \co i \to i'$ in $\cal{I}$ and a square $\kappa \co e \Rightarrow e'$  such that the following diagram in $\cal{E}^\to$ commutes:
\[
\xymatrix{
  e
  \ar[r]^{\sigma}
    \ar[d]_{\kappa}
&
  u_i
  \ar[r]^{\rho}
  \ar[d]^{u_f}
&
  e
  \ar[d]^{\kappa}
\\
  e'
  \ar[r]_{\sigma'}
&
  u_{i'}
  \ar[r]_{\rho'}
&
  e' \, .
}
\]
The functor $\overline{u} \co \overline{\cal{I}} \to \catE^\to$ is then defined  on objects  by letting 
$\overline{u}(i, e, \sigma, \tau) \defeq e$,
and on morphisms by letting $\overline{u}(f, \kappa) \defeq \kappa$. The operation of retract closure gives a monad: for $u \co \cal{I} \to \catE^{\to}$,
the components of the multiplication and the unit, 
\[
\mu_\cal{I} \co \overline{\overline{\cal{I}}} \to \overline{\cal{I}} \, , \quad
\eta_\cal{I} \co \cal{I} \to \overline{\cal{I}} \, ,
\]
are defined by letting
\[
\mu_\cal{I}((i, e, \sigma,  \rho), e', \sigma', \rho') \defeq (i, e', \sigma \cc \sigma', \rho' \cc \rho) \, , \quad
\eta_{u_i} \defeq (i, u_i, \id_{u_i}, \id_{u_i}) \, .
\]




\begin{proposition}[Orthogonality and retract closure]
\label{retract-closure}
The orthogonality functors send the components of the unit and multiplication of the retract closure monad into natural
isomorphisms, and so for every $u \co \cal{I} \to \catE^\to$, we have isomorphisms of categories
\begin{gather*} 
 \liftr{(\overline{\cal{I}})} \iso \liftr{\cal{I}} \, , \quad
 \liftr{(\overline{\overline{\cal{I}}})} \iso \liftr{\overline{\cal{I}}}  \qquad
 \liftl{(\overline{\cal{I}})} \iso \liftl{\cal{I}} \, , \quad
 \liftl{(\overline{\overline{\cal{I}}})} \iso \liftl{\overline{\cal{I}}}
\end{gather*} 
over $\catE^\to$. \qed
\end{proposition}




\begin{remark} Let $\ret$ denote the \emph{walking retract}, \ie the category with objects $\retA, \retB$ and morphisms generated by $s \co \retA \to \retB$ and $r \co \retB \to \retA$ under the relation $r \cc s = \id_{\retA}$. The retract closure of $u \co \cal{I} \to \catE^\to$ fits into the following diagram, involving strict pullback and left composition:
\[
\xymatrix@C+1em{
  \overline{\cal{I}}
  \ar[r]
  \ar[d]
  \ar@/_2em/[dd]_{\overline{u}}
  \pullback{dr}
&
  \cal{I}
  \ar[d]^{u}
\\
  (\catE^{\to})^{\ret}
  \ar[r]^-{(\catE^{\to})^{\retB}}
  \ar[d]^{(\catE^{\to})^{\retA}}
&
  \catE^{\to}
\\
  \catE^{\to}
}
\]
The unit of the monad is formally induced by $(\catE^{\to})^{\canonical} \co \catE^{\to} \to (\catE^{\to})^{\ret}$ being a section to $(\catE^{\to})^{\retB}$.
\end{remark}




Next, we consider the interaction between the orthogonality functors and the slicing and coslicing operations. 
 In the classical setting it is well-known that the right orthogonality operation commutes with slicing, while the left orthogonality operation commutes with coslicing.  In order to provide a counterpart of this fact in our setting, we need some auxiliary definitions. Given a functor $u \co \cal{I} \to \catE^{\to}$ and $X \in \catE$, we define the category $\cal{I}/X$
and a functor $u/X \co \cal{I}/X \to (\cal{E}/X)^\to$ as follows. The category $\cal{I}/X$ has as objects pairs consisting of an object $a \in \cal{I}$ and a commutative triangle of the form
\[
\xymatrix{
A_i \ar[dr] \ar[rr]^{u_i} & & B_i \ar[dl] \\
 & X }
 \]
The functor $u/X \co \cal{I}/X \to (\cal{E}/X)^\to$ sends such a pair to $u_i \co A_i \to B_i$, viewed as a morphism in $\cal{E}/X$. This category fits into the
following pullback diagram:
\[
\xymatrix{
  \cal{I}/X
  \ar[r]
  \ar[d]_{u/X}
  \pullback{dr}
&
  \cal{I}
  \ar[d]^{u}
\\
  (\catE/X)^{\to}
  \ar[r]
&
  \catE^{\to}
}
\]
where we used the functor on arrow categories induced by the forgetful functor $\operatorname{dom} \co \catE/X \to \catE$.  Dually, taking the strict pullback along the map on arrows induced by the forgetful functor 
$\operatorname{cod} \co X/\cal{E} \to \catE$ constructs the \emph{coslice} over $X$:
\[
\xymatrix{
  X/\cal{I}
  \ar[r]
  \ar[d]_{X/u}
  \pullback{dr}
&
  \cal{I}
  \ar[d]^{u}
\\
  (X/\catE)^{\to}
  \ar[r]
&
  \catE^{\to}
}
\]
which also admits an explicit description, dual to the one given above for $\cal{I}/X$. With these definitions in place, we can now state the counterpart in our setting of the familiar commutation between slicing and orthogonality operations. 



\begin{proposition}[Orthogonality and slicing] \hfill 
\label{pitchfork-slicing}
\begin{enumerate}[(i)]
\item The right orthogonality functor commutes with slicing, \ie for every $u \co \cal{I} \to \cal{E}$, we have
\[
  \liftr{\cal{I}}/X = \liftr{(\cal{I}/X)}
\]
as categories over $\cal{E}^\to$.
\item The left orthogonality functor commutes with coslicing, \ie for every $u \co \cal{I} \to \cal{E}$, we have
\[
 \liftl{\cal{I}} \backslash X = \liftl{\cal{I} \backslash X}
\]
as categories over $\cal{E}^\to$.
\end{enumerate}
\end{proposition}

\begin{proof} We only consider (i). The claim follows by unfolding definitions, but we describe the objects of the category explicitly for clarity. They are given by 
tuples consisting of an arrow in~$\cal{E}/X$, 
\[
\xymatrix{
X \ar[dr] \ar[rr]^f  &  & Y \ar[dl] \\
 & X & }
 \]
and a function $\phi$ that assigns a diagonal filler to every diagram in $\cal{E}$ of the form
\[
\xymatrix{
A_i \ar[r] \ar[d]_{u_i} & X \ar[d]^{f} \\
B_i \ar[r] & Y}
\]
where $i \in \cal{I}$, subject to a uniformity condition. 
\end{proof}

\begin{remark}
\label{retract-closure-slicing}
Taking the retract closure commutes with slicing and coslicing.
\end{remark}

Finally, we discuss the interaction between the orthogonality functors and adjunctions.
In the standard setting, it is well known that if  we have classes of maps $\cal{I} \subseteq \cal{E}^\to$ and $\cal{J} \subseteq \cal{F}^\to$ and an adjunction
\[
\xymatrix@C+1em{
  \cal{E}
  \ar@<5pt>[r]^{F}
  \ar@{}[r]|{\bot}
&
  \cal{F}
  \ar@<5pt>[l]^{G}
}
\]
then $F(\cal{I}) \subseteq \liftl{\cal{J}}$ if and only if $\liftr{\cal{I}} \subseteq G(\cal{J})$, and consequently $\liftr{F(\cal{I})} = G(\liftr{\cal{I}})$ and $\liftl{G(\cal{J})} = F(\liftl{\cal{J}})$.
The next proposition and corollary provide counterparts of these facts in our setting.

\begin{proposition}[Orthogonality and adjoints] \label{lift-of-adjunction} 
Let $u \co \cal{I} \to \cal{E}^{\to}$ and $v \co \cal{J} \to \cal{F}^{\to}$ be functors and consider an adjunction
\[
\xymatrix@C+1em{
  \cal{E}
  \ar@<5pt>[r]^{F}
  \ar@{}[r]|{\bot}
&
  \cal{F}
  \ar@<5pt>[l]^{G}
}
\]
Then the following are equivalent:
\begin{enumerate}[(i)]
\item the functor $F \co \cal{E}^\to \to \cal{F}^\to$ extends to a functor $F' \co \cal{I} \to \liftl{\cal{J}}$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \ar[r]^{F'}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \cal{E}^{\to}
  \ar[r]_-{F}
&
  \cal{F}^{\to}\, ,}
\]
\item the functor $G \co \cal{F}^\to \to \cal{E}^\to$ extends to a functor $G' \co \cal{J} \to \liftr{\cal{I}}$, making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \liftr{\cal{I}}
  \ar[d]_{\liftr{u}}
&
  \cal{J}
  \ar[l]_{G'} 
  \ar[d]^{v}
\\
  \cal{E}^{\to}
&
  \cal{F}^{\to}
  \ar[l]^{G}
}
\]
\end{enumerate}
\end{proposition}

\begin{proof} Giving a functor $F' \co \cal{I} \to \liftl{\cal{J}}$ as above is the same thing as giving fillers for squares of the form
\[
\xymatrix{
FA \ar[d]_{F u_i} \ar[r] & C \ar[d]^{v_j} \\
FB \ar[r] & D }
\]
natural in $i  \in \cal{I}$ and $j \in \cal{J}$. Similarly, giving a functor $G' \co \cal{J} \to \liftl{\cal{I}}$ as above is the same thing as giving fillers for squares 
of the form
\[
\xymatrix{
A \ar[d]_{u_i} \ar[r] & GC \ar[d]^{Gv_j} \\
B \ar[r] & GD }
\]
 natural in $i \in \cal{I}$ and $j \in \cal{J}$. Since $F \dashv G$, these situations coincide.
\end{proof}

\cref{lift-of-adjunction} can equivalently be expressed as orthogonality functors commuting with left composition with adjoints:

\begin{corollary}
\label{pitchfork-adjunction}
In the setting of \cref{lift-of-leibniz-adjunction}, we have canonical isomorphisms as follows:
\begin{align*}
\liftr{(F^{\to} \cc u)} &= G^{\to} \cc \liftr{u}
\\
\liftl{(G^{\to} \cc v)} &= F^{\to} \cc \liftl{v}
\end{align*}
\end{corollary}

\begin{proof}
For \eg the first isomorphism, apply the adjunction \eqref{garner-adjunction} to the first diagram in \cref{lift-of-adjunction} and compare it with the second diagram.
\end{proof}

We will now generalize \cref{lift-of-adjunction} to Leibniz adjunctions.
Consider bifunctors $F \co \cal{K} \times \cal{E} \to \cal{F}$ and $G \co \cal{K}^{\op} \times \cal{F} \to \cal{E}$ related pointwise for $k \in \cal{K}$ by an adjunction:
\[
\xymatrix@C+1em{
  \cal{E}
  \ar@<5pt>[r]^{F(k, \arghole)}
  \ar@{}[r]|{\bot}
&
  \cal{F}
  \ar@<5pt>[l]^{G(k, \arghole)}
}
\]
Assume that $\cal{E}$ has pushouts and $\cal{F}$ has pullbacks.
Let 
\[
\widehat{F} \co \cal{K}^{\to} \times \cal{E}^{\to} \to \cal{F}^{\to} \, , \quad
\widehat{G} \co (\cal{K}^{\op})^{\to} \times \cal{F}^{\to} \to \cal{E}^{\to}
\] 
denote the respective Leibniz constructions for $F$ and $G^{\op}$, using pullback instead of pushout for~$\widehat{G}$.
In the standard setting, it is well known that if  we have classes of maps $\cal{I} \subseteq \cal{E}^\to$ and $\cal{J} \subseteq \cal{F}^\to$, then for each $h \in \cal{K}^{\to}$ we have $\widehat{F}(h, \cal{I}) \subseteq \liftl{\cal{J}}$ if and only if $\liftr{\cal{I}} \subseteq \widehat{G}(h, \cal{J})$, and consequently $\liftr{F(h, \cal{I})} = G(h, \liftr{\cal{I}})$ and $\liftl{G(h, \cal{J})} = F(h, \liftl{\cal{J}})$.
The next proposition and corollary provide counterparts of these facts in our setting.

\begin{proposition}[Orthogonality and Leibniz adjoints]
\label{lift-of-leibniz-adjunction}
Let $u \co \cal{I} \to \cal{E}^{\to}$ and $v \co \cal{J} \to \cal{F}^{\to}$ be functors.
Consider bifunctors $F \co \cal{K} \times \cal{E} \to \cal{F}$ and $G \co \cal{K}^{\op} \times \cal{F} \to \cal{E}$ related pointwise for 
$k \in \cal{K}$ by an adjunction:
\[
\xymatrix@C+1em{
  \cal{E}
  \ar@<5pt>[r]^{F(k, \arghole)}
  \ar@{}[r]|{\bot}
&
  \cal{F}
  \ar@<5pt>[l]^{G(k, \arghole)}
}
\]
Assume that $\cal{E}$ has pushouts and $\cal{F}$ has pullbacks.
Let 
\[
\widehat{F} \co \cal{K}^{\to} \times \cal{E}^{\to} \to \cal{F}^{\to} \, , \quad \widehat{G} \co (\cal{K}^{\op})^{\to} \times \cal{F}^{\to} \to \cal{E}^{\to}
\] 
denote the respective Leibniz constructions for $F$ and $G^{\op}$ (using pullback instead of pushout for $G$).
Then the following are equivalent for $h \co X \to Y$ in $\cal{K}$:
\begin{enumerate}[(i)]
\item Extensions $F' \co \cal{I} \to \liftl{\cal{J}}$ of the functor $\widehat{F}(h, \arghole) \co \cal{E}^\to \to \cal{F}^\to$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \ar[r]^{F'}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \cal{E}^{\to}
  \ar[r]_-{\widehat{F}(h, \arghole)}
&
  \cal{F}^{\to}\, ,}
\]
\item Extensions $G' \co \cal{J} \to \liftr{\cal{I}}$ of the functor $\widehat{G}(h, \arghole) \co \cal{F}^\to \to \cal{E}^\to$  making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \liftr{\cal{I}}
  \ar[d]_{\liftr{u}}
&
  \cal{J}
  \ar[l]_{G'} 
  \ar[d]^{v}
\\
  \cal{E}^{\to}
&
  \cal{F}^{\to}
  \ar[l]^-{\widehat{G}(h, \arghole)}
}
\]
\end{enumerate}
\end{proposition}

\begin{proof}
Giving a functor $F' \co \cal{I} \to \liftl{\cal{J}}$ as above is the same thing as giving fillers for trapezoids $\widehat{F}(h, u_i) \to v_j$
\[
\xymatrix{
  F(X, A)
  \ar[r]
  \ar[d]
&
  F(Y, A)
  \ar[d]
  \ar@/^2em/[ddr]
\\
  F(X, B)
  \ar[r]
  \ar@/_2em/[drr]
&
  \bullet
  \ar[dr]_{\widehat{F}(h, u_i)}
  \ar[rr]
  \pullback{ul}
&&
  C \ar[d]^{v_j}
\\&&
  F(Y, B)
  \ar[r]
&
  D
}
\]
natural in $i \in \cal{I}$ and $j \in \cal{J}$.
Similarly, giving a functor $G' \co \cal{J} \to \liftl{\cal{I}}$ as above is the same thing as giving fillers for trapezoids $u_i \to \widehat{G}(h, v_j)$
\[
\xymatrix{
  A
  \ar[d]_{u_i}
  \ar[r]
&
  G(Y, C)
  \ar[dr]^{\widehat{G}(h, v_j)}
  \ar@/_2em/[ddr]
  \ar@/^2em/[drr]
\\
  B
  \ar[rr]
&&
  \bullet
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  G(X, C)
  \ar[d]
\\&&
  G(Y, D)
  \ar[r]
&
  G(X, D)
}
\]
natural in $i \in \cal{I}$ and $j \in \cal{J}$.
Since $F(X, \arghole) \dashv G(X, \arghole)$ and $F(Y, \arghole) \dashv G(Y, \arghole)$, the usual Leibniz construction diagram chasing shows that these situations coincide.
\end{proof}

\cref{lift-of-leibniz-adjunction} can equivalently be expressed as orthogonality functors commuting with left composition with Leibniz adjoints:

\begin{corollary}
\label{pitchfork-leibniz-adjunction}
In the setting of \cref{lift-of-leibniz-adjunction}, we have canonical isomorphisms as follows:
\begin{align*}
\liftr{(\widehat{F}(h, \arghole) \cc u)} &= \widehat{G}(h, \arghole) \cc \liftr{u}
\\
\liftl{(\widehat{G}(h, \arghole) \cc v)} &= \widehat{F}(h, \arghole) \cc \liftl{v}
\end{align*}
\end{corollary}

\begin{proof}
For \eg the first isomorphism, apply the adjunction \eqref{garner-adjunction} to the first diagram in \cref{lift-of-leibniz-adjunction} and compare it with the second diagram.
\end{proof}

\begin{remark}
\cref{lift-of-adjunction,pitchfork-adjunction} can be seen as special cases of \cref{lift-of-leibniz-adjunction,pitchfork-leibniz-adjunction} where $\cal{K}$ is the terminal category.
\end{remark}

\begin{example}
\label{pitchfork-leibniz-most-general-example}
In \cref{lift-of-leibniz-adjunction} or \cref{pitchfork-leibniz-adjunction}, let $\cal{K}$ be the category of adjunctions $U \dashv V$ with $F : \cal{E} \to \cal{F}$ and $G : \cal{F} \to \cal{E}$.
A morphism from $U_1 \dashv V_1$ to $U_2 \dashv V_2$ consists of natural transformations $u : U_1 \to U_2$ and $v : V_2 \to V_1$ forming mates.
Note that we have fully faithful forgetful functors $\cal{K} \to [\cal{E}, \cal{F}]$ and $\cal{K} \to [\cal{F}, \cal{E}]^{\op}$.
We have functors $F : \cal{K} \times \cal{E} \to \cal{F}$ and $G : \cal{K}^{\op} \times \cal{F} \to \cal{E}$ given by left and right adjoint application, respectively.
This is, in some sense, the most general instantiation of \cref{lift-of-leibniz-adjunction}.
\end{example}

\section{The Frobenius the Beck-Chevalley conditions}
\label{sec:frobenius}

\begin{definition}[Frobenius condition] Let $u \co \cal{I} \to \cal{E}^\to$ be a functor. We say that a map $f \co X \to Y$ \emph{satisfies the Frobenius condition} with respect to $u$ if pullback along $f$ 
lifts to a functor 
\[
\xymatrix@C=1.5cm{
  \cal{I}/Y
   \ar[r]^{f^*}
  \ar[d]_{u/Y} 
  &
  \liftl{ ( \liftr{\cal{I}}/X ) }
  \ar[d]^{\liftl{(\liftr{u}/X)}}
     \\
     (\catE/Y)^{\to} \ar[r]_{f^*} &
   (\catE/X)^{\to} 
}
\]
\end{definition}

\begin{proposition} \label{lift-dependent-product}
 Let $u \co \cal{I} \to \cal{E}^\to$ be a functor. For a map $f \co X \to Y$
admitting pullback and pushforward:
\[
\xymatrix@C+1em{
  \catE/X
  \ar@<5pt>[r]^{f_*}
  \ar@{}[r]|{\top}
&
  \catE/Y
  \ar@<5pt>[l]^{f^*}
}
\]
the following are equivalent:
\begin{enumerate}[(i)] 
\item $f$ satisfies the Frobenius condition, 
\item  pushforward along $f$ lifts to a functor
\[
\xymatrix@C=1.5cm{
\liftr{\cal{I}}/X
\ar[r]^{f_*}
  \ar[d]_{u/X}
&
  \liftr{\cal{I}}/Y
  \ar[d]^{\liftr{u}/Y}
\\
  (\catE/X)^{\to}
   \ar[r]_{f_*}
&
  (\catE/Y)^{\to}
 }
\]

\end{enumerate}
\end{proposition} 

\begin{proof} Recall from \cref{pitchfork-slicing} that slicing commutes with the right orthogonality functor.
%For the first correspondence, apply \cref{lift-of-adjunction} to the adjunction $p^* \dashv p_*$ with $v = \liftr{u}$.
%The last statement is simply the adjunction~\eqref{garner-adjunction}.
Now apply \cref{lift-of-adjunction} to the adjunction $p^* \dashv p_*$ with $u = u/X$ and $v = \liftr{u}/Y$.
\end{proof}

In order to introduce the Beck-Chevalley condition, we need to prove an auxiliary result that shows how 
we can lift pullback functors to categories of right orthogonal maps. For this, we first establish the following
lemma.


\begin{lemma}
\label{slicing-2-functorial}
Let $u \co \cal{I} \to \catE^{\to}$ be a functor and $f \co X \to Y$ a map in $\catE$. Then, 
\begin{enumerate}[(i)]
\item left composition $f_! \co \calE/X \to \calE/Y$ lifts to a functor $f_!$ between slices of $u$,
\[
\xymatrix@C+1em{
  \cal{I}/X
  \ar[r]^-{f_!}
  \ar[d]_{u/X}
&
  \cal{I}/Y
  \ar[d]^{u/Y}
\\
  (\calE/X)^{\to}
  \ar[r]_-{f_!}
&
  (\calE/Y)^{\to}
}
\]
\item right composition $f^! : \calE \backslash Y \to \calE \backslash X$ lifts to a functor $f^!$ between coslices of $u$,
\[
\xymatrix@C+1em{
  \cal{I} \backslash X
  \ar[d]_{u/X}
&
  \cal{I} \backslash Y
  \ar[l]_-{f^!}
  \ar[d]^{u \backslash Y}
\\
  (\calE \backslash X)^{\to}
&
  (\calE \backslash Y)^{\to}
  \ar[l]^-{f^!}
}
\]
\end{enumerate}
\end{lemma}



\begin{definition}[Beck-Chevalley condition] Let $f \co X \to Y$ and $g \co U \to V$ be maps that satisfy the Frobenius condition. We say that a commutative square 
\[
\xymatrix{
  X 
  \ar[d]_{f}
  \ar[r]^{s}
&
  U
  \ar[d]^{g}
\\
  Y
  \ar[r]_{t}
&
  V
}
\]
satisfies the \emph{Beck-Chevalley condition} if the canonical natural transformation 
 \[
\xymatrix{
  (\cal{E}^\to)_{/X}
  \ar[r]^{s_!}
&
  (\cal{E}^\to)_{/U}
\\
  (\cal{E}^\to)_{/Y}
  \ar[u]^{f^*} 
  \ar[r]_{t_!}
  \urtwocell<\omit>{\phi'}
&
  (\cal{E}^\to)_{/V}
  \ar[u]_{g^*}
}
\]
 lifts to a natural transformation
 \[
\xymatrix{
  \cal{I}_{/X}
  \ar[r]^{s_!}
&
   \cal{I}_{/U}
\\
   \cal{I}_{/Y}
  \ar[u]^{f^*} 
  \ar[r]_{t_!}
  \urtwocell<\omit>{\phi'}
&
   \cal{I}_{/V}
  \ar[u]_{g^*}
}
\]
\end{definition}

\begin{remark}[Beck-Chevalley condition] To be added.

\end{remark} 

\begin{lemma} \label{lift-pullback} Let $u : \cal{I} \to \catE^{\to}$ be a functor.
For every map $f \co X \to Y$ admitting pullback:
\[
\xymatrix@C+1em{
  \catE/X
  \ar@<-5pt>[r]_{f_!}
  \ar@{}[r]|{\top}
&
  \catE/Y
  \ar@<-5pt>[l]_{f^*}
}
\]
pullback along $f$ lifts to slices of the right orthogonality categories,
\[
\xymatrix@C=1.5cm{
  \liftr{\cal{I}}/X
  \ar[d]_{\liftr{u}/X}
&
  \liftr{\cal{I}}/Y
  \ar[l]_{f^*}
  \ar[d]^{\liftr{u}/Y}
\\
  (\catE/X)^{\to}
&
  (\catE/Y)^{\to}
  \ar[l]^{f^*}
}
\]
\end{lemma}

\begin{proof}
Combine \cref{lift-of-adjunction} with part (i) of \cref{slicing-2-functorial}.
\end{proof}

%\begin{question}
%In fact, $\liftr{C}/\text{--}$ is a cartesian fibration (compare notes-on-awfs).
% Do we need that?
% \end{question}



\begin{proposition} \label{lift-pushforward-BC}  Let $u \co \cal{I} \to \catE^{\to}$ be a functor.
Let $f \co X \to Y$ and $g \co U \to V$ be maps that satisfy the Frobenius condition. For a square
\[
\xymatrix{
  X 
  \ar[d]_{f}
  \ar[r]^{s}
&
  U
  \ar[d]^{g}
\\
  Y
  \ar[r]_{t}
&
  V
}
\]
the following are equivalent: 
\begin{enumerate}[(i)]
\item $(s,t)$ satisfies the Beck-Chevalley condition, 
\item the canonical natural transformation
\[
\xymatrix{
  \catE^\to_{/X}
  \ar[d]_{f_*}
&
  \catE^\to_{/U} \ar[d]^{g_*} \ar[l]_{s^*} 
\\
  \catE^\to_{/Y} 
&
  \catE^\to_{/V}
  \ar[l]^{t^*}
}
\]
lifts to a natural transformation 
\[
\xymatrix{
  \cal{I}_{/X}
  \ar[d]_{f_*}
&
  \cal{I}_{/U} \ar[d]^{g_*} \ar[l]_{s^*} 
\\
  \cal{I}_{/Y} 
&
  \cal{I}_{/V}
  \ar[l]^{t^*}
}
\]

\end{enumerate}
\end{proposition}

\begin{proof} Recall from \cref{pitchfork-slicing} that slicing commutes with the right orthogonality functor.
Now apply \cref{lift-of-adjunction} in the form of a natural correspondence (not just a logical equivalence) with $u = u/V$ and $v = \liftr{u}/X$ while noting that the construction of \cref{lift-of-adjunction} as applied in \cref{lift-pullback} and \cref{lift-dependent-product} composes (meaning the correspondence of \cref{lift-of-adjunction} commutes with composition of adjunctions).
\end{proof}





\section{Cylinders and homotopies}
\label{sec:preliminaries}



\begin{definition} \label{def:cylinder}
 A \emph{functorial cylinder} $(\interval \otimes (-), \lcyl, \rcyl, \ccyl)$ in $\catE$ 
is an endofunctor $\interval \otimes (-) \co \catE \to \catE$ equipped with natural transformation $\lcyl, \rcyl$ and $\ccyl$ having components
of the form
\[
\lcyl_X \, , \rcyl_X \co X \to \interval \otimes X \, , \quad \varepsilon_X \co \interval \otimes X \to X \, ,
 \]
and such that the following diagrams commute:
\[
\xymatrix{
X  \ar[r]^{\lcyl_X} \ar[dr]_{\id_X} & \interval \otimes X \ar[d]^-(.4){\varepsilon_X} & X \ar[dl]^{\id_X} \ar[l]_-{\rcyl_X}  \\
 & X & }
 \]
 for all $X \in \catE$.
\end{definition}


\begin{definition} \label{def:homotopy} Let $\catE$ be a category equipped with a functorial cylinder $(\interval \otimes (-), \lcyl, \rcyl, \ccyl)$.
\begin{enumerate}[(i)] 
\item  Let $f, g \co X \to Y$ be maps in $\catE$. A \emph{homotopy from $f$ to $g$}, denoted $h \co f \sim g$,  is a morphism 
$h \co \interval \otimes X \to Y$ such that the following diagrams commute:
\[
\xymatrix@C=1.2cm{
X \ar[r]^-{\lcyl_X} \ar[dr]_{f} & \interval \otimes X \ar[d]^{h} & X \ar[dl]^{g} \ar[l]_-{\rcyl_X}  \\
 & Y & }
 \]
 \item A map $f \co X \to Y$ is called a \emph{left homotopy equivalence} if there exist $g \co Y \to X$ and homotopies $h \co \id_X \sim g \cc f$ and $k \co
\id_Y \sim f \cc g$. Such a left homotopy equivalence is said to be \emph{strong} if the
following diagram commutes:
\[
\xymatrix{
\interval \otimes X \ar[r]^{\interval \otimes f } \ar[d]_{h} & \interval \otimes Y \ar[d]^{k} \\
X \ar[r]_{f} & Y}
\]
and it is said to be \emph{co-strong} if  the following diagram commutes:
\[
\xymatrix{
\interval \otimes Y \ar[r]^{\interval \otimes g } \ar[d]_{k} & \interval \otimes X \ar[d]^{h} \\
Y \ar[r]_{g} & X \, .}
\]
The notion of a \emph{(strong) right homotopy} is defined dually.
\end{enumerate}
\end{definition}



\begin{remark} \hfill 
\begin{enumerate}[(i)]
\item  The notion of homotopy equivalence is symmetric and admits an evident duality, and a homotopy equivalence is strong if 
and only if its dual is co-strong. 
\item The notion of a left or right strong homotopy equivalence is a generalization of the notion of a strong deformation retract, which is obtained by requiring also
that the homotopy $h$ is trivial.
\end{enumerate}
\end{remark}


We define the category $\cal{S}_0(\cal{I})$ of strong right homotopy equivalences and the category $\cal{S}_1(\cal{I})$ of strong left homotopies, relative
to  $\cal{I}$ as follows. 
The objects of $\cal{S}_1(\cal{I})$ are  4-tuples $(i, g,h,k)$ consisting of an object $i \in \cal{I}$ together with data making $u_i \co A_i \to B_i$ into a strong left homotopy equivalence,
\ie arrows $g \co B_i \to A_i$, $h \co \interval \otimes A \to A$, $k \co \interval \otimes B \to B$, satisfying the appropriate diagrams.
A morphism $m \co (i,g, h, k) \to (i', g', h', k')$ consists of a map $m \co i \to i'$ in $\cal{I}$ such that, writing 
\[
\xymatrix{
A \ar[d]_{u_i}  \ar[r]^s & A' \ar[d]^{u_{i'}} \\
B \ar[r]_t & B'}
\]
for $u_m \co u_i \to u_{i'}$, the following diagrams commute:
\begin{mathpar}
\xymatrix{
  B
  \ar[r]^{t}
  \ar[d]_{g}
&
  B'
  \ar[d]^{g'}
\\
  A
  \ar[r]_{s}
&
  A'
}
\and
\xymatrix@C+2em{
  \interval \otimes A
  \ar[d]_{h}
  \ar[r]^{\interval \otimes s}
&
  I \otimes A'
  \ar[d]^{h'}
\\
  A  \ar[r]_{s}
&  A'
}
\and
\xymatrix{
  \interval \otimes B
  \ar[d]_{k}
  \ar[r]^{\interval \otimes t}
&
  I \otimes B'
  \ar[d]^{k'}
\\
  B
  \ar[r]_{t}
&
  B'
}
\end{mathpar}
Note that there is an obvious forgetful functor $\cal{S}_1(\cal{I}) \to \cal{I}$. We write $\cal{S}_1(u) \co \cal{S}_1(\cal{I}) \to \catE^{\to}$ be its composition with $u \co \cal{I} \to \catE^{\to}$, mapping $(i, g,h,k)$ to $u_i \co A_i \to B_i$. We have a dual construction of a category $\cal{S}_r(\cal{I})$ of strong right homotopy equivalences relative to  $u \co \cal{I} \to \catE^{\to}$.

\medskip

Our next goal is to give an alternative characterisation of strong homotopy equivalences. In order to do this, we 
introduce a general construction that will be useful also in other sections. Given
 $f \co X \to Y$, we define $\delta^k \hatotimes f \co (\interval \otimes X) +_{X} Y \to \interval \otimes Y$, where
 $k \in \{  0, 1\}$, by the universal property of pushouts, as in the following diagram:
 \begin{equation}
 \label{equ:delta-and-f}
 \begin{gathered}
\xymatrix@C=1.2cm{
X  \ar[r]^{f}  \ar[d]_{\kcyl_{X}} & Y  \ar@/^2pc/[ddr]^{\kcyl_{Y}} \ar[d] & \\ 
\interval \otimes X \ar@/_1pc/[drr]_{\interval \otimes f} \ar[r] & (\interval \otimes X) +_{X} Y \ar[dr]^-{\delta^k \hatotimes f}  & \\ 
 & & \interval \otimes Y} 
 \end{gathered}
 \end{equation}
Note that this is an instance of the Leibniz construction. 

Let $0_\catE \co \catE \to \catE$ be the functor with constant value the initial object $0 \in \catE$, and let 
$\bot \co 0_\catE \rightarrow \Id_\catE$ be the natural transformation with components given by the unique maps $\bot_X \co 0 \to X$. Observe that for every $f \co X \to Y$, we have an isomorphism
\begin{equation}
\label{equ:bot-hatotimes-f}
\bot \hatotimes f \iso f \, .
\end{equation}
For $k \in \{ 0, 1 \}$, we then have a commutative square of functors and natural transformations
\[
\xymatrix@C+2em{
0_\catE \ar[r]^{\bot} \ar[d]_{\bot} & \id_\catE \ar[d]^{\rcyl} \\
\id_\catE \ar[r]_{\lcyl} & \interval \otimes (-)}
\]
This diagram determines two maps in $[\catE, \catE]^\to$, 
\begin{equation}
\label{equ:thetas}
\thetal \co \bot \rightarrow \rcyl \, , \quad \thetar \co \bot \rightarrow \lcyl 
\end{equation}
which are defined by letting $\thetal \defeq (\bot, \lcyl)$ and $\thetar  \defeq (\bot, \rcyl)$.  By functoriality of the Leibniz construction
and the isomorphisms in~\eqref{equ:bot-hatotimes-f}, the
maps in~\eqref{equ:thetas} give us two maps 
 \[
 \thetal \hatotimes f \co f \to \rcyl \hatotimes f  \, , \qquad \thetar \hatotimes f \co f \to \lcyl \hatotimes f 
 \]
 in $\catE^\to$, which consist of squares of the form
 \[
 \xymatrix@C+2em{
 X \ar[r] \ar[d]_{f}  & (\interval \otimes X) +_{X} Y  \ar[d]^{\kcyl \hatotimes f}  \\ 
 Y \ar[r] & \interval \otimes Y} 
 \]
 for $k \in \{0, 1\}$. We can now provide a characterization of strong homotopy equivalences.



\begin{proposition}
\label{strong-h-equiv-as-section}
Let $f \co X  \to Y$ be a morphism in $\catE$.
\begin{enumerate}[(i)]
\item $f$ is a strong right homotopy equivalence if and only if $\thetar \hatotimes f \co f \rightarrow  \lcyl \hatotimes f$ is a section.
\item $f$ is a strong left homotopy equivalence if and only if $\thetal \hatotimes f \co f \rightarrow \rcyl \hatotimes f$ is a section.
\end{enumerate}
\end{proposition}

\begin{proof}
By duality, it suffices to exhibit the equivalence in (ii). To say that $\thetal \hatotimes f \co f \to \rcyl \hatotimes f$ is a section means that
there is retraction $\rho$, as follows:
\[
\xymatrix@C+1em{
  X \ar[r] \ar[d]_f & (\interval \otimes X) +_{X} Y \ar[d]^{\rcyl \hatotimes f}  \ar[r]  & X \ar[d]^f \\
  Y \ar[r] & \interval \otimes Y \ar[r] & Y }
\]
where the two horizontal composites should be identiies. First, by a standard diagram-chasing arguments, giving 
the square on the right  is equivalent  to giving maps $h \co \interval \otimes X \to X$, $g \co Y \to X$, and $k \co \interval \otimes Y \to Y$ such that the following diagrams commute:
\begin{equation}
\label{equ:first-three}
\xycenter{
X \ar[r]^-{\rcyl_X}  \ar[d]_f & \interval \otimes X \ar[d]^{h} \\
Y \ar[r]_{g} & X}  \qquad
\xycenter{
Y \ar[r]^-{\rcyl_Y} \ar[d]_g & \interval \otimes Y \ar[d]^{k} \\
X \ar[r]_f & B} \qquad
\xycenter{ 
\interval \otimes X \ar[d]_h \ar[r]^{I \otimes f} & \interval \otimes Y \ar[d]^k \\
X \ar[r]_{f} & Y }
\end{equation}
Secondly, requiring that the two horizontal composites are a section to $\thetal \hatotimes f$ means that the diagrams
\begin{equation}
\label{equ:second-two}
\xycenter{
X \ar[r]^-{\lcyl_X} \ar[dr]_{\id_X} & \interval \otimes X \ar[d]^h \\ 
 & X } \qquad
 \xycenter{
 Y \ar[r]^-{\lcyl_Y}  \ar[dr]_{\id_Y} & \interval \otimes Y \ar[d]^{k} \\
  & Y} 
\end{equation}
commute. With reference to \cref{def:homotopy}, the equations in~\eqref{equ:first-three} provide right endpoint for $h$, 
right endpoint for $k$, and strength for $h$, respectively; while the equations in~\eqref{equ:second-two} provide left endpoints for~$h$ and~$k$, respectively.
\end{proof}

\cref{strong-h-equiv-as-section} implies that left or right strong homotopy equivalences are closed under retracts 
since functors preserve sections, and that  sections are closed under retracts.

\medskip


%\begin{remark} \label{strong-h-equiv-closed-under-monoidal-prod}
%If either $f$ or $g$ is a left (respectively, right) strong homotopy equivalence, then so is $f \hatotimes g$.
%Apply \cref{strong-h-equiv-as-section} and use that functors (in this case the Leibniz monoidal product in one variable) preserve sections.
% \end{remark}




In order to state our next result, we introduce a construction that will be useful also in the following. For  $k \in \{ 0, 1 \}$, we define a functor
 \[
\kcyl \hatotimes u \co \cal{I} \to \catE^\to
 \]
 by letting $(\kcyl \otimes u)_i \defeq \kcyl  \hatotimes u_i$,  where $\kcyl \hatotimes u_i$ is given by the construction
 in~\eqref{equ:delta-and-f}.   
 
 



\begin{lemma}
\label{strong-h-equiv-as-section-algebraic}
The category $\cal{S}_k(\cal{I})$ is  isomorphic to the category given as follows:
\begin{enumerate}[(i)]
\item  objects are pairs $(i, \rho)$ consisting of $i \in \cal{I}$ and a retraction $\rho$ to $\thetak \hatotimes u_i$, as in the diagram
\[
\xymatrix@C+2em{
u_i 
  \ar[r]^-{\thetak \hatotimes u_i }
  \ar[dr]_{\id}
&
  \kcyl \hatotimes u_i \ar[d]^{\rho}
\\&
  u_i
}
\]
\item morphisms $\tau \co (i, \rho) \to (i', \rho')$ are arrows $\tau \co i \to i'$  such that the following
diagram commutes:
\[
\xymatrix@C+2em{
  \kcyl \hatotimes u_i 
  \ar[d]_-{\rho}
  \ar[r]^{\kcyl \hatotimes u_\tau }
&
 \kcyl \hatotimes u_{i'} 
  \ar[d]^-{\rho'}
\\
  u_i
  \ar[r]_{u_\tau}
&
  u_{i'}
}
\]
\end{enumerate}
\end{lemma}

\begin{proof} This follows from \cref{strong-h-equiv-as-section}.
\end{proof}

We conclude this section by applying Lemma~\ref{strong-h-equiv-as-section-algebraic} to construct
a pair of functors that will be used in the next section
to prove \cref{thm:frobenius-fibrations}. The first functor has the form
\begin{equation}
\xycenter{
\cal{S}_k(\cal{I})  \ar[dr]_{\cal{S}_k(u)} \ar[rr]^L & & \overline{\cal{I}} \ar[dl]^-{\overline{\kcyl \hatotimes u}} \\
  & \catE^{\to} & } \qquad \quad \label{she-to-retract-closure}  
  \end{equation}
We describe its action on objects, leaving the definition of the definition of the action on arrows to the
reader. For this, we identify the category $\cal{S}_k(\cal{I})$ with the isomorphic category defined
in \cref{strong-h-equiv-as-section-algebraic}. Observe that $u_i \co A_i \to B_i$ is a retract 
of~$\kcyl \hatotimes u_i \co (\interval \otimes A_i) +_{A_i} B_i \to \interval \otimes B_i$ via the diagram
\[
\xymatrix@C+1em{
 A_i \ar[d]_{u_i} \ar[r] & (\interval \otimes A_i) +_{A_i} B_i \ar[r] \ar[d]^{\kcyl \hatotimes u_i } & A_i \ar[d]^{u_i} \\
 B_i \ar[r] & \interval \otimes B_i \ar[r] & B_i }
\]
where the left-hand side square is $\thetak \hatotimes u_i$ and right-hand side square is given by $\rho$. Thus, we can define 
\[
L(i, \rho) \defeq (i, u_i, \thetak \hatotimes u_i, \rho) \, .
\]
Observe that this definition makes the diagram in~\eqref{she-to-retract-closure} commute. 

\medskip

In order to define the second functor,  we make two furher assumptions. The first is that  $\kcyl$ is a strong left homotopy equivalence. [ADD]
This means that for $f \co X \to Y$, we have 
\begin{equation}
\label{equ:retraction-for-f} 
\begin{gathered}
\xymatrix@C+3em{
 \kcyl \hatotimes f 
  \ar[r]^-{\thetak \hatotimes (\kcyl \hatotimes f)}
  \ar[dr]_{\id}
&
  \kcyl \hatotimes (\kcyl \hatotimes f)  \ar[d]^{\rho_f}
\\&
  \kcyl \hatotimes f 
}
\end{gathered}
\end{equation}
Our second additional assumption is that the functor $\kcyl \hatotimes (-) \co \catE^\to \to \catE^\to$ lifts 
to $\cal{I}$, in the sense that we have a diagram of the form
\[
\xymatrix@C+2em{
\cal{I}  \ar[d]_u \ar[r]^{\kcyl \hatotimes (-)} & \cal{I} \ar[d]^{u} \\
\cal{E}^\to \ar[r]_{\kcyl \hatotimes (-)} & \cal{E}^\to}
\]
This means that for $i \in \cal{I}$, we have $\kcyl \hatotimes i \in \cal{I}$ such that
\begin{equation}
\label{equ:I-closed-under-tensor}
u_{\kcyl \hatotimes i} = \kcyl \hatotimes u_i \, .
\end{equation}
We wish to exhibit a functor of the form
\begin{equation}
  \label{horn-times-gen-to-she}
\xycenter{
 \cal{I} \ar[dr]_{\kcyl \hatotimes u} \ar[rr]^M & & \cal{S}_k(\cal{I}) \ar[dl]^{\cal{S}_k(u)} \\ 
 & \ \catE^\to & }
 \end{equation}
As before, we  define the functor $M$ in~\eqref{horn-times-gen-to-she} only on objects. We use again the isomorphic description
of~$\cal{S}_k(\cal{I})$ in \cref{strong-h-equiv-as-section-algebraic}.  In order to guarantee that the
diagram to commutes, we send $i \in \cal{I}$ to a pair of the form $(\kcyl \hatotimes i, \rho)$, using the assumption 
that $\kcyl \hatotimes (-)$ lifts. Here, $\rho$ has to be a retraction to $\thetak \hatotimes u_{\kcyl \hatotimes i}$, 
\ie a retraction to $\thetak \hatotimes (\kcyl \hatotimes u_i)$ by~\eqref{equ:I-closed-under-tensor}. But such a retraction is provided by taking 
$f = u_i$ in~\eqref{equ:retraction-for-f}. We can then let $M(i) \defeq (\kcyl \hatotimes i, \rho_{u_i})$.





\section{The Frobenius condition for uniform fibrations} 
\label{sec:frobenius-uniform-fibration}
 
Let us consider a fixed cylinder $(\interval \otimes (-), \lcyl, \rcyl, \ccyl)$ in $\catE$. 
Given a functor $u \co \cal{I} \to \catE^\to$, we define a category~$\cal{J}$ and a functor $v \co \cal{J} \to \catE^\to$. 
First, let $\cal{J} \defeq \cal{I} + \cal{I}$. Next, recall that for $k \in \{ 0, 1 \}$ we have a functor $\kcyl \hatotimes u 
\co \cal{I} \to \catE^\to$ defined by letting
\[
 (\kcyl \hatotimes u)_i \defeq \kcyl \hatotimes u_i \, .
 \]
The functor $v  \co \cal{J}  \to \catE^\to$ is then given by the coproduct diagram
\begin{equation}
\label{equ:u-interval}
\vcenter{\hbox{\xymatrix@C=1.2cm{
\cal{I} \ar[r]^{\iota_0} \ar[dr]_-{\lcyl \hatotimes u} & \cal{J} \ar[d]^(.4){v} & \cal{I} \ar[dl]^-{\rcyl \hatotimes u} \ar[l]_{\iota_1} \\ 
 & \catE^\to }}}
\end{equation}
Note that, even if $u \co \cal{I} \to \catE^\to$ is an inclusion, $v \co \cal{J} \to \catE^\to$ is not.

\begin{definition} \label{def:I-fibration}
Let $u \co \cal{I} \to \catE^\to$ be a functor.
\begin{enumerate}[(i)]
\item An \emph{uniform $\cal{I}$-fibration} is a right $\cal{J}$-map, \ie 
a map  $p \co X \to Y$ equipped with a function~$\phi$ that assigns
to every $i \in \cal{I}$, $k \in \{0, 1\}$  and commuting
square a diagram of the form
\[
\xymatrix{
(\interval \otimes A_i) +_{A_i} B_i  \ar[r] \ar[d]_{\kcyl_{A_i} \hatotimes u_i} & X \ar[d]^p \\
\interval \otimes B_i  \ar[r] & Y }
\]
a diagonal filler, subject to a naturality condition.
\item A \emph{uniform $\cal{I}$-fibration morphism} is a morphism of right $\cal{J}$-maps.
\end{enumerate}
\end{definition}


\begin{example} The notion of a uniform Kan fibration will be introduced in \cref{sec:uniform-fibrations} as a a 
special case of the notion of an $\cal{I}$-fibration by considering the inclusion 
$\cal{M} \subseteq \cal{E}^\to$ of decidable monomorphisms and pullback squares
as $u \co \cal{I} \to \cal{E}^\to$. 
\end{example} 




\begin{proposition} \label{prod-exp-general}
For every map $p \co X \to Y$ in $\cal{E}$ 
 the following are equivalent: 
\begin{enumerate}[(i)]
\item $p$ admits the structure of a uniform $\cal{I}$-fibration. 
\item $\hatexp(\lcyl, p)$ and $\hatexp(\rcyl, p)$ admit the structure of right $\cal{I}$-maps.
\end{enumerate} 
\end{proposition}

\begin{proof}
First note that the right orthogonality functor sends coproducts to products of categories over $\cal{E}^{\to}$ as evidenced by the adjunction~\eqref{garner-adjunction}.
The remainder of the claim follows from \cref{pitchfork-leibniz-adjunction} as applied in \cref{pitchfork-leibniz-most-general-example}. 
\end{proof}


\medskip

The key step in proving the Frobenius condition
for $\cal{I}$-fibrations is the following lemma.

\begin{lemma}
\label{strong-h-equiv-base-change-along-fibration}
Let $p \co Y \to X$ be a $(\lcyl \otimes \id_{\calE})$-right map.
Assume that pullback  along $p$ lifts to a functor $F \co \cal{I}_{/X} \to \cal{I}_{/Y}$.
Then it lifts further to a functor $G \co (\cal{S}_k)_{/X} \to (\cal{S}_1)_{/Y}$, as in
\[
\xymatrix@C+2em{
  \cal{S}_1(\cal{I})_{/X}
  \ar@{.>}[r]^{G}
  \ar[d]
&
  \cal{S}_1(\cal{I})_{/Y}
  \ar[d]
\\
  \cal{I}_{/X}
  \ar[r]^{F}
  \ar[d]_{\cal{I}_{/X}}
&
  \cal{I}_{/Y}
  \ar[d]^{\cal{I}_{/Y}}
\\
  (\catE / X)^{\to}
  \ar[r]_{p^*}
&
  (\catE / Y)^{\to}
}
\]
\end{lemma}

\begin{proof}
We work with the characterization of \cref{strong-h-equiv-as-section-algebraic}. We define separately
the action of $G$ on objects and on maps. 
For the action on objects, suppose we are given $i \in \cal{I}_{/X}$ such that $u_i$ is a strong left homotopy equivalence.
This means we have a commutative triangle
\[
\xymatrix{
  A
  \ar[rr]^{u_i}
  \ar[dr]
&&
  B
  \ar[dl]
\\&
  X
}
\]
and a retraction $\rho$ to $\thetal \hatotimes i$ 
\[
\xymatrix@C+1em{
  u_i
  \ar[r]^-{\thetal \hatotimes u_i}
  \ar[dr]_{\id}
&
  \rcyl \hatotimes u_i \ar[d]^{\rho}
\\&
  u_i
}
\]
Let $\sigma \co u_{i'} \to u_i$ denote the pullback of $i$ along $p$:
\[
\xymatrix{
  A'
  \ar[r]
  \ar[d]_{u_{i'}}
  \pullback{dr}
&
  A
  \ar[d]^{u_i}
\\
  B'
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  B
  \ar[d]
\\
  Y
  \ar[r]_p
&
  X
}
\]
We want to make $u_{i'}$ into a strong left homotopy equivalence.
This means to find a retraction $\rho'$ to $\thetal \hatotimes i$ 
\[
\xymatrix@C+1em{
  u_{i'}
  \ar[r]^-{\thetal \hatotimes u_{i'}}
  \ar[dr]_{\id}
&
  \rcyl \hatotimes u_{i'}
  \ar@{.>}[d]^{\rho'}
\\&
  u_{i'}
}
\]
We will construct the retraction $\rho'$ as indicated in the below diagram:
\[
\xymatrix@C+2em{
  u_{i'}
  \ar[r]^-{\thetal \hatotimes u_{i'}}
  \ar[d]_{\sigma}
&
  \rcyl \hatotimes u_{i'}
  \ar@{.>}[r]^-{\rho'}
  \ar[d]_{\rcyl \hatotimes \sigma}
&
  u_{i'}
  \ar[d]^{\sigma}
\\
  u_i
  \ar[r]_-{\thetal \hatotimes u_i}
&
  \rcyl \hatotimes u_i
  \ar[r]_-{\rho}
&
  u_i
}
\]
Since $\sigma$ is a pullback square, it suffices to solve this problem when projected to codomains:
\[
\xymatrix@C+4em{
  B'
  \ar[r]^-{\lcyl_{B'}}
  \ar[d]_{\cod(\sigma)}
&
  \interval \otimes B'
  \ar@{.>}[r]^{\cod(\rho')}
  \ar[d]^{\interval \otimes \cod(\sigma)}
&
  B'
  \ar[d]^{\cod(\sigma)}
\\
  B
  \ar[r]_-{\lcyl_B}
&
  \interval \otimes B
  \ar[r]_-{\cod(\rho)}
&
  B
}
\]
We will now lift this diagram from $\catE$ to the total space of the codomain fibration on $\catE$, again omitting the identity arrows for readability:
\[
\xymatrix@C+2em{
  B'
  \ar[r]^-{\lcyl_{B'}}
  \ar[dd]_{\cod(\sigma)}
  \ar@/_2em/[drrr]
&
  \interval \otimes B'
  \ar@{.>}[r]^{\cod(\rho')}
  \ar[dd]^(0.7){\interval \otimes \cod(\sigma)}
  \ar@{-->}@/_1em/[drr]
&
  B'
  \ar[dd]^(0.8){\cod(\sigma)}
  \ar[dr]
\\&&&
  Y
  \ar[dd]^{p}
\\
  B
  \ar[r]^-{\lcyl_B}
  \ar@/_2em/[drrr]
&
  \interval \otimes B
  \ar[r]^-{\cod(\rho)}
  \ar@/_1em/[drr]
&
  B
  \ar[dr]
\\&&&
  X
}
\]
The arrows to $X$ from the bottom row are induced by $B \to X$.
The square $\cod(\sigma)$ over $p$ is cartesian by construction.
If we can find a dashed arrow cohering as indicated, there will hence be a unique dotted arrow as indicated.
To find the dashed arrow is to construct a diagonal filler in the following square:
\[
\xymatrix@C+3em{
  B'
  \ar[rr]
  \ar[d]_{\lcyl_{B'}}
&&
  Y
  \ar[d]^{p}
\\
  \interval \otimes B'
  \ar[r]_{I \otimes \cod(\sigma)}
  \ar@{-->}[urr]
&
  \interval \otimes B
  \ar[r]
&
  X
}
\]
But we have such a filler since $p$ is a $(\lcyl \otimes \id_\catE)$-right map by assumption.

\medskip

We now define the action of $G$ on morphisms. Suppose we are given a map $\tau \co (i_1, \rho_1) \to (i_2, \rho_2)$ of strong homotopy equivalences over $X$.
This consists of a map $\tau \co i_1 \to i_2$ in $\cal{I}$ living over $X$ as depicted below:
\[
\xymatrix{
  A_1 \ar[rr]^{u_{i_1}}  \ar[d]  &   & B_1 \ar[d] \\
  A_2  \ar[rr]^{u_{i_2}} \ar[dr] &   & B_2 \ar[dl] \\
  & X & }
\]
such that $\tau$ commutes with the retractions $\rho_1$ and $\rho_2$ as follows:
\[
\xymatrix@C+2em{
  \rcyl \hatotimes u_{i_1}
  \ar[r]^-{\rho_1}
  \ar[d]_{\rcyl \hatotimes u_\tau}
&
  u_{i_1}
  \ar[d]^{u_\tau}
\\
  \rcyl \hatotimes u_{i_2}
  \ar[r]_-{\rho_2}
&
  u_{i_2}
}
\]
Let $(i_1', \rho_1')$ and $(i_2', \rho_2')$ denote the action of $G$ on the objects $(i_1, \rho_1)$ and $(i_2, \rho_2)$, respectively, as constructed in the previous paragraph.
Recall that this includes cartesian squares 
\[
\sigma_1 \co u_{i_1'} \to u_{i_1} \, , \quad
\sigma_2 \co u_{i_2'} \to u_{i_2}  
\]
cartesian over $p \co Y \to X$.
Since the base change functor lifts to slices of $\cal{I}$ by assumption, we have a lift $\tau' \co i_1' \to i_2'$ in $\cal{I}_{/Y}$ of the morphism $\tau \co i_1 \to i_2$ in $\cal{I}_{/X}$.
We want to show that $\tau'$ in addition forms a morphism of left strong homotopy equivalences $\tau' \co (i_1', \rho_1') \to (i_2', \rho_2')$.
For this, we have to verify commutativity of the following diagram:
\[
\xymatrix@C+2em{
  \rcyl \hatotimes u_{i_1'}
  \ar[r]^-{\rho_1'}
  \ar[d]_{\rcyl \hatotimes u_{\tau'}}
&
  u_{i_1'}
  \ar[d]^{u_{\tau'}}
\\
  \rcyl \hatotimes u_{i_2'}
  \ar[r]_-{\rho_2'}
&
  u_{i_2'}
}
\]
Recall the construction of $\rho_1'$ and $\rho_2'$:
\[
\xymatrix@C+2em{
  u_{i_1'}
  \ar[rr]^-{\thetal \hatotimes u_{i_1'}}
  \ar[dd]_{\sigma_1}
  \ar[dr]^{u_{\tau'}}
&&
  \rcyl \hatotimes u_{i_1'}
  \ar@{.>}[rr]^-{\rho_1'}
  \ar[dd]^(0.3){\rcyl \hatotimes \sigma_1}
  \ar[dr]^{\rcyl \hatotimes u_{\tau'}}
&&
  u_{i_1'}
  \ar[dd]^(0.3){\sigma_1}
  \ar[dr]^{u_{\tau'}}
\\&
  u_{i_2'}
  \ar[rr]^-(0.3){\thetal \hatotimes u_{i_2'}}
  \ar[dd]_(0.3){\sigma_2}
&&
  \rcyl \hatotimes u_{i_2'}
  \ar@{.>}[rr]^-(0.3){\rho_2'}
  \ar[dd]^(0.3){\rcyl \hatotimes \sigma_2}
&&
  u_{i_2'}
  \ar[dd]^(0.3){\sigma_2}
\\
  u_{i_1}
  \ar[rr]^-(0.25){\thetal \hatotimes u_{i_1}}
  \ar[dr]^{u_\tau}
&&
  \rcyl \hatotimes u_{i_1}
  \ar[rr]^-(0.3){\rho_1}
  \ar[dr]^{\rcyl \hatotimes u_{\tau'}}
&&
  u_{i_1}
  \ar[dr]^{u_\tau}
\\&
  u_{i_2}
  \ar[rr]^-{\thetal \hatotimes u_{i_2}}
&&
  \rcyl \hatotimes u_{i_2} 
  \ar[rr]^-{\rho_2}
&&
  u_{i_2}
}
\]
Our goal is to show that the top right square commutes.
Since that square commutes after composing it with the cartesian square $\sigma_2$, it suffices to show that the square commutes when projected to codomains:
\[
\xymatrix@C+2em{
  B_1'
  \ar[rr]^-{\lcyl \otimes B_1'}
  \ar[dd]_{\sigma_1}
  \ar[dr]^{u_{\tau'}}
&&
  \interval \otimes B_1'
  \ar@{.>}[rr]^-{\cod(\rho_1')}
  \ar[dd]^(0.3){\interval \otimes \cod(\sigma_1)}
  \ar[dr]^{\interval \otimes \cod(u_{\tau'})}
&&
  B_1'
  \ar[dd]^(0.3){\cod(\sigma_1)}
  \ar[dr]^{\cod(u_{\tau'})}
\\&
  B_2'
  \ar[rr]^-(0.3){\lcyl \otimes B_2'}
  \ar[dd]_(0.3){\cod(\sigma_2)}
&&
  \interval \otimes B_2'
  \ar@{.>}[rr]^-(0.3){\cod(\rho_2')}
  \ar[dd]^(0.3){\interval \otimes \cod(\sigma_2)}
&&
  B_2'
  \ar[dd]^(0.3){\cod(\sigma_2)}
\\
  B_1
  \ar[rr]^-(0.25){\lcyl \otimes B_1}
  \ar[dr]^{u_\tau}
&&
  \interval \otimes B_1
  \ar[rr]^-(0.3){\cod(\rho_1)}
  \ar[dr]^{\interval \otimes \cod(u_{\tau'})}
&&
  B_1
  \ar[dr]^{\cod(u_\tau)}
\\&
  B_2
  \ar[rr]^-{\lcyl \otimes B_2}
&&
  \interval \otimes B_2
  \ar[rr]^-{\cod(\rho_2)}
&&
  B_2
}
\]
The dotted arrows were constructed by extending the back and front faces of this diagram to the total space of the codomain fibration and then appealing to the universal property of the cartesian squares $\cod(\sigma_1)$ and 
$\cod(\sigma_2)$ over $p$.
For our goal it will thus suffice to show that the maps from the back to the front face coherently extend to the total space of the codomain fibration as well.
This is canonically the case except potentially for the top middle map $\interval \otimes B_1' \to \interval \otimes B_2'$.
For this, we have to verify coherence of the dashed arrows as indicated below:
\[
\xymatrix@C+2em{
  B_1'
  \ar[rrrr]
  \ar[dd]_{\lcyl \otimes B_1'}
  \ar[dr]^{\cod(u_{\tau'})}
&&&&
  Y
  \ar[dd]^(0.3){p}
  \ar@{=}[dr]
\\&
  B_2'
  \ar[rrrr]
  \ar[dd]_(0.7){\lcyl \otimes B_2'}
&&&&
  Y
  \ar[dd]^{p}
\\
  \interval \otimes B_1'
  \ar[rr]_(0.7){I \otimes \cod(\sigma_1)}
  \ar@{-->}[uurrrr]
  \ar[dr]_{\lcyl \otimes \cod(u_{\tau'})}
&&
  \interval \otimes B_1
  \ar[rr]
  \ar[dr]^(0.7){\interval \otimes \cod(u_\tau)}
&&
  X
  \ar@{=}[dr]
\\&
  \interval \otimes B_2'
  \ar[rr]_{I \otimes \cod(\sigma_2)}
  \ar@{-->}[uurrrr]
&&
  \interval \otimes B_2
  \ar[rr]
&&
  X
}
\]
But the left face forms a morphism in $\lcyl \otimes \catE$; since $p$ was assumed a $(\lcyl \otimes \catE)$-right map, its right lifting structure is coherent as needed.
\end{proof}

For the next result, we assume that $\cal{I}$ is closed under tensoring with $\rcyl$ and  that $\rcyl$ is a strong left homotopy equivalence,
which allows us to use the functors in~\eqref{she-to-retract-closure} and~\eqref{horn-times-gen-to-she}.

\begin{theorem}
\label{thm:frobenius-fibrations}
Let $p \co Y \to X$ be a uniform $\cal{I}$-fibration. If pullback along $p$ lifts to a functor
\[
\xymatrix@C+2em{
  \cal{I}_{/X}
  \ar[r]^{F}
  \ar[d]_{u_{/X}}
&
  \cal{I}_{/Y}
  \ar[d]^{u_{/Y}}
\\
  (\catE / X)^{\to}
  \ar[r]_{p^*}
&
  (\catE / Y)^{\to}
}
\]
then it also lifts to a functor 
\[
\xymatrix@C+2em{
\cal{J}_{/X} \ar[r] \ar[d]_{v/X} &  \overline{\cal{J}}_{/Y} \ar[d]^{v/Y} \\ 
(\cal{E}_{/X})^\to \ar[r]_{p^*} & (\cal{E}_{/Y})^\to
}
\]
\end{theorem}

\begin{proof}
It will suffice to separately show that $p^*$ lifts to functors
\[
\xymatrix@C+2em{
  \cal{I}_{/X}
  \ar[r]^{F}
  \ar[d]_{(\kcyl \hatotimes u)_{/X}}
&
  \overline{\cal{I}}_{/Y}
  \ar[d]^{  \overline{\kcyl \hatotimes u}_{/Y}}
\\
  (\catE / X)^{\to}
  \ar[r]_{p^*}
&
  (\catE / Y)^{\to}
}
\]
 for $k \in \{0, 1\}$. 
For simplicity, we treat the case of $k =0$. Since a uniform $\cal{I}$-fibration is in particular a $(\lcyl \otimes \id_\catE)$-right map,
we can apply  \cref{strong-h-equiv-base-change-along-fibration} and observe that the pullback functor lifts as follows:
\[
\xymatrix@C+2em{
  \cal{S}_1(\cal{I})_{/X}
  \ar[r]^{G}
  \ar[d]
&
  \cal{S}_1(\cal{I})_{/Y}
  \ar[d] \\
  (\catE / X)^{\to}
  \ar[r]_{p^*}
&
  (\catE / Y)^{\to}
}
\]
Composing this with the the functors in \eqref{she-to-retract-closure} and~\eqref{horn-times-gen-to-she}, we obtain
\[
\xymatrix{
  \cal{I}_{/X} 
  \ar[rr]^{M_{/X}}
  \ar[dr]_{(\lcyl \hatotimes u)_{/X}} & 
&
  \cal{S}_1(\cal{I})_{/X}
  \ar[r]^G 
  \ar[dl]
&
  \cal{S}_1(\cal{I})_{/Y}
  \ar[rr]^{L_{/Y}}
  \ar[dr]
& &
  \overline{\cal{I}_{/Y}}
  \ar[dl]^{\overline{\lcyl \hatotimes u}_{/Y}}
\\ & 
  (\catE/X)^{\to}
  \ar[rrr]_{p^*}
&&&
  (\catE/Y)^{\to} & 
} 
\] 
as required.
\end{proof}

\begin{corollary}
Let $p \co Y \to X$ be a uniform $\cal{I}$-fibration. If pullback along $p$ lifts to a functor
\[
\xymatrix@C+2em{
  \cal{I}_{/X}
  \ar[r]^{F}
  \ar[d]_{u_{/X}}
&
  \cal{I}_{/Y}
  \ar[d]^{u_{/Y}}
\\
  (\catE / X)^{\to}
  \ar[r]_{p^*}
&
  (\catE / Y)^{\to}
}
\]
then  pushforward along $p$ lifts to a functor 
\[
\xymatrix@C+2em{
\cal{I}\text{-}\Fib_{/Y} \ar[r] \ar[d]_{} &  \cal{I}\text{-}\Fib_{/X} \ar[d] \\ 
(\cal{E}_{/Y})^\to \ar[r]_{p_*} & (\cal{E}_{/X})^\to
}
\]
\end{corollary}



\section{The Beck-Chevalley condition for uniform fibrations}

Let $\omega = (y, x) \co p_1 \to p_2$ be a morphism of $(\lcyl \otimes \catE)$-maps $p_1 \co Y_1 \to X_1$ and $p_2 \co Y_2 \to X_2$:
\begin{equation}
\label{strong-h-equiv-base-change-along-fibration-BC:0}
\begin{gathered}
\xymatrix{
  Y_1
  \ar[r]^{p_1}
  \ar[d]_{y}
&
  X_1
  \ar[d]^{x}
\\
  Y_2
  \ar[r]_{p_2}
&
  X_2
}
\end{gathered}
\end{equation}
Noting the adjunctions $x_! \dashv x^*$ and $y_! \dashv y^*$, we have a canonical natural transformation $\phi$ as follows:
\begin{equation}
\label{strong-h-equiv-base-change-along-fibration-BC:1}
\begin{gathered}
\xymatrix{
  \catE/Y_1
  \ar[d]_{x_!}
&
  \catE/X_1
  \ar[l]_{p_1^*}
  \ar[d]^{y_!}
\\
  \catE/Y_2
  \urtwocell<\omit>{\phi}
&
  \catE/X_2
  \ar[l]^{p_2^*}
}
\end{gathered}
\end{equation}
For the statement of the next result, recall from \cref{slicing-2-functorial} that we have canonical lifts of left composition along $x$ and $y$ to slices of $\cal{I}$ and $\cal{S}_1(\cal{I})$.

\begin{theorem}
\label{strong-h-equiv-base-change-along-fibration-BC}
Assume that pullback functors along $p_1$ and $p_2$ lift to functors 
\[
p_1^* \co \cal{I}_{/X_1} \to \cal{I}_{/Y_1} \, , \quad 
p_2^* \co \cal{I}_{/X_2} \to \cal{I}_{/Y_2} \, , 
\]
respectively, and that the natural transformation $\phi \co x_! \, p_1^* \Rightarrow p_2^* \, y_{!}$  lifts to a natural transformation~$\phi'$: 
\begin{equation}
\label{strong-h-equiv-base-change-along-fibration-BC:2}
\begin{gathered}
\xymatrix{
  \cal{I}_{/Y_1}
  \ar[d]_{y_!}
&
  \cal{I}_{/X_1}
  \ar[l]_{p_1^*}
  \ar[d]^{x_!}
\\
  \cal{I}_{/Y_2}
  \urtwocell<\omit>{\phi'}
&
  \cal{I}_{/X_2}
  \ar[l]^{p_2^*}
}
\end{gathered}
\end{equation}
(satisfying coherence with respect to $\phi^\to$ that we do not spell out). Then it lifts further to a natural transformation $\phi''$ between the lifts 
\begin{equation}
\label{strong-h-equiv-base-change-along-fibration-BC:3}
\begin{gathered}
\xymatrix{
  \cal{S}(\cal{I})_{/Y_1}
  \ar[d]_{y_!}
&
  \cal{S}(\cal{I})_{/X_1}
  \ar[l]_{p_1^*}
  \ar[d]^{x_!}
\\
  \cal{S}(\cal{I})_{/Y_2}
  \urtwocell<\omit>{\phi''}
&
  \cal{S}(\cal{I})_{/X_2}
  \ar[l]^{p_2^*}
}
\end{gathered}
\end{equation}
(satisfying coherence with respect to $\phi'$ that we do not spell out)
\end{theorem}

\begin{proof}
By faithfulnes of the functor $\cal{S}(\cal{I})_{/Y_2} \to \cal{I}_{/Y_2}$, we only have to check objectwise lifting. So, 
suppose we are given a strong left homotopy equivalence $(i, \rho) \in \cal{I}_{/X_1}$ over $X_1$.
This means we have a commutative triangle
\[
\xymatrix{
  A
  \ar[rr]^{u_i}
  \ar[dr]
&&
  B
  \ar[dl]
\\&
  X_1
}
\]
and a retraction $\rho$ to $\thetal \hatotimes i$ in $\catE^{\to}$:
\[
\xymatrix@C+1em{
  u_i
  \ar[r]^-{\thetal \hatotimes u_i}
  \ar[dr]_{\id}
&
  \rcyl \hatotimes u_i \ar[d]^{\rho}
\\&
  u_i
}
\]
Let $\sigma_1 \co u_{i_1'} \to u_i$ and $\sigma_2 \co u_{i_2'} \to u_i$ denote the base changes of $i$ along $p_1$ and $p_2$, respectively:
\[
\xymatrix{
  A_1'
  \ar[rr]
  \ar[dd]_{u_{i_1'}}
  \pullback{dr}
  \ar@{.>}[dr]
&&
  A
  \ar[dd]^(0.3){u_i}
  \ar@{=}[dr]
\\&
  A_2'
  \ar[rr]
  \ar[dd]_(0.3){u_{i_2'}}
  \pullback{dr}
&&
  A
  \ar[dd]^{u_i}
\\
  B_1'
  \ar[rr]
  \ar[dd]
  \pullback{dr}
  \ar@{.>}[dr]
&&
  B
  \ar[dd]
  \ar@{=}[dr]
\\&
  B_2'
  \ar[rr]
  \ar[dd]
  \pullback{dr}
&&
  B
  \ar[dd]
\\
  Y_1
  \ar[rr]^(0.7){p_1}
  \ar[dr]^{y}
&&
  X_1
  \ar[dr]^{x}
\\&
  Y_2
  \ar[rr]^(0.3){p_2}
&&
  X_2
}
\]
Recall that we have a canonical morphism $\phi_{u_i}^{\to} \co u_{i_1'} \to u_{i_2'}$ over $Y_2$ as indicated in the diagram.
By assumption, this lifts to a morphism $\phi_i' \co i_1' \to i_2'$ in $\cal{I}_{/Y_2}$.

The proof of \cref{strong-h-equiv-base-change-along-fibration} endows $i_1'$ and $i_2'$ with data for a strong left homotopy equivalence consisting of retracts $\rho_1'$ and $\rho_2'$, respectively.
Our goal is to check that $\phi_i'$ lifts to a morphism in $\cal{S}(\cal{I})_{/Y_2}$, \ie to verify that $\phi_{u_i}^{\to}$ coheres with as follows:
\[
\xymatrix@C+2em{
  \rcyl \hatotimes u_{i_1'}
  \ar[r]^-{\rho_1'}
  \ar[d]_{\rcyl \hatotimes u_{\tau'}}
&
  u_{i_1'}
  \ar[d]^{u_{\tau'}}
\\
  \rcyl \hatotimes u_{i_2'}
  \ar[r]_-{\rho_2'}
&
  u_{i_2'}
}
\]
Recall the construction of $\rho_1'$ and $\rho_2'$:
\[
\xymatrix@C+2em{
  u_{i_1'}
  \ar[rr]^-{\thetal \hatotimes u_{i_1'}}
  \ar[dd]_{\sigma_1}
  \ar[dr]^{u_{\phi_i'}}
&&
  \rcyl \hatotimes u_{i_1'}
  \ar@{.>}[rr]^-{\rho_1'}
  \ar[dd]^(0.3){\rcyl \hatotimes \sigma_1}
  \ar[dr]^{\rcyl \hatotimes u_{\phi_i'}}
&&
  u_{i_1'}
  \ar[dd]^(0.3){\sigma_1}
  \ar[dr]^{u_{\phi_i'}}
\\&
  u_{i_2'}
  \ar[rr]^-(0.3){\thetal \hatotimes u_{i_2'}}
  \ar[dd]_(0.3){\sigma_2}
&&
  \rcyl \hatotimes u_{i_2'}
  \ar@{.>}[rr]^-(0.3){\rho_2'}
  \ar[dd]^(0.3){\rcyl \hatotimes \sigma_2}
&&
  u_{i_2'}
  \ar[dd]^(0.3){\sigma_2}
\\
  u_i
  \ar[rr]^-(0.25){\thetal \hatotimes u_i}
  \ar@{=}[dr]
&&
  \rcyl \hatotimes u_i
  \ar[rr]^-(0.3){\rho}
  \ar@{=}[dr]
&&
  u_i
  \ar@{=}[dr]
\\&
  u_i
  \ar[rr]^-{\thetal \hatotimes u_i}
&&
  \rcyl \hatotimes u_i
  \ar[rr]^-{\rho}
&&
  u_i
}
\]
Our goal is to show that the top right square commutes.
Since that square commutes after composing it with the cartesian square $\sigma_2$, it suffices to show that the square commutes when projected to codomains:
\[
\xymatrix@C+2em{
  B_1'
  \ar[rr]^-{\lcyl \otimes B_1'}
  \ar[dd]_{\sigma_1}
  \ar[dr]^{u_{\tau'}}
&&
  \interval \otimes B_1'
  \ar@{.>}[rr]^-{\cod(\rho_1')}
  \ar[dd]^(0.3){\interval \otimes \cod(\sigma_1)}
  \ar[dr]^{\interval \otimes \cod(u_{\tau'})}
&&
  B_1'
  \ar[dd]^(0.3){\cod(\sigma_1)}
  \ar[dr]^{\cod(u_{\tau'})}
\\&
  B_2'
  \ar[rr]^-(0.3){\lcyl \otimes B_2'}
  \ar[dd]_(0.3){\cod(\sigma_2)}
&&
  \interval \otimes B_2'
  \ar@{.>}[rr]^-(0.3){\cod(\rho_2')}
  \ar[dd]^(0.3){\interval \otimes \cod(\sigma_2)}
&&
  B_2'
  \ar[dd]^(0.3){\cod(\sigma_2)}
\\
  B
  \ar[rr]^-(0.25){\lcyl \otimes B}
  \ar@{=}[dr]
&&
  \interval \otimes B
  \ar[rr]^-(0.3){\cod(\rho)}
  \ar@{=}[dr]
&&
  B
  \ar@{=}[dr]
\\&
  B
  \ar[rr]^-{\lcyl \otimes B}
&&
  \interval \otimes B
  \ar[rr]^-{\cod(\rho)}
&&
  B
}
\]
The dotted arrows were constructed by extending the back and front faces of this diagram to the total space of the codomain fibration and then appealing to the universal property of the cartesian squares $\cod(\sigma_1)$ and $\cod(\sigma_2)$ over $p$.
For our goal it will thus suffice to show that the maps from the back to the front face coherently extend to the total space of the codomain fibration as well.
This is canonically the case except potentially for the top middle map $\interval \otimes B_1' \to \interval \otimes B_2'$.
For this, we have to verify coherence of the dashed arrows as indicated below:
\[
\xymatrix@C+2em{
  B_1'
  \ar[rrrr]
  \ar[dd]_{\lcyl \otimes B_1'}
  \ar@{=}[dr]
&&&&
  Y_1
  \ar[dd]^(0.3){p}
  \ar[dr]^{y}
\\&
  B_2'
  \ar[rrrr]
  \ar[dd]_(0.7){\lcyl \otimes B_2'}
&&&&
  Y_2
  \ar[dd]^{p}
\\
  \interval \otimes B_1'
  \ar[rr]_(0.7){I \otimes \cod(\sigma_1)}
  \ar@{-->}[uurrrr]
  \ar@{=}[dr]
&&
  \interval \otimes B_1
  \ar[rr]
  \ar@{=}[dr]
&&
  X_1
  \ar[dr]^{x}
\\&
  \interval \otimes B_2'
  \ar[rr]_{I \otimes \cod(\sigma_2)}
  \ar@{-->}[uurrrr]
&&
  \interval \otimes B_2
  \ar[rr]
&&
  X_2
}
\]
But the right face forms a morphism of $(\lcyl \otimes \catE)$-right maps by assumption; its right lifting structures hence cohere as needed.
\end{proof}




\section{Uniform Kan  fibrations}
\label{sec:uniform-fibrations}

 
Let us assume that $\cal{E}$ is a category of presheaves.
We write $\cal{M}$ for the full category of $\cal{E}^\to_\cart$ spanned
by the decidable monomorphisms. 

\begin{definition} \hfill
\begin{enumerate}[(i)]
\item A \emph{uniform trivial Kan fibration} is a right $\cal{M}$-map, \ie a map
$f  \co X \to Y$ equipped with a function $\phi$
that assigns to every decidable monomorphism $i \co A \to B$ and commuting square 
 \[
 \xymatrix{
 A \ar[r]^s \ar[d]_i & X \ar[d]^f \\
 B \ar[r]_t & Y}
 \]
a diagonal filler $\phi(i, s, t) \co B \to X$, subject to the following naturality condition: for every 
diagram 
\[
\xymatrix{
A \ar[r]^{h} \ar[d]_{i} & C \ar[d]^{j}  \ar[r]^s & X \ar[d]^f \\
B \ar[r]_{k} & D \ar[r]_t & Y }
\]
where the left-hand side square is a pullback, we have that $\phi(j, s, t) \, k = \phi(i, s  h, t  k)$.
 \item A \emph{morphism of uniform trivial Kan fibrations} $(s, t) \co (f, \phi) \to (g, \psi)$ is a commutative
 square
 \[
 \xymatrix{
  A \ar[d]_f \ar[r]^s & C \ar[d]^g \\
  B \ar[r]_{t}& D} 
  \]
  satisfying a compatibility condition with respect to $\phi$ and $\psi$, which we omit. 
\end{enumerate}
\end{definition}

We write $\mathsf{TrivFib}$ for the category of uniform trivial Kan fibrations and their morphisms.
By its very definition we have $\mathsf{TrivFib} = \liftr{\cal{M}_{\textup{dec}}}$. We then define
the category $\mathsf{Cof}$ of \emph{cofibrations} and \emph{cofibration morphisms} to be the left orthogonal
category of $\mathsf{TrivFib}$, \ie $\mathsf{Cof} = \liftl{\mathsf{TrivFib}}$. This terminology is non-standard,
since we are not working with model structures, but it is suggestive of the intuition behind the definition.

\medskip

Let us now fix a functorial cylinder $(\interval \otimes (-), \lcyl, \rcyl, \ccyl)$. The notion of a uniform Kan fibration is obtained 
as a special case of \cref{def:I-fibration}. For a monomorphism $i \co A \to B$
and $k \in \{0 , 1\}$, we have the following pushout diagram
\[
\xymatrix{
 A \ar[r]^{i}  \ar[d]_{\delta^k_A} &  B \ar@/^2em/[ddr]^{\delta^k_B} \ar[d] & \\ 
\interval \otimes A \ar@/_1em/[drr]_{\interval \otimes i} \ar[r] & (\interval \otimes A) +_A B \ar[dr]^-{\kcyl_A \hatotimes i}  & \\ 
 & & \interval \otimes B}
 \]
 Thus, given the inclusion $u \co \cal{M} \hookrightarrow \cal{E}^\to$ of decidable morphisms and pullback squares, 
 we define the functor $v \co \cal{M} + \cal{M} \to \cal{E}^\to$  via the universal
 property of coproducts:
  \[
 \xymatrix@R=1.2cm@C=1.2cm{
 \cal{M} \ar[dr]_-{\lcyl \hatotimes u}  \ar[r]^{\iota_0} &  \cal{M} + \cal{M} 
 \ar[d]^{v} & \cal{M} \ar[dl]^-{\rcyl \hatotimes u} \ar[l]_{\iota_1} \\
  & \cal{E}^\to & }
  \]
 


\begin{definition} \hfill 
\begin{enumerate}[(i)] 
\item  A \emph{uniform  Kan fibration} is an $\cal{M}$-fibration, \ie 
a map  $p \co X \to Y$ equipped with a function~$\phi$ that assigns
to every decidable monomorphism $i \co A \to B$, $k \in \{0, 1\}$  and commuting
square a diagram of the form
\[
\xymatrix{
 (\interval \otimes A) +_A B \ar[r] \ar[d]_{\kcyl_A \hatotimes i} & X \ar[d]^p \\
\interval \otimes  B \ar[r] & Y }
\]
a diagonal filler, subject to a naturality condition.
 \item A \emph{morphism of uniform Kan fibrations} $(s,t) \co (p, \phi) \to (p', \phi')$ is
 a commutative diagram of the form
 \[
 \xymatrix{
  X \ar[d]_{p} \ar[r]^s & X' \ar[d]^{p'} \\
  Y \ar[r]_{t}& Y' } 
  \]
  satisfying a compatibility condition with respect to $\phi$ and $\phi'$, which we omit. 
 \end{enumerate}
 \end{definition}
 
 We write $\mathsf{Fib}$ for the category of uniform Kan fibrations and their morphisms, \ie 
$\mathsf{Fib} = \liftr{(\cal{M}_{\textup{dec}})_I}$. We then define
the category $\mathsf{TrivCof}$ of \emph{trivial cofibrations} and \emph{trivial cofibration morphisms}
by letting \ie $\mathsf{TrivCof} = \liftl{\mathsf{Fib}}$. As before, the terminology is meant to be
suggestive, rather than to denote the existence of a model structure. 
 
 \begin{remark} In the category of simplicial sets, the maps $h^0 \, , h^1 \co 1 \to \Delta_1$ are two basic forms of the horn
 inclusions $h^k_n \co \Lambda^k_n \to \Delta_n$.  Thus, higher-dimensional horns are not involved
 explicitly in the definition of a uniform Kan fibration in simplicial sets. However, 
  since they are included indirectly since they are  retracts of one-dimensional horns by Leibniz product 
  with certain subobjects of representables~\cite{joyal-quaderns}.
  \end{remark} 
 
We wish to show that uniform trivial Kan fibrations and uniform Kan fibrations in $\cal{E}$ are the
right classes of a natural weak factorisation system. In the classical setting of 
simplicial sets, the existence of weak factorisation systems having trivial Kan fibrations
and Kan fibrations as their right classes is proved using Quillen's small object argument,
applied after having identified a suitable class of generating left maps. These are given
by the boundary inclusions $i_n \co \partial \Delta_n \to \Delta_n$ for trivial Kan fibrations
and by the horn inclusions $h^k_n \co \Lambda^k_n \to \Delta_n$ for Kan fibrations. 
We wish to establish a counterpart of  this fact in our setting. In particular,
we will apply Garner's small object argument after having isolated suitable
small categories of generating left maps. In order to do this, it is convenient
to establish some general facts about the interaction between orthogonality 
functors and left Kan extensions. 

\begin{proposition} Let $F \co \cal{I} \to \cal{J}$ be a fully faithful functor. 
\label{kan-extension-closure}
\begin{enumerate}[(i)]
\item Assuming that the pointwise left Kan extension of 
$u \co \cal{I} \to \catE^{\to}$ along $F$ exists
\[
\xymatrix{
  \cal{I}
  \ar[dr]_{u}
  \ar[rr]^{F}
&&
  \cal{J}
  \ar[dl]^{\Lan_F u}
\\&
  \catE^{\to}
}
\]
then the functor $\liftr{F} \co \liftr{\cal{J}} \to \liftr{\cal{I}}$,  fitting in the diagram
\[
\xymatrix{
  \liftr{\cal{I}}
  \ar[dr]_{\liftr{u}}
&&
  \liftr{\cal{J}}
  \ar[ll]_{\liftr{F}}
  \ar[dl]^{\liftr{(\Lan_F u)}}
\\&
  \catE^{\to}
}
\]
is an isomorphism.
\item Assuming that the pointwise right Kan extension of 
$u \co \cal{I} \to \catE^{\to}$ along $F$ exists
\[
\xymatrix{
  \cal{I}
  \ar[dr]_{u}
  \ar[rr]^{F}
&&
  \cal{J}
  \ar[dl]^{\Ran_F u}
\\&
  \catE^{\to}
}
\]
then the functor $\liftl{F} \co \liftl{\cal{J}} \to \liftl{\cal{I}}$, fitting in the diagram
\[
\xymatrix{
  \liftl{\cal{I}}
  \ar[dr]_{\liftl{u}}
&&
  \liftl{\cal{J}}
  \ar[ll]_{\liftl{F}}
  \ar[dl]^{\liftl{(\Ran_F u)}}
\\&
  \catE^{\to}
}
\]
is an isomorphism. \qed
\end{enumerate}
\end{proposition}









\medskip

\newcommand{\yon}{\mathrm{y}} 
Let us assume that $\catE$ is a presheaf category, \ie $\catE = \hat{\cat{C}}$, where $\catC$ is some small category. We write $\yon \co \cat{C} \to \catE$ for the Yoneda embedding.

\begin{proposition}
\label{left-kan-extension-of-representables}
Let $\cal{J}$ be a full subcategory of $\catE_{\cart}^{\to}$ closed under base change to representables.
Let $\cal{I}$ denote its restriction to arrows into representables.
\[
\xymatrix{
  \cal{I}
  \ar[rr]
  \ar[dr]
&&
  \cal{J}
  \ar[dl]
\\&
  \catE^{\to}
}
\]
Then, the inclusion $\cal{J} \to \catE^{\to}$ is the left Kan extension of $\cal{I} \to \catE^{\to}$ along $\cal{I} \to \cal{J}$.
\end{proposition}



\begin{proof}
Since $\catE^{\to}$ is cocomplete, we can verify the claim using  the colimit formula for left Kan extensions.
All of the following will be functorial in an object $j \co A \to B$ of $\cal{J}$.
We consider the diagram indexed by cartesian squares of the form
\[
\xymatrix@C=1.2cm{
  A'
  \ar[r]
  \ar[d]_{i}
  \pullback{dr}
&
  A
  \ar[d]^{j}
\\
  \yon(c) 
  \ar[r]_-b 
&
  B
}
\]
with $i \co A' \to \yon(c)$ in $\cal{I}$ and valued $i$.
Our goal is to show that its colimit of this diagram in $\catE^{\to}$ is $j$.
Using the assumption that $\cal{J}$ is closed under pullback to representables, the given diagram
can be described equivalently as the the diagram indexed by maps $b \co \yon(c) \to B$ and valued $b^*(j)$. The claim can then be restated as  $\colim_{b : \yon(c) \to B} b^*(j) \iso j$, which 
holds since pullback commutes with colimits in presheaf categories, and  $\colim_{b : \yon(c) \to B} \yon(c) \iso B$.
\end{proof}


\begin{remark} It would be of interest to prove \cref{left-kan-extension-of-representables} by combining 
the codomain fibration and the corresponding left Kan extension claim for the codomain part
\[
\xymatrix{
  \cat{C}
  \ar[rr]^{y}
  \ar[dr]_{y}
&&
  \hat{\catC}
  \ar[dl]^{\id}
\\&
  \hat{\cat{C}}
}
\]
which holds by the co-Yoneda lemma.
\end{remark}



\begin{proposition}
\label{awfs-on-arrows-into-representables}
Let $\cal{J}$ be a full subcategory of $\catE_{\cart}^{\to}$ closed under base change to representables.
Let $\cal{I}$ denote its restriction to arrows into representables.
\[
\xymatrix{
  \cal{I}
  \ar[rr]
  \ar[dr]
&&
  \cal{J}
  \ar[dl]
\\&
  \catE^{\to}
}
\]
Then $\liftr{\cal{I}} = \liftr{\cal{J}}$.
\end{proposition}

\begin{proof} The result follows by combining \cref{left-kan-extension-of-representables} and part~(i) of \cref{kan-extension-closure}. 
\end{proof}

ADD THAT "COFIBRATIONS" ARE CLOSED UNDER PULLBACK ASSUMING C AND D AS ABOVE.


\begin{lemma} \label{small-gen-triv-kan}
The category of uniform trivial  Kan fibrations is isomorphic to the right orthogonality 
category of the following full subcategories of  the category $\cal{M}$ of decidable
monomorphisms and cartesian squares:
\[
\cal{M}_{\textup{rep}}  = \braces{i \co A \rightarrow \yon(c) \ | \ i \text{ is a  decidable monomorphism} } 
\]
\end{lemma}

\begin{proof}    \cref{awfs-on-arrows-into-representables} implies that we have that $\liftr{\cal{M}_1}  = \liftr{\cal{M}}$.
For the other equalities, observe that for every full subcategory $\cal{S} \subseteq \cal{M}$ containing $\cal{M}_1$ we have that $\liftr{\cal{M}} = \liftr{\cal{S}}$, since $\cal{M}_1$ is the restriction to maps into representables  of $\cal{M}$. 
\end{proof}


\begin{remark} One could have considered different classes:
\begin{align*}
\cal{M}'  & = \braces{i \co A \rightarrow \yon(c_1) \times \ldots \times \yon(c_n)
\ | \ i \text{ is a  decidable monomorphism} }  \\
\cal{M}''  & = \braces{ i \co A \rightarrow B \mid \ i \text{ is a decidable monomorphism and 
$B$ is finite and finite-dimensional}} 
\end{align*}
The key advantage of $\cal{M}_1$ is that it happens to be small in the examples of interest. However, 
these classes have better closure properties. The right orthogonality class of all of these subcategories
will be the same.
\end{remark}





\begin{theorem} Let $\catE$ be a category of elegant Reedy presheaves. 
There exists an algebraic weak factorisation system $(\mathsf{L}, \mathsf{R})$ on
$\cal{E}$ such that the category of $\mathsf{R}$-algebras is the category of uniform trivial  Kan fibrations. 
In particular, there is a functorial factorisation of maps of simplicial sets which sends
a map $f \co X \to Y$ to a diagram of the form
\[
\xymatrix{ 
X \ar[rr]^f \ar[dr]_{i_f}  & & Y \\
 & C_f \ar[ur]_{p_f} }
 \]
 where $p_f$ admits the structure of  a uniform trivial  Kan fibration and 
 $i_f$ admits the structure of a $\mathsf{L}$-coalgebra.
\end{theorem}

\begin{proof} Since $\catE$ is a category of elegant Reedy presheaves, 
the full category $\cal{M}_{\textup{rep}} \subseteq \cal{M}$  spanned by 
 monomorphisms with codomain a representable
presheaf is small. Now, since 
the inclusion $\cal{M}_1 \hookrightarrow \catE^\to$ preserves $\omega$-filtered colimits, 
it is possible to apply Garner's small object argument to
obtain an algebraic weak factorisation system $(\mathsf{L}, \mathsf{R})$.
The fact that the category of $\mathsf{R}$-algebras is the category of uniform trivial Kan fibrations
 follows from \cref{small-gen-triv-kan}.
 \end{proof} 


\begin{theorem} Let $\catE$ be a category of elegant Reedy presheaves. 
There exists an algebraic weak factorisation system $(\mathsf{L}, \mathsf{R})$
such that the category of $\mathsf{R}$-algebras is the category of uniform  Kan fibrations. 
In particular, there is a functorial factorisation of maps of simplicial sets which sends
a map $f \co X \to Y$ to a diagram of the form
\[
\xymatrix{ 
X \ar[rr]^f \ar[dr]_{i_f}  & & Y \\
 & P_f \ar[ur]_{p_f} }
 \]
 where $p_f$ admits the structure of  a uniform  Kan fibration and 
 $i_f$ admits the structure of a $\mathsf{L}$-coalgebra.
\end{theorem} 

\begin{proof} The claim follows from Garner's small object argument, once we find a 
functor $u \co \cal{I} \rightarrow \catE^\to$ such that $\cal{I}$ is small and the
category of uniform  Kan fibrations is isomorphic to $\liftr{\cal{I}}$. If we consider
the inclusion $u \co \mathcal{M}_1 \to \cal{E}^\to$ and perform the construction
$u_\cyl \co (\mathcal{M}_1)_\cyl \to \catE^\to$, the result follows 
by \cref{small-gen-triv-kan} and \cref{prod-exp-general}. 
\end{proof}



\section{Kan fibrations and uniform Kan fibrations}
\label{section-kan-fib}

 The aim of this section is to compare the standard notion of a Kan fibration with the
 notion of a uniform Kan fibration: we will show that a map $p \co X \to Y$ of simplicial
 sets is a Kan fibration if and only if it can be equipped with the structure of a uniform
 Kan fibration. Note that ~\cref{awfs-on-arrows-into-representables} cannot be used to show 
a map $p \co X \to Y$ of simplicial sets admits the structure of a uniform trivial Kan  fibration if and only if it is a trivial Kan fibration in the usual sense since  the class of boundary inclusions  is contained strictly  in~$\cal{M}_{\mathrm{rep}}$. 

 We first establish the corresponding result for 
 trivial Kan fibration. For this, it is useful to define the following subcategory $\cal{I} \subseteq \SSet^\to$. The objects are the boundary inclusions
$i_n \co \partial \Delta_n \to \Delta_n$ and the identity maps $\id_{\Delta_n} \co \Delta_n \to \Delta_n$; the
maps are the identity squares and those of the form
 \[
\xymatrix@C=1.2cm{
  \partial \Delta_n
  \ar[r]
  \ar[d]_{i_n}
&
  \Delta_{n-1}
  \ar[d]^{\id_{\Delta_{n-1}}}
\\
  \Delta_n
  \ar[r]_-{s^k_{n-1}}
&
  \Delta_{n-1}
}
\] 


\begin{definition} A \emph{regular trivial Kan fibration} is a right $\cal{I}$-map, \ie a map $p \co X \to Y$ 
equipped with a function that assigns fillers to all squares of the form
\begin{equation}
\label{equ:boundary-filler}
\xycenter{
\partial \Delta_n \ar[d]_{i_n} \ar[r] & X \ar[d]^{p} \\
\Delta_n \ar[r] & Y } 
\end{equation}
subject to the following naturality condition: for every diagram of the form
\begin{equation}
\label{equ:factor-via-id}
{\vcenter{\hbox{\xymatrix@C=1.2cm{
  \partial \Delta_n
  \ar[r]
  \ar[d]_{i_n}
&
  \Delta_{n-1}
  \ar[r]
  \ar[d]^{\id_{\Delta_{n-1}}}
&
  X
  \ar[d]^{p}
\\
  \Delta_n
  \ar[r]_-{s_k^{n-1}}
&
  \Delta_{n-1}
  \ar[r]
&
  Y
}}}}
\end{equation}
the composite filler is coherent with respect to the trivial filler in the right square. 
\end{definition}


\begin{lemma}[ZFC] \label{triv-Kan-is-regular}
Every trivial Kan fibration admits the structure of a regular trivial Kan fibration.
\end{lemma}

\begin{proof} By the axiom of choice, we can choose  designated fillers for squares as in~\eqref{equ:boundary-filler}
 based on (using excluded middle) whether that square factors as in~\eqref{equ:factor-via-id}. Note that it does not matter which degeneracy we choose if multiple are available, since the resulting diagonal filler will be coherent with 
 all possible choices.
\end{proof} 


\begin{lemma} \label{reg-triv-is-unif-Kan}
Every regular trivial Kan fibration admits the structure of a uniform trivial Kan fibration.
\end{lemma}

\begin{proof} Let us consider a map $p \co X \to Y$ equipped with the structure of a 
regular trivial fibration. By \cref{small-gen-triv-kan}, it is sufficient to show that $p$
can be equipped with the structure of a right $\cal{M}_1$-map, where $\cal{M}_1$
is the full subcategory of $\SSet^{\mathbf{2}}_\cart$  spanned by monomorphisms into representables.
So, let us consider a square of the form
\[
\xymatrix{
A \ar[d]_i \ar[r] & X \ar[d]^p \\
\Delta_n \ar[r]  & Y }
\]
where $i$ is a decidable monomorphism. 
We define a diagonal filler by decomposing $i$ into a finite composition of cobase changes of boundary inclusions, filling each of these using~\cref{triv-Kan-is-regular}.
Crucially, this process is independent of the actual order of the boundary fillings (note that this is not true for the analogous situation of horn fillings). In order to prove the naturality condition of uniform trivial Kan fibrations, 
let us consider a diagram of the form
\[
\xymatrix{
  A
  \ar[r]
  \ar[d]_i
  \pullback{dr}
&
  B
  \ar[d]_j 
  \ar[r]
&
  X
  \ar[d]^p 
\\
  \Delta_{n}
  \ar[r]
&
  \Delta_{m}
  \ar[r]
&
  Y
}
\]
where the left-hand side square is a pullback. 
By ``vertical'' induction and the remark on order invariance of boundary fillings, it will suffice to study the case where the middle vertical map is a boundary inclusion $i_n \co \partial \Delta_n \to \Delta_n$.
Working ``horizontally'', it suffices to study the situation where the map $\Delta_{m} \to \Delta_n$ is a face or degeneracy map as $\Delta$ is generated by these.

Let us first examine the case of a face operation.
\[
\xymatrix{
  \Delta_n
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  \partial \Delta_{n+1}
  \ar[d]
  \ar[r]
&
  X
  \ar[d]
\\
  \Delta_n
  \ar[r]_{d^k_{n+1}}
&
  \Delta^{n+1}
  \ar[r]
&
  Y
}
\]
Since the left vertical map is necessarily the identity, the filler for the composite square is uniquely determined, so there is no coherence to be verified.

Let us now examine the case of a degeneracy operation.
\[
\xymatrix{
  2 \times \partial \Delta_n
  \ar[r]
  \ar[d]
  \ar@/^2em/[rr]^(0.3){\pi_2}
  \pullback{dr}
&
  \bigcup_{i \neq k, k+1} \Delta_{[n+1] - i}
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  \partial \Delta_n
  \ar[d]
  \ar[r]
&
  X
  \ar[dd]
\\
  2 \times \Delta_n
  \ar[r]
  \ar@/_2em/[rr]_(0.3){\pi_2}
&
  \partial \Delta_{n+1}
  \ar[r]
  \ar[d]
  \ar@{.>}[urr]
  \pullback{ul}
&
  \Delta_n
  \ar[d]
  \ar@{.>}[ur]
\\&
  \Delta_{n+1}
  \ar[r]_{s_k^n}
  \ar@{.>}[uurr]
&
  \Delta_n
  \ar[r]
  \ar@{.>}[uur]
&
  Y
}
\]
The pullback of the boundary inclusion $\partial \Delta_n \to \Delta_n$ along $s^k_n$ decomposes as a cobase change of two parallel boundary inclusions of dimension $n$ followed by a boundary inclusion of dimension $n+1$,
as indicated.
The two parallel boundary fillings are identical copies of the original right square boundary filling, so they cohere as indicated.
Finally, the filling for the boundary inclusion~$\partial \Delta_{n+1} \to \Delta_{n+1}$ coheres as indicated by how boundary filling was originally defined for degenerate squares.
\end{proof}











\begin{theorem}[ZFC]  \hfill 
\begin{enumerate}[(i)]
\item  Every trivial Kan fibration admits the structure of a uniform trivial Kan fibration.
\item Every Kan fibration admits the structure of a uniform  Kan fibration.
\end{enumerate} 
\end{theorem}

\begin{proof} The claim in (i) follows by \cref{triv-Kan-is-regular}  and \cref{reg-triv-is-unif-Kan}. For (ii), let
$p \co X \to Y$ be a Kan fibration. By the non-algebraic counterpart of \cref{prod-exp-general}, it follows 
that $\hatexp(h_k^1, p)$ is a trivial Kan fibration for $k = 0, 1$. The claim then follows  by \cref{prod-exp-general}. 
\end{proof}




\section*{Acknowledgements}

We are grateful to Steve Awodey, Simon Huber and Andrew Swan for helpful discussions on the cubical model of type theory,
and to Emily Riehl for insightful comments on algebraic weak factorization systems.

This material is based on research sponsored by the Air Force Research Laboratory, under agreement number FA8655-13-1-3038, by a grant from the John Templeton Foundation and by an EPSRC grant (EP/M01729X/1).

\appendix


\section{Some auxiliary notions}

For this,
we need a special case of the so-called Leibniz construction~\cite{riehl-verity:reedy} (which, in fact, will be used also later on). Given a natural transformation $\phi \co F \Rightarrow
G$, where $F, G \co \cal{E} \to \cal{E}$ are two functors, and a map $f \co X \to Y$, we define the map~$\phi \hatotimes f \co GX +_{FX} FY \to GY$ via the following
pushout diagram:
 \[
\xymatrix@C=1.2cm{
FX \ar[r]^{Ff}  \ar[d]_{\phi_X} & FY  \ar@/^2pc/[ddr]^{\phi_Y} \ar[d] & \\ 
GX \ar@/_1pc/[drr]_{Gf} \ar[r] &  GX +_{FX} FY \ar[dr]^-(.35){\phi \hatotimes f}  & \\ 
 & & GY } 
 \]
This operation extends to a functor $(-) \hatotimes (-) \co [\catE, \catE]^\to \times \catE^\to \to \catE^\to$. 

The internal hom $\hatexp(f,g)$ in $\catE^\to$ of $f \co X \to Y$ and $g \co U \to V$, is their \emph{pullback exponential}, obtained by the following pullback diagram
\[
\xymatrix@R=1.2cm{
[Y, U] \ar@/^2pc/[drr]^{[f,U]} \ar@/_2pc/[ddr]_{[Y,g]}  \ar[dr]^{\hatexp(f,g)} & & \\ 
 & [Y,V] \times_{[X,V]} [X,U]  \ar[d] \ar[r] & [X,U] \ar[d]^{[X,g]} \\
 & [Y,V] \ar[r]_{[f,V]} & [X,V] }
 \]
 



\bibliographystyle{alpha}
\bibliography{../../common/uniform-kan-bibliography}

\end{document}
