\documentclass[reqno,10pt,a4paper,oneside,draft]{amsart}

\setcounter{tocdepth}{1}
% \usepackage[parfill]{parskip}

\usepackage{uniform-kan-prelude}

\title{Uniform fibrations and the Frobenius condition}

\begin{document}

\begin{abstract}
We introduce and study the notion of a uniform fibration in categories with a functorial cylinder. In particular,
we show that in a wide class of presheaf categories, including simplicial sets and cubical sets with connections,
uniform fibrations are the right class of a natural weak factorisation system and 
satisfy the Frobenius property. This implies that the pushforward along a uniform fibration preserves uniform fibrations. 
When applied to simplicial sets, this result gives a constructive counterpart of one of the key facts underpinning Voevodsky's simplicial
model of univalent foundaitons, while in cubical sets it subsumes some of the existing work on cubical models of type theory.
\end{abstract}

\author{Nicola Gambino}
\address{School of Mathematics, University of Leeds, Leeds LS2 9JT, UK}
\email{n.gambino@leeds.ac.uk}

\author{Christian Sattler}
\address{School of Mathematics, University of Leeds, Leeds LS2 9JT, UK}
\email{c.sattler@leeds.ac.uk}

\date{\today}

\maketitle

%\tableofcontents

% \notec{To do: remove unneeded parentheses.}

\section{Introduction}

In recent years there has been increasing interest in variants of the notion of a Kan fibration.
One line of work, originating in work by Cisinski~\cite{cisinski-asterisque}, is concerned with the generalisation of the theory of Kan fibrations from simplicial sets to general presheaf categories~\cite{cisinski-univalence,moerdijk-minimal}.
Another direction of research, which is motivated by Voevodsky's univalence foundations programme~\cite{voevodsky:uf} and began with work by Bezem, Coquand and Huber~\cite{coquand-cubical-sets}, focuses on notions of uniform Kan fibration in categories of cubical sets~\cite{awodey-cubical,coquand-variation,huber-thesis,pitts-cubical-nominal,swan-awfs}.
Here, a uniform fibration is understood to be a map equipped with additional structure which provides diagonal fillers for appropriate diagrams, as in the theory of natural weak factorisation systems~\cite{grandis-tholen-nwfs}, rather than a map merely satisfying a weak orthogonality property, as in the usual definition of a Kan fibration.

In this paper we introduce and study the notion of a uniform fibration in the general setting of categories with a functorial cylinder, taking further ideas in the two lines of research mentioned above.  On the one hand, the abstract approach that we adopt allows us to apply our results to both simplicial sets and to cubical sets with connections, as defined in~\cite{coquand-variation}. On the other hand, 
by working without assuming the law of excluded middle or the axiom of choice, we contribute to the definition of a constructive version of the simplicial model of univalent foundations~\cite{voevodsky-simplicial-model}, which is also the goal of work on cubical sets mentioned above. Such a definition is of great interest since it would improve the relative consistency result in~\cite[Theorem~3.4.3]{voevodsky-simplicial-model} and help to establish the homotopy canonicity conjecture for the univalence axiom~\cite[Conjecture 1]{voevodsky:uf}.

As an application of our results, we prove constructively that in the category of simplicial sets the pushforward along a uniform Kan fibration preserves uniform Kan fibrations. We consider this the constructive counterpart of the fact that the pushforward along a Kan fibration preserves Kan fibrations, which is a key ingredient in the simplicial model of univalent foundations~\cite[Lemma~2.3.1]{voevodsky-simplicial-model}, but cannot be proved constructively without modifying the standard notion of a Kan fibration~\cite{coquand-non-constructivity-kan}.

In view of our applications to simplicial and cubical sets, we devote particular attention to uniform (trivial) fibrations in presheaf categories equipped with a functorial cylinder.
In this setting,  uniform trivial fibration are defined by weak orthogonality with respect to the category~$\mathcal{M}$ of decidable monomorphisms and pullback squares, while uniform fibrations are defined by weak orthogonality with respect to a category
obtained by applying a Leibniz construction, in the sense of~\cite{riehl-verity:reedy}, to the endpoint inclusions of
the functorial cylinder and~$\cal{M}$.  These definitions may
be seen as a counterpart in our setting of those introduced by Cisinski in~\cite{cisinski-asterisque}. 

Our first main result (\cref{thm:ac-kan-is-uniform}) relates the notion of a uniform (trivial) fibration to its non-algebraic counterpart
in the setting of presheaf categories over an elegant Reedy category~\cite{bergner-rezk-elegant}. 
In particular, we show that, if one assumes the axiom of choice, then a map can be equipped with the structure of a uniform (trivial) fibration if and only if it satisfies the right lifting property with respect to the maps involved in the definition of a uniform (trivial)
fibration. 
It should be pointed out that this result is far from being a simple application of the axiom of choice, since the function that is
required for having a uniform fibration needs to satisfy an appropriate naturality condition. Instead, it is necessary to 
obtain a careful decomposition of the lifting problems involved in the naturality condition.
By applying this result in the category of simplicial sets, we obtain that every Kan fibration can be equipped with the structure of a uniform Kan fibration.

Our second main result (\cref{thm:sset-cset-nwfs}) is that in presheaf categories (not necessarily over an elegant Reedy category) uniform trivial fibrations and uniform fibrations are the right maps of two natural weak factorisation systems, which are obtained using Garner's small object argument~\cite{garner:small-object-argument}.
As a special case of this result, we obtain natural weak factorisation systems in simplicial and cubical sets that have uniform Kan fibrations as the right maps, which are of interest for the interpretation of Martin-L\"of's rules for identity 
types~\cite{awodey-warren:homotopy-idtype,gambino-garner:idtypewfs,warren:thesis,garner:topological-simplicial,shulman:inverse-diagrams}.
The key fact for establishing our second main result is that uniform (trivial) fibrations can be be defined equivalently by weak orthogonality with respect to a small category of maps (\cref{small-gen-triv-kan}).
Working with uniform fibrations is essential to prove this fact, since it allows us to write an arbitrary lifting problem as a colimit of a functorial family of lifting problems, while still working constructively.
This type of good interaction between colimits and lifting problems in the theory of natural weak factorisation systems was already emphasised in~\cite{riehl-cat-homotopy}.

For our third main result, we return to consider the general setting of categories equipped with a functorial cylinder.
In this setting, we introduce a version in our setting of the Frobenius condition\footnote{The terminology is inspired by Lawvere's Frobenius reciprocity condition~\cite{lawvere-equality}; see~\cite{clementino:frobenius} for a precise connection between the two notions.} for weak factorisation systems~\cite{garner:types-omega-groupoids}, which states that the pullback along a right map preserves left maps.
We then show that, under the crucial assumption of connections, uniform fibrations satisfy the Frobenius condition (\cref{thm:frobenius-fibrations}). As a consequence, we obtain that the pushforward, \ie the right adjoint to pullback, along a uniform fibration preseves uniform fibrations (\cref{thm:frobenius-pushforward}). When applied to the category of simplicial sets, we obtain the above-mentioned
result  that pushforward along a uniform Kan fibration preseves uniform Kan fibrations. When instanciated to the category of cubical sets with connections, our results give also a new proof of the fact that the pushforward along a Kan fibration preserves Kan fibrations, which avoids entirely combinatorial manipulations with cubical sets~\cite{coquand-variation}.

Because of these results, we regard the independence result in~\cite{coquand-non-constructivity-kan} as an indication that the standard notion of a Kan fibration is not suitable for developing simplicial homotopy theory constructively, rather than as an inherent non-constructivity of the simplicial setting. Indeed, the notion of a uniform Kan fibration, while classically equivalent to the usual notion of a Kan fibration, permits the development of some parts of the theory of Kan fibrations in a constructive setting in simplicial sets. 

Let us also mention that, just as we introduce a version of the Frobenius property for a map, we introduce also a version of the Beck-Chevalley conditions for morphisms of maps, \ie commutative squares.
As before, we show that the Beck-Chevalley holds for morphisms of uniform fibrations under mild assumptions, which are verified in categories of presheaves.

\subsection*{Organization of the paper}

Section~\ref{sec:cylhuf} introduces the main concepts that will be studied in the paper, namely functorial cylinders with connections, homotopy equivalences, and uniform fibrations, giving examples of these notions in presheaf categories in general and in simplicial and cubical sets in particular.
The paper then proceeds with two sections with auxiliary results: Section~\ref{sec:ortf} establishes basic facts about orthogonality functors, while \cref{sec:remshe} focuses on strong homotopy equivalences.
The rest of the paper contains our main results.
In Section~\ref{sec:unifpc} we establish the relationship between uniform fibrations and their non-algebraic counterparts, assuming the axiom of choice, and prove the existence of natural weak factorisation systems with uniform (trivial) fibrations as right maps.
After introducing the Frobenius and Beck-Chevalley conditions in Section~\ref{sec:frobc}, we prove that they hold for uniform fibrations under mild assumptions in~\cref{sec:frocuf}.
Appendix~\ref{app:tecp} contains the proof of two technical lemmas.

\subsection*{Acknowledgements}  We are grateful to Steve Awodey, Simon Huber and Andrew Swan for helpful discussions on the cubical model of type theory; to Emily Riehl for insightful comments on algebraic weak factorization systems; and to Richard Garner for pointing us to useful references.

This material is based on research sponsored by the Air Force Research Laboratory, under agreement number FA8655-13-1-3038, by a grant from the John Templeton Foundation and by an EPSRC grant (EP/M01729X/1).




\section{Cylinders, homotopies, and uniform fibrations}
\label{sec:cylhuf}

The aim of this section is to introduce the main notions that will be used in our development, and provide examples thereof in categories of interest, such as the category of simplicial sets and the category of cubical sets with connections.
%\notec{There is excessive spacing after this paragraph. Can you fix it while still getting rid of most med skips?}

\subsection*{Cylinders and homotopies}

Recall from~\cite{kamps-porter:homotopy} that a \emph{functorial cylinder} $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ in $\calE$ is an endofunctor $\interval \otimes (-) \co \catE \to \catE$ equipped with natural transformations $\lcyl \otimes (-), \rcyl \otimes (-) \co \Id_\catE \to \interval \otimes (-)$ called the \emph{right and left endpoint inclusions}, respectively.
We say the functorial cylinder has \emph{contractions} if there is a common retraction $\ccyl \otimes (-) \co \interval \otimes (-) \to \Id_\catE$ to $\lcyl \otimes (-)$ and $\rcyl \otimes (-)$, making the following diagram commute:
\[
\xymatrix@C+2em{
  \Id_\catE
  \ar[r]^-{\lcyl \otimes (-)}
  \ar@{=}[dr]
&
  \interval \otimes (-)
  \ar[d]^(0.4){\ccyl \otimes (-)}
&
  \Id_\catE
  \ar[l]_-{\rcyl \otimes (-)}
  \ar@{=}[dl]
\\&
  \Id_\catE
\rlap{.}}
\]
The notation $\interval \otimes (-)$ adopted here is deliberately suggestive of the fact that, in many examples, a functorial cylinder is defined using a monoidal structure and an interval object as in \cref{exa:cyl-via-int} below.
However, it is convenient to develop our theory without making this extra assumption.
We adopt the convention of associating the tensor product shorthand notation to the right in order to avoid excessive bracketing.

\begin{example} \label{exa:cyl-via-int}
Let $(\catE, \otimes, \top)$ be a monoidal category.
An \emph{interval object} $(\interval, \lcyl, \rcyl)$ in $\calE$ is an object~$\interval \in \catE$ equipped with maps $\lcyl, \rcyl \co \top \to \interval$ called \emph{left and right endpoint inclusions}, respectively.
It has \emph{contractions} if there is a common retraction $\ccyl \co \interval \to \top$ to $\lcyl$ and $\rcyl$, making the following diagram commute:
\[
\xymatrix@C+1em{
  \top
  \ar[r]^{\lcyl}
  \ar@{=}[dr]
&
  \interval
  \ar[d]^(0.4){\ccyl}
&
  \top
  \ar[l]_{\rcyl}
  \ar@{=}[dl]
\\&
  \top
\rlap{.}}
\]
If the unit $\top$ of the monoidal structure is also terminal, an interval object canonically has contractions.
Tensoring with an interval object (with contractions) evidently induces a functorial cylinder (with contractions).
\end{example}

Our main examples will have functorial cylinders induced by interval objects.

\begin{example}[Functorial cylinder in simplicial sets] \label{exa:cyl-in-sset}
The category $\SSet$ of simplicial sets is Cartesian closed.
An interval object with contractions is given by $\Delta^1$ with endpoint inclusions $h_{1-k}^1 \co \braces{k} \hookrightarrow \Delta^1$ for $k \in \braces{ 0, 1 }$.
Note that these are special cases of the horn inclusions $h_k^n \co \Lambda_k^n \to \Delta^n$.
As in \cref{exa:cyl-via-int}, taking the Cartesian product with $\Delta^1$ provides a functorial cylinder.
\end{example}

\begin{example}[Functorial cylinder in cubical sets] \label{exa:cyl-in-cuset}
The category of cubical sets $\CSet$ as studied in \cite{coquand-variation} has a monoidal structure with unit coinciding with the terminal object.
An interval object with contractions is given by $\Box^1$ with endpoint inclusions $\braces{0} \to \Box^1$ and $\braces{1} \to \Box^1$.
As in \cref{exa:cyl-via-int}, tensoring with $\Box^1$ provides a functorial cylinder.
\end{example}

Let $f, g \co X \to Y$ be maps in $\catE$.
Recall that a \emph{homotopy from $f$ to $g$}, denoted $\phi \co f \sim g$, is a morphism $\phi \co \interval \otimes X \to Y$ such that the following diagram commutes:
\begin{equation}
\label{equ:homotopy}
\begin{gathered}
\xymatrix@C=1.2cm{
  X
  \ar[r]^-{\lcyl \otimes X}
  \ar[dr]_{f}
&
  \interval \otimes X
  \ar[d]^(0.4){\phi}
&
  X
  \ar[dl]^{g}
  \ar[l]_-{\rcyl \otimes X}
\\&
  Y
\rlap{.}}
\end{gathered}
\end{equation}

A map $f \co X \to Y$ is called a \emph{left homotopy equivalence} if there exist $g \co Y \to X$ and homotopies $\phi \co g \cc f \sim \id_X $ and $\psi \co f \cc g \sim \id_Y$.
Dually, a map $f \co X \to Y$ is called a \emph{right homotopy equivalence} if there exist $g \co Y \to X$ and homotopies $\phi \co \id_X \sim g \cc f$ and $\psi \co \id_Y \sim f \cc g$.
The notion of a \emph{(left or right) strong deformation retract} is obtained by requiring also that the homotopy $\phi$ is trivial.
The following generalization of strong deformation retracts will be crucial for our purposes:

\begin{definition} \label{def:strhe}
A left (or right) homotopy equivalence as above is said to be \emph{strong} if the diagram
\[
\xymatrix{
  \interval \otimes X \ar[r]^{\interval \otimes f} \ar[d]_{\phi} & \interval \otimes Y \ar[d]^{\psi} \\
  X \ar[r]_{f} & Y
}
\]
commutes, and \emph{co-strong} if the diagram
\[
  \xymatrix{
  \interval \otimes Y \ar[r]^{\interval \otimes g} \ar[d]_{\psi} & \interval \otimes X \ar[d]^{\phi} \\
  Y \ar[r]_{g} & X
}
\]
commutes.
\end{definition}

The notion of homotopy equivalence is symmetric and admits an evident duality, and a homotopy equivalence is strong if and only if its dual is co-strong.
Strong homotopy equivalences will play a central role in our development (see \cref{def:effective-connections}).
In preparation for this, let us observe that they can be collected into a category as follows.

The category $\cal{S}_0$ of strong left homotopy equivalences is defined as follows.
An object is a 4-tuple $(f, g, \phi, \psi)$ consisting of an arrow $f \co A \to B$ together with data $g \co B \to A$, $\phi \co \interval \otimes A \to A$, $\psi \co \interval \otimes B \to B$ making $f$ into a strong left homotopy equivalence.
A morphism $m \co (f, g, \phi, \psi) \to (f', g', \phi', \psi')$ consists of maps $s \co A \to A', t \co B \to B'$ such that the following diagrams commute:
\begin{align*}
\xymatrix{
  A
  \ar[r]^{s}
  \ar[d]_{f}
&
  A'
  \ar[d]^{f'}
\\
  B
  \ar[r]_{t}
&
  B'\rlap{,}
}
&&
\xymatrix{
  B
  \ar[r]^{t}
  \ar[d]_{g}
&
  B'
  \ar[d]^{g'}
\\
  A
  \ar[r]_{s}
&
  A'\rlap{,}
}
&&
\xymatrix{
  \interval \otimes A
  \ar[d]_{\phi}
  \ar[r]^{\interval \otimes s}
&
  I \otimes A'
  \ar[d]^{\phi'}
\\
  A
  \ar[r]_{s}
&
  A' \rlap{,}
}
&&
\xymatrix{
  \interval \otimes B
  \ar[d]_{\psi}
  \ar[r]^{\interval \otimes t}
&
  I \otimes B'
  \ar[d]^{\psi'}
\\
  B
  \ar[r]_{t}
&
  B' \rlap{.}
}
\end{align*}
The category $\cal{S}_1$ of strong right homotopy equivalences is defined analogously.
There is an obvious forgetful functor $\cal{S}_k \to \catE^\to$ projecting to the first component.

\subsection*{Connections}

Although large parts of our development are carried out assuming only a functorial cylinder, some of our results, including that of the Frobenius property for uniform fibrations (\cref{thm:frobenius-fibrations}), assume also the presence of connections.
We recall the definition.

\begin{definition} \label{def:connections}
A functorial cylinder $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ with contractions $\ccyl \otimes (-)$ has \emph{connections} if, for $k \in \braces{0, 1}$, there is a natural transformations $c^k \otimes (-) \co \interval \otimes \interval \otimes (-) \to \interval \otimes (-)$ such that the diagrams
\begin{equation} \label{connections:0}
\xymatrix@C+3em{
  \interval \otimes (-)
  \ar[r]^-{\kcyl \otimes \interval \otimes (-)}
  \ar[d]_{\ccyl \otimes (-)}
&
  \interval \otimes \interval \otimes (-)
  \ar[d]^{c^k \otimes (-)}
&
  \interval \otimes (-)
  \ar[l]_-{\interval \otimes \kcyl \otimes (-)}
  \ar[d]^{\ccyl \otimes (-)}
\\
  \Id_\catE
  \ar[r]_{\kcyl \otimes (-)}
&
  \interval \otimes (-)
&
  \Id_\catE
  \ar[l]^{\kcyl \otimes (-)}
}
\end{equation}
and
\begin{equation} \label{connections:1}
\xymatrix@C+3em{
  \interval \otimes (-)
  \ar[r]^-{\kcylinv \otimes \interval \otimes (-)}
  \ar@{=}[dr]
&
  \interval \otimes \interval \otimes (-)
  \ar[d]^(0.4){c^k \otimes (-)}
&
  \interval \otimes (-)
  \ar[l]_-{\interval \otimes \kcylinv \otimes (-)}
  \ar@{=}[dl]
\\&
  \interval \otimes (-)
}
\end{equation}
commute.
\end{definition}

The notation $c^k \otimes (-)$ is once again suggestive of an interval object (see \cref{exa:connections-for-interval} below).

We use the notion of strong homotopy equivalence to introduce a structure on a functorial cylinder that is strictly weaker than connections, but encapsulates more economically the requirements needed for carrying out our main development.

\begin{definition} \label{def:effective-connections}
A functorial cylinder $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ has \emph{effective connections} if the endpoint inclusions $\lcyl \otimes X$ and $\rcyl \otimes X$ are strong left and right homotopy equivalences, respectively, naturally in $X \co \catE$.
Formally, for $k \in \braces{0, 1}$, the functor $\kcyl \otimes (-) \co \catE \to \catE^\to$ is required to lift through the forgetful functor $\cal{S}_k \to \catE^\to$.
\end{definition}

As we will see in \cref{effective-connections-leibniz}, when $\interval \otimes (-)$ preserves pushouts  it is possible to rephrase
equivalently the notion of effective connections by requiring certain maps to be left and right homotopies.  

\begin{remark} \label{connections-are-effective}
Effective connections, in contrast to connections, do not presuppose contractions. But if a functorial cylinder 
$(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ has contractions $\varepsilon \otimes (-)$, then
having connections $c^k \otimes (-)$ for $k \in \braces{0, 1}$ implies having effective connections.
To see this, it suffices to show that $\lcyl \hatotimes (-) \co \catE^\to \to \catE^\to$ lifts through $\cal{S}_0 \to \catE^\to$.
Given $X \in \catE$, observe that $\lcyl \otimes X \co X \to \interval \otimes X$ is a strong left deformation retract with retraction given by contraction $\ccyl \otimes X \co I \otimes X \to X$ and homotopy $\psi \co \ccyl \cc (\lcyl \otimes X) \sim \id_{I \otimes X}$ given by connection $\psi = c^0 \otimes X$.
The left and right endpoints of $\psi$ follow from the left parts of~\eqref{connections:0} and~\eqref{connections:1}, respectively, and the strength follows from the right part of~\eqref{connections:0}.
Recall that strong left deformation retracts are special cases of strong left homotopy equivalences.
The above assignment of a strong left homotopy equivalence is functorial in $X \in \catE$ since $\ccyl \otimes (-)$ and $c^0 \otimes (-)$ are natural transformations.
\end{remark}


\begin{example} \label{exa:connections-for-interval}
Let $(\catE, \otimes, \top)$ be a monoidal category.
An interval object $(\interval, \lcyl, \rcyl)$ with contractions $\ccyl$ has \emph{connections} if, for $k \in \braces{0, 1}$, there is a map $c^k \co \interval \otimes \interval \to \interval$ such the following diagrams commute:
\begin{align} \label{connections-for-interval:0}
\begin{aligned}
\xymatrix@C+1em{
  \interval
  \ar[r]^-{\kcyl \otimes \interval}
  \ar[d]_{\ccyl}
&
  \interval \otimes \interval
  \ar[d]^{c^k}
&
  \interval
  \ar[l]_-{\interval \otimes \kcyl}
  \ar[d]^{\ccyl}
\\
  \top
  \ar[r]_{\kcyl}
&
  \interval
&
  \top
  \ar[l]^{\kcyl}
\rlap{,}}
\end{aligned}
&&
\begin{aligned}
\xymatrix@C+2em{
  \interval
  \ar[r]^-{\kcylinv \otimes \interval}
  \ar@{=}[dr]
&
  \interval \otimes \interval
  \ar[d]^(0.4){c^k}
&
  \interval
  \ar[l]_-{\interval \otimes \kcylinv}
  \ar@{=}[dl]
\\&
  \interval
\rlap{.}}
\end{aligned}
\end{align}
The maps $c^0$ and $c^1$ can be seen as analogous to the minimum and maximum operations for the real line interval, or as conjunction and disjunction in a bounded distributive lattice.
An interval object $(\interval, \lcyl, \rcyl)$ has \emph{effective connections} if $\lcyl$ and $\rcyl$ are left and right homotopy equivalences, respectively.

Assuming connections, we see in~\eqref{connections-for-interval:0} that the map $c^0$, seen as a homotopy from $\id_I$ to $\lcyl \cc \ccyl$, makes $\lcyl$ into a strong left deformation retract with left inverse $\ccyl$.
Dually, the map $c^1$ makes $\rcyl$ into a strong right deformation retract with left inverse $\ccyl$.
Note that this is not an equivalent characterization of connections as commutativity of the right triangle in the seond diagram in~\eqref{connections-for-interval:0} is not captured.
Since strong deformation retracts are special cases of strong homotopy equivalences, we have effective connections.
This all is analogous to \cref{connections-are-effective}.

As in \cref{exa:cyl-via-int}, tensoring with an interval object with (effective) connections induces a functorial cylinder with (effective) connections.
\end{example}

%\begin{definition} \label{def:cyl-with-con}
%A \emph{functorial cylinder with connections} consists of a functorial cylinder $(\interval \otimes (-), \lcyl, \rcyl, \ccyl)$ in $\calE$ equipped with natural transformations
%\begin{align*}
%  \gamma^k &\co \interval \otimes (-) \to \id_\catE \rlap{,} &
%  \phi^k &\co \interval \otimes (-) \to \id_\catE \rlap{,} &
%  \psi^k &\co \interval \otimes (\interval \otimes (-)) \to \interval \otimes (-)
%\end{align*}
%which make the components of $\rcyl$ into a strong right homotopy equivalences and the components of $\lcyl$ into strong left homotopies.
%\noten{Check left and right}
%\end{definition}

\begin{example}[Connections in simplicial sets]
The interval object $(\Delta^1, h_1^1, h_0^1)$ in simplicial of~\cref{exa:cyl-in-sset} sets has uniquely determined connections $c^k \co \Delta^1 \times \Delta^1 \to \Delta^1$ with $k \in \braces{0, 1}$ given on points by $c^0(x, y) = \min(x, y)$ and $c^1(x, y) = \max(x, y)$.
For this, note that $\Delta^1$ and $\Delta^1 \times \Delta^1$ are nerves of posets and that $\min$ and $\max$ are monotonous with respect to their orderings.
\end{example}

\begin{example}[Connections in cubical sets] \noten{To be added}
\end{example}

\subsection*{Uniform fibrations}
We will interested in algebraic counterparts of the weak orthogonality properties that are used in the definition of a weak factorisation system~\cite{bousfield-wfs}.
Furthermore, instead of starting from a mere class of arrows in $\catE$ and define its left or right orthogonal class, we consider a category~$\cal{I}$, to be thought of an indexing category (but not assumed to be small), and a functor~$u \co \cal{I} \to \catE^\to$, where we write $\catE^\to$ for the category of arrows and commutative squares of $\catE$.
Thus, such a functor assigns a morphism $u_i \co A_i \to B_i$ of $\catE$ to each object $i \in \cal{I}$.
The additional generality obtained by allowing $u$ to be an arbitrary functor, rather than just an inclusion, will play an important role in our development.
Let us begin by recalling the following definition from~\cite{garner:small-object-argument}.

\begin{definition} \label{def:right-map}
Let $u \co \cal{I} \to \catE^\to$ be a functor.
\begin{enumerate}[(i)]
\item A \emph{right $\cal{I}$-map} $(f, \phi) \co X \to Y$ consisting of a map $f \co X \to Y$ in $\catE$ and a right lifting function~$\phi$ for $\cal{I}$, \ie a function that assigns to each $i \in \cal{I}$ and commuting square
\[
\xymatrix@C=2cm{
A_i \ar[r]^{s} \ar[d]_{u_i} & X \ar[d]^f \\
B_i \ar[r]_{t} & Y}
\]
a diagonal filler $\phi(i,s, t) \co B_i \to X$, satisfying the following naturality condition: for every diagram of the form
\[
\xymatrix{
A_i \ar[r]^a \ar[d]_{u_i} & A_j \ar[r]^{s} \ar[d]_{u_j} & X \ar[d]^f \\
B_i \ar[r]_{b} & B_j \ar[r]_{t} & Y \rlap{,}}
\]
where the left-hand side square is the image of $\sigma \co i \to j$ in $\cal{I}$ under $u$, we have that
\[
\phi(j, s, t) \cc b = \phi(i, s \cc a, t \cc b) \rlap{.}
\]
\item A \emph{right $\cal{I}$-map morphism} $\alpha \co (f, \phi) \to (f', \phi')$ is a square $\alpha \co f \to f'$ in~$\catE$ satisfying an evident compatibility condition with respect to the right lifting functions, which we omit.
\end{enumerate}
\end{definition}

For a functor $u \co \cal{I} \to \catE^\to$, we write $\liftr{\cal{I}}$ for the category of right $\cal{I}$-maps and their morphisms.
There is a forgetful functor~$\liftr{u} \co \liftr{\cal{I}} \to \catE^\to$ mapping $(f, \phi)$ to $f$, which we call the \emph{right orthogonal} of $u$.

The terminology introduced in the next example is intended to suggest the analogy with the theory developed by Cisinski in~\cite{cisinski-asterisque}, where he studied extensively model structures in which the cofibrations are the monomorphisms.

\begin{example}[Uniform trivial fibrations in presheaf categories] \label{exa-triv-kan-fib}
Let $\catE$ be a presheaf category and write $\cal{M}$ for the subcategory of $\catE^\to$ consisting of decidable monomorphisms, \ie monomorphisms whose components are functions with decidable image, and pullback squares.
The right $\cal{M}$-maps play a particularly important role in our development, and therefore we shall introduce a special terminology for them: we will call them \emph{uniform trivial fibrations}.
We define the category $\TrivFib$ of uniform trivial fibrations and their morphisms by letting
\[
 \TrivFib \defeq \liftr{\cal{M}} \rlap{.}
\]
Note that the compatibility condition for a uniform trivial fibration $(f, \phi) \co X \to Y$ involves diagrams of the form
\[
\xymatrix{
A \ar[r]^{h} \ar[d]_{i} \pullback{dr} & C \ar[d]^{j} \ar[r]^s & X \ar[d]^f \\
B \ar[r]_{k} & D \ar[r]_t & Y \rlap{,}}
\]
where $i$ and $j$ are decidable monomorphisms and the square on the left-hand side is a pullback.
A uniform trivial fibration in $\SSet$ and $\CSet$ will be called a \emph{uniform trivial Kan fibration}.
\end{example}

Let us now fix a functorial cylinder $(\interval \otimes (-), \lcyl, \rcyl, \ccyl)$ in $\calE$.
Given a functor $u \co \cal{I} \to \catE^\to$ (which we think of as the counterpart of a set of generating cofibrations), we will define a functor $u_\otimes \co \cal{I}_\otimes \catE^\to$ (which we think of as the counterpart of a set of generating trivial cofibrations) and use it to define the notion of a uniform $\cal{I}$-fibration.
The definition of $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ involves a special case of the so-called Leibniz construction (which is discussed in general in~\cite{riehl-verity:reedy}), which we now review for the convenience of the reader.

Given a natural transformation $\phi \co F \to G$ and a map $f \co X \to Y$, we define $\widehat{\mathrm{ev}}(\phi, f) \co \catE^\to \to \catE^\to$ by the universal property of pushouts, as in the following diagram:
\begin{gather*}
\xymatrix@C=1.2cm{
  FX \ar[r]^{Ff} \ar[d]_{\phi_X} & FY \ar@/^2pc/[ddr]^{\phi_Y} \ar[d] & \\
  GX \ar@/_1pc/[drr]_{Gf} \ar[r] & GX +_{FX} FY  \ar[dr]^-{\widehat{\mathrm{ev}}(\phi, f)} & \\
  & & GY
\rlap{.}}
\end{gather*}
In this way, one obtains a functor $\widehat{\mathrm{ev}} \co [\catE, \catE]^\to \times \catE^\to \to \catE^\to$.
Our notation is chosen since we are appying the Leibniz construction to the evaluation functor $\mathrm{ev} \co [\catE,\catE] \times \calE \to \catE$.

For $u \co \cal{I} \to \catE^\to$ and $k \in \braces{0, 1}$, we define a functor $\kcyl \hatotimes u \co \cal{I} \to \catE^\to$ by letting
\[
(\kcyl \otimes u)_i \defeq \kcyl \hatotimes u_i  \defeq \widehat{\mathrm{ev}}(\kcyl, u_i)  \rlap{.}
\]
We now define the category~$\cal{I}_\otimes$ and th functor $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ that will be used to define the notion of a uniform $\cal{I}$-fibration in \cref{def:I-fibration} below.
First, let $\cal{I}_\otimes \defeq \cal{I} + \cal{I}$.
Then, define $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ via the coproduct diagram
\begin{equation}
\label{equ:u-tensor}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I} \ar[r]^{\iota_0} \ar[dr]_-{\lcyl \hatotimes u} & \cal{I}_\otimes \ar[d]^(.4){u_\otimes} & \cal{I} \ar[dl]^-{\rcyl \hatotimes u} \ar[l]_{\iota_1} \\
  & \catE^\to
\rlap{.}}
\end{gathered}
\end{equation}
Note that, even if $u \co \cal{I} \to \catE^\to$ is an inclusion, $u_\otimes \co \cal{I}_\otimes \to \catE^\to$ is not.
With these definitions in place, the notion of a uniform $\cal{I}$-fibration can be stated very succintly, as in
\cref{def:I-fibration} below.
After stating the definition, we unfold it and illustrate it in some examples.

\begin{definition} \label{def:I-fibration}
Let $u \co \cal{I} \to \catE^\to$ be a functor.
\begin{enumerate}[(i)]
\item A \emph{uniform $\cal{I}$-fibration} is a right $\cal{I}_\otimes$-map.
\item A \emph{uniform $\cal{I}$-fibration morphism} is a morphism of right $\cal{I}_\otimes$-maps.
\end{enumerate}
\end{definition}

We write $\Fib[\cal{I}]$ for the category of uniform $\cal{I}$-fibrations and their morphisms, \ie
\[
\Fib[\cal{I}] \defeq \liftr{(\cal{I}_\otimes)} \rlap{.}
\]
By unfolding the relevant definitions, one readily sees that the notion of a uniform $\cal{I}$-fibration involves diagonal fillers for diagrams having on the left-hand side maps obtained by pushouts of the form
\begin{gather*}
\xymatrix@C=1.2cm{
  A_i \ar[r]^{u_i} \ar[d]_{\kcyl \otimes A_i} & B_i \ar@/^2pc/[ddr]^{\kcyl \otimes B_i} \ar[d] & \\
  \interval \otimes A_i \ar@/_1pc/[drr]_{\interval \otimes u_i} \ar[r] & (\interval \otimes A_i) +_{A_i} B_i \ar[dr]^-{\delta^k \hatotimes u_i} & \\
  & & \interval \otimes B_i
\rlap{.}}
\end{gather*}
where $i \in \cal{I}$ and $k \in \{0, 1 \}$.

\begin{remark}
One could object that our uniform $\cal{I}$-fibrations are not an algebraization of the \emph{naive fibrations} intoduced by Cisinski~\cite{cisinski-asterisque}.
Indeed, abbreviate
\[
m \otimes (-) \defeq [\lcyl \otimes (-), \rcyl \otimes (-)] : \Id_\catE + \Id_\catE \to \interval \otimes (-)
.\]
Then a notion $\Fib[\cal{I}]'$ of uniform Cisinski $\cal{I}$-fibrations would be given by first closing $\cal{I}_\otimes$ under Leibniz product with $m$, \ie defining $\Fib[\cal{I}]'$ as right maps for the functor $u_\otimes' : \cal{I}_\otimes' \to \catE^\to$ with $\cal{I}_\otimes' \defeq \mathbb{N} \times \cal{I}_\otimes$ and $u_\otimes'(n, i) = (m \hatotimes (-))^n(u_\otimes(i))$.
Our reasons for sticking with $\Fib[\cal{I}]$ are twofold.

First, if the functorial cylinder is induced by tensoring with an interval object in a symmetric monoidal category and the functor $u : \cal{I} \to \catE^\to$ is closed under Leibniz product with the ``boundary inclusion'' $[\lcyl, \rcyl] : 1 + 1 \to \interval$, then by permuting the Leibniz product one sees that every uniform $\cal{I}$-fibration also has canonically the structure of a uniform Cisinski $\cal{I}$-fibration.
This is the case in our main examples of simplicial and cubical sets where $u : \cal{I} \to \catE^\to$ is the subcategory of decidable monomorphisms, the map $[\lcyl, \rcyl]$ is a decidable monomorphism, and Leibniz product preserves decidable monomorphisms.

Second, if the functorial cylinder has connections, as we assume for our main results in \cref{sec:frocuf} and onwards, then the maps in $\cal{I}_\otimes$ can still be shown to be strong homotopy equivalences in a uniform way, giving rise to a functor $\cal{I}_\otimes \to \cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I})$ over $\catE^\to$ in the terminology of \cref{sec:remshe} if we assume $\cal{I}$ to be closed under Leibniz product not just with endpoint inclusions, but also with $[\lcyl, \rcyl]$.
With the results in \cref{sec:remshe}, every uniform Cisinski $\cal{I}$-fibrations is then a uniform $\cal{I}$-fibrations in a functorial way.
This is the case if $[\lcyl, \rcyl]$ is a decidable monomorphism and the maps in $\cal{I}$ are the decidable monomorphisms in a presheaf category as in \cref{sec:unifpc}.
\end{remark}

\begin{example}[Uniform fibrations in presheaf categories]
Let $\catE$ be a presheaf category equipped with a functorial cylinder $(\interval \otimes (-), \lcyl, \rcyl, \ccyl)$.
When working with presheaf categories, the category~$\cal{M}$ of decidable monomorphisms and pullback squares and the inclusion $u \co \cal{M} \hookrightarrow \catE^\to$ are of particular importance, {cf.}\,\cref{exa-triv-kan-fib}.
In this setting, a uniform~$\cal{M}$-fibration, \ie a right~$\cal{M}_\otimes$-map, will be called a \emph{uniform fibration}, without further specification.
We define the category $\Fib$ of uniform fibrations and their morphisms by letting
\[
  \Fib \defeq \Fib[\cal{M}] = \liftr{(\cal{M}_\otimes)} \rlap{.}
\]
Below, we illustrate the notion of a uniform fibration in simplicial sets and cubical sets.
\end{example}

\begin{example}[Uniform fibrations in simplicial sets]
A uniform fibration in $\SSet$ will be called a \emph{uniform Kan fibration}.
More explicitly, a uniform Kan fibration $(p, \phi) \co X \to Y$ consists of a simplicial map $p \co X \to Y$ and a function $\phi$ that provides diagonal fillers for diagrams of the form
\[
\xymatrix{
  (\Delta^1 \times A) \cup (\braces{k} \times B)
  \ar[r]
  \ar[d]
&
  X
  \ar[d]^{p}
\\
  \Delta^1 \times B
  \ar[r]
&
  Y
\rlap{.}}
\]
where the map on the left-hand side is the Leibniz product of one of the horn inclusion $h_{1-k}^1 \co \braces{k} \to \Delta^1$ mentioned in \cref{exa:cyl-in-sset} with a decidable monomorphism $i \co A \to B$.
Note that higher-dimensional horns are not involved explicitly here.
However, they are included indirectly since they are retracts of one-dimensional horns by Leibniz product with themselves~\cite{joyal-quaderns} (see also \cite[Proposition 2.1.2.6]{lurie:htt}).
We will show in \cref{thm:ac-kan-is-uniform} that, assuming the axiom of choice, every Kan fibration in the usual sense admits the structure of a uniform Kan fibration.
\end{example}

\begin{example}[Uniform fibrations in cubical sets]
\noten{we need to mention something in cubical sets.}
\end{example}


The next two sections, \cref{sec:ortf} and \cref{sec:remshe}, study categories of right maps (in the sense of~\cref{def:right-map}), and strong homotopy equivalences (in the sense of~\cref{def:strhe}), respectively, obtaining some results that will be used in our study of uniform fibrations in subsequent sections.
In particular, the results in \cref{sec:ortf} will be applied to both categories of trivial uniform fibrations and to categories of uniform fibrations, since both are defined as categories of right maps.


\section{Remarks on categories of orthogonal maps}
\label{sec:ortf}

The aim of this section is to establish some general facts regarding categories of right maps that will be useful in the remainder of the paper.
Most of these facts are expected counterparts of well-known statements for classes of weakly orthogonal classes in the non-algebraic setting.

Let us fix a category $\catE$.
First of all, recall from~\cite{garner:small-object-argument} that the function mapping a functor $u \co \cal{I} \to \catE^\to$ to its right orthogonal $\liftr{u} \co \liftr{\cal{I}} \to \catE^\to$ defines the action on objects of a functor
\[
  \liftr{\brarghole} \co (\CAT/\catE^\to)^{\op} \to \CAT/\catE^\to \rlap{.}
\]
In view of its use in the proof of~\cref{thm:orth-nat}, let us recall the action of this functor on arrows,
\begin{align*}
\xymatrix{
  \cal{I} \ar[dr]_u \ar[rr]^F & & \cal{J} \ar[dl]^{v} \\
  & \catE^\to
}
&&
\xymatrix{
  \ar@{}[d]|{\textstyle\longmapsto} \\
  {}
}
&&
\xymatrix{
  \liftr{\cal{J}} \ar[dr]_{\liftr{u}} \ar[rr]^{\liftr{F}} & & \liftr{\cal{J}} \ar[dl]^{\liftr{v}} \\
  & \catE^\to \rlap{,}
}
\end{align*}
is defined as follows.
For $(f, \phi) \in \liftr{\cal{J}}$, we let $\liftr{F}(f,\phi) \defeq (f, \phi_F)$, where $\phi_F(i, s, t) \defeq \phi(Fi, s, t)$.
As shown in~\cite[Proposition~3.8]{garner:small-object-argument}, analogously to the way in which standard orthogonality operations form a Galois connection, the orthogonality functors form an adjunction,
\begin{equation} \label{garner-adjunction}
\begin{gathered}
\xymatrix@C+2em{
  \CAT/\catE^\to
  \ar@<5pt>[r]^-{\liftl{\brarghole}}
  \ar@{}[r]|-{\bot}
&
  (\CAT/\catE^\to)^{\op} \rlap{.}
  \ar@<5pt>[l]^-{\liftr{\brarghole}}
}
\end{gathered}
\end{equation}
Most of the results in this section are easy extensions to the ortogonality functors of well-known properties of the orthogonality operations and therefore are probably known to experts.
However, we could not find a reference for them and hence we include them for completeness.
We omit the most straightforward proofs.


\subsection*{Natural transformations}

We begin with a simple observation.

\begin{proposition} \label{thm:orth-nat}
Consider a natural transformation between categories over $\catE^\to$,
\[
\xymatrix{
  \cal{I}
  \rrtwocell_G^F{\sigma}
 \ar[dr]_{u}
&&
  \cal{J}
  \ar[dl]^{v}
\\&
  \catE^\to \rlap{,}
}
\]
satisfying in particular the condition that $v \sigma = \id_u$.
Then $\liftr{F} = \liftr{G}$ and $\liftl{F} = \liftl{G}$,
\begin{align*}
\xymatrix{
  \liftr{\cal{I}}
  \ar[dr]_{\liftr{u}}
&&
  \liftr{\cal{J}}
  \lltwocell_{\liftr{F}}^{\liftr{G}}{=}
  \ar[dl]^{\liftr{v}}
\\&
  \catE^\to
}
&&
\xymatrix{
  \liftl{\cal{I}}
  \ar[dr]_{\liftl{u}}
&&
  \liftl{\cal{J}}
  \lltwocell_{\liftl{F}}^{\liftl{G}}{=}
  \ar[dl]^{\liftl{v}}
\\&
  \catE^\to
}
\end{align*}
\end{proposition}

\begin{proof} Using the notation introduced above, for $(f, \phi) \in \liftr{\cal{J}}$, we have $\liftr{F}(f, \phi) = (f, \phi_F)$ and $\liftr{G}(f, \phi) = (f, \phi_G)$.
We claim that the functions $\phi_F$ and $\phi_G$ coincide.
Observe that for every $i \in \cal{I}$, we have that $\sigma_i \co v_{Fi} \to v_{Gi}$ is the identity square on $u_i \co A_i \to B_i$.
Hence, by the naturality condition for $\phi$, applied to the diagram
\[
\xymatrix{
  A_i \ar@{=}[r] \ar[d]_{v_{Fi}} & A_i \ar[d]^{v_{Gi}} \ar[r]^{s} & X \ar[d]^{f} \\
  B_i \ar@{=}[r] & B_i \ar[r]_{t} & Y
\rlap{,}}
\]
we have that $\phi_F(i, s, t) = \phi_G(i, s, t)$, as required.
\end{proof}

We now extend some useful facts about orthogonality operations to orthogonality functors.



\subsection*{Retract closure}

In the setting of non-algebraic weak orthogonality operations, it is well-known that applying the left (or right) orthogonality operation to a class of morphisms produces the same result as applying it to its retract closure.
In order to establish a counterpart of this fact, we need some definitions.
Given a functor $u \co \cal{I} \to \calE^\to$, we define its~\emph{retract closure} $\overline{u} \co \overline{\cal{I}} \to \catE^\to$ as follows.
An object of $\overline{\cal{I}}$ is a tuple~$(i, e, \sigma, \tau)$ consisting of an object $i \in \cal{I}$ and an object $e \in \catE^\to$ and maps $\sigma \co e \rightarrow u_i$ $\rho \co u_i \rightarrow e$ in $\catE^\to$ which exhibit $e$ as a retract of $u_i$ in $\catE^\to$, \ie such that
\[
\xymatrix{
  u_i \ar[r]^\rho \ar@{=}[dr] & e \ar[d]^{\sigma} \\
  & u_i
\rlap{.}}
\]
A map $(f, \kappa) \co (i, e, \sigma, \tau) \to (i', e', \sigma', \tau')$ in $\overline{\cal{I}}$ consists of a map $f \co i \to i'$ in $\cal{I}$ and a map $\kappa \co e \rightarrow e'$ in $\catE^\to$ such that the following diagram in $\catE^\to$ commutes:
\[
\xymatrix{
  e
  \ar[r]^{\sigma}
  \ar[d]_{\kappa}
&
  u_i
  \ar[r]^{\rho}
  \ar[d]^{u_f}
&
  e
  \ar[d]^{\kappa}
\\
  e'
  \ar[r]_{\sigma'}
&
  u_{i'}
  \ar[r]_{\rho'}
&
  e'
\rlap{.}}
\]
The functor $\overline{u} \co \overline{\cal{I}} \to \catE^\to$ is then defined on objects by letting $\overline{u}(i, e, \sigma, \tau) \defeq e$, and on maps by letting $\overline{u}(f, \kappa) \defeq \kappa$.
The operation of retract closure gives a monad: for $u \co \cal{I} \to \catE^\to$, the components of the multiplication and the unit,
\[
\begin{aligned}
  \mu_\cal{I} &\co \overline{\overline{\cal{I}}} \to \overline{\cal{I}}
\, , &
  \eta_\cal{I} &\co \cal{I} \to \overline{\cal{I}}
\end{aligned}
\]
are defined by letting
\[
\begin{aligned}
  \mu_\cal{I}((i, e, \sigma, \rho), e', \sigma', \rho') &\defeq (i, e', \sigma \cc \sigma', \rho' \cc \rho)
\, , &
  \eta_\cal{I}(i) &\defeq (i, u_i, \id_{u_i}, \id_{u_i})
\, .
\end{aligned}
\]

\begin{proposition} \label{retract-closure}
The orthogonality functors send the components of the unit and multiplication of the retract closure monad into natural isomorphisms, and so for every $u \co \cal{I} \to \catE^\to$, we have canonical isomorphisms of categories
\[
\begin{aligned}
  \liftr{(\overline{\cal{I}})} &\iso \liftr{\cal{I}}
\, ,&
  \liftr{(\overline{\overline{\cal{I}}})} &\iso \liftr{\overline{\cal{I}}}
\, ,&
  \liftl{(\overline{\cal{I}})} &\iso \liftl{\cal{I}}
\, ,&
 \liftl{(\overline{\overline{\cal{I}}})} &\iso \liftl{\overline{\cal{I}}}
\end{aligned}
\]
over $\catE^\to$.
\qed
\end{proposition}

\begin{remark}
Let $\ret$ denote the \emph{walking retract}, \ie the category with objects $\retA, \retB$ and morphisms generated by $s \co \retA \to \retB$ and $r \co \retB \to \retA$ under the relation $r \cc s = \id_{\retA}$.
The retract closure of $u \co \cal{I} \to \catE^\to$ fits into the following diagram, involving strict pullback and left composition:
\[
\xymatrix@C+1em{
  \overline{\cal{I}}
  \ar[r]
  \ar[d]_v
  \pullback{dr}
&
  \cal{I}
  \ar[d]^{u}
\\
  (\catE^\to)^{\ret}
  \ar[r]_-{(\catE^\to)^{\retB}}
&
  \catE^\to
}
\]
and $\bar{u}$ is the composite
\[
\xymatrix@C+1em{
  \overline{\cal{I}} \ar[r]^-v &  (\catE^\to)^\ret \ar[r]^-{(\catE^\to)^\retA} & \catE^\to }
\]
The unit and multiplication of the monad are induced by
\[
\begin{aligned}
  (\catE^\to)^{\canonical} &\co \catE^\to \to (\catE^\to)^{\ret}
\, ,&
  (\catE^\to)^{\Delta} &\co (\catE^\to)^{\ret \times \ret} \to (\catE^\to)^{\ret}
\rlap{,}
\end{aligned}
\]
respectively.
Let us also note that this part of construction works for any bipointed category.
\end{remark}

\subsection*{Slicing and coslicing}

In the classical setting it is well-known that the right orthogonality operation commutes with slicing, while the left orthogonality operation commutes with coslicing.
In order to prove a counterpart of this fact in our setting, we need some auxiliary definitions.
Given a functor $u \co \cal{I} \to \catE^\to$ and $X \in \catE$, we define the category $\cal{I}_{/X}$ and a functor $u_{/X} \co
\cal{I}_{/X} \to (\catE_{/X})^\to$ as follows.
The category $\cal{I}_{/X}$ has as objects pairs consisting of an object $i \in \cal{I}$ and a commutative triangle of the form
\[
\xymatrix{
  A_i \ar[dr] \ar[rr]^{u_i} & & B_i \ar[dl] \\
  & X \rlap{.}
}
\]
The functor $u_{/X} \co \cal{I}_{/X} \to (\catE_{/X})^\to$ sends such a pair to $u_i \co A_i \to B_i$, viewed as a morphism in~$\catE_{/X}$.
This category fits into the pullback diagram
\[
\xymatrix{
  \cal{I}_{/X}
  \ar[r]
  \ar[d]_{u_{/X}}
  \pullback{dr}
&
  \cal{I}
  \ar[d]^{u}
\\
  (\catE_{/X})^\to
  \ar[r]
&
  \catE^\to \rlap{,}
}
\]
where we used the functor on arrow categories induced by the forgetful functor $\operatorname{dom} \co \catE_{/X} \to \catE$.
Dually, taking the strict pullback along the map on arrows induced by the forgetful functor $\operatorname{cod} \co \catE_{\backslash X} \to \catE$ constructs the \emph{coslice} over $X$:
\[
\xymatrix{
 \cal{I}_{\backslash X}
  \ar[r]
  \ar[d]_{u_{\backslash X}}
  \pullback{dr}
&
  \cal{I}
  \ar[d]^{u}
\\
  (\catE_{\backslash X})^\to
  \ar[r]
&
  \catE^\to \rlap{,}
}
\]
which also admits an explicit description, dual to the one given above for $\cal{I}_{/X}$.
With these definitions in place, we can now state the counterpart in our setting of the familiar commutation between slicing and orthogonality operations.

\begin{proposition}\label{pitchfork-slicing}
\hfill
\begin{enumerate}[(i)]
\item The right orthogonality functor commutes with slicing, \ie for every $u \co \cal{I} \to \catE$, we have
\[
  \liftr{(\cal{I}_{/X})} = {\liftr{\cal{I}}}_{/X}
\]
as categories over $\catE^\to$.
\item The left orthogonality functor commutes with coslicing, \ie for every $u \co \cal{I} \to \catE$, we have
\[
  \liftl{(\cal{I}_{\backslash X})} = (\liftl{\cal{I}})_{ \backslash X}
\]
as categories over $\catE^\to$.
\qed
\end{enumerate}
\end{proposition}

\begin{proposition}
The retract closure commutes with slicing and coslicing, in the sense that for every $u \co \cal{I} \to \catE^\to$ we have
\[
\overline{\cal{I}_{/X}} = \overline{\cal{I}}_{/X}
\]
as categories over $\catE^\to$.
\qed
\end{proposition}

\subsection*{Adjunctions}

Next, we discuss the interaction between the orthogonality functors and adjunctions.
Let us fix an adjunction
\[
\xymatrix@C+1em{
  \catE
  \ar@<5pt>[r]^{F}
  \ar@{}[r]|{\bot}
&
  \cal{F}
  \ar@<5pt>[l]^{G} \rlap{.}
}
\]
In the non-algebraic setting, it is well known that if we have classes of maps $\cal{I} \subseteq \catE^\to$ and~$\cal{J} \subseteq \cal{F}^\to$, then $F(\cal{I}) \subseteq \liftl{\cal{J}}$ if and only if $\liftr{\cal{I}} \subseteq G(\cal{J})$, and thus $\liftr{F(\cal{I})} = G(\liftr{\cal{I}})$ and $\liftl{G(\cal{J})} = F(\liftl{\cal{J}})$.
The next proposition and corollary provide counterparts of these facts in our setting.

\begin{proposition} \label{lift-of-adjunction}
Let $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \cal{F}^\to$ be functors.
Then the following are equivalent:
\begin{enumerate}[(i)]
\item the functor $F \co \catE^\to \to \cal{F}^\to$ lifts to a functor $F \co \cal{I} \to \liftl{\cal{J}}$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \ar[r]^{F}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \catE^\to
  \ar[r]_-{F}
&
  \cal{F}^\to
\rlap{,}}
\]
\item the functor $G \co \cal{F}^\to \to \catE^\to$ lifts to a functor $G \co \cal{J} \to \liftr{\cal{I}}$, making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{J}
    \ar[d]_{v}
\ar[r]^{G}
&
  \liftr{\cal{I}}
  \ar[d]^{\liftr{u}}
\\
  \cal{F}^\to
   \ar[r]_{G}
&
  \catE^\to
\rlap{.}}
\]
\end{enumerate}
\end{proposition}

\begin{proof}
Giving a functor $F \co \cal{I} \to \liftl{\cal{J}}$ as above is the same thing as giving fillers for squares of the form
\[
\xymatrix{
  FA \ar[d]_{F u_i} \ar[r] & C \ar[d]^{v_j} \\
  FB \ar[r] & D \rlap{,}
}
\]
natural in $i \in \cal{I}$ and $j \in \cal{J}$.
Similarly, giving a functor $G \co \cal{J} \to \liftl{\cal{I}}$ as above is the same thing as giving fillers for squares of the form
\[
\xymatrix{
  A \ar[d]_{u_i} \ar[r] & GC \ar[d]^{Gv_j} \\
  B \ar[r] & GD \rlap{,}
}
\]
natural in $i \in \cal{I}$ and $j \in \cal{J}$.
Since $F$ is left adjoint to $G$, these situations coincide.
\end{proof}

\cref{lift-of-adjunction} implies that orthogonality functors commute with left composition with adjoints, as the next corollary makes precise.

\begin{corollary} \label{pitchfork-adjunction}
Let $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \cal{F}^\to$ be functors.
There are natural isomorphisms
\begin{align*}
\xycenter{
  \liftr{\cal{I}}
  \ar[dr]^-{\liftr{(F \cc u)}}
  \ar[d]_-{\liftr{u}}
\\
  \catE^\to
  \ar[r]_-G
&
  \catE^\to
\rlap{,}}
&&
\xycenter{
  \liftl{\cal{I}}
  \ar[d]_-{\liftl{v}}
  \ar[dr]^-{\liftl{(G \cc v)}}
\\
  \catE^\to
  \ar[r]_-{F}
&
  \catE^\to
\rlap{.}}
\end{align*}
\end{corollary}

\begin{proof}
For the first isomorphism, apply the adjunction in~\eqref{garner-adjunction} to the first diagram in \cref{lift-of-adjunction} and compare it with the second diagram.
The second isomorphism is obtained dually.
\end{proof}

\begin{example} \label{exa:composition-pullback-lift}
Recall that for an arrow $f \co X \to Y$, we have an adjunction
\[
\xymatrix{
\catE_{/X} \ar@<1ex>[r]^{f_{!}} \ar@{}[r]|{\bot} & \catE_{/Y} \rlap{,} \ar@<1ex>[l]^{f^*}}
\]
where the left adjoint is the left composition functor and the right adjoint is the pullback functor.
Given a functor $u \co \cal{I} \to \catE^\to$, it is immediate to check that the left composition functor lifts as follows:
\[
\xymatrix@C+1em{
  \cal{I}_{/X}
  \ar[r]^-{f_!}
  \ar[d]_{u_{/X}}
&
  \cal{I}_{/Y}
  \ar[d]^{u_{/Y}}
\\
  (\calE_{/X)}^\to
  \ar[r]_-{f_!}
&
  (\calE_{/Y})^\to \rlap{.}
}
\]
By \cref{lift-of-adjunction}, the pullback functor $f^* \co \catE_{/Y} \to \catE_{/X}$ then lifts to slices of the right orthogonality categories,
\[
\xymatrix@C=1.5cm{
   (\liftr{\cal{I}})_{/ Y}
 \ar[d]_{{\liftr{u}}_{/Y}}
  \ar[r]^{f^*}
&
  (\liftr{\cal{I}})_{/X}
 \ar[d]^{{\liftr{u}}_{/X}}
\\
 ({\catE}_{/Y})^\to
  \ar[r]_{f^*}
&
   (\catE_{/X})^\to \rlap{.}
}
\]
\end{example}

%\begin{question}
%In fact, $\liftr{C}/\text{--}$ is a Cartesian fibration (compare notes-on-awfs).
% Do we need that?
% \end{question}

\subsection*{Leibniz adjunctions}

We will now generalize \cref{lift-of-adjunction} to Leibniz adjunctions~\cite{riehl-verity:reedy}.
Let us fix bifunctors $F \co \cal{K} \times \catE \to \cal{F}$ and $G \co \cal{K}^{\op} \times \cal{F} \to \catE$ related pointwise for $k \in \cal{K}$ by an adjunction:
\[
\xymatrix@C+1em{
  \catE
  \ar@<5pt>[r]^{F(k, \arghole)}
  \ar@{}[r]|{\bot}
&
  \cal{F} \rlap{.}
  \ar@<5pt>[l]^{G(k, \arghole)}
}
\]
Assume that $\catE$ has pushouts and $\cal{F}$ has pullbacks.
Let
\[
\begin{aligned}
  \widehat{F} &\co \cal{K}^\to \times \catE^\to \to \cal{F}^\to
\, ,&
  \widehat{G} &\co (\cal{K}^{\op})^\to \times \cal{F}^\to \to \catE^\to
\end{aligned}
\]
denote the respective Leibniz constructions for $F$ and $G^{\op}$, using pullback instead of pushout for~$\widehat{G}$.
In the standard setting, it is well known that if we have classes of maps $\cal{I} \subseteq \catE^\to$ and $\cal{J} \subseteq \cal{F}^\to$, then for each $h \in \cal{K}^\to$ we have $\widehat{F}(h, \cal{I}) \subseteq \liftl{\cal{J}}$ if and only if $\liftr{\cal{I}} \subseteq \widehat{G}(h, \cal{J})$, and consequently $\liftr{F(h, \cal{I})} = G(h, \liftr{\cal{I}})$ and $\liftl{G(h, \cal{J})} = F(h, \liftl{\cal{J}})$.
The next proposition and corollary provide counterparts of these facts in our setting.

\begin{proposition} \label{lift-of-leibniz-adjunction}
Let $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \cal{F}^\to$ be functors.
Then the following are equivalent for $h \co X \to Y$ in $\cal{K}$:
\begin{enumerate}[(i)]
\item liftings $F' \co \cal{I} \to \liftl{\cal{J}}$ of the functor $\widehat{F}(h, \arghole) \co \catE^\to \to \cal{F}^\to$ making the following diagram commute:
\[
\xymatrix@C=1.2cm{
  \cal{I}
  \ar[r]^{F'}
  \ar[d]_{u}
&
  \liftl{\cal{J}}
  \ar[d]^{\liftl{v}}
\\
  \catE^\to
  \ar[r]_-{\widehat{F}(h, \arghole)}
&
  \cal{F}^\to
\rlap{,}}
\]
\item liftings $G' \co \cal{J} \to \liftr{\cal{I}}$ of the functor $\widehat{G}(h, \arghole) \co \cal{F}^\to \to \catE^\to$ making the following diagram commute:
\[
\xymatrix@C+2em{
    \cal{J}
      \ar[d]_{v}
      \ar[r]^{G'}
&
  \liftr{\cal{I}}
    \ar[d]^{\liftr{u}}
\\
  \cal{F}^\to
   \ar[r]_-{\widehat{G}(h, \arghole)}
&
  \catE^\to
\rlap{,}}
\]
\end{enumerate}
\end{proposition}

\begin{proof}
Giving a functor $F' \co \cal{I} \to \liftl{\cal{J}}$ as above is the same thing as giving fillers for diagrams of the form
\[
\xymatrix@C+2em{
  F(X,B) +_{F(X,A)} F(Y,A)
  \ar[d]_{\widehat{F}(h, u_i)}
  \ar[r]
&
  C_j
  \ar[d]^{v_j}
\\
  F(Y, B)
  \ar[r]
&
  D_j \rlap{,}
}
\]
natural in $i \in \cal{I}$ and $j \in \cal{J}$.
Similarly, giving a functor $G' \co \cal{J} \to \liftl{\cal{I}}$ as above is the same thing as giving fillers for squares of the form
\[
\xymatrix@C+2em{
  A_i
  \ar[d]_{u_i}
  \ar[r]
&
  G(Y, C)
  \ar[d]^{\widehat{G}(h, v_j)}
\\
  B
  \ar[r]
&
  G(Y,D) \times_{G(X,D)} G(X,D) \rlap{,}
}
\]
natural in $i \in \cal{I}$ and $j \in \cal{J}$.
Since $F(X, \arghole) \dashv G(X, \arghole)$ and $F(Y, \arghole) \dashv G(Y, \arghole)$, a diagram chasing argument typical of Leibniz constructions shows that these situations coincide.
\end{proof}

\cref{lift-of-leibniz-adjunction} can be expressed equivalently as orthogonality functors commuting with left composition with Leibniz adjoints.

\begin{corollary} \label{pitchfork-leibniz-adjunction}
Let $u \co \cal{I} \to \catE^\to$ and $v \co \cal{J} \to \cal{F}^\to$ be functors.
There are natural isomorphisms
\begin{align*}
\xymatrix@C+1em{
  \liftr{\cal{I}}
  \ar[dr]^-{\liftr{(\widehat{F}(h, -) \cc u)}}
  \ar[d]_-{\liftr{u}}
\\
  \catE^\to
  \ar[r]_-{\widehat{G}(h, -)}
&
  \catE^\to
\rlap{,}}
&&
\xymatrix@C+1em{
  \liftl{\cal{I}}
  \ar[d]_-{\liftl{v}}
  \ar[dr]^-{\liftl{(\widehat{G}(h, -) \cc v)}}
\\
  \catE^\to
  \ar[r]_-{\widehat{F}(h, -)}
&
  \catE^\to
\rlap{.}}
\end{align*}
\end{corollary}

\begin{proof}
For the first isomorphism, apply the adjunction in~\eqref{garner-adjunction} to the first diagram in \cref{lift-of-leibniz-adjunction} and compare it with the second diagram.
The second isomorphism is obtained dually.
\end{proof}

Note that \cref{lift-of-adjunction,pitchfork-adjunction} can be seen as special cases of \cref{lift-of-leibniz-adjunction,pitchfork-leibniz-adjunction} where $\cal{K}$ is the terminal category.

\begin{remark} \label{pitchfork-leibniz-most-general-example}
In \cref{lift-of-leibniz-adjunction} or \cref{pitchfork-leibniz-adjunction}, let $\cal{K}$ be the category of adjunctions $U \dashv V$ with $U \co \catE \to \cal{F}$ and $V \co \cal{F} \to \catE$.
A morphism from $U_1 \dashv V_1$ to $U_2 \dashv V_2$ consists of natural transformations $u \co U_1 \to U_2$ and $v \co V_2 \to V_1$ forming mates.
Note that we have fully faithful forgetful functors $\cal{K} \to [\catE, \cal{F}]$ and $\cal{K} \to [\cal{F}, \catE]^{\op}$.
We have functors $F \co \cal{K} \times \catE \to \cal{F}$ and $G \co \cal{K}^{\op} \times \cal{F} \to \catE$ given by left and right adjoint application, respectively.
This is, in some sense, the most general instantiation of \cref{lift-of-leibniz-adjunction}.
\end{remark}

\medskip

If $\interval \otimes (-)$ has a right adjoint, we obtain a \emph{functorial cocylinder} $(\exp(\interval, -), \bar{\delta}^0, \bar{\delta}^1)$ \notec{Fix notation}, \ie a functorial cylinder in the opposite category $\catE^{\op}$~\cite{kamps-porter:homotopy}.
We obtain a functor $[\bar{\delta}^k, -]$, defined in terms of a pullback, dual to $\kcyl \hatotimes (-)$, which was defined in terms of a pushout, for~$k \in \braces{0, 1}$.
These form an adjunction as follows:
\[
\xymatrix@C+4em{
  \catE^\to \ar@<1ex>[r]^{\kcyl \hatotimes (-)} \ar@{}[r]|{\bot} &
  \catE^\to \rlap{.} \ar@<1ex>[l]^{\hatexp(\bar{\delta}^k, -)}
}
\]
For a functor $u \co \cal{I} \to \catE^\to$, we can apply the results obtained above to characterize uniform $\cal{I}$-fibrations, which we introduced in \cref{def:I-fibration}, in terms of right $\cal{I}$-maps.

\begin{proposition} \label{prod-exp-general}
For every map $p \co X \to Y$ in $\catE$, the following are equivalent:
\begin{enumerate}[(i)]
\item $p$ admits the structure of a uniform $\cal{I}$-fibration.
\item $\hatexp(\bar{\delta}^0, p)$ and $\hatexp(\bar{\delta}^1, p)$ admit the structure of right $\cal{I}$-maps.
\end{enumerate}
\end{proposition}

\begin{proof}
First recall that the right orthogonality functor is contravariant and part of the adjunction~\eqref{garner-adjunction}, hence sends coproducts to products of categories over $\catE^\to$.
The remainder of the claim follows from \cref{pitchfork-leibniz-adjunction} as applied in \cref{pitchfork-leibniz-most-general-example} and the preceeding discussion.
\end{proof}

\subsection*{Kan extensions}

We now establish some general facts about the interaction between orthogonality functors and left Kan extensions, which will be applied in \cref{sec:unifpc} to show that uniform (trivial) Kan fibrations are the right maps of a natural weak factorisation system.

\begin{proposition} \label{kan-extension-closure}
Let $F \co \cal{I} \to \cal{J}$ be a fully faithful functor.
\begin{enumerate}[(i)]
\item Assume that the pointwise left Kan extension of $u \co \cal{I} \to \catE^\to$ along $F$ exists
\[
\xymatrix{
  \cal{I}
  \ar[dr]_{u}
  \ar[rr]^{F}
&&
  \cal{J}
  \ar[dl]^{\Lan_F u}
\\&
  \catE^\to \rlap{.}
}
\]
Then the functor $\liftr{F} \co \liftr{\cal{J}} \to \liftr{\cal{I}}$, fitting in the diagram
\[
\xymatrix{
  \liftr{\cal{I}}
  \ar[dr]_{\liftr{u}}
&&
  \liftr{\cal{J}}
  \ar[ll]_{\liftr{F}}
  \ar[dl]^{\liftr{(\Lan_F u)}}
\\&
  \catE^\to
}
\]
is an isomorphism.
\item Assume that the pointwise right Kan extension of $u \co \cal{I} \to \catE^\to$ along $F$ exists
\[
\xymatrix{
  \cal{I}
  \ar[dr]_{u}
  \ar[rr]^{F}
&&
  \cal{J}
  \ar[dl]^{\Ran_F u}
\\&
  \catE^\to \rlap{.}
}
\]
Then the functor $\liftl{F} \co \liftl{\cal{J}} \to \liftl{\cal{I}}$, fitting in the diagram
\[
\xymatrix{
  \liftl{\cal{I}}
  \ar[dr]_{\liftl{u}}
&&
  \liftl{\cal{J}}
  \ar[ll]_{\liftl{F}}
  \ar[dl]^{\liftl{(\Ran_F u)}}
\\&
  \catE^\to
}
\]
is an isomorphism.
\qed
\end{enumerate}
\end{proposition}


\section{Remarks on strong homotopy equivalences}
\label{sec:remshe}

The aim of this section is to develop some general results on strong homotopy equivalences, which we introduced in \cref{def:strhe}.
The main result, \cref{strong-h-equiv-as-section}, is a characterisation of strong homotopy equivalences as particular sections.
This characterisation leads to the proof of two results, \cref{lem:from-strong-hequiv} and \cref{lem:to-strong-hequiv}, that will play an important role in our study of the Frobenius and Beck-Chevalley conditions for uniform fibrations in \cref{sec:frocuf}.

Let $\catE$ be a category with finite colimits equipped with a functorial cylinder $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$.
Our first goal is to give an alternative characterisation of strong left or right homotopy equivalences.
For this, we need some definitions.
Let $0_\catE \co \catE \to \catE$ be the functor with constant value the initial object $0 \in \catE$, and let $\bot \co 0_\catE \rightarrow \Id_\catE$ be the natural transformation with components given by the unique maps $\bot_X \co 0 \to X$.
Observe that for every $f \co X \to Y$, we have an isomorphism
\begin{equation}
\label{equ:bot-hatotimes-f}
\bot \hatotimes f \iso f \, .
\end{equation}
For $k \in \braces{0, 1}$, we have a commutative square of functors and natural transformations
\[
\xymatrix@C+2em{
  0_\catE
  \ar[r]^{\bot}
  \ar[d]_{\bot}
&
  \id_\catE
  \ar[d]^{\rcyl \otimes (-)}
\\
  \id_\catE
  \ar[r]_{\lcyl \otimes (-)}
&
  \interval \otimes (-)
\rlap{.}}
\]
This diagram determines two maps in $[\catE, \catE]^\to$:
\begin{equation} \label{equ:thetas}
\begin{aligned}
  \thetal \otimes (-) &\co \bot \rightarrow \lcyl \otimes (-)
\, ,&
  \thetar \otimes (-) &\co \bot \rightarrow \rcyl \otimes (-) \rlap{,}
\end{aligned}
\end{equation}
which are defined by letting $\thetal \otimes (-) \defeq (\bot, \rcyl \otimes (-))$ and $\thetar \otimes (-) \defeq (\bot, \lcyl \otimes (-))$.
By functoriality of the Leibniz construction and the isomorphisms in~\eqref{equ:bot-hatotimes-f}, the maps in~\eqref{equ:thetas} give us two maps
\begin{equation*}
\begin{aligned}
  \thetal \hatotimes f &\co f \to \lcyl \hatotimes f
\, ,&
  \thetar \hatotimes f &\co f \to \rcyl \hatotimes f
\end{aligned}
\end{equation*}
in $\catE^\to$, which consist of squares of the form
\[
\xymatrix@C+3em{
  X
  \ar[r]^-{\inl \cc (\kcylinv \otimes X)}
  \ar[d]_{f}
&
  (\interval \otimes X) +_{X} Y \ar[d]^{\kcyl \hatotimes f}
\\
  Y
  \ar[r]_-{\kcylinv \otimes Y}
&
  \interval \otimes Y
\rlap{,}}
\]
for $k \in \braces{0, 1}$.
We use these maps to provide the following characterization of strong homotopy equivalences.

\begin{lemma} \label{strong-h-equiv-as-section}
For $k \in \braces{0, 1}$, the category $\cal{S}_k$ of strong (left or right) homotopy equivalences in $\catE$ can isomorphically be described as the category of arrows $f \in \catE^{\to}$ with a retraction $\rho$ to $\thetak \hatotimes f$.
In detail,
\begin{enumerate}[(i)]
\item objects are pairs $(f, \rho)$ consisting of $f \in \catE^\to$ and a retraction $\rho$ to $\thetak \hatotimes f$, as below:
\[
\xymatrix@C+2em{
  f
  \ar[r]^-{\thetak \hatotimes f}
  \ar@{=}[dr]
&
  \kcyl \hatotimes f \ar[d]^{\rho}
\\&
  f
\rlap{,}}
\]
\item morphisms $\tau \co (f, \rho) \to (f', \rho')$ are maps $\tau \co f \to f'$ such that the below diagram commutes:
\[
\xymatrix@C+2em{
  \kcyl \hatotimes f
  \ar[d]_-{\rho}
  \ar[r]^{\kcyl \hatotimes \tau}
&
 \kcyl \hatotimes f'
  \ar[d]^-{\rho'}
\\
  u_i
  \ar[r]_{\tau}
&
  u_{i'} \rlap{.}
}
\]
\end{enumerate}
\end{lemma}

\begin{proof}
We will only do the case $k = 0$ and the object part of the correspondence.
To say that $\thetal \hatotimes f \co f \to \lcyl \hatotimes f$ is a section means that there is retraction $\rho$, as follows:
\[
\xymatrix@C+3em{
  X
  \ar[r]^-{\inl \cc (\rcyl \otimes X)}
  \ar[d]_f
&
  (\interval \otimes X) +_{X} Y
  \ar[d]^{\lcyl \hatotimes f}
  \ar@{.>}[r]
&
  X
  \ar[d]^f
\\
  Y
  \ar[r]_-{\rcyl \otimes Y}
&
  \interval \otimes Y
  \ar@{.>}[r]
&
  Y
\rlap{,}}
\]
where the two horizontal composites should be identities.
First, by a standard diagram-chasing arguments, giving the square on the right is equivalent to giving maps $\phi \co \interval \otimes X \to X$, $g \co Y \to X$, $\psi \co \interval \otimes Y \to Y$ such that the following diagrams commute:
\begin{align} \label{equ:first-three}
\xycenter{
  X
  \ar[r]^-{\rcyl \otimes X}
  \ar[d]_f
&
  \interval \otimes X \ar[d]^{\phi}
\\
  Y \ar[r]_{g}
&
  X
\rlap{,}}
&&
\xycenter{
  Y
  \ar[r]^-{\rcyl \otimes Y}
  \ar[d]_g
&
  \interval \otimes Y \ar[d]^{\psi}
\\
  X
  \ar[r]_f
&
  B
\rlap{,}}
&&
\xycenter{
  \interval \otimes X
  \ar[d]_\phi
  \ar[r]^{I \otimes f}
&
  \interval \otimes Y
  \ar[d]^\psi
\\
  X
  \ar[r]_{f}
&
  Y
\rlap{.}}
\end{align}
Second, requiring that the two horizontal composites are a section to $\thetar \hatotimes f$ means that the diagrams
\begin{align} \label{equ:second-two}
\xycenter{
  X
  \ar[r]^-{\lcyl \otimes X}
  \ar@{=}[dr]
&
  \interval \otimes X \ar[d]^\phi
\\&
  X
\rlap{,}}
&&
\xycenter{
  Y
  \ar[r]^-{\lcyl \otimes Y}
  \ar@{=}[dr]
&
  \interval \otimes Y \ar[d]^{\psi}
\\&
  Y
}
\end{align}
commute.
With reference to \eqref{equ:homotopy}, the equations in~\eqref{equ:first-three} provide right endpoint for $\phi$, right endpoint for $\psi$, and strength for $\phi$, respectively; while the equations in~\eqref{equ:second-two} provide left endpoints for $\phi$ and $\psi$, respectively.
\end{proof}

\begin{remark}
\cref{strong-h-equiv-as-section} implies that strong left or right homotopy equivalences are closed under retracts since functors preserve sections and sections are closed under retracts.
\end{remark}

For the remainder of this section, we fix $k \in \braces{0, 1}$ and identify the category $\cal{S}_k$ with the isomorphic category defined in \cref{strong-h-equiv-as-section}.

If the functorial cylinder is induced by tensoring with an interval object in a monoidal category, then \cref{strong-h-equiv-as-section} shows that strong left or right homotopy equivalences are closed under Leibniz tensoring from the right with arbitrary maps since functors preserve section-retraction pairs.
We have an analogue of this also in the general setting.

\begin{lemma} \label{leibniz-lift}
Assume that $\interval \otimes (-)$ preserves pushouts.
If $u : \cal{D} \to \catE^\to$ lifts through $\cal{S}_k \to \catE^\to$, then so does $\hat{\mathrm{ev}}(u, -) : \cal{D}^\to \to \catE^\to$.
\end{lemma}

\begin{proof}

\newcommand{\cchat}{\mathbin{\widehat{\cc}}}
\newcommand{\buhatE}{\mathbin{\widehat{\bullet}_\catE}}
\newcommand{\buhatD}{\mathbin{\widehat{\bullet}_{\cal{D}}}}

This is a formal argument in the theory of Leibniz constructions~\cite{riehl-verity:reedy}.
In order to make this argument more readable, we will use infix notation for several important bifunctors.
Let first $[\catE, \catE]'$ denote the pushout preserving endofunctors on $\catE$.
By assumption, we have that~$\thetak$ is a map in $[\catE, \catE]'^{\to}$.
We write $ {\cc}  \co [\catE, \catE]' \times [\cal{D}, \catE] \to [\cal{D}, \catE]$ for functor composition as well as~$\bullet_\catE \co [\catE, \catE]' \times \catE \to \catE$ and $\bullet_{\cal{D}} \co [\cal{D}, \catE] \times \cal{D} \to \catE$ for functor application (previously denoted $\mathrm{ev}$).
Of course, we have an isomorphism
\begin{equation} \label{leibniz-lift:0}
  (U \cc F) \bullet_{\cal{D}} X = U \bullet_\catE (F \bullet_{\cal{D}} X)
\end{equation}
natural $U \in [\catE, \catE]'$, $F \in [\cal{D}, \catE]$, and $X \in \cal{D}$.

Recall that $\catE$ has pushouts so that we have the Leibniz construction available and pushouts in the relevant functor categories are computed pointwise.
From~\eqref{leibniz-lift:0}, it follows that we have an isomorphism
\begin{equation} \label{leibniz-lift:1}
  (\thetak \cchat u) \bullet_{\cal{D}} X = \thetak \buhatE (u \bullet_{\cal{D}} X)
\end{equation}
natural in $X \in \cal{D}^\to$.
Since $\bullet_{\cal{D}} \co [\cal{D}, \catE] \times \cal{D} \to \catE$ and $\bullet_\catE : [\catE, \catE]' \times \catE \to \catE$ preserve pushouts in their first and second argument, respectively, it also follows that we have an isomorphism
\begin{equation} \label{leibniz-lift:2}
  (\thetak \cchat u) \buhatD f = \thetak \buhatE (u \buhatD f)
\end{equation}
natural in $f \in \cal{D}^\to$.

The assumption of $u \co \cal{D} \to \catE^\to$ lifting through $\cal{S}_k \to \catE^\to$ is equivalent to having a retraction to~$\thetak \buhatE (u \bullet_{\cal{D}} (-))$.
By~\eqref{leibniz-lift:1}, this map is isomorphic to~$(\thetak \cchat u) \bullet_{\cal{D}} (-) = \thetak \cchat u$.
The goal of $u \buhatD (-) \co \cal{D}^\to \to \catE^\to$ lifting through $\cal{S}_k \to \catE^\to$ is equivalent to a retraction to the 
map~$\thetak \buhatE (u \buhatD (-))$.
By~\eqref{leibniz-lift:2}, this map is isomorphic to $(\thetak \cchat u) \buhatD (-)$.
But functors, in this case~$m \mapsto m \buhatD (-)$, preserve section-retraction pairs.
\end{proof}

\cref{leibniz-lift} enables us to characterise effective connections as follows.

\begin{corollary} \label{effective-connections-leibniz}
Assume that $\interval \otimes (-)$ preserves pushouts.
Then the functorial cylinder has effective connections if and only if $\lcyl \hatotimes f$ and $\rcyl \otimes f$ are strong left and right homotopy equivalences, respectively, naturally in $f \co \catE^\to$, or formally, for $k \in \braces{0, 1}$, the functor $\kcyl \hatotimes (-) \co \catE^\to \to \catE^\to$ lifts through the forgetful functor $\cal{S}_k \to \catE^\to$. \qed
\end{corollary}

\begin{remark}[Fillers and compositions] \label{thm:retraction-for-connections}
Assume that $\interval \otimes (-)$ preserves pushouts.
By \cref{effective-connections-leibniz}, the functorial cylinder has effective connections if and only if, for $k \in \braces{0, 1}$, there exists a natural transformation $\rho \co \kcyl \hatotimes \kcyl \hatotimes (-) \to \kcyl \hatotimes (-)$ in the arrow category whose components provide retractions as follows:
\begin{equation} \label{retraction-for-connections:0}
\xymatrix@C+3em{
  \kcyl \hatotimes f
  \ar[r]^-{\thetak \hatotimes \kcyl \hatotimes f}
  \ar@{=}[dr]
&
  \kcyl \hatotimes \kcyl \hatotimes f
  \ar[d]^{\rho_f}
\\&
  \kcyl \hatotimes f
\rlap{.}}
\end{equation}
This retract situation is the categorical reason why Coquand \etal\cite{coquand-variation} are able to, in their teminology, reduce filling for L-systems to composition.
Translating to our language, an \emph{L-system} is a lifting problem of the form $\kcyl \hatotimes f \to p$.
A \emph{filling} consists of a diagonal filler for that square.
A \emph{composition} consists of a diagonal filler for the composite square $f \to \kcyl \hatotimes f \to p$ obtained by prefixing $\theta^k \hatotimes f$.
Using the retract situation of \eqref{retraction-for-connections:0}, filling for a lifting problem $\kcyl \hatotimes f \to p$ reduces to composition for $\kcyl \hatotimes \kcyl \hatotimes f \to p$.
Uniformity in the sense of~\cite{coquand-variation} means Cartesian naturality in $f$.
\end{remark}

Let now $u \co \cal{I} \to \catE^\to$ be a functor.
For $k \in \braces{0, 1}$, we denote $\cal{S}_k(u) \co \cal{S}_k(\cal{I}) \to \catE^\to$ the category of strong (left or right) homotopy equivalences relative to $\cal{I}$.
It is induced by the following strict pullback of categories:
\[
\xymatrix{
  \cal{S}_k(\cal{I})
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  \cal{I}
  \ar[d]^{u}
\\
  \cal{S}_k
  \ar[r]
&
  \catE^\to
}
\]
This means that an object of $\cal{S}_k(\cal{I})$ consists of an object $i \in \cal{I}$ together with data $(g, \phi, \psi)$ making~$u_i$ into a strong (left or right) homotopy equivalence.

For the remainder of this section, we fix $k \in \braces{0, 1}$ and identify the category $\cal{S}_k$ with the isomorphic category defined in \cref{strong-h-equiv-as-section}.
Under this identification, an object of $\cal{S}_k(\cal{I})$ consists of an object $i \in \cal{I}$ together with a retraction to $\thetak \hatotimes u_i$.
We are now going to relate strong homotopy equivalences relative to $\cal{I}$ with the components of $\cal{I}_\otimes$.

\begin{lemma} \label{lem:from-strong-hequiv}
There is a functor
\[
\xymatrix@!C{
  \cal{S}_k(\cal{I})
  \ar[dr]_{\cal{S}_k(u)}
  \ar[rr]^{L_k}
&&
  \overline{\cal{I}}
  \ar[dl]^-{\overline{\kcyl \hatotimes u}}
\\&
  \catE^\to
\rlap{.}}
\]
\end{lemma}

\begin{proof}
We only describe the action of the functor $L$ on an object $(i, \rho)$, leaving the evident definition of the action on arrows to the reader.
Recall that $\rho$ is a retraction to $\thetak \hatotimes u_i \co u_i \to \kcyl \hatotimes u_i$, exhibiting $u_i$ as a retract of $\kcyl \hatotimes u_i$.
%Observe that $u_i \co A_i \to B_i$ is a retract of~$\kcyl \hatotimes u_i \co (\interval \otimes A_i) +_{A_i} B_i \to \interval \otimes B_i$ via the diagram
%\[
%\xymatrix@C+1em{
%  A_i \ar[d]_{u_i} \ar[r] & (\interval \otimes A_i) +_{A_i} B_i \ar[r] \ar[d]^{\kcyl \hatotimes u_i } & A_i \ar[d]^{u_i} \\
%  B_i \ar[r] & \interval \otimes B_i \ar[r] & B_i \rlap{,}}
%\]
%where the left square is $\thetak \hatotimes u_i$ and right square is given by $\rho$.T
%\notec{I think having this diagram is more confusing than illuminating. We have already reached a level of abstraction at the arrow category that permits to forget about the gory details underneath.}
Thus, we may define $L(i, \rho) \defeq (i, u_i, \thetak \hatotimes u_i, \rho)$.
Observe that this definition makes the diagram for $L$ commute.
\end{proof}

\begin{lemma} \label{lem:to-strong-hequiv}
Assume that $\cal{I}$ is closed under Leibniz tensor with $\kcyl$ in the sense of the functor $\kcyl \hatotimes (-) \co \catE^\to \to \catE^\to$ lifting as follows:
\begin{equation}
\label{to-strong-hequiv:0}
\begin{gathered}
\xymatrix@C+2em{
  \cal{I}
  \ar[d]_u
  \ar@{.>}[r]^{\kcyl \hatotimes (-)}
&
  \cal{I}
  \ar[d]^{u}
\\
  \catE^\to
  \ar[r]_{\kcyl \hatotimes (-)}
&
  \catE^\to
\rlap{.}}
\end{gathered}
\end{equation}
Assume further that the functorial cylinder has effective connections.
Then there is a functor
\[
\xymatrix@!C{
  \cal{I}
  \ar[dr]_{\kcyl \hatotimes u} \ar[rr]^{M_k}
&&
  \cal{S}_k(\cal{I})
  \ar[dl]^{\cal{S}_k(u)}
\\&
   \catE^\to
\rlap{.}}
\]
\end{lemma}

\begin{proof}
As before, we describe the functor $M$ only on objects.
In order to guarantee that the diagram to commutes, we send $i \in \cal{I}$ to a pair of the form $(\kcyl \hatotimes i, \rho)$, using the assumption~\eqref{to-strong-hequiv:0} that $\kcyl \hatotimes (-)$ lifts to $\cal{I}$.
Here, $\rho$ has to be a retraction to $\thetak \hatotimes u_{\kcyl \hatotimes i}\, ,$ which equals $\thetak \hatotimes \kcyl \hatotimes u_i$ by~\eqref{to-strong-hequiv:0}.
But such a retraction is provided by the natural transformation $\rho$ of~\cref{thm:retraction-for-connections}.
We can then let $M(i) \defeq (\kcyl \hatotimes i, \rho_{u_i})$.
\end{proof}

\begin{remark}
Upon combining the cases $k = 0$ and $k = 1$ and passing to right orthogonality categories, \cref{lem:from-strong-hequiv,lem:to-strong-hequiv} induce functors
\[
\xymatrix@!C{
  \liftr{(\cal{S}_0(\cal{I}) + \cal{S}_1(\cal{I}))}
  \ar[dr]
  \ar@<4pt>[rr]^{\liftr{(M_0 + M_1)}}
&&
  \Fib[\cal{I}]
  \ar[dl]
  \ar@<4pt>[ll]^{\liftr{(L_0 + L_1)}}
\\&
  \catE^\to
}
\]
relating uniform $I$-fibrations with right maps for strong homotopy equivalences relative to $\cal{I}$ (note that the retract closure of \cref{lem:from-strong-hequiv} vanishes because of \cref{retract-closure}).
This will in general not be an isomorphism of categories over $\catE^\to$.
\end{remark}


\section{Uniform fibrations in presheaf categories}
\label{sec:unifpc}

The aim of this section is to study in more detail uniform fibrations in presheaf categories.
Let us fix a presheaf category $\catE = \Psh(\cat{C})$, where $\cat{C}$ is a small category.
We write $\yon \co \catC \to \catE$ for the Yoneda embedding.
We assume that $\catE$ is equipped with a functorial cylinder $( \interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ and that the endofunctor $ \interval\otimes (-) \co \catE \to \catE$ has a right adjoint, so that we can apply \cref{prod-exp-general}.

\subsection*{Small generating categories for fibrations}

Recall from \cref{exa-triv-kan-fib} that, in a presheaf category $\catE$, we defined the category of uniform trivial fibrations
$\TrivFib$ and the category of uniform fibrations $Fib$ by letting
\[
\begin{aligned}
  \TrivFib &\defeq \liftr{\cal{M}}
\, ,&
  \Fib &\defeq \liftr{(\cal{M}_\otimes)}
\rlap{,}
\end{aligned}
\]
\notec{Brackets needed here and elsewhere? Compare with $\liftr{\cal{M}_\otimes}$. Or is $\cal{M}_\otimes^\pitchfork$ preferrable?}
respectively, where $\cal{M}$, is the subcategory of $\catE^\to$ consisting of decidable monomorphisms and pullback squares.
Our main result is that these categories can be also be defined as the right orthogonal with respect to categories over
$\catE$ that are small.

\begin{lemma} \label{left-kan-extension-of-representables}
Let $\cal{J}$ be a full subcategory of $\catE_{\cart}^\to$ closed under pullbacks along morphisms with codomain a representable presheaf.
Let $\cal{I}$ denote its restriction to arrows into representables.
\[
\xymatrix{
  \cal{I}
  \ar[rr]
  \ar[dr]
&&
  \cal{J}
  \ar[dl]
\\&
  \catE^\to
}
\]
Then the inclusion $\cal{J} \to \catE^\to$ is the left Kan extension of $\cal{I} \to \catE^\to$ along $\cal{I} \to \cal{J}$.
\end{lemma}

\begin{proof}
Since $\catE^\to$ is cocomplete, we can verify the claim using the colimit formula for left Kan extensions.
All of the following will be functorial in an object $j \co A \to B$ of $\cal{J}$.
We consider the diagram indexed by pullback squares of the form
\[
\xymatrix@C=1.2cm{
  A'
  \ar[r]
  \ar[d]_{i}
  \pullback{dr}
&
  A
  \ar[d]^{j}
\\
  \yon(x)
  \ar[r]_-b
&
  B
}
\]
with $i \co A' \to \yon(x)$ in $\cal{I}$ and valued $i$.
Our goal is to show that its colimit of this diagram in $\catE^\to$ is $j$.
Using the assumption that $\cal{J}$ is closed under pullback to representables, the given diagram can be described equivalently as the the diagram indexed by maps $b \co \yon(x) \to B$ and valued $b^*(j)$.
The claim can then be restated as $\colim_{b \co \yon(x) \to B} b^*(j) \iso j$, which holds since pullback commutes with colimits in presheaf categories, and $\colim_{b \co \yon(x) \to B} \yon(x) \iso B$.
\end{proof}

\begin{remark}
It would be of interest to prove \cref{left-kan-extension-of-representables} by combining the codomain fibration and the corresponding left Kan extension claim for the codomain part
\[
\xymatrix{
  \cat{C}
  \ar[rr]^{y}
  \ar[dr]_{y}
&&
  \hat{\catC}
  \ar[dl]^{\id}
\\&
  \hat{\cat{C}}
\rlap{,}}
\]
which holds by the co-Yoneda lemma.
\end{remark}

\begin{proposition} \label{awfs-on-arrows-into-representables}
Let~$\cal{J}$ be a full subcategory of $\catE_{\cart}^\to$ closed under base change to representables.
Let $\cal{I}$ denote its restriction to arrows into representables,
\[
\xymatrix{
  \cal{I}
  \ar[rr]
  \ar[dr]
&&
  \cal{J}
  \ar[dl]
\\&
  \catE^\to
\rlap{.}}
\]
Then $\liftr{\cal{I}} = \liftr{\cal{J}}$.
\end{proposition}

\begin{proof}
The result follows by combining part~(i) of \cref{kan-extension-closure} and \cref{left-kan-extension-of-representables}.
\end{proof}

\begin{theorem} \label{small-gen-triv-kan} Let $\cal{N}$ be the full subcategory of $\cal{M}$ spanned by the mononorphisms with a representable presheaf as codomain.
\begin{enumerate}[(i)]
\item There is an isomorphism $\TrivFib = \liftr{\cal{N}}$,
\item There is an isomorphism $\Fib = \liftr{(\cal{N}_\otimes)}$.
\end{enumerate}
\end{theorem}

\begin{proof} Part (i) follows from \cref{awfs-on-arrows-into-representables}.
Part (ii) follows from part (i) and \cref{prod-exp-general}.
\end{proof}

In particular, part (i) of \cref{small-gen-triv-kan} says that, for a map $f \co X \to Y$ in $\catE$, to give a natural choice of fillers for all diagrams with an arbitrary monomorphism on the right-hand side is the same as to give a choice of fillers for all diagrams of the form
\[
\xymatrix{
A \ar[r] \ar[d] & X \ar[d]^f \\
\yon(x) \ar[r] & Y \rlap{,} }
\]
where $\yon(x)$ the Yoneda embedding of some $x \in \catC$.
The reduction to this type of diagrams relies essentially on the good behaviour of the orthogonality functors with respect to colimits, as described in~\cref{awfs-on-arrows-into-representables}.

\medskip

Let us point out that we have that $\TrivFib = \liftr{\cal{S}}$ for every full subcategory $\cal{S} \subseteq \cal{M}$ containing~$\cal{N}$, since~$\cal{N}$ is the restriction to maps into representables of $\cal{M}$.
In particular, one could consider for
$\cal{S}$ the full subcategory of $\cal{M}$ spaned by decidable monomorphisms with codomain a finite product of representables or, in the case of simplicial sets, decidable monomorphisms with codomain a finite and finite-dimensional simplicial set.
These subcategories have better closure properties than $\cal{N}$, but $\cal{N}$ has the key advantage of being a small category.
We will expoit this fact to obtain our first main results, \cref{thm:ac-kan-is-uniform} and \cref{thm:sset-cset-nwfs}, in the rest of this section.

\subsection*{Comparison with non-uniform fibrations}

In this section, the only one in which the law of excluded middle and the axiom of choice are assumed, we study the notion of a uniform (trivial) fibration in the context of presheaf categories over elegant Reedy presheaves, in the sense of \cite{bergner-rezk-elegant}, equipped with a functorial cylinder whose endofunctor has a right adjoint.
In particular, we introduce the non-algebraic notion of a (trivial) fibration and fibration in that setting, essentially generalising in a straightforward way the definitions of the notion of a (trivial) Kan fibration in simplicial sets.
We then show that every (trivial) fibration admits the structure of a uniform (trivial) fibration, thereby establishing how our notions relate to more familiar ones in the presence of the axiom of choice.

\medskip

Let us begin by reviewing some terminology.
Recall that a \emph{Reedy category} $(\R, \deg, \Rp, \Rm)$ is a category $\R$ equipped with a \emph{degree function} $\deg \co \obj(\R) \to \alpha$, where $\alpha$ is some ordinal, and wide subcategories $\Rp, \Rm$ satisfying the following properties:
\begin{enumerate}[(i)]
\item the maps of $\Rp$, called \emph{cofaces}, are monotone with respect to $\deg$,
\item the maps of $\Rm$, called \emph{codegeneracies}, are antimonotone with respect to $\deg$,
\item every map in $\R$ is assumed to factor uniquely as a codegeneracy followed by a coface.
\end{enumerate}
Recall that these properties imply that $\R$ is skeletal.
For every degree $n < \alpha$, we have a \emph{skeleton} comonad $\Sk_n$ and a \emph{coskeleton} monad $\Cosk_n$ on $\catE = \Psh(\R)$ (both idempotent) forming an adjunction $\Sk_n \dashv \Cosk_n$ derived from left and right Kan extension along the full embedding $\R_{<n} \to \R$ of objects of degree less than $n$ (note the index shift contrary to the usual convention in the literature).

\medskip

Next, recall from~\cite{bergner-rezk-elegant} that a Reedy category $\R$ is called \emph{elegant} if every element in any presheaf on $\R$ is a degeneracy in a unique way.
For example, the categories $\Delta$ and $\square$ are elegant Reedy category. 
In an elegant Reedy category $\R$, the action of $\Sk_n$ can be described as keeping only the non-degenerate elements of degree strictly less than $n$: for any $X \in \Psh(\R)$, the counit $\Sk_n(X) \to X$ of the skeleton comonad on $X$ is a monomorphism.
Given $A \in \R$, the \emph{boundary} of $A$ is defined as $\partial A \defeq \Sk_{\deg(A)}(\yon A)$.
The counit of $\Sk_{\deg(A)}$ induces a \emph{boundary inclusion} monomorphism $i^A \co \partial A \to \yon A$.

\medskip

For the remainder of this section, we fix an elegant Reedy category $\R$ and consider the category of presheaves over it, $\calE \defeq \Rhat$. Note that the our presheaves are valued in the category of sets, while the presheaves over an elegant Reedy category considered in~\cite{shulman:reedy} are valued in simplicial sets.  We will first establish the classical equivalence of trivial fibrations and uniform trivial fibrations.
Note that \cref{awfs-on-arrows-into-representables} cannot be applied here since the class of boundary inclusions as a discrete category does not represent the added coherence of $\cal{N}$.

\begin{definition} \hfill
\begin{enumerate}[(i)]
\item A \emph{trivial fibration} is a right $\cal{I}$-map, where $\cal{I}$ is the discrete subcategory of $\catE^{\to}$ consisting of boundary inclusions $\partial A \to \yon A$.
\item A \emph{regular trivial fibration} is a right $\cal{J}$-map, where $\cal{J}$ is the subcategory of~$\catE^{\to}$ that has boundary inclusions $\partial A \to \yon A$ and identity maps $\id_{\yon A} \co \yon A \to \yon A$ as objects, and commutative squares
\[
\xymatrix{
  \partial A_1
  \ar[r]
  \ar[d]
&
  \yon A_2
  \ar[d]
\\
  \yon A_1
  \ar[r]_{\yon(d)}
&
  \yon A_2
}
\]
where $d$ in $\Rm$ and not an identity, as maps.
\end{enumerate}
\end{definition}

The notion of a regular trivial fibrations will be useful to relate trivial fibrations to uniform trivial fibrations.
Note that a regular trivial fibration is a map equipped with a filler for each boundary inclusion lifting problems such that degenerate lifting problems have degenerate fillers.

\begin{proposition} \label{trivial-fibration-to-regular} \hfill
\begin{enumerate}[(i)]
\item A map is a trivial fibration if and only if it has the right lifting property against boundary inclusions.
\item Every trivial fibration can be equipped with the structure of a regular trivial fibration.
\end{enumerate}
\end{proposition}

\begin{proof} Part (i) is an application of the axiom of choice\footnote{This will be the only use of choice in this section, the remainder of the classical development in this subsection relies only on the law of the excluded middle.}.
For part (ii), consider a lifting problem as follows:
\begin{equation} \label{trivial-fibration-to-regular:0}
\xymatrix{
  \partial A
  \ar[d]_{i^A}
  \ar[r]^{s}
&
  X
  \ar[d]^{p}
\\
  \yon A
  \ar[r]^{t}
&
  Y \rlap{.}
}
\end{equation}
We need to choose a filler for it such that for every non-trivial codegeneracy $d \co A \to B$ and factorisation of~\eqref{trivial-fibration-to-regular:0} as below,
\begin{equation} \label{trivial-fibration-to-regular:1}
\xymatrix@C+3em{
  \partial A
  \ar[r]^{\yon(d) \cc i^A}
  \ar[d]_{i^A}
  % \ar@/^2em/[rr]^{s}
&
  \yon B
  \ar@{.>}[r]^{s'}
  \ar@{=}[d]
&
  X
  \ar[d]^{p}
\\
  \yon A
  \ar[r]_{\yon(d)}
%  \ar@/_2em/[rr]_{t}
&
  \yon B
  \ar@{.>}[r]_{t'}
&
  Y
}
\end{equation}
the chosen filler for the now composite square coheres with the unique filler for the right square.

We do this by case distinction (using the law of excluded middle) on whether a factorisation~\eqref{trivial-fibration-to-regular:1} exists at all.
If none exist, we choose the filler provided to us by $p$ being a trivial fibration.
If one exists, we choose $s' \cc \yon(d)$ as filler.

It only remains to justify that the latter choice is independent of the particular factorisation.
This is where we use the assumption that the Reedy category $\R$ is elegant.
\cref{pushout-non-trivial-deg-boundary} below shows that any two factorings through non-trivial codegeneracies $d_1$ and $d_2$ extends to a common factoring through the pushout of $d_1$ and $d_2$, yielding independence as required.
Note this also shows the existence of a unique largest factoring since $\alpha$ is wellfounded.
\end{proof}

\begin{lemma}
\label{pushout-non-trivial-deg-boundary}
Let $d_i \co A \to B_i$ be a non-trivial codegeneracy for $i \in \braces{1, 2}$.
Then the span $(d_1, d_2)$ has a pushout $(e_1, e_2)$ with $e_i \co B_i \to C$ a codegeneracy for $i \in \braces{1, 2}$.
The image of this square under the Yoneda embedding is again pushout.
Furthermore, this pushout is stable under right composition with the boundary inclusion $i^A \co \partial A \to \yon A$.
\end{lemma}

\begin{proof}
Everything up until the last sentence is part of the characterization of elegancy in~\cite[Proposition~3.8]{bergner-rezk-elegant}.
For the remaining claim, note that right composing the pushout square under consideration with $\partial A \to \yon A$ is tantamount to applying $\Sk_{\deg(A)}$ to the square since we assumed $d_1, d_2$ to be non-trivial, \ie degree reducing.
But $\Sk_{\deg(A)}$ is a left adjoint and hence preserves pushouts.
\end{proof}

Note that the construction of \cref{trivial-fibration-to-regular} does not seem to extend to functor from the category of trivial fibrations to the category of regular trivial fibrations over $\catE^{\to}$.

\medskip

We will now relate regular trivial fibrations with uniform trivial fibrations.
For this, we need to show how it is possible to reduce a lifting problem involving monomorphisms to lifting problems involving boundary inclusions.

\begin{definition} A \emph{cellular presentation} of a monomorphism $i \co U \to V$ in $\catE$ is a cocontinuous ordinal-indexed diagram $F \co \gamma \to \catE_{\backslash U}$ with colimit $i$
\[
\xymatrix{
  U = F 0
  \ar[r]^-{F s_0}
&
  F 1
  \ar[r]^{F s_1}
&
  \ldots
  \ar[r]
&
  V
}
\]
such that for $\beta + 1 < \gamma$, the image of a successor step $s_{\beta} \co \beta \to \beta + 1$ under $F$ is a (possibly infinite) coproduct of boundary inclusions.
\end{definition}

Since $\R$ is elegant, every monomorphism $i \co U \to V$ in $\catE$ admitsa \emph{canonical cellular presentation} indexed by $\alpha$, in which the $\beta$-th successor step adds the non-degenerate representables of degree $\beta$ in $V$ not contained in $U$.
Note that a transfinite composition of cobase changes of coproducts of cellular presentations can be flattened to a single cellular presentation.

\begin{proposition} \label{regular-trivial-fibration-to-uniform}
Every regular trivial fibration can be given the structure of a uniform trivial fibration.
\end{proposition}

\begin{proof} Let $p \co X \to Y$ be a regular trivial fibration.
Let $i \co U \to V$ be a monomorphism and consider a lifting problem as follows:
\begin{equation} \label{regular-trivial-fibration-is-uniform:0}
\xycenter{
  U
  \ar[d]_{i}
  \ar[r]
&
  X
  \ar[d]^{p}
\\
  V
  \ar[r]
  \ar@{.>}[ur]
&
  Y
\rlap{.}
}
\end{equation}
Since $\R$ is elegant, we have a cellular presentation for $i$ as per the preceding discussion.
As a regular trivial fibration, note that $p$ has fillers for lifting problems against boundary inclusions.
This induces a filler in~\eqref{regular-trivial-fibration-is-uniform:0}.
Importantly, standard reasoning used in the theory of Reedy categories shows that this filler is independent of the particular cellular presentation chosen.

It remains to verify coherence of fillers with respect to pullback squares between monomorphisms:
\begin{equation} \label{regular-trivial-fibration-is-uniform:1}
\xycenter{
  U'
  \ar[d]_{i'}
  \ar[r]
  \pullback{dr}
&
  U
  \ar[d]_(0.3){i}
  \ar[r]
&
  X
  \ar[d]^{p}
\\
  V'
  \ar[r]
  \ar@{.>}[urr]
&
  V
  \ar[r]
  \ar@{.>}[ur]
&
  Y
\rlap{.}}
\end{equation}
Choose a cellular presentation for $i$.
Base change along $V' \to V$ induces a corresponding transfinite decomposition of $i'$ into cobase changes of coproducts of monomorphisms.
Since the fillers for squares~\eqref{regular-trivial-fibration-is-uniform:0} are independent of the chosen cellular presentation, it suffices to verify coherence of fillers in~\eqref{regular-trivial-fibration-is-uniform:1} with $i$ replaced by a single boundary inclusion as in~\eqref{regular-trivial-fibration-is-uniform:2} below and apply transfinite induction to the chosen cellular presentation for $i$.

It remains to verify coherence of fillers with respect to pullback squares between monomorphisms with representable sink:
\begin{equation} \label{regular-trivial-fibration-is-uniform:2}
\xycenter{
  U'
  \ar[d]_{i'}
  \ar[r]
  \pullback{dr}
&
  \partial A
  \ar[d]_(0.3){i^A}
  \ar[r]
&
  X
  \ar[d]^{p}
\\
  V'
  \ar[r]_{m}
  \ar@{.>}[urr]^(0.3){e'}
&
  \yon A
  \ar[r]
  \ar@{.>}[ur]_{e}
&
  Y
\rlap{.}}
\end{equation}
Choose a cellular presentation $F \co \gamma \to \catE \backslash U'$ for $i'$.
For $\beta < \gamma$, let $e_{\beta}' \co F(\beta) \to X$ denote the $\beta$-th stage of the construction of the composite filler $e'$ in~\eqref{regular-trivial-fibration-is-uniform:2} and write $t_{\beta} \co F(\beta) \to V'$ for the leg of the colimiting cocone of $V'$ under $F$.
Note that $e_{\beta}' = e' t_{\beta}$.
We will show that $e' t_{\beta} = e m t_{\beta}$ by transfinite induction on $\beta$.
Passing to the colimit, it will then follow that $e' m = e$ as required.

For the actual induction, the limit step similarly follows by passing to the colimit.
For the successor step, let $\beta$ with $\beta + 1 < \gamma$ be given.
We want to show $e_{\beta+1}' = e m t_{\beta+1}$ assuming that $e_{\beta}' = e m t_{\beta}$, \ie
\begin{equation} \label{regular-trivial-fibration-is-uniform:ih}
  e_{\beta+1}' \cc F(s_{\beta}) = e m t_{\beta+1} \cc F(s_{\beta}) \, .
\end{equation}
Here we have recalled that $e_{\beta}' = e_{\beta+1}' \cc F(s_{\beta})$ and $t_{\beta} = t_{\beta+1} \cc F(s_{\beta})$ where $F(s_{\beta})$ is given as a cobase change of a coproduct of boundary inclusions.
It will suffice to focus on one such boundary inclusion as shown below:
\begin{equation} \label{regular-trivial-fibration-is-uniform:3}
\xycenter{
  \bullet
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  U'
  \ar[rr]
  \ar[d]
  \pullback{dr}
&&
  \partial A
  \ar[r]
  \ar[dd]_(0.6){i^A}
&
  X
  \ar[dd]^{p}
\\
  \partial B
  \ar[r]^{b'}
  \ar[d]_{i^B}
  \pullback{dr}
&
  F(\beta)
  \ar[d]_{F(s_{\beta})}
  \ar@{.>}[urrr]^(0.4){e_{\beta}'}
\\
  \yon B
  \ar[r]_-{b}
&
  F(\beta+1)
  \ar[r]_-{t_{\beta+1}}
  \ar@{.>}[uurrr]_(0.4){e_{\beta+1}'}
&
  V'
  \ar[r]_{m}
&
  \yon A
  \ar[r]
  \ar@{.>}[uur]^{e}
&
  Y
\rlap{,}}
\end{equation}
and verify that $e_{\beta+1}' b = e m t_{\beta+1} b$, which will be our goal for the remainder of this proof.
Here, the right pullback is derived from the pullback in~\eqref{regular-trivial-fibration-is-uniform:2} using that $t_{\beta+1}$ is mono.
Recall that $e_{\beta+1}' b$ is by construction the filler for the above lifting problem from $i^B$ to $p$ provided by the given right lifting structure of $p$.

Write $m t_{\beta+1} b = \yon(d)$ with $d \co B \to A$.
Note that $d$ has to be codegenerate.
For otherwise, we would have $\yon(d)$ lifting through $i^A \co \partial A \to \yon A$.
Recalling that the base change of $i^A$ along itself is an isomorphism since $i^A$ is mono, it would follow that the base change of $i^A$ along $\yon(d)$ is an isomorphism as well.
But as seen in~\eqref{regular-trivial-fibration-is-uniform:3}, this isomorphism would lift through $i^B$, making $i^B$ a retraction and hence an isomorphism, a contradiction.

We will proceed by case distinction on whether $d$ is the identity on $A$, \ie $B = A$ and $m t_{\beta+1} b = \id_A$.
If that is the case, then the goal reduces to $e_{\beta+1}' b = e$.
But $e$ and $e_{\beta+1}' b$ are fillers for the same lifting problem from $i^A$ to $p$.
Since they have both been provided by the given right lifting structure of $p$, they are equal.

The remaining and main case is that $d$ is non-trivially codegenerate.
But then we can make use of $\cal{J}$-coherence in the following comparison of lifting problems:
\[
\xymatrix{
  \partial B
  \ar[r]
  \ar[d]_{i^B}
  \pullback{dr}
&
  F(\beta)
  \ar[rr]
  \ar[d]_{F(s_{\beta})}
&&
  \yon A
  \ar[r]^{e}
  \ar@{=}[d]
&
  X
  \ar[d]^{p}
\\
  \yon B
  \ar[r]_{b}
  \ar@{.>}[urrrr]_(0.6){e_{\beta+1}' b}
&
  F(\beta+1)
  \ar[r]_-{t_{\beta+1}}
&
  V'
  \ar[r]_-{m}
&
  \yon A
  \ar[r]
  \ar@{.>}[ur]_{e}
&
  Y
\rlap{.}}
\]
Commutativity of the top triangle of the composite square follows from the induction hypothesis~\eqref{regular-trivial-fibration-is-uniform:ih}.
Recalling that the dotted fillers are provided by the given right lifting structure of $p$ as a regular trivial fibration, they cohere as needed.
\end{proof}

\begin{theorem} \label{thm:ac-kan-is-uniform} Let $\catE$ be the category of presheaves over an elegant Reedy category, equipped with a functorial cylinder $(\interval \otimes (-), \lcyl, \rcyl)$ such that the functor $\interval \otimes (-) \co \catE \to \catE$ has a right adjoint.
\begin{enumerate}[(i)]
\item Every trivial fibration admits the structure of a uniform trivial fibration,
\item Every fibration admits the structure of a uniform fibration.
\end{enumerate}
\end{theorem}

\begin{proof}
Part (i) follows by \cref{trivial-fibration-to-regular} and \cref{regular-trivial-fibration-to-uniform}.
For part (ii), let $p \co X \to Y$ be a fibration.
By the non-algebraic counterpart of \cref{prod-exp-general}, it follows that $\hatexp(\bar{\delta}^k, p)$
is a trivial fibration for $k \in \braces{0, 1}$, and hence a uniform trivial fibration by part (i).
The claim then follows by \cref{prod-exp-general}.
\end{proof}

\subsection*{Existence of natural weak factorisation systems}

\cref{small-gen-triv-kan} allows us to apply Garner's small object argument~\cite{garner:small-object-argument} and obtain two natural weak factorisation systems in which the right maps are the uniform trivial fibrations and the uniform fibrations, respectively.

\begin{theorem} \label{thm:sset-cset-nwfs}
There exist two natural weak factorisation systems $(\mathsf{L}_1, \mathsf{R}_1)$ and $(\mathsf{L}_2, \mathsf{R}_2)$ on $\catE$, in which right maps are the uniform trivial Kan fibrations and the uniform Kan fibrations, respectively.
In particular, every map $f \co X \to Y$ admits two functorial factorisations, one of the form
\[
\xymatrix{
  X \ar[rr]^f \ar[dr]_{i_f} & & Y \\
  & C_f \ar[ur]_{p_f}
}
\]
where $p_f$ admits the structure of a uniform trivial Kan fibration and $i_f$ admits the structure of a $\mathsf{L}_1$-coalgebra, and another of the form
\[
\xymatrix{
X \ar[rr]^f \ar[dr]_{i_f} & & Y \\
 & P_f \ar[ur]_{p_f} }
 \]
where $p_f$ admits the structure of a uniform fibration and $i_f$ admits the structure of a $\mathsf{L}_2$-coalgebra.
\end{theorem}

\begin{proof}
First, observe that the full subcategory of $\catE^\to$ spanned by monomorphisms with codomain a representable presheaf is small.
Now, since the inclusion~$u \co \cal{N} \hookrightarrow \catE^\to$ preserves $\omega$-filtered colimits, it is possible to apply Garner's small object argument to obtain an algebraic weak factorisation system $(\mathsf{L}_1, \mathsf{R}_1)$.
The fact that the category of $\mathsf{R}_1$-algebras is the category of uniform trivial fibrations follows from part~(i) of \cref{small-gen-triv-kan}.
For (ii), Garner's small object argument, it is sufficient to find a functor $v \co \cal{J} \rightarrow \catE^\to$ such that the category~$\cal{J}$ is small and the category of uniform Kan fibrations is isomorphic to~$\liftr{\cal{J}}$.
By part (ii) of~\cref{small-gen-triv-kan}, such a category is given by $u_\otimes \co \cal{N}_\otimes \rightarrow \catE^\to$, where $u \co \cal{N} \to \catE^\to$ is the evident inclusion.
\end{proof}

\cref{thm:sset-cset-nwfs} suggests the possibility of defining constructively model structures on $\SSet$ and $\CSet$ having as (trivial) fibrations the maps that admit the structure of a uniform (trivial) cofibration.
We leave this question to further investigation.


\section{The Frobenius and Beck-Chevalley conditions}
\label{sec:frobc}

\subsection*{The Frobenius condition}

The first aim of this section is to introduce the Frobenius condition for a map $f \co X \to Y$ with respect to a functor $u \co \cal{I} \to \catE^\to$.
As we will see in~\cref{lift-dependent-product}, analogously to the situation for Lawvere's original formulation of the Frobenius condition~\cite{lawvere-equality}, there is an equivalent formulation of our Frobenius condition that involves pushforward, rather than pullback, functors.
The second aim of this section is to introduce a counterpart of the well-known Beck-Chevalley conditions in our setting.
Also for this condition, we will provide an equivalent formulation, expressed using pushforward rather than pullback.

\medskip

We begin by introducing the Frobenius condition.

\begin{definition}[Frobenius condition] \label{thm:frobenius-def}
Let $u \co \cal{I} \to \catE^\to$ be a functor.
We say that a map $f \co X \to Y$ \emph{satisfies the Frobenius condition} with respect to $u$ if pullback along $f$ lifts to a functor
\[
\xymatrix@C=1.5cm{
  \cal{I}_{/Y}
  \ar[r]^{f^*}
  \ar[d]_{u/Y}
&
  \liftl{ ( \liftr{\cal{I}} )}_{/X}
  \ar[d]^{\liftl{(\liftr{u})/X}}
\\
  (\catE_{/Y})^\to \ar[r]_{f^*}
&
  (\catE_{/X})^\to \rlap{.}
}
\]
\end{definition}

Let us explain the connection between the Frobenius condition of \cref{thm:frobenius-def} and the Frobenius condition on a weak factorisation system, which states the the pullback along a right map preserves left maps~\cite{garner:types-omega-groupoids,garner:topological-simplicial} and is closely related to the axioms for identity types in Martin-L\"of type theory~\cite{gambino-garner:idtypewfs}.
Given a weak factorisation system $(\cal{L}, \cal{R})$ on a category $\catE$, we have that the pullback along a right map preserves left maps if and only if every right map satisfies the Frobenius condition with respect to the inclusion $\cal{L} \hookrightarrow \catE^\to$.

\begin{remark}
The Frobenius property for a weak factorisation system is closely related to the right properness condition for a model structure.
Indeed, a model structure where the cofibrations are stable under pullback (which is the case if they are the monomorphisms) is right proper if and only if the weak factorisation system given by trivial cofibrations and fibrations has the Frobenius property.
For example, the weak factorisation system on simplicial sets in which the right maps are the Kan fibrations has the Frobenius property.
The standard proof of this fact follows from the right properness of the Kan model structure on simplicial sets, which in turn can be established either using the right properness of the model structure on topological spaces in which the fibrations are the Serre fibrations~\cite[Theorem~13.1.13]{hirschhorn-model-localizations}.
Working purely combinatorially, it is possible to establish directly the Frobenius condition using the theory of minimal fibrations~\cite[Theorem~1.7.1]{joyal-tierney-notes}.
Note that, by the independence result in~\cite{coquand-non-constructivity-kan}, these arguments must use classical reasoning.
\end{remark}

\medskip

For a weak factorisation system in a category with pushforward functors, \ie right adjoints to pullbacks, the standard Frobenius condition is equivalent to saying that pushforward along a right map preserves right maps.
The counterpart of this equivalence in our setting is provided by the next proposition.

\begin{proposition} \label{lift-dependent-product}
Let $u \co \cal{I} \to \catE^\to$ be a functor.
For a map $f \co X \to Y$ admitting pushforward,
\[
\xymatrix@C+1em{
  \catE_{/Y}
  \ar@<5pt>[r]^{f^*}
  \ar@{}[r]|{\bot}
&
  \catE_{/X}
  \ar@<5pt>[l]^{f_*} \rlap{,}
}
\]
the following are equivalent:
\begin{enumerate}[(i)]
\item $f$ satisfies the Frobenius condition,
\item pushforward along $f$ lifts to a functor
\[
\xymatrix@C=1.5cm{
  {\liftr{\cal{I}}}_{/X}
  \ar[r]^{f_*}
  \ar[d]_{u_{/X}}
&
  {\liftr{\cal{I}}}_{/Y}
  \ar[d]^{{\liftr{u}}_{/Y}}
\\
  (\catE_{/X})^\to
  \ar[r]_{f_*}
&
  (\catE_{/Y})^\to \rlap{.}
}
\]

\end{enumerate}
\end{proposition}

\begin{proof}
Recall from \cref{pitchfork-slicing} that slicing commutes with the right orthogonality functor.
%For the first correspondence, apply \cref{lift-of-adjunction} to the adjunction $p^* \dashv p_*$ with $v = \liftr{u}$.
%The last statement is simply the adjunction~\eqref{garner-adjunction}.
Now apply \cref{lift-of-adjunction} to the adjunction $p^* \dashv p_*$ with $u = u_{/X}$ and $v = {\liftr{u}}_{/Y}$.
\end{proof}

\subsection*{The Beck-Chevalley condition}

In order to introduce the Beck-Chevalley condition, recall from \cref{exa:composition-pullback-lift} that for a functor $u \co \cal{I} \to \catE^\to$ and a map $f \co X \to Y$ in~$\catE$, left composition $f_! \co \calE/X \to \calE/Y$ lifts to a functor between slices of~$u$.

\begin{definition}[Beck-Chevalley condition] \label{def:beck-chevalley}
Let $f \co X \to Y$ and $g \co U \to V$ be maps that satisfy the Frobenius condition.
We say that a commutative square
\[
\xymatrix{
  X
  \ar[d]_{f}
  \ar[r]^{s}
&
  U
  \ar[d]^{g}
\\
  Y
  \ar[r]_{t}
&
  V
}
\]
satisfies the \emph{Beck-Chevalley condition} if the canonical natural transformation
\[
\xymatrix{
  (\catE^\to)_{/Y}
   \ar[d]_{t_!}
  \ar[r]^{f^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\phi$}}
&
  (\catE^\to)_{/X}
  \ar[d]^{s_!}
\\
  (\catE^\to)_{/V}
  \ar[r]_{g^*}
&
  (\catE^\to)_{/U}
}
\]
lifts to a natural transformation
\[
\xymatrix@C+3em{
   \cal{I}_{/Y}
    \ar[r]^{f^*}
     \ar[d]_{t_!}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\phi'$}}
   &
  {\liftl{(\liftr{\cal{I}})}}_{/X}
  \ar[d]^{\liftl{(\liftr{s_!})}} \\
  \cal{I}_{/V}
   \ar[r]_{g^*}
 &
   {\liftl{(\liftr{\cal{I}})}}_{/U} \rlap{.}
}
\]
satisying evident coherence conditions with respect to $\phi$.
\end{definition}

\begin{remark}
If the given commutative square is a pullback, then the canonical natural transformation $\phi \co s_! f^* \to g^* t_!$ is an isomorphism (by the usual Beck-Chevalley condition), and so is $\phi'$ since $\liftl{(\liftr{u})}$ reflects isomorphisms.
\notec{Make this a separate earlier remark, shortens proof of first proposition in second section.}
\end{remark}

In analogy with \cref{lift-dependent-product}, we provide an equivalent formulation of the Beck-Chevalley condition of \cref{def:beck-chevalley} in terms of pushforward, rather than pullback, functors.
In order to state this characterization, recall from \cref{exa:composition-pullback-lift} that for a functor $u \co \cal{I} \to \catE^\to$ and a map $s \co X \to U$, the pullback functor $s^* \co \catE^\to_{/U} \to \catE^\to_{/X}$ lifts to a functor $s^* \co {\liftr{\cal{I}}}_{/U} \to {\liftr{\cal{I}}}_{/X}$.

\begin{proposition} \label{lift-pushforward-BC}
Let $u \co \cal{I} \to \catE^\to$ be a functor.
Let $f \co X \to Y$ and $g \co U \to V$ be maps that satisfy the Frobenius condition.
For a square
\[
\xymatrix{
  X
  \ar[d]_{f}
  \ar[r]^{s}
&
  U
  \ar[d]^{g}
\\
  Y
  \ar[r]_{t}
&
  V
}
\]
the following statements are equivalent:
\begin{enumerate}[(i)]
\item the square $(s,t)$ satisfies the Beck-Chevalley condition,
\item the canonical natural transformation
\[
\xymatrix@C+2em{
  \catE^\to_{/U}
  \ar[r]^{g_*}
   \ar[d]_{s^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\phi$}}
&
\catE^\to_{/V}
 \ar[d]^{t^*}
\\
  \catE^\to_{/X}
  \ar[r]_{f_*}
&
  \catE^\to_{/Y}
}
\]
lifts to a natural transformation
\[
\xymatrix@C+2em{
  {\liftr{\cal{I}}}_{/U}
  \ar[r]^{g_*}
  \ar[d]_{s^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\phi'$}}
&
  {\liftr{\cal{I}}}_{/V}
  \ar[d]^{t^*}
\\
  {\liftr{\cal{I}}}_{/X}
  \ar[r]_{f_*}
&
  {\liftr{\cal{I}}}_{/Y}
}
\]
satisying the evident coherence conditions with respect to $\psi$.
\end{enumerate}
\end{proposition}

\begin{proof}
Recall from \cref{pitchfork-slicing} that slicing commutes with the right orthogonality functor.
Now apply \cref{lift-of-adjunction} in the form of a natural correspondence (not just a logical equivalence) with $u = u/V$ and $v = \liftr{u}/X$ while noting that the construction of \cref{lift-of-adjunction} as applied in \cref{exa:composition-pullback-lift} and \cref{lift-dependent-product} composes (meaning the correspondence of \cref{lift-of-adjunction} commutes with composition of adjunctions).
\end{proof}

As we will see in \cref{sec:frocuf}, morphisms of uniform $\cal{I}$-fibrations satisfy the Beck-Chevalley condition under very mild assumptions on $u \co \cal{I} \to \catE^\to$.
In particular, morphisms of uniform fibrations in presheaf categories satisfy the Beck-Chevalley condition.

\subsection*{The uniform Frobenius condition}

We conclude this section by providing a combination of the Frobenius and Beck-Chevalley conditions.
Indeed, these two conditions can be seen as the component for objects of $\catE^\to$ and the component for morphisms of $\catE^\to$ of a global condition.

\begin{definition}[Uniform Frobenius condition]
Let $u \co \cal{I} \to \catE^\to$.
We say that $v \co \cal{J} \to \catE^\to$ satisfies the \emph{uniform Frobenius condition} with respect to $u$ if for every object $j \in \cal{J}$ the morphism $v_j \co C_j \to D_j$ satisfies the Frobenius condition with respect to $u$, and for every morphism $\tau \co j \to j'$ in $\cal{J}$, the square $v_\tau$
\[
\xymatrix{
C_j \ar[r] \ar[d]_{v_j} & C_{j'} \ar[d]^{v_{j'}} \\
D_j \ar[r] & D_{j'}}
\]
satisfies the Beck-Chevalley condition with respect to $u$.
\end{definition}

\noten{Add some discussion of this notion and forward references to its uses}


\section{The Frobenius and Beck-Chevalley conditions for uniform fibrations}
\label{sec:frocuf}

\subsection*{The Frobenius condition}

The aim of this section is to show that, under suitable hypotheses, uniform fibrations to satisfy the Frobenius condition, and in particular that uniform fibrations in presheaf categories always satisfy the Frobenius condition.
The proof of the main result in this section, \cref{thm:frobenius-fibrations}, relies on two key steps, one following from our earlier results on strong homotopy equivalences and one on right orhogonality classes.
For the reminder of this section, we fix a category $\catE$ with finite limits and colimits, equipped with a functorial cylinder functor $(\interval \otimes (-), \rcyl \otimes (-), \lcyl \otimes (-), \ccyl \otimes (-))$ with connections, and a functor $u \co \cal{I} \to \catE^\to$.

\medskip

The first key step to prove \cref{thm:frobenius-fibrations} is the following lemma, whose technical proof is given in the appendix.

\begin{lemma} \label{strong-h-equiv-base-change-along-fibration}
Let $u : \cal{I} \to \catE^\to$ and $v : \cal{J} \to \catE^\to$ be functors.
Let $p \co X \to Y$ be a right map for $\kcylinv \otimes \id_{\calE} : \catE \to \catE^\to$ where $k \in \braces{0, 1}$.
Assume that pullback along $p$ lifts to a functor $p^* \co \cal{I}_{/Y} \to \cal{J}_{/X}$.
Then it lifts further to a functor $p^* \co \cal{S}_k(\cal{I})_{/Y} \to \cal{S}_k(\cal{J})_{/X}$,
\[
\xymatrix@C+2em{
  \cal{S}_k(\cal{I})_{/Y}
  \ar@{.>}[r]^{p^*}
  \ar[d]
&
  \cal{S}_k(\cal{J})_{/X}
  \ar[d]
\\
  \cal{I}_{/Y}
  \ar[r]^{p^*}
  \ar[d]_{u_{/Y}}
&
  \cal{J}_{/X}
  \ar[d]^{v_{/X}}
\\
  (\catE_{/Y})^\to
  \ar[r]_{p^*}
&
  (\catE_{/X})^\to \rlap{.}
}
\]
\end{lemma}

\begin{proof}
See Appendix~\ref{app:tecp}.
\end{proof}

We are now ready to prove the main result of this section.
Recall that we are working in the setting of a finitely complete and cocomplete category $\catE$ equipped with a functorial cylinder with connections.
Broadly speaking, it should be read as saying that if pullback along a fibration preserves cofibrations, then it preserves trivial cofibrations.

\begin{theorem} \label{thm:frobenius-fibrations}
Let $u \co \cal{I} \to \catE^\to$ be a functor that is closed with respect to Leibniz product with endpoint inclusions, and let $(p,\phi) \co X \to Y$ be a uniform $\cal{I}$-fibration.
Assume that $p$ satisfies the Frobenius condition with respect to $u \co \cal{I} \to \catE^\to$.
Then $p$ satisfies the Frobenius condition with respect to $u_\otimes \co \cal{I}_\otimes \to \catE^\to$.
\end{theorem}

\begin{proof}
We assume that the pullback along $p$ lifts to a functor
\[
\xymatrix@C+2em{
  \cal{I}_{/Y}
  \ar[r]^{p^*}
  \ar[d]_{u_{/Y}}
&
  \cal{I}_{/X}
  \ar[d]^{u_{/X}}
\\
  (\catE_{/Y})^\to
  \ar[r]_{p^*}
&
  (\catE_{/X})^\to \rlap{.}
}
\]
We will show that $p^*$ also lifts to a functor
\[
\xymatrix@C+2em{
  (\cal{I}_\otimes)_{/Y} \ar[r]^{p^*} \ar[d]_{u_{\otimes}/Y} & \overline{\cal{I}_\otimes}_{/X} \ar[d]^{u_{\otimes}/X} \\
  (\catE_{/Y})^\to \ar[r]_{p^*} & (\catE_{/X})^\to \rlap{.}
}
\]
which implies the claim by \cref{retract-closure}.
By the definiton of $u_\otimes \co \cal{I} \to \catE^\to$, as given in~\eqref{equ:u-tensor}, it suffices to separately show that $p^*$ lifts to functors
\[
\xymatrix@C+2em{
  \cal{I}_{/Y}
  \ar[r]^{p^*}
  \ar[d]_{(\kcyl \hatotimes u)_{/Y}}
&
  \overline{\cal{I}}_{/X}
  \ar[d]^{ \overline{\kcyl \hatotimes u}_{/X}}
\\
  (\catE_{/Y})^\to
  \ar[r]_{p^*}
&
  (\catE_{/X})^\to \rlap{,}
}
\]
for $k \in \braces{0, 1}$.
Since a uniform $\cal{I}$-fibration is in particular a $(\kcyl \otimes \id_\catE)$-right map, we can apply \cref{strong-h-equiv-base-change-along-fibration} and observe that the pullback functor lifts as follows:
\[
\xymatrix@C+2em{
  \cal{S}_k(\cal{I})_{/Y}
  \ar[r]^{G}
  \ar[d]
&
  \cal{S}_k(\cal{I})_{/X}
  \ar[d] \\
  (\catE_{/Y})^\to
  \ar[r]_{p^*}
&
  (\catE_{/X})^\to \rlap{.}
}
\]
Composing this with the the functors of \cref{lem:from-strong-hequiv} and \cref{lem:to-strong-hequiv}, we obtain
\[
\xymatrix{
  \cal{I}_{/Y}
  \ar[rr]^{M_{/Y}}
  \ar[dr]_{(\kcyl \hatotimes u)_{/Y}} &
&
  \cal{S}_k(\cal{I})_{/Y}
  \ar[r]
  \ar[dl]
&
  \cal{S}_k(\cal{I})_{/X}
  \ar[rr]^{L_{/X}}
  \ar[dr]
& &
  \overline{\cal{I}_{/X}}
  \ar[dl]^{\overline{\kcyl \hatotimes u}_{/X}}
\\ &
  (\catE_{/Y})^\to
  \ar[rrr]_{p^*}
&&&
  (\catE_{/X})^\to \rlap{.}
}
\]
as required.
\end{proof}

As a corollary, we obtain the pushforward version of the Frobenius property for uniform~$\cal{I}$-fibrations.

\begin{corollary} \label{thm:frobenius-pushforward}
Let $p \co X \to Y$ be a uniform $\cal{I}$-fibration.
Assume that $p$ satisfies the Frobenius condition with respect to $u \co \cal{I} \to \catE^\to$.
Then pushforward along $p$ lifts to a functor
\[
\xymatrix@C+2em{
  \Fib[\cal{I}]_{/X} \ar[r]^{p_*} \ar[d] & \Fib[\cal{I}]_{/Y} \ar[d] \\
  (\catE_{/X})^\to \ar[r]_{p_*} & (\catE_{/Y})^\to
}
\]
\end{corollary}

\begin{proof} The claim follows from~\cref{thm:frobenius-fibrations} and \cref{lift-dependent-product}.
\end{proof}

\begin{example}[The Frobenius property for uniform fibrations in presheaf categories] \label{frobenius-uniform-presheaf}
Let $\catE$ be a category of presheaves equipped with a functorial cylinder $(\interval \otimes (-), \lcyl \otimes (-), \rcyl \otimes (-))$ with effective connections such that $\lcyl$ and $\rcyl$ are decidable monomorphisms.
Recall that we write $u \co \cal{M} \hookrightarrow \catE^\to$ for the inclusion of the subcategory of decidable monomorphisms and pullback squares.
Note that $\cal{M}$ is closed under Leibniz product with endpoint inclusions since decidable monomorphisms are closed under Leibniz product in the category of sets.
Since pulling back preserves decidable monomorphisms and pullback squares between them, it follows that every uniform fibration (in fact, any map) satisfies the Frobenius property with respect to $\cal{M} \hookrightarrow \catE^\to$.
Therefore, pushforward along $p$ lifts to a functor
\[
\xymatrix@C+2em{
  \Fib_{/X} \ar[r]^{p_*} \ar[d]_{} & \Fib_{/Y} \ar[d] \\
  (\catE_{/X})^\to \ar[r]_{p_*} & (\catE_{/Y})^\to \rlap{.}
}
\]
In particular, the pushforward of a uniform fibrations along a uniform fibration is again a uniform fibration.
\end{example}

\begin{example}[The Frobenius property for uniform Kan fibrations]
As a special case of \cref{frobenius-uniform-presheaf}, we obtain that in $\SSet$ the pushforward of a uniform Kan fibrations along a uniform Kan fibration is again a uniform Kan fibration.
We consider this a constructive counterpart of the result that the pushforward along a Kan fibration preserves Kan fibrations~\cite{voevodsky-simplicial-model}, which cannot be proved constructively~\cite{coquand-non-constructivity-kan}.
Obviously, since exponentiation is a special case of pushforward, this result shows also that the exponential of two uniform Kan complexes (defined in the evident way) is again a Kan complex.
\end{example}

\noten{Need to add something about cubical sets}

\subsection*{The Beck-Chevalley condition for uniform fibrations}
% \label{sec:becccu}

We conclude the paper by providing some general conditions for morphisms of uniform fibrations to satisfy the Beck-Chevalley condition.
In particular, we will show that morphisms of uniform fibrations in presheaf categories, such as simplicial and cubical sets, always satisfy the Beck-Chevalley condition.

\medskip

Let us consider a fixed category $\catE$ with finite limits and colimits, equipped with a functorial cylinder $(\interval \otimes, \rcyl \otimes (-), \lcyl \otimes (-), \ccyl \otimes (-))$.
Let us fix $(\kcyl \otimes \id_\catE)$-maps, for $k \in \{0 , 1\}$, $p \co X \to Y$ and $q \co U \to V$, and a morphism of $(\kcyl \otimes \id_\catE)$-maps
\begin{equation} \label{strong-h-equiv-base-change-along-fibration-BC:0}
\begin{gathered}
\xymatrix{
X \ar[r]^s \ar[d]_{p} & U \ar[d]^{q} \\
Y \ar[r]_t & V
\rlap{.}}
\end{gathered}
\end{equation}
Let us write $\phi$ for the canonical natural transformation
\begin{equation} \label{strong-h-equiv-base-change-along-fibration-BC:1}
\begin{gathered}
\xymatrix{
  \catE/Y
  \ar[r]^{p^*}
  \ar[d]_{t_!}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\phi$}}
&
  \catE/X
  \ar[d]^{s_!}
\\
  \catE/V
  \ar[r]_{q^*}
&
  \catE/U
}
\end{gathered}
\end{equation}

The key to prove the Beck-Chevalley property for morphisms of uniform $\cal{I}$-fibrations (under some hypotheses on $u \co \cal{I} \to \catE$) is the next lemma.
For its statement, recall from \cref{exa:composition-pullback-lift} that $s_!$ and $t_!$ lift to slices of $\cal{I}$, and note that they also lift to slices of $\cal{S}_k(\cal{I})$.

\begin{lemma} \label{strong-h-equiv-base-change-along-fibration-BC}
Let $u : \cal{I} \to \catE^\to$ and $v : \cal{J} \to \catE^\to$ be functors.
Let $p_1 \co X_1 \to Y_1$ and $p_2 \co X_2 \to Y_2$ be maps satisfying the assumptions of \cref{strong-h-equiv-base-change-along-fibration} with $k \in \braces{0, 1}$.
Let $(s, t) : p_1 \to p_2$ be a morphism of $(\kcylinv \otimes \id_\catE)$-right maps.
If the canonical natural transformation $\phi \co s_! p^* \to q^* t_!$ lifts to a natural transformation $\phi'$:
\begin{equation*} %\label{strong-h-equiv-base-change-along-fibration-BC:3}
\begin{gathered}
\xymatrix{
  \cal{I}_{/Y_1}
  \ar[r]^{p_1^*}
  \ar[d]_{t_!}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\phi'$}}
&
  \cal{J}_{/X_1}
  \ar[d]^{s_!}
\\
  \cal{I}_{/Y_2}
  \ar[r]_{p_2^*}
&
  \cal{J}_{/X_2}
\rlap{,}}
\end{gathered}
\end{equation*}
then it lifts further to a natural transformation $\phi''$:
\begin{equation*} %\label{strong-h-equiv-base-change-along-fibration-BC:3}
\begin{gathered}
\xymatrix{
  \cal{S}_k(\cal{I})_{/Y_1}
  \ar[r]^{p_1^*}
  \ar[d]_{t_!}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle\phi''$}}
&
  \cal{S}_k(\cal{J})_{/X_1}
  \ar[d]^{s_!}
\\
  \cal{S}_k(\cal{I})_{/Y_2}
  \ar[r]_{p_2^*}
&
  \cal{S}_k(\cal{J})_{/X_2}
\rlap{.}}
\end{gathered}
\end{equation*}
\end{lemma}

\begin{proof}
See Appendix~\ref{app:tecp}.
\end{proof}

\begin{theorem} \label{thm:beck-chevalley-unif}
Let $u \co \cal{I} \to \catE^\to$ be a functor that is closed with respect to Leibniz product with endpoint inclusions.
Consider a morphism $(s, t) : p \to q$ of uniform $\cal{I}$-fibrations $p \co X \to Y$ and $q \co U \to V$:
\[
\xymatrix{
  X \ar[r]^s \ar[d]_{p} & U \ar[d]^{q} \\
  Y \ar[r]_t & V
\rlap{.}}
\]
Assume that $(s,t) \co p \to q$ satisfies the Beck-Chevalley condition with respect to $u \co \cal{I} \to \catE^\to$.
Then $(s,t) \co p \to q$ satisfies the Beck-Chevalley condition with respect to $u_\otimes \co \cal{I}_\otimes \to \catE^\to$.\end{theorem}

\begin{proof} The argument is analogous to that of \cref{thm:frobenius-fibrations} and hence we omit it.
\end{proof}


\begin{corollary} \label{thm:beck-chevalley-unif-push}
Let $u \co \cal{I} \to \catE^\to$ be a functor that is closed with respect to Leibniz product with endpoint inclusions.
If $(s,t) \co p \to q$ satisfies the Beck-Chevalley condition with respect to $u \co \cal{I} \to \catE^\to$, then the canonical natural transformation $\psi \co t^* q_* \to p_* s^*$ lifts to a natural transformation
\[
\xymatrix@C+2em{
  \Fib[\cal{I}]_{/U}
  \ar[r]^{q_*}
  \ar[d]_{s^*}
  \ar@{}[dr]|{\textstyle\Downarrow \rlap{$\labelstyle \psi''$}}
&
  \Fib[\cal{I}]_{/V}
  \ar[d]^{t^*}
\\
  \Fib[\cal{I}]_{/X}
  \ar[r]_{p_*}
&
  \Fib[\cal{I}]_{/Y}
}
\]
satisfying coherence with respect to $\psi$.
\end{corollary}

\begin{proof}
 The claim follows from \cref{thm:beck-chevalley-unif} and \cref{lift-pushforward-BC}.
\end{proof}


\begin{example}[Beck-Chevalley condition for uniform fibrations in presheaf categories]
It is easily checked that the canonical natural transformation $\phi \co t^* q_* \to p_* \, s^*$ of functors $\catE_{/U}^\to \to \catE_{/Y}^\to$ is valued in pullback squares.
Hence, we can lift it as required in \cref{thm:beck-chevalley-unif} and \cref{thm:beck-chevalley-unif-push} and obtain that maps of uniform fibrations satisfy the Beck-Chevalley condition.
\end{example}



\appendix

\section{Two technical proofs}
\label{app:tecp}

\begin{proof}[Proof of \cref{strong-h-equiv-base-change-along-fibration}]
\noten{Proof needs to be checked.}
We work with the characterization of \cref{strong-h-equiv-as-section}.
We define separately the action of the lift $p^* \co \cal{S}_k(\cal{I})_{/Y} \to \cal{S}_k(\cal{I})_{/Y}$ on objects and on morphisms.
For the action on objects, suppose we are given $i \in \cal{I}_{/Y}$ such that $u_i$ is a strong left homotopy equivalence.
This means we have a commutative triangle
\[
\xymatrix{
  A
  \ar[rr]^{u_i}
  \ar[dr]
&&
  B
  \ar[dl]
\\&
  Y
}
\]
and a retraction $\rho$ to $\thetak \hatotimes i$ as follows:
\[
\xymatrix@C+1em{
  u_i
  \ar[r]^-{\thetak \hatotimes u_i}
  \ar@{=}[dr]
&
  \kcyl \hatotimes u_i \ar[d]^{\rho}
\\&
  u_i
\rlap{.}}
\]
Let $\sigma \co v_{j} \to u_i$ denote the pullback of $i$ along $p$ with $j \co \cal{I}$:
\[
\xymatrix{
  C
  \ar[r]
  \ar[d]_{v_{j}}
  \pullback{dr}
&
  A
  \ar[d]^{u_i}
\\
  D
  \ar[r]
  \ar[d]
  \pullback{dr}
&
  B
  \ar[d]
\\
  X
  \ar[r]_p
&
  Y
\rlap{.}}
\]
We want to make $v_{j}$ into a strong left homotopy equivalence.
This means to find a retraction $\pi$ to $\thetak \hatotimes i$ as follows:
\[
\xymatrix@C+1em{
  v_{j}
  \ar[r]^-{\thetak \hatotimes v_{j}}
  \ar@{=}[dr]
&
  \kcyl \hatotimes v_{j}
  \ar@{.>}[d]^{\pi}
\\&
  v_{j}
}
\]
We will construct the retraction $\pi$ as indicated in the below diagram where the two horizontal composites should be identities.
\[
\xymatrix@C+2em{
  v_{j}
  \ar[r]^-{\thetak \hatotimes v_{j}}
  \ar[d]_{\sigma}
&
  \kcyl \hatotimes v_{j}
  \ar@{.>}[r]^-{\pi}
  \ar[d]_{\kcyl \hatotimes \sigma}
&
  v_{j}
  \ar[d]^{\sigma}
\\
  u_i
  \ar[r]_-{\thetak \hatotimes u_i}
&
  \kcyl \hatotimes u_i
  \ar[r]_-{\rho}
&
  u_i
}
\]
Since $\sigma$ is a pullback square, it suffices to solve this problem when projected to codomains:
\[
\xymatrix@C+4em{
  D
  \ar[r]^-{\kcylinv \otimes D}
  \ar[d]_{\cod(\sigma)}
&
  \interval \otimes D
  \ar@{.>}[r]^{\cod(\pi)}
  \ar[d]^{\interval \otimes \cod(\sigma)}
&
  D
  \ar[d]^{\cod(\sigma)}
\\
  B
  \ar[r]_-{\kcylinv \otimes B}
&
  \interval \otimes B
  \ar[r]_-{\cod(\rho)}
&
  B
}
\]
We will now lift this diagram from $\catE$ to the total space of the codomain fibration on $\catE$, again omitting drawing the identity constraints for the horizontal composites for readability:
\[
\xymatrix@C+2em{
  D
  \ar[r]^-{\kcylinv \otimes D}
  \ar[dd]_{\cod(\sigma)}
  \ar@/_2em/[drrr]
&
  \interval \otimes D
  \ar@{.>}[r]^{\cod(\pi)}
  \ar[dd]^(0.7){\interval \otimes \cod(\sigma)}
  \ar@{-->}@/_1em/[drr]
&
  D
  \ar[dd]^(0.8){\cod(\sigma)}
  \ar[dr]
\\&&&
  X
  \ar[dd]^{p}
\\
  B
  \ar[r]^-{\kcylinv \otimes B}
  \ar@/_2em/[drrr]
&
  \interval \otimes B
  \ar[r]^-{\cod(\rho)}
  \ar@/_1em/[drr]
&
  B
  \ar[dr]
\\&&&
  Y
\rlap{.}}
\]
The arrows to $Y$ from the bottom row are induced by $B \to Y$.
The square $\cod(\sigma)$ over $p$ is a pullback by construction.
If we can find a dashed arrow cohering as indicated, there will hence be a unique dotted arrow as indicated.
To find the dashed arrow is to construct a diagonal filler in the following square:
\[
\xymatrix@C+3em{
  D
  \ar[rr]
  \ar[d]_{\kcylinv \otimes D}
&&
  X
  \ar[d]^{p}
\\
  \interval \otimes D
  \ar[r]_{I \otimes \cod(\sigma)}
  \ar@{-->}[urr]
&
  \interval \otimes B
  \ar[r]
&
  Y
\rlap{.}}
\]
But we have such a filler since $p$ is a $(\kcylinv \otimes \id_\catE)$-right map by assumption.

\medskip

We now define the action of the lift $p^*$ on morphisms.
Suppose we are given a map $\tau \co (i_1, \rho_1) \to (i_2, \rho_2)$ of strong homotopy equivalences over $Y$.
This consists of a map $\tau \co i_1 \to i_2$ in $\cal{I}$ living over $Y$ as depicted below:
\[
\xymatrix{
  A_1 \ar[rr]^{u_{i_1}}  \ar[d]  & & B_1 \ar[d] \\
  A_2  \ar[rr]^{u_{i_2}} \ar[dr] & & B_2 \ar[dl] \\
  & Y \rlap{,}}
\]
such that $\tau$ commutes with the retractions $\rho_1$ and $\rho_2$ as follows:
\[
\xymatrix@C+2em{
  \kcyl \hatotimes u_{i_1}
  \ar[r]^-{\rho_1}
  \ar[d]_{\kcyl \hatotimes u_\tau}
&
  u_{i_1}
  \ar[d]^{u_\tau}
\\
  \kcyl \hatotimes u_{i_2}
  \ar[r]_-{\rho_2}
&
  u_{i_2}
\rlap{.}}
\]
Let $(j_1, \pi_1)$ and $(j_2, \pi_2)$ denote the action of the lift $p^*$ on the objects $(i_1, \rho_1)$ and $(i_2, \rho_2)$, respectively, as constructed in the previous paragraph.
Recall that this includes pullback squares
\[
\begin{aligned}
  \sigma_1 &\co v_{j_1} \to u_{i_1}
\, ,\\
  \sigma_2 &\co v_{j_2} \to u_{i_2}
\end{aligned}
\]
Cartesian over $p \co X \to Y$.
Since the base change functor lifts to a functor from $\cal{I}_{/Y}$ to $\cal{J}_{/X}$ by assumption, the morphism $\tau \co i_1 \to i_2$ in $\cal{I}_{/Y}$ pulls back to a morphism $\upsilon \co j_1 \to j_2$ in $\cal{J}_{/Y}$.
We want to show that $\upsilon$ in addition forms a morphism of strong left homotopy equivalences $\upsilon \co (j_1, \pi_1) \to (j_2, \pi_2)$.
For this, we have to verify commutativity of the following diagram:
\[
\xymatrix@C+2em{
  \kcyl \hatotimes v_{j_1}
  \ar[r]^-{\pi_1}
  \ar[d]_{\kcyl \hatotimes u_{\upsilon}}
&
  v_{j_1}
  \ar[d]^{u_{\upsilon}}
\\
  \kcyl \hatotimes v_{j_2}
  \ar[r]_-{\pi_2}
&
  v_{j_2}
\rlap{.}}
\]
Recall the construction of $\pi_1$ and $\pi_2$, omitting horizontal composite identity arrows for readability:
\[
\xymatrix@C+2em{
  v_{j_1}
  \ar[rr]^-{\thetak \hatotimes v_{j_1}}
  \ar[dd]_{\sigma_1}
  \ar[dr]^{u_{\upsilon}}
&&
  \kcyl \hatotimes v_{j_1}
  \ar@{.>}[rr]^-{\pi_1}
  \ar[dd]^(0.3){\kcyl \hatotimes \sigma_1}
  \ar[dr]^{\kcyl \hatotimes u_{\upsilon}}
&&
  v_{j_1}
  \ar[dd]^(0.3){\sigma_1}
  \ar[dr]^{u_{\upsilon}}
\\&
  v_{j_2}
  \ar[rr]^-(0.3){\thetak \hatotimes v_{j_2}}
  \ar[dd]_(0.3){\sigma_2}
&&
  \kcyl \hatotimes v_{j_2}
  \ar@{.>}[rr]^-(0.3){\pi_2}
  \ar[dd]^(0.3){\kcyl \hatotimes \sigma_2}
&&
  v_{j_2}
  \ar[dd]^(0.3){\sigma_2}
\\
  u_{i_1}
  \ar[rr]^-(0.25){\thetak \hatotimes u_{i_1}}
  \ar[dr]^{u_\tau}
&&
  \kcyl \hatotimes u_{i_1}
  \ar[rr]^-(0.3){\rho_1}
  \ar[dr]^{\kcyl \hatotimes u_{\upsilon}}
&&
  u_{i_1}
  \ar[dr]^{u_\tau}
\\&
  u_{i_2}
  \ar[rr]^-{\thetak \hatotimes u_{i_2}}
&&
  \kcyl \hatotimes u_{i_2}
  \ar[rr]^-{\rho_2}
&&
  u_{i_2}
\rlap{.}}
\]
Our goal is to show that the top right square commutes.
Since that square commutes after composing it with the pullback square $\sigma_2$, it suffices to show that the square commutes when projected to codomains, omitting horizontal composite identity arrows for readability:
\[
\xymatrix@C+2em{
  D_1
  \ar[rr]^-{\kcylinv \otimes D_1}
  \ar[dd]_{\sigma_1}
  \ar[dr]^{\cod(u_{\upsilon})}
&&
  \interval \otimes D_1
  \ar@{.>}[rr]^-{\cod(\pi_1)}
  \ar[dd]^(0.3){\interval \otimes \cod(\sigma_1)}
  \ar[dr]^{\interval \otimes \cod(u_{\upsilon})}
&&
  D_1
  \ar[dd]^(0.3){\cod(\sigma_1)}
  \ar[dr]^{\cod(u_{\upsilon})}
\\&
  D_2
  \ar[rr]^-(0.3){\kcylinv \otimes D_2}
  \ar[dd]_(0.3){\cod(\sigma_2)}
&&
  \interval \otimes D_2
  \ar@{.>}[rr]^-(0.3){\cod(\pi_2)}
  \ar[dd]^(0.3){\interval \otimes \cod(\sigma_2)}
&&
  D_2
  \ar[dd]^(0.3){\cod(\sigma_2)}
\\
  B_1
  \ar[rr]^-(0.25){\kcylinv \otimes B_1}
  \ar[dr]^{\cod(u_\tau)}
&&
  \interval \otimes B_1
  \ar[rr]^-(0.3){\cod(\rho_1)}
  \ar[dr]^{\interval \otimes \cod(u_{\upsilon})}
&&
  B_1
  \ar[dr]^{\cod(u_\tau)}
\\&
  B_2
  \ar[rr]^-{\kcylinv \otimes B_2}
&&
  \interval \otimes B_2
  \ar[rr]^-{\cod(\rho_2)}
&&
  B_2
\rlap{.}}
\]
The dotted arrows were constructed by extending the back and front faces of this diagram to the total space of the codomain fibration and then appealing to the universal property of the Cartesian morphisms $\cod(\sigma_1)$ and $\cod(\sigma_2)$ over $p$.
For our goal it will thus suffice to show that the maps from the back to the front face coherently extend to the total space of the codomain fibration as well.
This is canonically the case except potentially for the top middle map $\interval \otimes D_1 \to \interval \otimes D_2$.
For this, we have to verify coherence of the dashed arrows as indicated below:
\[
\xymatrix@C+2em{
  D_1
  \ar[rrrr]
  \ar[dd]_{\kcylinv \otimes D_1}
  \ar[dr]^{\cod(u_{\upsilon})}
&&&&
  X
  \ar[dd]^(0.3){p}
  \ar@{=}[dr]
\\&
  D_2
  \ar[rrrr]
  \ar[dd]_(0.7){\kcylinv \otimes D_2}
&&&&
  X
  \ar[dd]^{p}
\\
  \interval \otimes D_1
  \ar[rr]_(0.7){I \otimes \cod(\sigma_1)}
  \ar@{-->}[uurrrr]
  \ar[dr]_{I \otimes \cod(u_{\upsilon})}
&&
  \interval \otimes B_1
  \ar[rr]
  \ar[dr]^(0.7){\interval \otimes \cod(u_\tau)}
&&
  Y
  \ar@{=}[dr]
\\&
  \interval \otimes D_2
  \ar[rr]_{I \otimes \cod(\sigma_2)}
  \ar@{-->}[uurrrr]
&&
  \interval \otimes B_2
  \ar[rr]
&&
  Y
\rlap{.}}
\]
But the left face forms a morphism in the category $\kcylinv \otimes \id_\catE \co \catE \to \catE^\to$ of arrows; since $p$ was assumed a $(\kcylinv \otimes \id_\catE)$-right map, its right lifting structure is coherent as needed.
\end{proof}

\begin{proof}[Proof of \cref{strong-h-equiv-base-change-along-fibration-BC}]
\noten{This proof needs to be checked.}
By faithfulness of the functor $\cal{S}_k(\cal{J})_{/Y_2} \to \cal{J}_{/Y_2}$, we only have to check objectwise lifting.
Suppose we are given a strong left homotopy equivalence $(i, \rho) \in \cal{I}_{/X_1}$ over $X_1$.
This means we have a commutative triangle
\[
\xymatrix{
  A
  \ar[rr]^{u_i}
  \ar[dr]
&&
  B
  \ar[dl]
\\&
  X_1
}
\]
and a retraction $\rho$ to $\thetak \hatotimes i$ in $\catE^\to$:
\[
\xymatrix@C+1em{
  u_i
  \ar[r]^-{\thetak \hatotimes u_i}
  \ar@{=}[dr]
&
  \rcyl \hatotimes u_i \ar[d]^{\rho}
\\&
  u_i
\rlap{.}}
\]
Let $\sigma_1 \co v_{j_1} \to u_i$ and $\sigma_2 \co v_{j_2} \to u_i$ with $j_1, j_2 : \cal{J}$ denote the base changes of $i$ over along $p_1$ and $p_2$, respectively:
\[
\xymatrix{
  C_1
  \ar[rr]
  \ar[dd]_{v_{j_1}}
  \pullback{dr}
  \ar@{.>}[dr]
&&
  A
  \ar[dd]^(0.3){u_i}
  \ar@{=}[dr]
\\&
  C_2
  \ar[rr]
  \ar[dd]_(0.3){v_{j_2}}
  \pullback{dr}
&&
  A
  \ar[dd]^{u_i}
\\
  D_1
  \ar[rr]
  \ar[dd]
  \pullback{dr}
  \ar@{.>}[dr]
&&
  B
  \ar[dd]
  \ar@{=}[dr]
\\&
  D_2
  \ar[rr]
  \ar[dd]
  \pullback{dr}
&&
  B
  \ar[dd]
\\
  Y_1
  \ar[rr]^(0.7){p_1}
  \ar[dr]^{t}
&&
  X_1
  \ar[dr]^{s}
\\&
  Y_2
  \ar[rr]^(0.3){p_2}
&&
  X_2
\rlap{.}}
\]
Recall that we have a canonical morphism $\phi_{u_i}^\to \co v_{j_1} \to v_{j_2}$ over $Y_2$ as indicated in the diagram.
By assumption, this lifts to a morphism $\phi_j \co j_1 \to j_2$ in $\cal{J}_{/Y_2}$.

The proof of \cref{strong-h-equiv-base-change-along-fibration} endows $j_1$ and $j_2$ with data for a strong left homotopy equivalence consisting of retracts $\pi_1$ and $\pi_2$, respectively.
Our goal is to check that $\phi_j$ lifts to a morphism in $\cal{S}(\cal{J})_{/Y_2}$, \ie to verify that $\phi_{u_i}^\to$ coheres as follows:
\[
\xymatrix@C+2em{
  \rcyl \hatotimes v_{j_1}
  \ar[r]^-{\pi_1}
  \ar[d]_{\rcyl \hatotimes u_{\upsilon}}
&
  v_{j_1}
  \ar[d]^{u_{\upsilon}}
\\
  \rcyl \hatotimes v_{j_2}
  \ar[r]_-{\pi_2}
&
  v_{j_2}
\rlap{.}}
\]
$\upsilon$
Recall the construction of $\pi_1$ and $\pi_2$, where we omit again the horizontal composite identities:
\[
\xymatrix@C+2em{
  v_{j_1}
  \ar[rr]^-{\thetak \hatotimes v_{j_1}}
  \ar[dd]_{\sigma_1}
  \ar[dr]^{u_{\phi_j}}
&&
  \rcyl \hatotimes v_{j_1}
  \ar@{.>}[rr]^-{\pi_1}
  \ar[dd]^(0.3){\rcyl \hatotimes \sigma_1}
  \ar[dr]^{\kcyl \hatotimes u_{\phi_j}}
&&
  v_{j_1}
  \ar[dd]^(0.3){\sigma_1}
  \ar[dr]^{u_{\phi_j}}
\\&
  v_{j_2}
  \ar[rr]^-(0.3){\thetak \hatotimes v_{j_2}}
  \ar[dd]_(0.3){\sigma_2}
&&
  \rcyl \hatotimes v_{j_2}
  \ar@{.>}[rr]^-(0.3){\pi_2}
  \ar[dd]^(0.3){\rcyl \hatotimes \sigma_2}
&&
  v_{j_2}
  \ar[dd]^(0.3){\sigma_2}
\\
  u_i
  \ar[rr]^-(0.25){\thetak \hatotimes u_i}
  \ar@{=}[dr]
&&
  \rcyl \hatotimes u_i
  \ar[rr]^-(0.3){\rho}
  \ar@{=}[dr]
&&
  u_i
  \ar@{=}[dr]
\\&
  u_i
  \ar[rr]^-{\thetak \hatotimes u_i}
&&
  \rcyl \hatotimes u_i
  \ar[rr]^-{\rho}
&&
  u_i
\rlap{.}}
\]
Our goal is to show that the top right square commutes.
Since that square commutes after composing it with the Cartesian square $\sigma_2$, it suffices to show that the square commutes when projected to codomains:
\[
\xymatrix@C+2em{
  D_1
  \ar[rr]^-{\kcylinv \otimes D_1}
  \ar[dd]_{\sigma_1}
  \ar[dr]^{\cod(u_{\upsilon})}
&&
  \interval \otimes D_1
  \ar@{.>}[rr]^-{\cod(\pi_1)}
  \ar[dd]^(0.3){\interval \otimes \cod(\sigma_1)}
  \ar[dr]^{\interval \otimes \cod(u_{\upsilon})}
&&
  D_1
  \ar[dd]^(0.3){\cod(\sigma_1)}
  \ar[dr]^{\cod(u_{\upsilon})}
\\&
  D_2
  \ar[rr]^-(0.3){\kcylinv \otimes D_2}
  \ar[dd]_(0.3){\cod(\sigma_2)}
&&
  \interval \otimes D_2
  \ar@{.>}[rr]^-(0.3){\cod(\pi_2)}
  \ar[dd]^(0.3){\interval \otimes \cod(\sigma_2)}
&&
  D_2
  \ar[dd]^(0.3){\cod(\sigma_2)}
\\
  B
  \ar[rr]^-(0.25){\kcylinv \otimes B}
  \ar@{=}[dr]
&&
  \interval \otimes B
  \ar[rr]^-(0.3){\cod(\rho)}
  \ar@{=}[dr]
&&
  B
  \ar@{=}[dr]
\\&
  B
  \ar[rr]^-{\kcylinv \otimes B}
&&
  \interval \otimes B
  \ar[rr]^-{\cod(\rho)}
&&
  B
}
\]
The dotted arrows were constructed by extending the back and front faces of this diagram to the total space of the codomain fibration and then appealing to the universal property of the Cartesian squares $\cod(\sigma_1)$ and $\cod(\sigma_2)$ over $p$.
For our goal, it will thus suffice to show that the maps from the back to the front face coherently extend to the total space of the codomain fibration as well.
This is canonically the case except potentially for the top middle map $\interval \otimes D_1 \to \interval \otimes D_2$.
For this, we have to verify coherence of the dashed arrows as indicated below:
\[
\xymatrix@C+2em{
  D_1
  \ar[rrrr]
  \ar[dd]_{\kcylinv \otimes D_1}
  \ar[dr]^{\cod(u_{\upsilon})}
&&&&
  Y_1
  \ar[dd]^(0.3){p_1}
  \ar[dr]^{t}
\\&
  D_2
  \ar[rrrr]
  \ar[dd]_(0.7){\kcylinv \otimes D_2}
&&&&
  Y_2
  \ar[dd]^{p_2}
\\
  \interval \otimes D_1
  \ar[rr]_(0.7){I \otimes \cod(\sigma_1)}
  \ar@{-->}[uurrrr]
  \ar[dr]_{I \otimes \cod(u_{\upsilon})}
&&
  \interval \otimes B_1
  \ar[rr]
  \ar@{=}[dr]
&&
  X_1
  \ar[dr]^{s}
\\&
  \interval \otimes D_2
  \ar[rr]_{I \otimes \cod(\sigma_2)}
  \ar@{-->}[uurrrr]
&&
  \interval \otimes B_2
  \ar[rr]
&&
  X_2
}
\]
But the right face forms a morphism of $(\kcylinv \otimes \id_\catE)$-right maps by assumption; its right lifting structures hence cohere as needed.
\end{proof}


\bibliographystyle{plain}
\bibliography{../../common/uniform-kan-bibliography}

\end{document}
