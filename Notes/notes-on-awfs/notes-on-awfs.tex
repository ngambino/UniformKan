\documentclass[reqno,10pt,a4paper,oneside]{amsart}

\usepackage{uniform-kan-prelude}

\title{Remarks on Algebraic Weak Factorization Systems}

\begin{document}

\begin{abstract}
We collect some general remarks concerning algebraic weak factorization systems in view of later applications.
\end{abstract}

\maketitle

\tableofcontents

Recall the notion of \emph{algebraic weak factorization system} from~\cite{garner:small-object-argument} (there called \emph{natural weak factorization system}).

\section{Identifying Isomorphic Algebraic Weak Factorization Systems}

The motivation for this section is \cref{monos-into-representables,decidable-monos-into-representables}, providing a partial justification for choosing (decidable) monomorphisms into representables (and cartesian squares as morphisms) as generating left category for algebraic fibrations in simplicial sets.

\subsection{An Easy Criterion}

Fix a cocomplete category $\cat{E}$. 
We prove an easy sufficient criterion for when a category over $\cat{E}^{\to}$ has the same free algebraic weak factorization system as a full subcategory of it.

\begin{proposition}
\label{criterion-for-cats-generating-same-awfs}
Consider a functor of categories over $\cat{E}^{\to}$ as follows:
\[
\xymatrix{
  \cat{C}
  \ar[rr]^{F}
  \ar[dr]_{I}
&&
  \cat{D}
  \ar[dl]^{J}
\\&
  \cat{E}^{\to}
}
\]
Suppose that $F$ is fully faithful and that $J$ is the left Kan extension of $I$ along $F$.
Then $I$ admits a free algebraic weak factorization system precisely if $J$ does, and the morphism between them induced by $F$ is an isomorphism.
\end{proposition}

\begin{proof}
Let $U$ denote the functor from algebraic weak factorization systems for $\cat{E}$ to categories over $\cat{E}^{\to}$ mapping $(L, R)$ to $\Coalg(L)$.
Recall that $(L, R)$ is free on $A : \CAT/\cat{E}^{\to}$ precisely if we have a map $\eta : A \to \Coalg(L)$ such that $((L, R), \eta)$ is initial in $A \downarrow U$.

Composition with $F$ induces a faithful functor from $J \downarrow U$ to $I \downarrow U$.
Let us show that this is an isomorphism, hence relates initial objects.
It will be enough to verify that for an algebraic weak factorization system $(L, R)$, any map $P : \cat{C} \to \Coalg(L)$ over $\cat{E}^{\to}$ factors uniquely through $F$ as indicated below:
\[
\xymatrix{
  \cat{C}
  \ar[rr]^{P}
  \ar[dr]^{F}
  \ar[ddr]_{I}
&&
  \Coalg(L)
  \ar[ddl]
\\&
  \cat{D}
  \ar@{.>}[ur]^{\exists !}
  \ar[d]^(0.3){J}
\\&
  \cat{E}^{\to}
}
\]
This follows by applying \cref{ugly-outsourced-lemma} below.
For this, note that $\cat{E}^{\to}$ and $\Coalg(L)$ are cocomplete with $\cat{E}$ and that the functor $\Coalg(L) \to \cat{E}^{\to}$ is strictly comonadic, hence cocontinuous and an amnestic isofibration.
\end{proof}

\begin{lemma}
\label{ugly-outsourced-lemma}
Consider categories and functors strictly commuting as indicated by solid lines below:
\[
\xymatrix{
  \cat{C}
  \ar[rr]^{P}
  \ar[dr]^{F}
%  \ar[ddr]_{I}
&&
  \cat{X}
  \ar[ddl]^{K}
\\&
  \cat{D}
  \ar@{.>}[ur]^{H}
  \ar[d]^(0.3){J}
\\&
  \cat{E}
}
\]
Assume that
\begin{itemize}
\item
$F$ is fully faithful,
\item
$J$ is the left Kan extension of some functor $I : \cat{C} \to \cat{E}$ along $F$,
\item
$\cat{X}$ and $\cat{E}$ are cocomplete and $K : \cat{X} \to \cat{E}$ creates colimits,
\item
$K$ is an amnestic isofibration.%
\footnote{
  A functor is \emph{amnestic} if any isomorphism mapping to an identity is itself an identity.
  An amnestic isofibration is characterized by unique lifts of isomorphisms given a lift of either its domain or codomain.
  This non-invariant assumption is necessary here because we are working with strict equality of functors.
}
\end{itemize}
Then there is a unique functor $H$ strictly cohering as indicated by the dotted line.
\end{lemma}

\begin{proof}
First of all, observe that given a diagram in $\cat{X}$ and a colimiting cone for it in $\cat{E}$, there is a strictly unique lift of this cone through the amnestic isofibration $K$ (lifting up to isomorphism uses cocompleteness and creation of colimits, existence of a strict lift uses the isofibration, and strict uniqueness uses amnesticity).

We define the desired functor $H : \cat{D} \to \cat{X}$ as follows.
All of the following will be functorial in $Y : \cat{D}$.
We consider the canonical cocone $Z$ of the diagram $F \downarrow Y \to \cat{C} \to \cat{D}$ with cotip $Y$.
Since $J = \Lan_F I$, the cocone $JZ$ is colimiting in $\cat{E}$.
By the constraint $HF = P$, the diagram part of $HZ$ needs to be $F \downarrow Y \to \cat{C} \to \cat{X}$.
By the constraint $KH = J$, the image of $HZ$ under $K$ needs to be the colimiting cocone $JZ$.
This determines $HZ$ uniquely according to the first paragraph, hence also its cotip $H(Y)$.

Note that for $Y = F(X)$ with $X : \cat{C}$, there is a canonical cocone over $F \downarrow F(X) \to \cat{C} \to \cat{X}$ with cotip $P(X)$ using full faithfulness of $F$.
This cocone satisfies the constraints of the previous paragraph (using $KP = JF$ for the second one), hence we have $HF = P$.
The other constraint $KH = J$ holds by construction.
\end{proof}

\subsection{Application to Presheaf Categories}

We now consider presheafs on a category $\cat{B}$.
Our intention is to apply \cref{criterion-for-cats-generating-same-awfs} to full subcategories of $(\Set^{\cat{B}})_{\cart}^{\to}$, the arrow category of presheafs on $\cat{B}$ with cartesian squares as morphisms:

\begin{proposition}
\label{awfs-on-arrows-into-representables}
Let $\cat{J}$ be a full subcategory of $(\Set^{\cat{B}})_{\cart}^{\to}$ closed under base change to representables.
Let $\cat{I}$ denote its restriction to arrows into representables.
\[
\xymatrix{
  \cat{I}
  \ar[rr]
  \ar[dr]
&&
  \cat{J}
  \ar[dl]
\\&
  (\Set^{\cat{B}})^{\to}
}
\]
Suppose that $\cat{I}$ is small, so that it generates an algebraic weak factorization system $(L, R)$ (algebraically) free on $\cat{I}$.
Then $(L, R)$ is also free on $\cat{J}$, with the universal maps related by $\cat{I} \to \cat{J}$.
It $\cat{J}$ is small, then $(L, R)$ will be algebraically free on $\cat{J}$.%
\footnote{
  Not being able to always show $(L, R)$ algebraically free on $\cat{J}$ is currently the drawback of arguing from the left instead of the right.
  The left side relates better to freeness, while the right side related better to algebraic freeness.
  But arguing from the right always starts with quantifying over a generic algebra never playing any role in the argument beside being lifted against from the left --- the real reasoning takes place entirely on the left in the form of colimit closure properties.
  So the left approach followed here is preferable from an asthetic point to the right approach previously written out.
  Algebraic freeness for non-small categories, if relevant, should follow as a technical corollary by set theoretic reasoning (Garner would know a nice way).
}
\end{proposition}

\begin{proof}
Garner's small object argument~\cite{garner:small-object-argument} generates an algebraic weak factorization system $(L, R)$ algebraically free on $\cat{I}$. 
It is also shown in~\cite{garner:small-object-argument} that algebraic freeness implies freeness.
For the first claim, we apply \cref{criterion-for-cats-generating-same-awfs}, offloading its proof obligations to the below \cref{left-kan-extension-of-representables}.
Finally, if $\cat{J}$ is also small, it will generate an algebraically free (hence free) algebraic weak factorization system itself.
By universality of freeness, it is isomorphic to $(L, R)$, which henceforth must be algebraically free on $\cat{J}$.
\end{proof}

\begin{lemma}
\label{left-kan-extension-of-representables}
In the situation of \cref{awfs-on-arrows-into-representables}, the inclusion $\cat{J} \to (\Set^{\cat{B}})^{\to}$ is the left Kan extension of $\cat{I} \to (\Set^{\cat{B}})^{\to}$ along $\cat{I} \to \cat{J}$.
\end{lemma}

\begin{question}
There should be an abstract argument here cleverly combining the codomain fibration and the corresponding left Kan extension claim for the codomain part
\[
\xymatrix{
  \cat{B}
  \ar[rr]^{y}
  \ar[dr]_{y}
&&
  \Set^{\cat{B}}
  \ar[dl]^{\id}
\\&
  \Set^{\cat{B}}
}
\]
which holds by the co-Yoneda lemma.
How does it go?
\end{question}

\begin{proof}
Since $(\Set^{\cat{B}})^{\to}$ is cocomplete, we can use the colimit formula for left Kan extensions to verify the claim.
All of the following will be functorial in an object $f : X \to Y$ of $\cat{J}$.
We consider the diagram indexed by cartesian squares
\[
\xymatrix{
  U
  \ar[r]
  \ar[d]_{h}
  \pullback{dr}
&
  X
  \ar[d]^{f}
\\
  \hom(\arghole, M)
  \ar[r]
&
  Y
}
\]
with $h : \cat{I}$ and valued $h$.
Our goal is to show that its colimit in $(\Set^{\cat{B}})^{\to}$ is $f$.
Using the assumption that $\cat{J}$ is closed under base change to representables, this is equivalently the diagram indexed by representables $s : \hom(\arghole, M) \to Y$ and valued $s^* i$.
Generalized to this level, the statement $\colim_{s : \hom(\arghole, M) \to Y} s^* f \simeq f$ holds since base change commutes with colimits and $\colim_{s : \hom(\arghole, M) \to Y} \hom(\arghole, M) \simeq Y$.
\end{proof}

\subsection{Application to Algebraic Cofibrations in Simplicial Sets}

The class of decidable monomorphisms is closed under base change.
We thus obtain as immediate consequences of \cref{awfs-on-arrows-into-representables}:

\begin{corollary}
\label{monos-into-representables}
The algebraically free algebraic weak factorization system generated by the full subcategory
\[\cat{I} = \braces{A \to \Delta^n\ \text{\normalfont{mono}}}\]
of $\SSetCart$ is also (algebraically) free on any other (small) full subcategory of monomorphisms containing $\cat{I}$.
\end{corollary}

\begin{corollary}
\label{decidable-monos-into-representables}
The algebraically free algebraic weak factorization system generated by the full subcategory
\[\cat{I}' = \braces{A \to \Delta^n\ \text{\normalfont{decidable mono}}}\]
of $\SSetCart$ is also (algebraically) free on any other (small) full subcategory of decidable monomorphisms containing $\cat{I}'$.
\end{corollary}

\section{Base Change for Algebras in an Algebraic Weak Factorization System}

\subsection{Preservation Results for Algebra Category Formation}

Consider a monad $S$ on a category $\cat{C}$ and a monad $T$ on a category $\cat{E}$ such that $T$ lies over $S$ with respect to a functor $P : \cat{E} \to \cat{C}$.
This gives rise to a functor $Q : \Alg(T) \to \Alg(S)$ strictly commuting as follows:
\begin{equation}
\label{relative-monad-situation}
\begin{gathered}
\xymatrix{
  \Alg(T)
  \ar[r]^-{U_T}
  \ar[d]^{Q}
&
  \cat{E}
  \ar[d]^{P}
\\
  \Alg(S)
  \ar[r]^-{U_S}
&
  \cat{C}
}
\end{gathered}
\end{equation}

\begin{lemma}
\label{Alg-preserves-cartesian-fib}
If $P$ is a cartesian fibration, then $Q$ is a cartesian fibration.
The top map $U_T$ in~\eqref{relative-monad-situation} creates cartesian morphisms.
\end{lemma}

\begin{remark}
This is entirely analogous to a certain lemma about inserter formation preserving cartesian fibrations from an unrelated write-up.
In fact, a corresponding generalization to quasi-categories in terms of almost-marked simplicial sets applies, which would also makes the proof far less redundant.
\end{remark}

\begin{proof}
Let us first show that $U_T$ reflects cartesian morphisms.
Consider the below situation of solid lines:
\[
\xymatrix{
  (X, \rho)
  \ar@{.>}[dr]_{f}
  \ar[drr]^{g}
\\&
  (Y, \sigma)
  \ar[r]_{h}
&
  (Z, \tau)
&
  \Alg(T)
  \ar[dd]^{Q}
\\
  (A, \alpha)
  \ar[dr]_{a}
  \ar[drr]^{b}
\\&
  (B, \beta)
  \ar[r]_{c}
&
  (C, \gamma)
&
  \Alg(S)
}
\]
With $h$ assumed $P$-cartesian, our goal is show unique existence of $f$ as indicated by the dotted line.
By assumption, we get a unique candidate $f$ after applying $U_S$ and $U_T$ to the situation.
We only need to verify that $f$ is an algebra map, \ie that the maps $f \cc \rho$ and $\sigma \cc T(f)$ over $a \cc \alpha = \beta \cc S(a)$ are identical.
Since $h$ is $P$-cartesian, this reduces to showing $h \cc f \cc \rho$ and $h \cc \sigma \cc T(f)$ identical, but this follows from $g$ and $h$ being algebra maps.

Let us now show that $Q$ has cartesian lifts.
Consider the below situation of solid lines:
\[
\xymatrix{
  (Y, \sigma)
  \ar@{.>}[r]_{\text{cart}}^{h}
&
  (Z, \tau)
&
  \Alg(T)
  \ar[d]^{Q}
\\
  (B, \beta)
  \ar[r]^{c}
&
  (C, \gamma)
&
  \Alg(S)
}
\]
We want to find $(Y, \sigma)$ and $h : (Y, \sigma) \to (Z, \tau)$ cartesian lifting as indicated.
We start be constructing a $P$-cartesian lift $h : Y \to Z$ after applying $U_S$ and $U_T$ to the situation.
Applying the previous paragraph, it remains to construct $\sigma : T(Y) \to Y$ over $\beta$ such that $h \cc \sigma = \tau \cc T(h)$.
But there is a unique such $\sigma$ since $h$ is $P$-cartesian and $c \cc \beta = \gamma \cc S(c)$ in the base $\cat{C}$.
Similary, we can deduce the algebra laws for $\sigma$ from those for $\tau$ by left composing with $h$.

By construction, the chosen cartesian lifts for $Q$ are preserved by $U_T$.
Since every cartesian morphism is suitably isomorphic to such a chosen lift, we deduce $U_T$ preserves cartesian morphisms.
\end{proof}

\begin{lemma}
\label{Alg-preserves-cocartesian-fib}
If $P$ is a cocartesian fibration and $T$ a cocartesian functor over $S$, then $Q$ is a cocartesian fibration.
The top map $U_T$ in~\eqref{relative-monad-situation} creates cocartesian morphisms.
\end{lemma}

\begin{remark}
This is almost dual to \cref{Alg-preserves-cartesian-fib}.
In fact, in the write-up for inserters mentioned earlier, it is exactly dual.
\end{remark}

\begin{proof}
Let us first show that $U_T$ reflects cocartesian morphisms.
Consider the below situation of solid lines:
\[
\xymatrix{
&&
  (Z, \tau)
\\
  (X, \rho)
  \ar[r]_{f}
  \ar[urr]^{g}
&
  (Y, \sigma)
  \ar@{.>}[ur]_{h}
&&
  \Alg(T)
  \ar[dd]^{Q}
\\&&
  (C, \gamma)
\\
  (A, \alpha)
  \ar[r]_{a}
  \ar[urr]^{b}
&
  (B, \beta)
  \ar[ur]_{c}
&&
  \Alg(S)
}
\]
With $f$ assumed $P$-cocartesian, our goal is show unique existence of $h$ as indicated by the dotted line.
By assumption, we get a unique candidate $h$ after applying $U_S$ and $U_T$ to the situation.
We only need to verify that $h$ is an algebra map, \ie that the maps $h \cc \sigma$ and $\tau \cc T(h)$ over $c \cc \beta = \gamma \cc S(c)$ are identical.
By assumption, also $T(f)$ is $P$-cocartesian.
With this, the goal reduces to showing $h \cc \sigma \cc T(f)$ and $\tau \cc T(h) \cc T(f)$ identical, but this follows from $f$ and $g$ being algebra maps.

Let us now show that $Q$ has cocartesian lifts.
Consider the below situation of solid lines:
\[
\xymatrix{
  (X, \rho)
  \ar@{.>}[r]_{\text{cocart}}^{f}
&
  (Y, \sigma)
&
  \Alg(T)
  \ar[d]^{Q}
\\
  (A, \alpha)
  \ar[r]^{a}
&
  (B, \beta)
&
  \Alg(S)
}
\]
We want to find $(Y, \sigma)$ and $f : (X, \rho) \to (Y, \sigma)$ cocartesian lifting as indicated.
We start be constructing a $P$-cocartesian lift $h : X \to Y$ after applying $U_S$ and $U_T$ to the situation.
Applying the previous paragraph, it remains to construct a structure map $\sigma : T(Y) \to Y$ over $\beta$ such that $f \cc \rho = \sigma \cc T(f)$.
But there is a unique such $\sigma$ since $T(f)$ is $P$-cocartesian and $a \cc \alpha = \beta \cc S(a)$ in the base $\cat{C}$.
Similarly, we can deduce the unit and multiplication laws for $\sigma$ from those for $\rho$ by right composing with $f$ and $T^2(f)$, respectively, using that these maps are $P$-cocartesian.

By construction, the chosen cocartesian lifts for $Q$ are preserved by $U_T$.
Since every cocartesian morphism is suitably isomorphic to such a chosen lift, we deduce $U_T$ preserves cocartesian morphisms.
\end{proof}

\begin{lemma}
\label{right-adjoints-in-2-cat-of-monads}
Consider a 1-cell $(L, \phi) : (A, S) \to (B, T)$ in the 2-category $\Mnd(\cat{C})$ of monads on some 2-category $\cat{C}$.
If $L : A \to B$ has a right adjoint $R : B \to A$ and $\phi$ is invertible, then $(L, \phi)$ has a right adjoint in $\Mnd(\cat{C})$.
\end{lemma}

\begin{proof}
This is routine verification.
Let $R : B \to A$ be the right adjoint to $L$.
Since in $\cat{C}$ the 2-cell
\[
\xymatrix{
  A
  \ar[r]^{L}
  \ar[d]_{S}
  \drtwocell<\omit>{\phi}
&
  B
  \ar[d]^{T}
\\
  A
  \ar[r]_{L}
&
  B
}
\]
is invertible, we can look at the mate of its inverse:
\[
\xymatrix{
  A
  \ar[d]_{S}
&
  B
  \ar[l]_{R}
  \ar[d]^{T}
  \dltwocell<\omit>{^\psi}
\\
  A
&
  B
  \ar[l]^{R}
}
\]
Using the calculus of mates, we verify that $(R, \psi) : (B, T) \to (A, S)$ is indeed a 1-cell in $\Mnd(\cat{C})$.

It remains to construct 2-cells $\epsilon : (L, \phi) \cc (R, \psi) \to \Id_{(A, S)}$ and $\eta : \Id_{(B, T)} \to (R, \psi) \cc (L, \phi)$ satisfying the triangle identifies.
Recall that a 2-cell in $\Mnd(\cat{C})$ is simply a 2-cell in $\cat{C}$ between the underlying 1-cells satisfying coherence with respect to the 2-cell parts of source and target.
We simply take the counit and unit 2-cells of the adjunction $L \dashv R$.
The coherence conditions will be tautologically satisfied by how $\psi$ was defined as a mate using the adjunction $L \dashv R$.

Finally, the triangle identities hold because they hold for the underlying adjunction $L \dashv R$, equality of 2-cells in $\Mnd(\cat{C})$ just being equality of the underlying 2-cells.
\end{proof}

\begin{lemma}
\label{Alg-preserves-right-adjoint-to-base-change}
Assume that
\begin{itemize}
\item
$P$ is a cartesian fibration,
\item
$P$ has cocartesian lifts over structure maps of $S$-algebras and $U_T$ preserves these,
\item
the Beck-Chevalley condition holds between the above cartesian and cocartesian lifts,%
\footnote{
  The last two conditions are likely not needed, but it helps with the presentation since it allows us to meld the fiberwise action of $T$ into a monad on the fiber.
  In the corresponding result for inserters, these conditions were not needed.
}
\item
$P$ has right adjoints to base change.
\end{itemize}
Let $d : (A, \alpha) \to (B, \beta)$ be a map of $S$-algebras
\[
\xymatrix{
  S(A)
  \ar[r]^{S(d)}
  \ar[d]^{\alpha}
&
  S(B)
  \ar[d]^{\beta}
\\
  A
  \ar[r]^{d}
&
  B
}
\]
such that $T$ maps cartesian lifts of $d$ to cartesian lifts of $S(d)$.
Then $Q$ has a right adjoint to base change along $d$.
\end{lemma}

\begin{question}
What about Beck-Chevalley for right adjoints to base change in $Q$?
\end{question}

\begin{proof}
Let $\gamma : S(C) \to C$ be an $S$-algebra.
By assumption, we have a cobase change $\gamma_! : P^{-1}(S(C)) \to P^{-1}(C)$.
This can be used to define a monad on $M_{(C, \gamma)}$ on $P^{-1}(C)$ as the following composition:
\[
\xymatrix{
  P^{-1}(C)
  \ar[r]^{T}
&
  P^{-1}(S(C))
  \ar[r]^-{\gamma_!}
&
  P^{-1}(C)
}
\]
Unit and multiplication of $T$ over $S$ carry over to $M_{(C, \gamma)}$ using that $T$ preserves $P$-cocartesian lifts of $S$-algebras.
With this, note that $Q^{-1}(C, \gamma)$ can equivalently be described as algebras over $M_{(C, \gamma)}$.

Returning to the map $d : (A, \alpha) \to (B, \beta)$ of $S$-algebras, note that $d^* : P^{-1}(B) \to P^{-1}(A)$ lifts to a morphism of monads $\phi_d : M_{(B, \beta)} \to M_{(A, \alpha)}$:
\begin{equation}
\label{Alg-preserves-right-adjoint-to-base-change:0}
\begin{gathered}
\xymatrix{
  P^{-1}(A)
  \ar[d]^{T}
&
  P^{-1}(B)
  \ar[l]^{d^*}
  \ar[d]^{T}
  \dltwocell<\omit>{^}
\\
  P^{-1}(S(A))
  \ar[d]^{\alpha_!}
&
  P^{-1}(S(B))
  \ar[l]^{S(d)^*}
  \ar[d]^{\beta_!}
  \dltwocell<\omit>{^}
\\
  P^{-1}(A)
&
  P^{-1}(B)
  \ar[l]^{d^*}
}
\end{gathered}
\end{equation}
We will use \cref{right-adjoints-in-2-cat-of-monads} to show that $\phi_d$ has a right adjoint $\psi_d$ in the 2-category of monads.
By \cref{right-adjoints-in-2-cat-of-monads}, this will be the case if $d^*$ has a right adjoint and the composite 2-cell in~\eqref{Alg-preserves-right-adjoint-to-base-change:0} is invertible.
But $d^*$ has a right adjoint by assumption.
The upper 2-cell in~\eqref{Alg-preserves-right-adjoint-to-base-change:0} is invertible because $T$ preserves $P$-cartesian lifts of $d$.
The lower 2-cell in~\eqref{Alg-preserves-right-adjoint-to-base-change:0} is invertible because of Beck-Chevalley.

Under the identifications $Q^{-1}(A, \alpha) \simeq \Alg(M_{(A, \alpha)})$ and $Q^{-1}(B, \beta) \simeq \Alg(M_{(B, \beta)})$, base change along $d$ in $Q$ corresponds to $\Alg(\phi_d)$.
The desired right adjoint to base change can thus be derived from $\phi_d \dashv \psi_d$ since the 2-functor $\Alg$ preserves adjunctions.
\end{proof}

\begin{corollary}
\label{Alg-preserves-right-adjoint-to-base-change-BC}
In the setting of \cref{Alg-preserves-right-adjoint-to-base-change}, consider a commutative square of $S$-algebras as follows:
\begin{equation}
\label{Alg-preserves-right-adjoint-to-base-change-BC:0}
\begin{gathered}
\xymatrix{
  (A, \alpha)
  \ar[r]^{d}
  \ar[d]^{a}
&
  (B, \beta)
  \ar[d]^{b}
\\
  (A', \alpha')
  \ar[r]^{d'}
&
  (B', \beta')
}
\end{gathered}
\end{equation}
Assume that $T$ preserves cartesianness of lifts of $d$ and $d'$ so that the respective right adjoints $R$ and $R'$ to base change in $Q$ along $d$ and $d'$ exist as per \cref{Alg-preserves-right-adjoint-to-base-change}.
If the right adjoints $d_*$ and $d_*'$ to base change in $P$ satisfy Beck-Chevalley with respect to the square
\[
\xymatrix{
  A
  \ar[r]^{d}
  \ar[d]^{a}
&
  B
  \ar[d]^{b}
\\
  A'
  \ar[r]^{d'}
&
  B'
}
\]
then $R$ and $R'$ satisfy Beck-Chevalley with respect to~\eqref{Alg-preserves-right-adjoint-to-base-change-BC:0} in $Q$.
\end{corollary}

\begin{proof}
We will continue to use the notation and identifications of the proof of \cref{Alg-preserves-right-adjoint-to-base-change}.
Our goal is to show that the mate
\[
\xymatrix{
  \Alg(M_{(A, \alpha)})
  \ar[r]^{\Alg(\psi_d)}
&
  \Alg(M_{(B, \beta)})
\\
  \Alg(M_{(A', \alpha')})
  \ar[r]^{\Alg(\psi_d)}
  \ar[u]^{\Alg(\phi_a)}
  \urtwocell<\omit>{^}
&
  \Alg(M_{(B', \beta')})
  \ar[u]^{\Alg(\phi_b)}
}
\]
is invertible.
By 2-functoriality, this will follow if we can show the mate
\[
\xymatrix{
  M_{(A, \alpha)}
  \ar[r]^{\psi_d}
&
  M_{(B, \beta)}
\\
  M_{(A', \alpha')}
  \ar[r]^{\psi_d}
  \ar[u]^{\phi_a}
  \urtwocell<\omit>{^}
&
  M_{(B', \beta')}
  \ar[u]^{\phi_b}
}
\]
invertible in the 2-category of monads.
But this holds since the underlying natural transformation
\[
\xymatrix{
  P^{-1}(A)
  \ar[r]^{d_*}
&
  P^{-1}(B)
\\
  P^{-1}(A')
  \ar[r]^{d_*}
  \ar[u]^{a^*}
  \urtwocell<\omit>{^}
&
  P^{-1}(B')
  \ar[u]^{b^*}
}
\]
is invertible by the Beck-Chevalley assumption for $P$.
\end{proof}

% An unfinished minimalistic ad-hoc attempt working with base change instead of cobase change
\begin{comment}
A $T$-algebra over $\alpha : S(A) \to A$ consists of $X$ over $A$ and $\rho : T(X) \to X$ over $\alpha$ such that $(X, \rho)$ is a $T$-algebra.
Equivalently, it consists of $X$ over $A$ and $\rho : T(X) \to \alpha^*(X)$ over $S(A)$ such that a modified unit law
\[
\xymatrix{
  X
  \ar[d]^{\mu_{T, X}'}
  \ar@{=}[r]
&
  X
  \ar@{=}[d]
\\
  \mu_{S, A}^* T(X)
  \ar[r]^{\eta_{S, A}^* \rho}
&
  (\alpha \cc \eta_{S, A})^* X
}
\]
and modified multiplication law
\[
\xymatrix@C+1em{
  T^2(X)
  \ar[r]^-{T(\rho)}
  \ar[d]^{\mu_{T, A}'}
&
  T(\alpha^* X) = \alpha^* T(X)
  \ar[r]^-{\alpha^* (\rho)}
&
  (S(\alpha) \cc \alpha)^* X
  \ar@{=}[d]
\\
  \mu_{S, A}^* T(X)
  \ar[rr]^-{\mu_{S, A}^* \rho}
&&
  (\alpha \cc \mu_{S, A})^* X
}
\]
over $A$ hold.

modified unit:
%  X --> T(X) over A --> S(A)
%  X --> (\eta_A^S)^* T(X) over A

modified multiplication:
%  T^2(X) -> T(X) over S^2(A) -> S(A)
%  T^*(X) -> (\mu_A^S)^* T(X) over S^2(A)

We define a functor $R$ from $Q^{-1}(A, \alpha)$ to $Q^{-1}(B, \beta)$ as follows.
Let $\rho : T(X) \to X$ be a $T$-algebra over $(A, \alpha)$.
Since $X : P^{-1}(A)$, we have $d_* X : P^{-1}(B)$.
Let us define a map $\sigma : T (d_* X) \to d_* X$ over $\beta$.
This is equivalent to defining $\sigma' : T (d_* X) \to \beta^* d_* X$.
By Beck-Chevalley, we have $\beta^* d_* \simeq S(d)_* \alpha^* X$ over $S(B)$.
So it is equivalent to defining $\sigma'' : T (d_* X) \to S(d)_* \alpha^* X$ over $S(B)$.
Using $S(d)^* \dashv S(d)_*$, it is equivalent to defining $\sigma''' : S(d)^* T(d_* X) \to \alpha^* X$ over $S(A)$.
This is the same as defining $\sigma'''' : S(d)^* T(d_* X) \to X$ over $\alpha$.
Using left composition with $\rho$, this follows from defining $\sigma''''' : S(d)^* T(d_* X) \to T(X)$ over $S(A)$.

%S(d)^* T(Y) --> T(d^* Y)

Let $\gamma : S(C) \to C$ be an $S$-algebra.
By assumption, we have cobase change functor $\gamma_! : P^{-1}(S(C)) \to P^{-1}(C)$.
The fiberwise functor $T : P^{-1}(C) \to P^{-1}(S(C))$ is not a monad on the fiber $P^{-1}(C)$, but we can rectify this deficit by instead working with $\gamma_! \cc T$, which has a monad structure induced by $T$.

We use it to define an endofunctor $M$ on $P^{-1}(C)$ as follows:
\[
\xymatrix{
  P^{-1}(C)
  \ar[r]^{T}
&
  P^{-1}(S(C))
  \ar[r]^{\gamma_!}
&
  P^{-1}(C)
}
\]
We can endow $M$ with a unit 
\end{comment}

\subsection{Application to (Right Parts of) Algebraic Weak Factorization Systems}

Let $\cat{E}$ be a locally cartesian-closed category.
We consider a codomain-preserving monad $R$ on $\cat{E}^{\to}$ (this is equivalent to the ``right part'' of an algebraic weak factorization system as explained in~\cite{garner:small-object-argument}).
This means that $R$ lies over the identity monad with respect to $\cod : \cat{E}^{\to} \to \cat{E}$.
We write $\Alg(R)$ for the category of algebras over $R$.
It comes with a strictly monadic functor $U : \Alg(R) \to \cat{E}^{\to}$.

\begin{corollary}
\label{Alg-over-cod-pres-monad-is-cartesian-fib}
The composition $\cod \cc U$ is a cartesian fibration.
\[
\xymatrix{
  \Alg(R)
  \ar[rr]^{U}
  \ar[dr]_{Q}
&&
  \cat{E}^{\to}
  \ar[dl]^{\cod}
\\&
  \cat{E}
}
\]
The functor $U$ creates cartesian lifts.
\end{corollary}

\begin{proof}
Apply \cref{Alg-preserves-cartesian-fib} to $R$ over $\Id_{\cat{E}}$ and note that $\Alg(\Id_{\cat{E}}) \simeq \cat{E}$.
\end{proof}

In particular, the action of base change for the cartesian fibration $\Alg(R) \to \cat{E}$ on the underlying map agrees with pullback; given a map $f : A \to B$ in the base $\cat{E}$, the corresponding base change functors as per the cleavage defined in \cref{Alg-preserves-cartesian-fib} commute strictly:
\[
\xymatrix{
  Q^{-1}(B)
  \ar[r]^{U}
  \ar[d]^{f^*}
&
  \cod^{-1}(B)
  \ar[d]^{f^*}
\\
  Q^{-1}(A)
  \ar[r]^{U}
&
  \cod^{-1}(A)
}
\]

\begin{corollary}
The cartesian fibration $Q$ in \cref{Alg-over-cod-pres-monad-is-cartesian-fib} has a right adjoint to base change along any map $f : A \to B$ in $\cat{E}$ such that $R$ preserves cartesian squares with bottom map $f$.
Furthermore, these right adjoints satisfy Beck-Chevalley with respect to pullback squares in the base.
\end{corollary}

\begin{proof}
Apply \cref{Alg-preserves-right-adjoint-to-base-change} and \cref{Alg-preserves-right-adjoint-to-base-change-BC} to $R$ over $\Id_{\cat{E}}$.
Note that structure maps of algebras over $\Id_{\cat{E}}$ are necessarily identities, hence the second and third conditions of \cref{Alg-preserves-right-adjoint-to-base-change} are vacuously satisfied.
\end{proof}

Note that this is analogous to the stable path objects condition of Warren, and also (by pullback pasting) the condition that left maps be preserved by pullback along right maps of Shulman, Joyal, and many others.

\bibliographystyle{plain}
\bibliography{../../common/uniform-kan-bibliography}

\end{document}